"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[7768],{93109:(e,t,s)=>{s.r(t),s.d(t,{LockScreen:()=>Wd,Main:()=>Vd});var a=s(31481),o=(s(48544),s(42347)),n=s(23174),i=s(89925),r=s(24585),d=s(96454),c=s(85982),l=s(46275),u=s(14487),h=s(87894),p=s(60343),m=s(43044),g=s(48775),f=s(6e4),I=s(37836),b=s(4875),v=s(90709),y=s(70636),w=s(13439),S=s(17872),A=s(32989),C=s(29807),M=s(22986),k=s(9716),F=s(5560),P=s(80140),T=s(26129),U=s(43503),x=s(76023);const B=32*x.$,N=45.5*x.$,R=26.5*x.$,J=16*x.$,E=16.125*x.$;var Y=s(16350),D=s(82150),L=s(43874);function O(e,t){return t-((0,C.nTw)(e).isLeftColumnShown&&!(0,L.Ny)()?e.leftColumnWidth||((s=U.A.get().width)>a.gQx?Math.min(Math.max(.25*s,J),.33*s):s>a.j7z?Math.min(Math.max(.33*s,J),.4*s):R):0);var s}function G(e,t,s){const a=(0,C.nZ4)(e,t.chatId),o=t.reactions||{results:[],areTags:a},n=(0,C.VF$)(e,t.chatId),i=(0,v.AK)(o.results,s);let{recentReactions:r=[]}=o;return r.length&&(r=r.filter((({isOwn:t,peerId:s})=>!t&&s!==e.currentUserId))),s.forEach((t=>{const{currentUserId:s}=e;"paid"!==t.type&&r.unshift({peerId:n?.id||s,reaction:t,addedDate:Math.floor(Date.now()/1e3),isOwn:!0})})),(0,D.r3)(e,t.chatId,t.id,{reactions:{...o,results:i,recentReactions:r}})}function V(e,t,s){return(0,Y.wi)(e,t,s,!0)}const j=350,q=1e3;let W=0;function z(e,t,s,a,o,n,i,r){const d=r?.reactions;if(d&&(0,M.T)(o,d))return e;const c=d?.results.find((e=>e.localAmount));if(c?.localAmount){const{localIsPrivate:e,localAmount:t,localPeerId:s}=c;o.results=(0,v.Ny)(o.results,t,e,s)}if(e=(0,S.r3y)(e,s,a,{reactions:o}),!i)return e;const{reaction:l,isOwn:h,isUnread:m}=o.recentReactions?.[0]??{};if((0,C.xYJ)(e,"reactionEffects")&&r&&l&&m&&!h){const e=(0,p.bj)(r);t.startActiveReaction({containerId:e,reaction:l,tabId:(0,u.g0)()})}const g=n.unreadReactions?.includes(a),f=(0,v.pU)(e,o);if(f&&!g){e=V(e,s,{unreadReactionsCount:(n?.unreadReactionsCount||0)+1,unreadReactions:[...n?.unreadReactions||[],a].sort(((e,t)=>t-e))});const t=(0,C.O5q)(e,s,a);if(!n||!t)return e;(0,I.aj)((()=>{(0,F.Oq)({chat:n,message:t,isReaction:!0})}))}return!f&&g&&(e=V(e,s,{unreadReactionsCount:(n?.unreadReactionsCount||1)-1,unreadReactions:n?.unreadReactions?.filter((e=>e!==a))})),e}function K(e,t,s,a,o=!1){const n=o?(0,C.Jl6)(e,t,s):(0,C.O5q)(e,t,s);if(n&&a.content&&!(0,p.iL)(s)){const{photo:e,video:t,sticker:s,document:o}=(0,v.r_)(n);e&&a.content.photo?(a.content.photo.blobUrl??=e.blobUrl,a.content.photo.thumbnail??=e.thumbnail):t&&a.content.video?a.content.video.blobUrl??=t.blobUrl:s&&a.content.sticker?a.content.sticker.isPreloadedGlobally??=s.isPreloadedGlobally:o&&a.content.document&&(a.content.document.previewBlobUrl??=o.previewBlobUrl)}const i=n?{...n,...a}:a;return o?(0,S.Egm)(e,t,s,i):(0,S.r3y)(e,t,s,i)}function _(e,t,s,a){const{chatId:o}=s,n=(0,T.Q)(s),{threadInfo:i}=(0,C.Tac)(e,s)||{};if(!i&&n?.replyToMsgId){const i=(0,C.O5q)(e,o,n.replyToMsgId);i?e=(0,S.Wwn)(e,i,o,s.id,a):t.loadMessage({chatId:o,messageId:n.replyToMsgId,threadUpdate:{isDeleting:a,lastMessageId:s.id}})}return e}function H(e,t,s){const{id:a,chatId:o}=s,i=(0,C.QP5)(e,s),{threadInfo:r}=(0,C.Tac)(e,s)||{},d=(0,C.hds)(e,o),c=d?.unreadCount&&!(0,C.gCU)(e,o,n.l3);e=_(e,t,s);const{threadId:l}=r??{threadId:i};return l&&(e=(0,S.d4w)(e,o,l,[a]),Object.values(e.byTabId).forEach((({id:t})=>{if((0,C.haw)(e,o,l,t)){const s=(0,C.RjD)(e,o,l),n=(0,S.fgD)(e,o,l,a,t),i=(0,C.rA3)(n,o,l,t);s&&!i.includes(s)||(e=n)}})),r&&(e=(0,S.eww)(e,o,l,"threadInfo",{...r,lastMessageId:s.id}),(0,v.Nb)(s)||(0,v._P)(s)||(e=(0,S.eAk)(e,o,l,{messagesCount:(r.messagesCount||0)+1})))),c||(e=(0,S.d4w)(e,o,n.l3,[a]),Object.values(e.byTabId).forEach((({id:t})=>{if((0,C.haw)(e,o,n.l3,t)){const s=(0,C.RjD)(e,o,n.l3),i=(0,S.fgD)(e,o,n.l3,a,t),r=(0,C.rA3)(i,o,n.l3,t);s&&!r.includes(s)||(e=i)}}))),e}function X(e,t,s,a=!1){const{chats:o}=e,n=o.byId[t],i=(0,C.ZZX)(e,t),r=n?.isForum?(0,C.nkm)(e,s):void 0;r&&(e=(0,S.TwA)(e,t,r.id,{lastMessageId:s.id}));const d=(0,C.QP5)(e,s);return d&&(e=(0,S.yKC)(e,d,s.id,"saved")),!i||a||i===s.id||i===s.previousLocalId||s.id>i?(0,S.yKC)(e,t,s.id):e}function $(e,t,s=n.l3){const a=(0,C.zeq)(e,t),o=(0,C.gCU)(e,t,s);if(!a||!o)return;let i=o.length;for(;i--;){const e=a[o[i]];if(e&&!e.isDeleting)return e}}function Q(e,t,s,a){if(t){const o=(0,C.hds)(e,t);if(!o)return;const i=new Set;i.add(n.l3),s.forEach((s=>{e=(0,S.r3y)(e,t,s,{isDeleting:!0}),(0,C.S0q)(e,t,s)&&(e=(0,S.do9)(e,t,s));const o=(0,C.O5q)(e,t,s);if(!o)return;"chatEditPhoto"===o.content.action?.type&&o.content.action.photo&&(e=(0,S.sol)(e,t,o.content.action.photo.id,!0)),e=_(e,a,o,!0);const n=(0,C.L_2)(e,o);n&&i.add(n)})),a.requestChatUpdate({chatId:t});const r=new Set(s);i.forEach((s=>{const i=(0,C.Vw0)(e,t,s);if(!i?.lastMessageId||!r.has(i.lastMessageId))return;const d=$(e,t,s);d?(s===n.l3&&(e=X(e,t,d,!0)),e=(0,S.eAk)(e,t,s,{lastMessageId:d.id}),o.isForum&&(e=(0,S.TwA)(e,t,Number(s),{lastMessageId:d.id}))):o.isForum&&s!==n.l3&&a.loadTopicById({chatId:t,topicId:Number(s)})})),(0,w.UF)(e);const d=(0,C.Rwe)(e);return void setTimeout((()=>{e=(0,w.mS)();const a=s.filter((s=>(0,C.O5q)(e,t,s)?.isDeleting));e=(0,S.AH0)(e,t,a),(0,w.UF)(e)}),d?q:j)}const o=[];s.forEach((t=>{const s=(0,C.Egn)(e,t);if(s){o.push(s);const n=$(e=(0,S.r3y)(e,s,t,{isDeleting:!0}),s);n&&(e=X(e,s,n,!0));const i=(0,C.O5q)(e,s,t);if((0,C.nZ4)(e,s)&&i){const t=(0,C.L_2)(e,i);if((0,v.cG)(s,t,e.currentUserId)){const o=$(e,s,t);a.requestSavedDialogUpdate({chatId:String(t)}),o&&(e=(0,S.yKC)(e,s,o.id,"saved"))}}"chatEditPhoto"===i?.content.action?.type&&i.content.action.photo&&(e=(0,S.sol)(e,s,i.content.action.photo.id,!0));const r=(0,C.Rwe)(e);setTimeout((()=>{e=(0,w.mS)(),e=(0,S.AH0)(e,s,[t]),(0,w.UF)(e)}),r?q:j)}})),(0,w.UF)(e),(0,h.Am)(o).forEach((e=>{a.requestChatUpdate({chatId:e})}))}(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"newMessage":{const{chatId:a,id:o,message:n,shouldForceReply:i,wasDrafted:r,poll:d}=s;e=H(e=K(e,a,o,n),t,n);const c=(0,C.O5q)(e,a,o),l=(0,T.Q)(c),u=(0,T.W)(c),h=(0,C.hds)(e,a);h?.isForum&&l?.isForumTopic&&!(0,C.nkm)(e,c)&&l.replyToMsgId&&t.loadTopicById({chatId:a,topicId:l.replyToMsgId});const p=(0,v.Nb)(n);if(Object.values(e.byTabId).forEach((({id:s})=>{p&&r&&(e=X(e,a,c));const d=(0,C.L_2)(e,c);if(e=(0,S.PKO)(e,c,a,d,s),(0,C.fo$)(e,a,n,s)){if(p&&n.isOutgoing&&!n.content?.action&&!u?.storyId&&!n.content?.storyData){const o=(0,C.Xf0)(e,s);o&&t.focusMessage({chatId:a,threadId:o.threadId,messageId:n.id,noHighlight:!0,isResizingContainer:!0,tabId:s})}p||setTimeout((()=>{e=(0,w.mS)(),i&&t.updateDraftReplyInfo({replyToMsgId:o,tabId:s}),e=X(e,a,c),(0,w.UF)(e)}),j)}else e=X(e,a,c)})),d&&(e=(0,S.J81)(e,d.id,d)),n.reportDeliveryUntilDate&&n.reportDeliveryUntilDate>(0,P.Fm)()&&t.reportMessageDelivery({chatId:a,messageId:o}),(0,w.UF)(e),p||h?.isNotJoined||(0,C.mJZ)(e,a)||t.loadTopChats(),!p&&(0,C.nZ4)(e,a)){const s=(0,C.QP5)(e,c);s&&!(0,C.mJZ)(e,s,"saved")&&t.requestSavedDialogUpdate({chatId:s})}break}case"updateChatLastMessage":{const{id:t,lastMessage:a}=s;e=X(e,t,a,!0),e=(0,S.KcS)(e,[a]),(0,w.UF)(e);break}case"updateStartEmojiInteraction":Object.values(e.byTabId).forEach((({id:t})=>{const{chatId:a}=(0,C.Xf0)(e,t)||{};if(a!==s.id)return;const o=(0,C.O5q)(e,a,s.messageId);if(!o)return;if((0,v.P5)(o)?.text!==s.emoji)return;const n=(0,C.nTw)(e,t);e=(0,A.w)(e,{activeEmojiInteractions:[...n.activeEmojiInteractions||[],{id:Math.random(),animatedEffect:s.emoji,messageId:s.messageId}]},t)})),(0,w.UF)(e);break;case"newScheduledMessage":{const{chatId:t,id:a,message:o,poll:i}=s;e=K(e,t,a,o,!0);const r=(0,C.K3w)(e,t,n.l3)||[];e=(0,S.eww)(e,t,n.l3,"scheduledIds",(0,h.Am)([...r,a]));const d=(0,C.L_2)(e,o);if(d!==n.l3){const s=(0,C.K3w)(e,t,d)||[];e=(0,S.eww)(e,t,d,"scheduledIds",(0,h.Am)([...s,a]))}i&&(e=(0,S.J81)(e,i.id,i)),e=(0,S.zTz)(e,t,{hasScheduledMessages:!0}),(0,w.UF)(e);break}case"updateScheduledMessage":{const{chatId:a,id:o,message:i,poll:r,isFromNew:d}=s,c=(0,C.Jl6)(e,a,o);if(!c)return void(d&&t.apiUpdate({"@type":"newScheduledMessage",id:s.id,chatId:s.chatId,message:s.message,poll:s.poll}));e=K(e,a,o,i,!0);const l=Object.keys((0,C.yFI)(e,a)||{}).map(Number).sort(((e,t)=>t-e));e=(0,S.eww)(e,a,n.l3,"scheduledIds",l);const u=(0,C.L_2)(e,c);if(u!==n.l3){const t=(0,C.K3w)(e,a,u)||[];e=(0,S.eww)(e,a,u,"scheduledIds",t.sort(((e,t)=>t-e)))}r&&(e=(0,S.J81)(e,r.id,r)),(0,w.UF)(e);break}case"updateMessage":{const{chatId:a,id:o,message:n,poll:i,isFromNew:r,shouldForceReply:d}=s,c=(0,C.O5q)(e,a,o);if(!c)return void(r&&t.apiUpdate({"@type":"newMessage",id:s.id,chatId:s.chatId,message:s.message,poll:s.poll,shouldForceReply:d}));const l=(0,C.hds)(e,a);e=K(e,a,o,n);const u=(0,C.O5q)(e,a,o);n.reactions&&l&&(e=z(e,t,a,o,n.reactions,l,u.isOutgoing,c)),n.content?.text?.text!==c?.content?.text?.text&&(e=(0,S.gt4)(e,a,o)),i&&(e=(0,S.J81)(e,i.id,i)),(0,w.UF)(e);break}case"updateQuickReplyMessage":{const{id:t,message:a,poll:o}=s;e=(0,S.QNR)(e,t,a),o&&(e=(0,S.J81)(e,o.id,o)),(0,w.UF)(e);break}case"deleteQuickReplyMessages":{const{messageIds:t}=s;e=(0,S.vad)(e,t),(0,w.UF)(e);break}case"updateQuickReplies":{const{quickReplies:t}=s,a=(0,h.dU)(t,"id");e=(0,S.xAV)(e,a),(0,w.UF)(e);break}case"deleteQuickReply":e=(0,S.hjk)(e,s.quickReplyId),(0,w.UF)(e);break;case"updateVideoProcessingPending":{const{chatId:a,localId:o,newScheduledMessageId:n}=s;e=(0,S.AH0)(e,a,[o]),e=(0,S.zTz)(e,a,{hasScheduledMessages:!0}),(0,w.UF)(e),Object.values(e.byTabId).forEach((({id:s})=>{const o=(0,C.Xf0)(e,s);if(o?.chatId!==a)return;const i=Date.now();i-W<1e3||(W=i,t.showNotification({message:{key:"VideoConversionText"},title:{key:"VideoConversionTitle"},tabId:s}),t.focusMessage({chatId:a,messageId:n,messageListType:"scheduled",tabId:s}))}));break}case"updateMessageSendSucceeded":{const{chatId:a,localId:o,message:i,poll:r}=s;e=H(e,t,i);const d=(0,C.O5q)(e,a,o);e=(0,S.AH0)(e,a,[o]),i.isScheduled&&(e=(0,S.XAm)(e,a,[o])),e=(0,S.r3y)(e,a,i.id,{...d,...i,previousLocalId:o,isDeleting:void 0}),r&&(e=(0,S.J81)(e,r.id,r)),e={...e,fileUploads:{byMessageKey:(0,h.cJ)(e.fileUploads.byMessageKey,[(0,p.bj)(i)])}};const c=(0,C.O5q)(e,a,i.id);e=X(e,a,c);const l=(0,C.Tac)(e,i);Object.values(e.byTabId).forEach((({id:s})=>{const{chatId:o,threadId:r}=(0,C.Xf0)(e,s)||{};o===a&&(l?.threadInfo?.threadId||n.l3)===r&&t.markMessageListRead({maxId:i.id,tabId:s})})),l?.threadInfo?.threadId&&(e=(0,S.eww)(e,a,l.threadInfo.threadId,"threadInfo",{...l.threadInfo,lastMessageId:i.id,lastReadInboxMessageId:i.id})),e=(0,S.wix)(e,a,{lastReadInboxMessageId:i.id});const u=(0,C.hds)(e,a);if(u?.isNotJoined||(0,C.mJZ)(e,a)||t.loadTopChats(),(0,C.nZ4)(e,a)){const s=(0,C.QP5)(e,c);s&&!(0,C.mJZ)(e,s,"saved")&&t.requestSavedDialogUpdate({chatId:s})}(0,w.UF)(e);break}case"updateScheduledMessageSendSucceeded":{const{chatId:t,localId:a,message:o,poll:i}=s,r=(0,C.K3w)(e,t,n.l3)||[];e=(0,S.eww)(e,t,n.l3,"scheduledIds",[...r,o.id]);const d=(0,C.L_2)(e,o);if(d!==n.l3){const s=(0,C.K3w)(e,t,d)||[];e=(0,S.eww)(e,t,d,"scheduledIds",[...s,o.id])}const c=(0,C.Jl6)(e,t,a);e=(0,S.XAm)(e,t,[a]),e=(0,S.Egm)(e,t,o.id,{...c,...o,previousLocalId:a,isDeleting:void 0}),i&&(e=(0,S.J81)(e,i.id,i)),(0,w.UF)(e);break}case"updatePinnedIds":{const{chatId:t,isPinned:a,messageIds:o}=s,i=(0,h._E)((0,C.zeq)(e,t),o),r={[n.l3]:o};Object.values(i).forEach((s=>{const o=(0,C.L_2)(e,s);if(e=(0,S.r3y)(e,t,s.id,{isPinned:a}),o===n.l3)return;const i=r[o]||[];i.push(s.id),r[o]=i})),Object.entries(r).forEach((([s,o])=>{const i=(0,C.fcC)(e,t,n.l3)||[],r=a?(0,h.Am)(i.concat(o)).sort(((e,t)=>t-e)):i.filter((e=>!o.includes(e)));e=(0,S.eww)(e,t,Number(s),"pinnedIds",r)})),(0,w.UF)(e);break}case"updateThreadInfo":{const{threadInfo:a}=s;e=(0,S.Ng8)(e,[a]);const{chatId:o,threadId:n}=a;if(!o||!n)return;const i=(0,C.hds)(e,o),r=(0,C.Vw0)(e,o,n),d=(0,C.S0q)(e,o,n);if(i?.isForum&&(d&&d.lastMessageId===r?.lastReadInboxMessageId?e=(0,S.TwA)(e,o,Number(n),{unreadCount:0}):t.loadTopicById({chatId:o,topicId:Number(n)})),!i?.isForum){const t=i?.lastReadInboxMessageId,s=a.lastReadInboxMessageId||t;t&&s&&(e=(0,S.eAk)(e,o,n,{lastReadInboxMessageId:Math.max(s,t)}))}(0,w.UF)(e);break}case"resetMessages":{const{id:a}=s,o=(0,C.zeq)(e,a);if(o&&!(0,k.L8)(a)){const s=(0,u.g0)();e=(0,S.AH0)(e,a,Object.keys(o).map(Number)),(0,w.UF)(e),t.loadFullChat({chatId:a,force:!0}),t.loadViewportMessages({chatId:a,threadId:n.l3,tabId:s})}break}case"deleteMessages":{const{ids:a,chatId:o}=s;Q(e,o,a,t);break}case"deleteScheduledMessages":{const{ids:a,newIds:o,chatId:i}=s,r=a?.some((t=>(0,C.Jl6)(e,i,t)?.isVideoProcessingPending)),d=o?.find((t=>{const s=(0,C.O5q)(e,i,t);return s?.content.video}));r&&d&&Object.values(e.byTabId).forEach((({id:e})=>{t.showNotification({message:{key:"VideoConversionDone"},actionText:{key:"VideoConversionView"},action:{action:"focusMessage",payload:{chatId:i,messageId:d,tabId:e}},tabId:e})})),function(e,t,s,a){t.forEach((t=>{a=(0,S.Egm)(a,e,t,{isDeleting:!0})})),(0,w.UF)(a);const o=(0,C.Rwe)(a);setTimeout((()=>{a=(0,w.mS)(),a=(0,S.XAm)(a,e,t);const s=(0,C.yFI)(a,e);a=(0,S.eww)(a,e,n.l3,"scheduledIds",Object.keys(s||{}).map(Number)),(0,w.UF)(a)}),o?q:j)}(i,a,0,e);break}case"deleteHistory":{const{chatId:o}=s,n=e.messages.byChatId[o];if(o===a.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map((e=>({...e,isDeleted:!0})))},(0,w.UF)(e)),n){const s=Object.keys(n.byId).map(Number);Q(e=(0,w.mS)(),o,s,t)}else t.requestChatUpdate({chatId:o});e=(0,w.mS)(),e=(0,S.SJu)(e,o),(0,w.UF)(e);break}case"deleteSavedHistory":{const{chatId:a}=s,o=e.currentUserId;e=(0,S.SJu)(e,a,"saved"),(0,w.UF)(e),function(e,t,s,a){const o=(0,C.zeq)(e,t);if(!o)return;const n=Object.values(o).filter((t=>(0,C.L_2)(e,t)===s)).map((e=>e.id));n.length&&Q(e,t,n,a)}(e=(0,w.mS)(),o,a,t);break}case"deleteParticipantHistory":{const{chatId:a,peerId:o}=s;!function(e,t,s,a){const o=(0,C.zeq)(e,t),n=Object.values(o).filter((e=>e.senderId===s)).map((e=>e.id));n.length&&Q(e,t,n,a)}(e=(0,w.mS)(),a,o,t);break}case"updateCommonBoxMessages":{const{ids:t,messageUpdate:a}=s;t.forEach((t=>{const s=(0,C.Egn)(e,t);s&&(e=(0,S.r3y)(e,s,t,a))})),(0,w.UF)(e);break}case"updateChannelMessages":{const{channelId:t,ids:a,messageUpdate:o}=s;a.forEach((s=>{e=(0,S.r3y)(e,t,s,o)})),(0,w.UF)(e);break}case"updateMessagePoll":{const{pollId:t,pollUpdate:a}=s;e=(0,S.J81)(e,t,a),(0,w.UF)(e);break}case"updateMessagePollVote":{const{pollId:t,peerId:a,options:o}=s;e=(0,S.DLl)(e,t,a,o),(0,w.UF)(e);break}case"updateServiceNotification":{const{message:a}=s;(0,C.dqr)(e)&&t.createServiceNotification({message:a});break}case"updateMessageReactions":{const{chatId:a,id:o,reactions:n}=s,i=(0,C.O5q)(e,a,o),r=(0,C.hds)(e,s.chatId);if(!r||!i)return;e=z(e,t,a,o,n,r,i.isOutgoing,i),(0,w.UF)(e);break}case"updateMessageExtendedMedia":{const{chatId:t,id:a,extendedMedia:o,isBought:n}=s,i=(0,C.O5q)(e,t,a);if(!(0,C.hds)(e,s.chatId)||!i)return;if(i.content.invoice){const s=o[0];if("mediaType"in s&&"extendedMediaPreview"===s.mediaType){if(!i.content.invoice)return;e=(0,S.r3y)(e,t,a,{content:{...i.content,invoice:{...i.content.invoice,extendedMedia:s}}}),(0,w.UF)(e)}else{const o=s;e=(0,S.r3y)(e,t,a,{content:{...o}}),(0,w.UF)(e)}}if(i.content.paidMedia){const s=n?{isBought:n,extendedMedia:o}:{extendedMedia:o,isBought:void 0};e=(0,S.r3y)(e,t,a,{content:{...i.content,paidMedia:{...i.content.paidMedia,...s}}}),(0,w.UF)(e)}break}case"updateTranscribedAudio":{const{transcriptionId:t,text:a,isPending:o}=s;e={...e,transcriptions:{...e.transcriptions,[t]:{...e.transcriptions[t]||{},transcriptionId:t,text:a,isPending:o}}},(0,w.UF)(e);break}case"updateMessageSendFailed":{const{chatId:a,localId:o,error:n}=s;n.match(/CHAT_SEND_.+?FORBIDDEN/)&&Object.values(e.byTabId).forEach((({id:e})=>{t.showAllowedMessageTypesNotification({chatId:a,tabId:e})})),e=(0,S.r3y)(e,a,o,{sendingState:"messageSendingStateFailed"}),(0,w.UF)(e);break}case"updateMessageTranslations":{const{chatId:t,messageIds:a,toLanguageCode:o,translations:n}=s;e=(0,S.rmT)(e,t,a,o,n),(0,w.UF)(e);break}}}));const Z=new Map,ee=(0,I.sg)((e=>e()),500,!1);async function te({global:e,chatId:t,threadId:s,draft:a,isLocalOnly:o,noLocalTimeUpdate:n}){const i=(0,C.hds)(e,t),r=(0,C.mBe)(e,t);if(!i||r&&(0,v.PL)(r))return;const d=(0,C.OEv)(e,t,s,a?.replyInfo),c=a?{...a,replyInfo:d,date:Math.floor(Date.now()/1e3),isLocal:!0}:void 0;e=(0,S.eww)(e,t,s,"draft",c),n||(e=(0,S.wix)(e,t,{draftDate:c?.date})),(0,w.UF)(e),o||(await(0,b.px)("saveDraft",{chat:i,draft:c})&&c&&(c.isLocal=!1),e=(0,w.mS)(),e=(0,S.eww)(e,t,s,"draft",c),e=(0,S.wix)(e,t,{draftDate:c?.date}),(0,w.UF)(e))}async function se(e,t,s){const{fromChatId:a,messageIds:o,toChatId:i,withMyScore:r,noAuthors:d,noCaptions:c,toThreadId:l=n.l3}=(0,C.nTw)(e,s).forwardMessages,{messagePriceInStars:u,isSilent:p,scheduledAt:m}=t,g=(0,C.g29)(e),f=l===n.l3,I=a?(0,C.hds)(e,a):void 0,y=i?(0,C.hds)(e,i):void 0,S=a&&o?o.sort(((e,t)=>e-t)).map((t=>(0,C.O5q)(e,a,t))).filter(Boolean):void 0;if(!I||!y||!S||l&&!f&&!y.isForum)return;const M=(0,C.VF$)(e,i),k=(0,C.GA4)(e,i,l||n.l3),F=(0,C.ZZX)(e,y.id),P=[],[T,U]=(0,h.jB)(S,(e=>!(0,v.u7)(e))),x=T.filter((t=>(0,C.R4s)(e,t)));if(x.length){const s=e.config?.maxForwardedCount?(0,v.v$)(x,e.config.maxForwardedCount):[x];for(const e of s){const s={fromChat:I,toChat:y,toThreadId:l,messages:e,isSilent:p,scheduledAt:m,sendAs:M,withMyScore:r,noAuthors:d,noCaptions:c,isCurrentUserPremium:g,wasDrafted:Boolean(k),lastMessageId:F,messagePriceInStars:u};if(u){const e=await(0,b.px)("forwardMessagesLocal",s);P.push({...t,forwardParams:{...s,forwardedLocalMessagesSlice:e},forwardedLocalMessagesSlice:e})}else(0,b.px)("forwardMessages",s)}}for(const t of U){const{text:s,entities:a}=t.content.text||{},{sticker:o}=t.content,n={chat:y,replyInfo:(0,C.OEv)(e,y.id,l),text:s,entities:a,sticker:o,isSilent:p,scheduledAt:m,sendAs:M,lastMessageId:F};await ie(e,n,P)}return e=(0,w.mS)(),e=(0,A.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},s),(0,w.UF)(e),P}async function ae(e,t,s,o,r,d=!1,c=!1,l,...[p=(0,u.g0)()]){const m=t.id;let g,f=a.yo2;switch(r){case i.TN.Backwards:o?(g=-1,f+=1):g=void 0;break;case i.TN.Around:g=-(Math.round(a.yo2/2)+1);break;case i.TN.Forwards:g=-(a.yo2+1),o&&(f+=1)}const I=(e=(0,w.mS)()).currentUserId,y=(0,v.cG)(m,s,I),A=y?String(s):m,M=await(0,b.px)("fetchMessages",{chat:(0,C.hds)(e,A),offsetId:o,addOffset:g,limit:f,threadId:s,isSavedDialog:y});if(!M)return;const{messages:k,count:F}=M;e=(0,w.mS)();const P=m===a.zv8?e.serviceNotifications.filter((({isDeleted:e})=>!e)).map((({message:e})=>e)):[],T=[].concat(k,P),U=(0,h.dU)(T,"id"),x=Object.keys(U).map(Number);if(s!==n.l3&&!(0,v.cG)(m,s,e.currentUserId)){const t=(0,C.dU3)(e,m,s);x[0]&&t!==x[0]||t===s||x.unshift(Number(s))}e=(0,S.o4A)(e,m,U),e=d?(0,S.E0b)(e,m,s,x):(0,S.d4w)(e,m,s,x);let B=(0,C.gCU)(e,m,s);const N=o?(0,C.Lzh)(e,m,s,o):void 0;if(d&&B&&N&&(N.length&&!(0,h.h8)(B,N)||(e=(0,S.d4w)(e,m,s,N),B=(0,C.gCU)(e,m,s),e=(0,S.qKm)(e,m,s,N),d=!1)),!c){const t=d&&N?N:B;if(t){const{newViewportIds:a}=oe(t,o,r);e=(0,S.s3Z)(e,m,s,a,p)}}F&&(e=(0,S.eAk)(e,t.id,s,{messagesCount:F})),(0,w.UF)(e),l?.()}function oe(e,t,s){const{length:o}=e,n=t?function(e,t){return t<e[0]?0:t>e[e.length-1]?e.length-1:e.findIndex(((s,a)=>s===t||s<t&&e[a+1]>t))}(e,t):-1,r=s===i.TN.Backwards?n:n+1||o,d=s===i.TN.Around?Math.round(a.yo2/2):a.yo2,c=r-d,l=r+d-1,u=e.slice(Math.max(0,c),l+1);let h,p;switch(s){case i.TN.Backwards:h=r>=0,p=c>=0;break;case i.TN.Forwards:h=r<o,p=l<=o-1;break;case i.TN.Around:default:h=u.length>0,p=u.length===a.yo2}return{newViewportIds:u,areSomeLocal:h,areAllLocal:p}}async function ne(e,t){const s=(0,C.PVB)(e,t);if(!s)return;if((0,y.vj)(s))return s.paidMessagesStars;if(!s?.paidMessagesStars)return;const a=(0,C.vGo)(e,s.id);return a?a.paidMessagesStars:await(0,b.px)("fetchPaidMessagesStarsAmount",s)}async function ie(e,t,s){if(t.messagePriceInStars){const e=await(0,b.px)("sendMessageLocal",t);e&&s.push({...t,localMessage:e})}else re(e,t)}async function re(e,t){let s;(t.replyInfo||d.pz)&&await(0,I.P_)();const a=t.attachment?(t,o)=>{Z.has(o)||(s=o,Z.set(o,a)),e=(0,w.mS)(),e=(0,S.mR)(e,o,t),(0,w.UF)(e)}:void 0;await(0,b.px)("sendMessage",t,a),a&&s&&(e=(0,w.mS)(),e=(0,S.mR)(e,s,void 0),(0,w.UF)(e),Z.delete(s))}async function de(e,t,s){const a=(0,C.hds)(e,t);if(!a)return;const o=await(0,b.px)("fetchUnreadMentions",{chat:a,offsetId:s});if(!o)return;const{messages:n}=o,i=(0,h.dU)(n,"id"),r=Object.keys(i).map(Number);e=(0,w.mS)(),e=(0,S.o4A)(e,a.id,i),e=(0,S.Wez)(e,t,a,r),(0,w.UF)(e)}(0,w.aJ)("loadViewportMessages",((e,t,s)=>{const{direction:a=i.TN.Around,isBudgetPreload:o=!1,shouldForceRender:n=!1,onLoaded:r,onError:d,tabId:c=(0,u.g0)()}=s||{};let{chatId:l,threadId:h}=s||{};if(!l||!h){const t=(0,C.Xf0)(e,c);if(!t)return void d?.();l=t.chatId,h=t.threadId}const m=(0,C.hds)(e,l);if(!m||m.isRestricted)return void d?.();const g=(0,C.rA3)(e,l,h,c),f=(0,C.gCU)(e,l,h);if(g&&g.length&&a!==i.TN.Around){const s=a===i.TN.Backwards?g[0]:g[g.length-1];if((0,p.iL)(s))return;if(s===h&&a===i.TN.Backwards)return;const n=Boolean(f&&!f.includes(s)),d=n?(0,C.Lzh)(e,l,h,s):f;if(d?.length){const{newViewportIds:i,areSomeLocal:p,areAllLocal:g}=oe(d,s,a);p&&(e=(0,S.s3Z)(e,l,h,i,c)),(0,I.aj)((()=>{!async function(e,t,s,a,o,n,i,r,d,c,...[l=(0,u.g0)()]){s||await ae(e,n,i,d,r,a,o,c,l),o||t.loadViewportMessages({chatId:n.id,threadId:i,direction:r,isBudgetPreload:!0,onLoaded:c,tabId:l})}(e,t,g,n,o,m,h,a,s,r,c)}))}if(o)return}else{const t=(0,C.kdX)(e,l,c)||(0,C.EHH)(e,l,h),s=Boolean(t&&f&&!f.includes(t)),a=(s?(0,C.Lzh)(e,l,h,t):f)||[],{newViewportIds:n,areSomeLocal:d,areAllLocal:u}=oe(a,t,i.TN.Around);d&&(e=(0,S.s3Z)(e,l,h,n,c)),u?r?.():(0,I.aj)((()=>{ae(e,m,h,t,i.TN.Around,s,o,r,c)}))}(0,w.UF)(e,{forceOnHeavyAnimation:n})})),(0,w.aJ)("loadMessage",(async(e,t,s)=>{const{chatId:a,messageId:o,replyOriginForId:i,threadUpdate:r}=s,d=(0,C.hds)(e,a);if(!d)return;const c=await async function(e,t,s,a){const o=await(0,b.px)("fetchMessage",{chat:t,messageId:s});if(o){if(o!==n.K1)return e=(0,w.mS)(),e=(0,S.r3y)(e,t.id,s,o.message),(0,w.UF)(e),o.message;if(a){e=(0,w.mS)();const s=(0,C.O5q)(e,t.id,a);e=(0,S.r3y)(e,t.id,a,{...s,replyInfo:void 0}),(0,w.UF)(e)}}}(e,d,o,i);if(c&&r){const{lastMessageId:t,isDeleting:s}=r;e=(0,w.mS)(),e=(0,S.Wwn)(e,c,a,t,s),(0,w.UF)(e)}})),(0,w.aJ)("sendMessage",(async(e,t,s)=>{const{messageList:o,tabId:i=(0,u.g0)()}=s,{storyId:r,peerId:d}=(0,C.V9I)(e,i),c=Boolean(r&&d);if(!o&&!c)return;let{chatId:l,threadId:f,type:I}=o||{};if(c&&(l=d,f=n.l3,I="thread"),s=(0,h.cJ)(s,["tabId"]),"scheduled"===I&&!s.scheduledAt)return e=(0,A.w)(e,{contentToBeScheduled:s},i),void(0,w.UF)(e);const b=(0,C.hds)(e,l),v=(0,C.GA4)(e,l,f),y=(0,C.nTw)(e,i).forwardMessages?.messageIds?.length,S=y||c?void 0:v?.replyInfo,M=c?{type:"story",peerId:d,storyId:r}:void 0,k=(0,C.OEv)(e,l,f,S),F=M||k,P=(0,C.ZZX)(e,l),T=await ne(e,l),U={...s,chat:b,replyInfo:F,noWebPage:(0,C.rQx)(e,l,f),sendAs:(0,C.VF$)(e,l),lastMessageId:P,messagePriceInStars:T,isStoryReply:c,isPending:!!T||void 0};c||t.clearWebPagePreview({tabId:i});const x=(!s.attachments||s.attachments.length<=1)&&!y,B=!x&&s.shouldGroupMessages,N=[];if(x){const{attachments:t,...s}=U,a={...s,attachment:t?t[0]:void 0,wasDrafted:Boolean(v)};await ie(e,a,N)}else if(B){const{text:t,entities:s,attachments:o,...n}=U,i=function(e){return e.reduce(((e,t,s,a)=>0===s?(e.push([t]),e):(me(t)===me(a[s-1])?e[e.length-1].push(t):e.push([t]),e)),[])}(o);let r=!1;for(let o=0;o<i.length;o++){const d=i[o],c=(0,h.lD)(d,a.ynd);for(let a=0;a<c.length;a++){const l=`${Date.now()}${o}${a}`,u=0===a&&0===o,h=a===c.length-1&&o===i.length-1;if(d[0].quick&&!d[0].shouldSendAsFile){const[o,...i]=c[a];let d={...n,text:u&&!r?t:void 0,entities:u&&!r?s:void 0,attachment:o,groupedId:i.length>0?l:void 0,wasDrafted:Boolean(v)};await ie(e,d,N),r=!0;for(const t of i)d={...n,attachment:t,groupedId:l},await ie(e,d,N)}else{const o=c[a].slice(0,-1),i=c[a][c[a].length-1];for(const t of o){const s={...n,attachment:t,groupedId:l};await ie(e,s,N)}const d={...n,text:h&&!r?t:void 0,entities:h&&!r?s:void 0,attachment:i,groupedId:o.length>0?l:void 0,wasDrafted:Boolean(v)};await ie(e,d,N),r=!0}}}}else{const{text:t,entities:s,attachments:a,replyInfo:o,...n}=U;if(t){const a={...n,text:t,entities:s,replyInfo:o,wasDrafted:Boolean(v)};await ie(e,a,N)}if(a)for(const t of a){const s={...n,attachment:t};await ie(e,s,N)}}if(y){const t=await se(e,U,i);t&&N.push(...t)}N?.length&&async function(e,t){const s=t[0]?.chat;if(!s||!t.length)return;const a=await ne(e,s.id);if(!a)return void(0,w.ko)().sendMessages({sendParams:t});const o=t.reduce(((e,t)=>{if(t.localMessage?.id)e.push(t.localMessage.id);else if(t.forwardedLocalMessagesSlice?.localMessages){const s=Object.values(t.forwardedLocalMessagesSlice.localMessages).map((e=>e.id)).filter(Boolean);e.push(...s)}return e}),[]),n=t[0]?.forwardedLocalMessagesSlice?.localMessages,i=t[0]?.localMessage||n&&Object.values(n)[0];if(!i)return;const r=o.length,d=t[0];let c;if(1===t.length&&d.isStoryReply){const{gif:e,sticker:t,isReaction:s}=d;e?c={key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}}:t?c={key:"StoryTooltipStickerSent"}:s&&(c={key:"StoryTooltipReactionSent"})}const l=c||{key:"MessageSentPaidToastTitle",variables:{count:r},options:{pluralValue:r}};(0,w.ko)().sendMessages({sendParams:t}),(0,w.ko)().showNotification({localId:(0,p.bj)(i),title:l,message:{key:"MessageSentPaidToastText",variables:{amount:(0,g.K)((0,m.Yw)(),a*r)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage"})}(e,N)})),(0,w.aJ)("sendInviteMessages",(async(e,t,s)=>{const{chatId:a,userIds:o,tabId:n=(0,u.g0)()}=s,i=(0,C.AWZ)(e,a);if(!i?.inviteLink)return;const r=[];return await Promise.all(o.map((t=>{const s=(0,C.hds)(e,t);if(!s)return;const a=(0,v.Yg)((0,C.mBe)(e,t));return a&&r.push(a),re(e,{chat:s,text:i.inviteLink})}))),t.showNotification({message:(0,f.yE)("Conversation.ShareLinkTooltip.Chat.One",r.join(", ")),tabId:n})})),(0,w.aJ)("editMessage",((e,t,s)=>{const{messageList:a,text:o,entities:n,attachments:i,tabId:r=(0,u.g0)()}=s;if(!a)return;let d;const c=i?(t,s)=>{Z.has(s)||(d=s,Z.set(s,c)),e=(0,w.mS)(),e=(0,S.mR)(e,s,t),(0,w.UF)(e)}:void 0,{chatId:l,threadId:h,type:p}=a,m=(0,C.hds)(e,l),g=(0,C.KLw)(e,l,h,p);m&&g&&(t.setEditingId({messageId:void 0,tabId:r}),(async()=>{await(0,b.px)("editMessage",{chat:m,message:g,attachment:i?i[0]:void 0,text:o,entities:n,noWebPage:(0,C.rQx)(e,l,h)},c),c&&d&&(e=(0,w.mS)(),e=(0,S.mR)(e,d,void 0),(0,w.UF)(e),Z.delete(d))})())})),(0,w.aJ)("cancelUploadMedia",((e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.O5q)(e,a,o);if(!n)return;const i=n&&Z.get((0,p.bj)(n));i&&(0,b.om)(i),(0,v.Nb)(n)&&t.apiUpdate({"@type":"deleteMessages",ids:[o],chatId:a})})),(0,w.aJ)("saveDraft",((e,t,s)=>{const{chatId:a,threadId:o,text:n}=s;if(!n)return;const i=(0,C.GA4)(e,a,o);te({global:e,chatId:a,threadId:o,draft:{text:n,replyInfo:i?.replyInfo,effectId:i?.effectId}})})),(0,w.aJ)("clearDraft",((e,t,s)=>{const{chatId:a,threadId:o=n.l3,isLocalOnly:i,shouldKeepReply:r}=s,d=(0,C.GA4)(e,a,o);if(!d)return;const c=d.replyInfo;te({global:e,chatId:a,threadId:o,draft:r&&c?{replyInfo:c}:void 0,isLocalOnly:i})})),(0,w.aJ)("updateDraftReplyInfo",((e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=(0,C.Xf0)(e,a);if(!n)return;const{chatId:i,threadId:r}=n,d=(0,C.GA4)(e,i,r),c={type:"message",...d?.replyInfo,...o};c.replyToMsgId&&te({global:e,chatId:i,threadId:r,draft:{...d,replyInfo:c},isLocalOnly:!0,noLocalTimeUpdate:!0})})),(0,w.aJ)("resetDraftReplyInfo",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:n,threadId:i}=o,r=(0,C.GA4)(e,n,i),d=r?.text?{...r,replyInfo:void 0}:void 0;te({global:e,chatId:n,threadId:i,draft:d,isLocalOnly:Boolean(d)})})),(0,w.aJ)("saveEffectInDraft",((e,t,s)=>{const{chatId:a,threadId:o,effectId:n}=s;te({global:e,chatId:a,threadId:o,draft:{...(0,C.GA4)(e,a,o),effectId:n},isLocalOnly:!0,noLocalTimeUpdate:!0})})),(0,w.aJ)("updateInsertingPeerIdMention",((e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s||{};return(0,A.w)(e,{insertingPeerIdMention:a},o)})),(0,w.aJ)("toggleMessageWebPage",((e,t,s)=>{const{chatId:a,threadId:o,noWebPage:n}=s;return(0,S.eww)(e,a,o,"noWebPage",n)})),(0,w.aJ)("pinMessage",((e,t,s)=>{const{chatId:a,messageId:o,isUnpin:n,isOneSide:i,isSilent:r}=s,d=(0,C.hds)(e,a);d&&(0,b.px)("pinMessage",{chat:d,messageId:o,isUnpin:n,isOneSide:i,isSilent:r})})),(0,w.aJ)("unpinAllMessages",(async(e,t,s)=>{const{chatId:a,threadId:o}=s,i=(0,C.hds)(e,a);if(!i)return;await(0,b.px)("unpinAllMessages",{chat:i,threadId:o}),e=(0,w.mS)();const r=(0,C.fcC)(e,a,o);r?.forEach((t=>{e=(0,S.r3y)(e,a,t,{isPinned:!1})})),e=(0,S.eww)(e,i.id,n.l3,"pinnedIds",[]),(0,w.UF)(e)})),(0,w.aJ)("deleteMessages",((e,t,s)=>{const{messageIds:a,shouldDeleteForAll:o,messageList:n,tabId:i=(0,u.g0)()}=s,r=(0,C.Xf0)(e,i),d=n||r;if(!d)return;const{chatId:c,threadId:l}=d,h=(0,C.hds)(e,c),p=a.filter((t=>{const s=(0,C.O5q)(e,c,t);return s&&!(0,v.Nb)(s)}));if(!p.length&&a.length)return void Q(e,(0,v.WX)(h)||(0,v.Vs)(h)?c:void 0,a,t);(0,b.px)("deleteMessages",{chat:h,messageIds:p,shouldDeleteForAll:o});const m=(0,C.Ys6)(e,c,l);m&&a.includes(m)&&t.setEditingId({messageId:void 0,tabId:i})})),(0,w.aJ)("resetLocalPaidMessages",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).notifications;return o&&o.length?(o.forEach((e=>{if("paidMessage"===e.type){const s=e.dismissAction;s&&!Array.isArray(s)&&t[s.action](s.payload),t.dismissNotification({localId:e.localId,tabId:a})}})),e):e})),(0,w.aJ)("deleteParticipantHistory",((e,t,s)=>{const{chatId:a,peerId:o}=s,n=(0,C.hds)(e,a),i=(0,C.PVB)(e,o);(0,b.px)("deleteParticipantHistory",{chat:n,peer:i})})),(0,w.aJ)("deleteScheduledMessages",((e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Xf0)(e,o);if(!n)return;const{chatId:i}=n,r=(0,C.hds)(e,i);(0,b.px)("deleteScheduledMessages",{chat:r,messageIds:a});const d=(0,C.VlN)(e,i);d&&a.includes(d)&&t.setEditingId({messageId:void 0,tabId:o})})),(0,w.aJ)("deleteHistory",(async(e,t,s)=>{const{chatId:a,shouldDeleteForAll:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;await(0,b.px)("deleteHistory",{chat:i,shouldDeleteForAll:o}),e=(0,w.mS)();const r=(0,C.Xf0)(e,n);r&&r.chatId===a&&t.openChat({id:void 0,tabId:n});const d=e.chatFolders.byId;Object.values(d).forEach((e=>{if(e.includedChatIds.includes(a)||e.pinnedChatIds?.includes(a)){const t=e.includedChatIds.filter((e=>e!==a)),s=e.pinnedChatIds?.filter((e=>e!==a)),o={...e,includedChatIds:t,pinnedChatIds:s};(0,b.px)("editChatFolder",{id:e.id,folderUpdate:o})}}))})),(0,w.aJ)("deleteSavedHistory",(async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;await(0,b.px)("deleteSavedHistory",{chat:n}),e=(0,w.mS)();const i=(0,C.Xf0)(e,o);i&&i.threadId===a&&t.openChat({id:void 0,tabId:o})})),(0,w.aJ)("reportMessages",(async(e,t,s)=>{const{messageIds:o,description:n="",option:i="",chatId:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,r),l=await(0,b.px)("reportMessages",{peer:c,messageIds:o,description:n,option:i});if(!l)return;const{result:h,error:p}=l;if(p===a.zLi)return t.showNotification({message:(0,f.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find((e=>e.option===i)),a={title:h.title,options:h.options,subtitle:s?.text};e=(0,A.w)(e,{reportModal:{chatId:r,messageIds:o,description:n,subject:"message",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find((e=>e.option===i)),a={isOptional:h.isOptional,option:h.option,title:s?.text};e=(0,A.w)(e,{reportModal:{chatId:r,messageIds:o,description:n,subject:"message",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}}})),(0,w.aJ)("sendMessageAction",(async(e,t,s)=>{const{action:a,chatId:o,threadId:n}=s;if("connectionStateReady"!==e.connectionState)return;if((0,C.nZ4)(e,o))return;const i=(0,C.hds)(e,o);if(!i)return;const r=(0,C.mBe)(e,o);r&&((0,v.tv)(r)||(0,v.PL)(r))||await(0,b.px)("sendMessageAction",{peer:i,threadId:n,action:a})})),(0,w.aJ)("reportChannelSpam",((e,t,s)=>{const{participantId:a,chatId:o,messageIds:n}=s,i=(0,C.PVB)(e,a),r=(0,C.hds)(e,o);i&&r&&(0,b.px)("reportChannelSpam",{peer:i,chat:r,messageIds:n})})),(0,w.aJ)("markMessageListRead",((e,t,s)=>{if((0,C.trm)(e))return;const{maxId:o,tabId:i=(0,u.g0)()}=s,r=(0,C.Xf0)(e,i);if(!r)return;const{chatId:d,threadId:c}=r,l=(0,C.hds)(e,d);if(!l||(0,v.cG)(d,c,e.currentUserId))return;ee((()=>{(0,b.px)("markMessageListRead",{chat:l,threadId:c,maxId:o})})),d===a.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map((e=>e.isUnread&&e.id<=o?{...e,isUnread:!1}:e))});const h=(0,C.rA3)(e,d,c,i),p=(0,C.RjD)(e,d,c);if(c!==n.l3&&!l.isForum)return(0,S.eAk)(e,d,c,{lastReadInboxMessageId:o});if(!h||!p||!l.unreadCount)return e;const m=function(e,t,s){if(0===e.length||t<e[0]||s>e[e.length-1])return;let a=0;for(let o=0,n=e.length;o<n&&(e[o]>=t&&e[o]<=s&&a++,!(e[o]>=s));o++);return a}(h,p,o);if(!m)return e;const g=(0,C.S0q)(e,d,c);if(l.isForum&&g){e=(0,S.eAk)(e,d,c,{lastReadInboxMessageId:o});const t=Math.max(0,g.unreadCount-m);return 0===t&&(e=(0,S.wix)(e,d,{unreadCount:Math.max(0,l.unreadCount-1)})),(0,S.TwA)(e,d,Number(c),{unreadCount:t})}return(0,S.wix)(e,d,{lastReadInboxMessageId:o,unreadCount:Math.max(0,l.unreadCount-m)})})),(0,w.aJ)("markMessagesRead",((e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)(),shouldFetchUnreadReactions:n}=s,i=(0,C.meB)(e,o);i&&(0,b.px)("markMessagesRead",{chat:i,messageIds:a}).then((()=>{n&&t.fetchUnreadReactions({chatId:i.id})}))})),(0,w.aJ)("loadWebPagePreview",(async(e,t,s)=>{const{text:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchWebPagePreview",{text:a});e=(0,w.mS)(),e=(0,A.w)(e,{webPagePreview:n},o),(0,w.UF)(e)})),(0,w.aJ)("clearWebPagePreview",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};if((0,C.nTw)(e,a).webPagePreview)return(0,A.w)(e,{webPagePreview:void 0},a)})),(0,w.aJ)("sendPollVote",((e,t,s)=>{const{chatId:a,messageId:o,options:n}=s,i=(0,C.hds)(e,a);i&&(0,b.px)("sendPollVote",{chat:i,messageId:o,options:n})})),(0,w.aJ)("cancelPollVote",((e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("sendPollVote",{chat:n,messageId:o,options:[]})})),(0,w.aJ)("closePoll",((e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a),i=(0,C.O5q)(e,a,o),r=i&&(0,C.zcZ)(e,i);n&&r&&(0,b.px)("closePoll",{chat:n,messageId:o,poll:r})})),(0,w.aJ)("loadPollOptionResults",(async(e,t,s)=>{const{chat:a,messageId:o,option:n,offset:i,limit:r,shouldResetVoters:d,tabId:c=(0,u.g0)()}=s,l=await(0,b.px)("loadPollOptionResults",{chat:a,messageId:o,option:n,offset:i,limit:r});if(!l)return;e=(0,w.mS)();const p=(0,C.nTw)(e,c),{pollResults:m}=p,{voters:g}=p.pollResults;e=(0,A.w)(e,{pollResults:{...m,voters:{...g,[n]:(0,h.Am)([...!d&&g?.[n]?g[n]:[],...l.votes.map((e=>e.peerId))])},offsets:{...m.offsets?m.offsets:{},[n]:l.nextOffset||""}}},c),(0,w.UF)(e)})),(0,w.aJ)("loadExtendedMedia",((e,t,s)=>{const{chatId:a,ids:o}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("fetchExtendedMedia",{chat:n,ids:o})})),(0,w.aJ)("loadScheduledHistory",(async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const i=await(0,b.px)("fetchScheduledHistory",{chat:o});if(!i)return;const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort(((e,t)=>t-e));if(e=(0,w.mS)(),e=(0,S.Ffw)(e,o.id,d),e=(0,S.eww)(e,o.id,n.l3,"scheduledIds",c),c.length||(e=(0,S.zTz)(e,o.id,{hasScheduledMessages:!1})),o?.isForum){const t={};r.forEach((s=>{const a=(0,C.L_2)(e,s),o=t[a]||[];o.push(s.id),t[a]=o})),Object.entries(t).forEach((([t,s])=>{e=(0,S.eww)(e,o.id,Number(t),"scheduledIds",s)}))}(0,w.UF)(e)})),(0,w.aJ)("sendScheduledMessages",((e,t,s)=>{const{chatId:a,id:o}=s,n=(0,C.hds)(e,a);n&&(0,b.px)("sendScheduledMessages",{chat:n,ids:[o]})})),(0,w.aJ)("rescheduleMessage",((e,t,s)=>{const{chatId:a,messageId:o,scheduledAt:n}=s,i=(0,C.hds)(e,a),r=i&&(0,C.Jl6)(e,i.id,o);i&&r&&(0,b.px)("rescheduleMessage",{chat:i,message:r,scheduledAt:n})})),(0,w.aJ)("transcribeAudio",(async(e,t,s)=>{const{messageId:a,chatId:o}=s,n=(0,C.hds)(e,o);if(!n)return;e=(0,S.r3y)(e,o,a,{transcriptionId:""}),(0,w.UF)(e);const i=await(0,b.px)("transcribeAudio",{chat:n,messageId:a});e=(0,w.mS)(),e=(0,S.r3y)(e,o,a,{transcriptionId:i,isTranscriptionError:!i}),(0,w.UF)(e)})),(0,w.aJ)("loadCustomEmojis",(async(e,t,s)=>{const{ids:a,ignoreCache:o}=s,n=o?a:(0,h.Am)(a.filter((t=>!e.customEmojis.byId[t]))),i=await(0,b.px)("fetchCustomEmoji",{documentId:n});i&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,byId:{...e.customEmojis.byId,...(0,h.dU)(i,"id")}}},(0,w.UF)(e))})),(0,w.aJ)("forwardMessages",((e,t,s)=>{const{isSilent:a,scheduledAt:o,tabId:n=(0,u.g0)()}=s,{toChatId:i}=(0,C.nTw)(e,n).forwardMessages,r=i?(0,C.hds)(e,i):void 0;r&&se(e,{chat:r,isSilent:a,scheduledAt:o},n)})),(0,w.aJ)("sendMessages",(async(e,t,s)=>{const{sendParams:a}=s;await Promise.all(a.map((async t=>{t.forwardedLocalMessagesSlice&&t.forwardParams?(await(0,I.P_)(),await(0,b.px)("forwardApiMessages",t.forwardParams)):await re(e,t)}))),a.length>0&&a[0].messagePriceInStars&&t.loadStarStatus()})),(0,w.aJ)("loadPinnedMessages",(async(e,t,s)=>{const{chatId:a,threadId:o}=s,n=(0,C.hds)(e,a);if(!n||(0,v.cG)(a,o,e.currentUserId))return;const i=await(0,b.px)("fetchPinnedMessages",{chat:n,threadId:o});if(!i)return;const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort(((e,t)=>t-e));e=(0,w.mS)(),e=(0,S.o4A)(e,n.id,d),e=(0,S.gz3)(e,n.id,o,c),(0,w.UF)(e)})),(0,w.aJ)("loadSeenBy",(async(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchSeenBy",{chat:n,messageId:o});i&&(e=(0,w.mS)(),e=(0,S.r3y)(e,a,o,{seenByDates:i}),(0,w.UF)(e))})),(0,w.aJ)("saveDefaultSendAs",((e,t,s)=>{const{chatId:a,sendAsId:o}=s,n=(0,C.hds)(e,a),i=(0,C.hds)(e,o)||(0,C.mBe)(e,o);if(n&&i)return(0,b.px)("saveDefaultSendAs",{sendAs:i,chat:n}),(0,S.ltr)(e,a,{sendAsId:o})})),(0,w.aJ)("loadSendAs",(async(e,t,s)=>{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const n=await(0,b.px)("fetchSendAs",{chat:o});if(!n)return e=(0,w.mS)(),e=(0,S.wix)(e,a,{sendAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,S.wix)(e,a,{sendAsPeerIds:n}),(0,w.UF)(e)})),(0,w.aJ)("loadSendPaidReactionsAs",(async(e,t,s)=>{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o)return;const n=await(0,b.px)("fetchSendAs",{chat:o,isForPaidReactions:!0});if(!n)return e=(0,w.mS)(),e=(0,S.wix)(e,a,{sendPaidReactionsAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,S.wix)(e,a,{sendPaidReactionsAsPeerIds:n}),(0,w.UF)(e)})),(0,w.aJ)("loadSponsoredMessages",(async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;if((0,y.mO)(o)&&(0,C.I_m)(e,o.id))return;const n=await(0,b.px)("fetchSponsoredMessages",{peer:o});n&&(e=(0,w.mS)(),e=(0,S.EKx)(e,a,n.messages[0]),(0,w.UF)(e))})),(0,w.aJ)("viewSponsored",((e,t,s)=>{const{randomId:a}=s;(0,b.px)("viewSponsoredMessage",{random:a})})),(0,w.aJ)("clickSponsored",((e,t,s)=>{const{randomId:a,isMedia:o,isFullscreen:n}=s;(0,b.px)("clickSponsoredMessage",{random:a,isMedia:o,isFullscreen:n})})),(0,w.aJ)("reportSponsored",(async(e,t,s)=>{const{peerId:a,randomId:o,option:n="",tabId:i=(0,u.g0)()}=s,r=await(0,b.px)("reportSponsoredMessage",{randomId:o,option:n});if(r){if("premiumRequired"===r.type)return t.openPremiumModal({initialSection:"no_ads",tabId:i}),void t.closeReportAdModal({tabId:i});if("reported"===r.type||"hidden"===r.type)return t.showNotification({message:(0,f.yE)("reported"===r.type?"AdReported":"AdHidden"),tabId:i}),t.closeReportAdModal({tabId:i}),e=(0,w.mS)(),e=a?(0,S.Itk)(e,a):(0,S.b8O)(e,{sponsoredPeer:void 0},i),void(0,w.UF)(e);if("selectOption"===r.type){e=(0,w.mS)();const t=(0,C.nTw)(e,i).reportAdModal?.sections,s=t?.[t.length-1]?.options.find((e=>e.option===n)),d={title:r.title,options:r.options,subtitle:s?.text};e=(0,A.w)(e,{reportAdModal:{chatId:a,randomId:o,sections:t?[...t,d]:[d]}},i),(0,w.UF)(e)}}})),(0,w.aJ)("hideSponsored",(async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};(0,C.g29)(e)?await(0,b.px)("toggleSponsoredMessages",{enabled:!1})&&(e=(0,w.mS)(),e=(0,S.weB)(e,e.currentUserId,{areAdsEnabled:!1}),(0,w.UF)(e),t.showNotification({message:(0,f.yE)("AdHidden"),tabId:a})):t.openPremiumModal({initialSection:"no_ads",tabId:a})})),(0,w.aJ)("fetchUnreadMentions",(async(e,t,s)=>{const{chatId:a,offsetId:o}=s;await de(e,a,o)})),(0,w.aJ)("markMentionsRead",((e,t,s)=>{const{chatId:a,messageIds:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);i&&(e=(0,S.pWt)(e,a,i,o,!0),(0,w.UF)(e),t.markMessagesRead({messageIds:o,tabId:n}))})),(0,w.aJ)("focusNextMention",(async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};let o=(0,C.meB)(e,a);if(o){if(!o.unreadMentions){await de(e,o.id),e=(0,w.mS)();const t=o.id;if(o=(0,C.meB)(e,a),!o?.unreadMentions||t!==o.id)return}t.focusMessage({chatId:o.id,messageId:o.unreadMentions[0],tabId:a})}})),(0,w.aJ)("readAllMentions",((e,t,s)=>{const{chatId:a,threadId:o=n.l3}=s,i=(0,C.hds)(e,a);if(i)return(0,b.px)("readAllMentions",{chat:i,threadId:o===n.l3?void 0:o}),o===n.l3?(0,S.wix)(e,i.id,{unreadMentionsCount:void 0,unreadMentions:void 0}):void 0})),(0,w.aJ)("openUrl",((e,t,s)=>{const{url:o,shouldSkipModal:n,ignoreDeepLinks:i,tabId:d=(0,u.g0)()}=s,c=(0,r.Tc)(o),h=new URL(c),p=(0,r._G)(c);if(!i&&(0,l.zq)(c))return t.closeStoryViewer({tabId:d}),t.closePaymentModal({tabId:d}),void t.openTelegramLink({url:o,tabId:d});const{appConfig:m,config:g}=e;if(m){if(g?.autologinToken&&m.autologinDomains.includes(h.hostname))return h.searchParams.set("autologin_token",g.autologinToken),void window.open(h.href,"_blank","noopener");if(m.urlAuthDomains.includes(h.hostname))return t.closeStoryViewer({tabId:d}),void t.requestLinkUrlAuth({url:o,tabId:d})}c.match(a.H_r)||n?window.open(h,"_blank","noopener"):t.toggleSafeLinkModal({url:p?h.toString():c,tabId:d})})),(0,w.aJ)("openChatOrTopicWithReplyInDraft",((e,t,s)=>{const{chatId:a,topicId:o,tabId:i=(0,u.g0)()}=s;e=(0,w.mS)();const r=(0,C.nTw)(e,i).replyingMessage;e=(0,A.w)(e,{isShareMessageModalShown:!1,replyingMessage:{}},i),(0,w.UF)(e),e=(0,w.mS)();const d=(0,C.meB)(e,i),c=(0,C.Xf0)(e,i)?.threadId;if(!d||!c)return;const l=o||n.l3,h=d.id,p={type:"message",replyToMsgId:r.messageId,replyToTopId:r.toThreadId,replyToPeerId:h,quoteText:r.quoteText,quoteOffset:r.quoteOffset},m=r.messageId?p:(0,C.GA4)(e,h,c)?.replyInfo;if(!m)return;if(!(0,C.Vz3)(e,a,h,m))return void t.showNotification({message:(0,f.yE)("Chat.SendNotAllowedText"),tabId:i});if(!m.replyToPeerId&&a===d.id)return;const g=m?.replyToPeerId?m.replyToPeerId===a?void 0:m.replyToPeerId:h;!function(e,t,s,a){const o=(0,C.GA4)(e,a,t);s.replyToMsgId&&te({global:e,chatId:a,threadId:t,draft:{...o,replyInfo:s},isLocalOnly:!0,noLocalTimeUpdate:!0})}(e,l,{...m,replyToPeerId:g,type:"message"},a),t.openThread({chatId:a,threadId:l,tabId:i}),t.closeMediaViewer({tabId:i}),t.exitMessageSelectMode({tabId:i}),t.clearDraft({chatId:h,threadId:c})})),(0,w.aJ)("setForwardChatOrTopic",(async(e,t,s)=>{const{chatId:a,topicId:o,tabId:i=(0,u.g0)()}=s,r=(0,C.mBe)(e,a);(0,C.lC)(e,i)&&r&&!await async function(e,t,s){let a=(0,C.vGo)(e,s);if(!a){const{accessHash:e}=t,o=await(0,b.px)("fetchFullUser",{id:s,accessHash:e});a=o?.fullInfo}return Boolean(!a?.noVoiceMessages)}(e,r,a)?t.showDialog({data:{message:(0,f.yE)("VoiceMessagesRestrictedByPrivacy",(0,v.Yg)(r))},tabId:i}):(e=(0,w.mS)(),(0,C.DI)(e,a,i)?(e=(0,A.w)(e,{forwardMessages:{...(0,C.nTw)(e,i).forwardMessages,toChatId:a,toThreadId:o},isShareMessageModalShown:!1},i),(0,w.UF)(e),t.openThread({chatId:a,threadId:o||n.l3,tabId:i}),t.closeMediaViewer({tabId:i}),t.exitMessageSelectMode({tabId:i})):t.showAllowedMessageTypesNotification({chatId:a,tabId:i}))})),(0,w.aJ)("forwardToSavedMessages",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,A.w)(e,{forwardMessages:{...(0,C.nTw)(e,a).forwardMessages,toChatId:e.currentUserId}},a),(0,w.UF)(e),t.exitMessageSelectMode({tabId:a}),t.forwardMessages({isSilent:!0,tabId:a})})),(0,w.aJ)("forwardStory",((e,t,s)=>{const{toChatId:a,tabId:o=(0,u.g0)()}=s||{},{fromChatId:n,storyId:i}=(0,C.nTw)(e,o).forwardMessages,r=n?(0,C.hds)(e,n):void 0,d=a?(0,C.hds)(e,a):void 0,c=n&&i?(0,C.Msb)(e,n,i):void 0;if(!r||!d||!c||"isDeleted"in c)return;const l=(0,C.ZZX)(e,a),{text:h,entities:p}=c.content.text||{};re(e,{chat:d,text:h,entities:p,story:c,lastMessageId:l}),e=(0,w.mS)(),e=(0,A.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},o),(0,w.UF)(e)})),(0,w.aJ)("requestMessageTranslation",((e,t,s)=>{const{chatId:a,id:o,toLanguageCode:n=(0,C.Qq_)(e),tabId:i=(0,u.g0)()}=s;return e=(0,S._Bm)(e,a,o,n,i),(0,S.qpc)(e,{translationLanguage:n})})),(0,w.aJ)("showOriginalMessage",((e,t,s)=>{const{chatId:a,id:o,tabId:n=(0,u.g0)()}=s;return(0,S.xGf)(e,a,o,n)})),(0,w.aJ)("markMessagesTranslationPending",((e,t,s)=>{const{chatId:a,messageIds:o,toLanguageCode:n=(0,C.wmb)(e)}=s;return o.forEach((t=>{e=(0,S.oeN)(e,a,t,n,{isPending:!0})})),e})),(0,w.aJ)("translateMessages",((e,t,s)=>{const{chatId:a,messageIds:o,toLanguageCode:n=(0,C.wmb)(e)}=s,i=(0,C.hds)(e,a);if(i)return t.markMessagesTranslationPending({chatId:a,messageIds:o,toLanguageCode:n}),(0,b.px)("translateText",{chat:i,messageIds:o,toLanguageCode:n}),e}));let ce,le={};function ue(){ce&&(clearTimeout(ce),ce=void 0);const{loadMessageViews:e}=(0,w.ko)();Object.entries(le).forEach((([t,s])=>{e({chatId:t,ids:Array.from(s),shouldIncrement:!0})})),le={}}(0,w.aJ)("scheduleForViewsIncrement",((e,t,s)=>{const{ids:a,chatId:o}=s;ce||setTimeout(ue,1e3),le[o]||(le[o]=new Set),a.forEach((e=>{le[o].add(e)}))})),(0,w.aJ)("loadMessageViews",(async(e,t,s)=>{const{chatId:a,ids:o,shouldIncrement:n}=s;if((0,C.trm)(e))return;const i=(0,C.hds)(e,a);if(!i)return;const r=await(0,b.px)("fetchMessageViews",{chat:i,ids:o,shouldIncrement:n});r&&(e=(0,w.mS)(),r.viewsInfo.forEach((t=>{e=(0,S.r3y)(e,a,t.id,{viewsCount:t.views,forwardsCount:t.forwards},!0),t.threadInfo&&(e=(0,S.eAk)(e,a,t.id,t.threadInfo))})),(0,w.UF)(e))})),(0,w.aJ)("loadFactChecks",(async(e,t,s)=>{const{chatId:a,ids:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchFactChecks",{chat:n,ids:o});i&&(e=(0,w.mS)(),i.forEach(((t,s)=>{e=(0,S.r3y)(e,a,o[s],{factCheck:t})})),(0,w.UF)(e))})),(0,w.aJ)("loadPaidReactionPrivacy",(()=>{(0,b.px)("fetchPaidReactionPrivacy")})),(0,w.aJ)("loadOutboxReadDate",(async(e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.hds)(e,a);if(n)try{const t=await(0,b.px)("fetchOutboxReadDate",{chat:n,messageId:o});t?.date&&(e=(0,w.mS)(),e=(0,S.r3y)(e,a,o,{readDate:t.date}),(0,w.UF)(e))}catch(t){const{message:s}=t;if("USER_PRIVACY_RESTRICTED"===s||"YOUR_PRIVACY_RESTRICTED"===s){if(e=(0,w.mS)(),!(0,C.mBe)(e,a))return;const t=(0,C.K0y)(e,a);if(!t)return;const n="USER_PRIVACY_RESTRICTED"===s?{isReadDateRestricted:!0}:{isReadDateRestrictedByMe:!0};e=(0,S.wWy)(e,{[a]:{...t,...n}}),e=(0,S.r3y)(e,a,o,{readDate:void 0}),(0,w.UF)(e)}}})),(0,w.aJ)("loadQuickReplies",(async e=>{const t=await(0,b.px)("fetchQuickReplies");t&&(e=(0,w.mS)(),e=(0,S.tMr)(e,(0,h.dU)(t.messages,"id")),e=(0,S.xAV)(e,t.quickReplies),(0,w.UF)(e))})),(0,w.aJ)("sendQuickReply",((e,t,s)=>{const{chatId:a,quickReplyId:o}=s,n=(0,C.hds)(e,a);return n?((0,b.px)("sendQuickReply",{chat:n,shortcutId:o}),e):e})),(0,w.aJ)("copyMessageLink",(async(e,t,s)=>{const{chatId:a,messageId:o,shouldIncludeThread:n,shouldIncludeGrouped:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a);if(!d)return void t.showNotification({message:(0,f.yE)("ErrorOccurred"),tabId:r});const l=()=>t.showNotification({message:(0,f.yE)("ErrorOccurred"),tabId:r});if(!(0,v.WX)(d)&&!(0,v.Vs)(d))return void l();const h=(0,b.px)("exportMessageLink",{chat:d,id:o,shouldIncludeThread:n,shouldIncludeGrouped:i});await(0,c.LD)(h,(()=>t.showNotification({message:(0,f.yE)("LinkCopied"),tabId:r})),l)}));const he=new Map;let pe;function me(e){const{shouldSendAsFile:t,mimeType:s}=e;return a.IH3.has(s)?"audio":t?"file":s===a.Vz3?"gif":a.gex.has(s)||a.fNs.has(s)?"media":e.voice?"voice":"file"}(0,w.aJ)("reportMessageDelivery",((e,t,s)=>{const{chatId:a,messageId:o}=s,n=he.get(a)||[];n.push(o),he.set(a,n),pe||(pe=window.setTimeout((()=>{pe=void 0,he.forEach(((t,s)=>{const a=(0,C.hds)(e,s);a&&(0,b.px)("reportMessagesDelivery",{chat:a,messageIds:t})})),he.clear()}),500))})),(0,w.aJ)("openPreparedInlineMessageModal",(async(e,t,s)=>{const{botId:a,messageId:o,webAppKey:n,tabId:i=(0,u.g0)()}=s,r=(0,C.mBe)(e,a);if(!r)return;const d=await(0,b.px)("fetchPreparedInlineMessage",{bot:r,id:o});d?(e=(0,w.mS)(),e=(0,A.w)(e,{preparedMessageModal:{message:d,webAppKey:n,botId:a}},i),(0,w.UF)(e)):t.sendWebAppEvent({webAppKey:n,event:{eventType:"prepared_message_failed",eventData:{error:"MESSAGE_EXPIRED"}},tabId:i})})),(0,w.aJ)("openSharePreparedMessageModal",((e,t,s)=>{const{webAppKey:a,message:o,tabId:n=(0,u.g0)()}=s,i=o.peerTypes?.filter((e=>"self"!==e));e=(0,w.mS)(),e=(0,A.w)(e,{sharePreparedMessageModal:{webAppKey:a,filter:i,message:o}},n),(0,w.UF)(e)}));var ge=s(529),fe=s(64520);const Ie=(0,I.nF)((e=>e()),500,!1);async function be(e,t){const s=await(0,b.px)("fetchRecentStickers",{hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:s}},(0,w.UF)(e))}async function ve(e,t,s){let a;try{a=await(0,b.px)("fetchStickers",{stickerSetInfo:s})}catch(a){if("STICKERSET_INVALID"===a.message)return void Object.values(e.byTabId).forEach((({id:a})=>{t.showNotification({message:(0,f.yE)("StickerPack.ErrorNotFound"),tabId:a}),"shortName"in s&&(0,C.nTw)(e,a).openedStickerSetShortName===s.shortName&&(e=(0,A.w)(e,{openedStickerSetShortName:void 0},a),(0,w.UF)(e))}))}if(e=(0,w.mS)(),!a)return;const{set:o,stickers:n,packs:i}=a,r=(e=(0,S.v9P)(e,o.id,{...o,stickers:n,packs:i})).stickers.forEmoji.emoji;r&&i[r]&&(e=(0,S.PcY)(e)),(0,w.UF)(e)}async function ye(e,t,s,a,...[o=(0,u.g0)()]){const n=await(0,b.px)("searchGifs",{query:t,offset:a,username:s});n&&(e=(0,w.mS)(),e=(0,S.Mel)(e,!a,n.gifs,n.nextOffset,o),(0,w.UF)(e))}(0,w.aJ)("loadStickerSets",(async(e,t)=>{const[s,a]=await Promise.all([(0,b.px)("fetchStickerSets",{hash:e.stickers.added.hash}),(0,b.px)("fetchCustomEmojiSets",{hash:e.customEmojis.added.hash})]);a&&s&&(e=(0,w.mS)(),e=(0,S.MkE)(e,"added",s.hash,s.sets),e=(0,S.E24)(e,a.hash,a.sets),(0,w.UF)(e),t.loadCustomEmojis({ids:e.recentCustomEmojis}))})),(0,w.aJ)("loadAddedStickers",(async(e,t)=>{const{added:{setIds:s=[]},setsById:a}=e.stickers,{added:{setIds:o=[]}}=e.customEmojis,n=[...s,...o];if(n.length)for(let e=0;e<n.length;e++){const s=n[e];a[s]?.stickers||(t.loadStickers({stickerSetInfo:{id:s,accessHash:a[s].accessHash}}),e%10==0&&e>0&&await(0,I.v7)(200))}})),(0,w.aJ)("loadRecentStickers",(e=>{const{hash:t}=e.stickers.recent||{};be(e,t)})),(0,w.aJ)("loadFavoriteStickers",(async e=>{const{hash:t}=e.stickers.favorite||{},s=await(0,b.px)("fetchFavoriteStickers",{hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:s}},(0,w.UF)(e))})),(0,w.aJ)("loadPremiumStickers",(async e=>{const{hash:t}=e.stickers.premium||{};if((0,C.trm)(e))return;const s=await(0,b.px)("fetchStickersForEmoji",{emoji:"⭐️⭐️",hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,premium:{hash:s.hash,stickers:s.stickers}}},(0,w.UF)(e))})),(0,w.aJ)("loadGreetingStickers",(async e=>{const{hash:t}=e.stickers.greeting||{};if((0,C.trm)(e))return;const s=await(0,b.px)("fetchStickersForEmoji",{emoji:"👋⭐️",hash:t});s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,greeting:{hash:s.hash,stickers:s.stickers.filter((e=>"👋"===e.emoji))}}},(0,w.UF)(e))})),(0,w.aJ)("loadFeaturedStickers",(async e=>{const{hash:t}=e.stickers.featured||{},s=await(0,b.px)("fetchFeaturedStickers",{hash:t});s&&(e=(0,w.mS)(),e=(0,S.MkE)(e,"featured",s.hash,s.sets),(0,w.UF)(e))})),(0,w.aJ)("loadPremiumGifts",(async e=>{const t=await(0,b.px)("fetchPremiumGifts");if(!t)return;const{set:s,stickers:a}=t;e=(0,w.mS)(),e={...e,premiumGifts:{...s,stickers:a}},(0,w.UF)(e)})),(0,w.aJ)("loadDefaultTopicIcons",(async e=>{const t=await(0,b.px)("fetchDefaultTopicIcons");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t,o={...s,stickers:a};e=(0,S.v9P)(e,o.id,o),e={...e,defaultTopicIconsId:o.id},(0,w.UF)(e)})),(0,w.aJ)("loadDefaultStatusIcons",(async e=>{const t=await(0,b.px)("fetchDefaultStatusEmojis");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t,o={...s,stickers:a};e=(0,S.v9P)(e,o.id,o),e={...e,defaultStatusIconsId:o.id},(0,w.UF)(e)})),(0,w.aJ)("loadUserCollectibleStatuses",(async(e,t)=>{(0,w.UF)(e);const{hash:s}=e.collectibleEmojiStatuses||{},a=await(0,b.px)("fetchCollectibleEmojiStatuses",{hash:s});if(!a)return;e=(0,w.mS)(),e={...e,collectibleEmojiStatuses:{hash:a.hash,statuses:a.statuses}},(0,w.UF)(e);const o=a.statuses.map((({documentId:e})=>e));t.loadCustomEmojis({ids:o})})),(0,w.aJ)("loadStickers",((e,t,s)=>{const{stickerSetInfo:a}=s,o=(0,C.ycM)(e,a);o&&o.count===o?.stickers?.length||ve(e,t,a)})),(0,w.aJ)("loadAnimatedEmojis",(async e=>{const[t,s]=await Promise.all([(0,b.px)("fetchAnimatedEmojis"),(0,b.px)("fetchAnimatedEmojiEffects")]);t&&s&&(e=(0,w.mS)(),e=(0,S.$nQ)(e,{...t.set,stickers:t.stickers}),e={...e,animatedEmojiEffects:{...s.set,stickers:s.stickers}},(0,w.UF)(e))})),(0,w.aJ)("loadBirthdayNumbersStickers",(async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:a.OVC}});t&&(e=(0,w.mS)(),e={...e,birthdayNumbers:{...t.set,stickers:t.stickers}},(0,w.UF)(e))})),(0,w.aJ)("loadRestrictedEmojiStickers",(async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:a.Kh8}});t&&(e=(0,w.mS)(),e={...e,restrictedEmoji:{...t.set,stickers:t.stickers}},(0,w.UF)(e))})),(0,w.aJ)("loadGenericEmojiEffects",(async e=>{const t=await(0,b.px)("fetchGenericEmojiEffects");if(!t)return;e=(0,w.mS)();const{set:s,stickers:a}=t;e={...e,genericEmojiEffects:{...s,stickers:a}},(0,w.UF)(e)})),(0,w.aJ)("loadSavedGifs",(async e=>{const{hash:t}=e.gifs.saved,s=await(0,b.px)("fetchSavedGifs",{hash:t});s&&(e=(0,w.mS)(),e={...e,gifs:{...e.gifs,saved:s}},(0,w.UF)(e))})),(0,w.aJ)("saveGif",(async(e,t,s)=>{const{gif:a,shouldUnsave:o,tabId:n=(0,u.g0)()}=s,i=e.gifs.saved.gifs?.length,r=(0,fe.d)(e,"savedGifs"),d=(0,fe.B)(e,"savedGifs"),c=(0,C.g29)(e);if(!o&&i&&i>=r&&t.showNotification({title:f.yE("LimitReachedFavoriteGifs",r.toString()),message:c?f.yE("LimitReachedFavoriteGifsSubtitlePremium"):f.yE("LimitReachedFavoriteGifsSubtitle",d.toString()),...!c&&{action:{action:"openPremiumModal",payload:{tabId:n}}},className:"bold-link",tabId:n}),!await(0,b.px)("saveGif",{gif:a,shouldUnsave:o}))return;e=(0,w.mS)();const l=e.gifs.saved.gifs?.filter((({id:e})=>e!==a.id))||[],h=o?l:[a,...l];e={...e,gifs:{...e.gifs,saved:{...e.gifs.saved,gifs:h}}},(0,w.UF)(e)})),(0,w.aJ)("faveSticker",((e,t,s)=>{const{sticker:a,tabId:o=(0,u.g0)()}=s,n=e.stickers.favorite.stickers.length,i=(0,fe.d)(e,"stickersFaved"),r=(0,fe.B)(e,"stickersFaved"),d=(0,C.g29)(e);n>=i&&t.showNotification({title:f.yE("LimitReachedFavoriteStickers",i.toString()),message:d?f.yE("LimitReachedFavoriteStickersSubtitlePremium"):f.yE("LimitReachedFavoriteStickersSubtitle",r.toString()),...!d&&{action:{action:"openPremiumModal",payload:{tabId:o}}},className:"bold-link",tabId:o}),a&&(0,b.px)("faveSticker",{sticker:a})})),(0,w.aJ)("unfaveSticker",((e,t,s)=>{const{sticker:a}=s;a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:{...e.stickers.favorite,stickers:e.stickers.favorite.stickers.filter((({id:e})=>e!==a.id))}}},(0,w.UF)(e),(0,b.px)("faveSticker",{sticker:a,unfave:!0}))})),(0,w.aJ)("removeRecentSticker",(async(e,t,s)=>{const{sticker:a}=s;await(0,b.px)("removeRecentSticker",{sticker:a})&&be((0,w.mS)())})),(0,w.aJ)("clearRecentStickers",(async e=>{await(0,b.px)("clearRecentStickers")&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:{stickers:[]}}},(0,w.UF)(e))})),(0,w.aJ)("toggleStickerSet",((e,t,s)=>{const{stickerSetId:a}=s,o=(0,C.ycM)(e,a);if(!o)return;const{accessHash:n,installedDate:i,isArchived:r}=o,d=!r&&Boolean(i);(0,b.px)(d?"uninstallStickerSet":"installStickerSet",{stickerSetId:a,accessHash:n})})),(0,w.aJ)("loadEmojiKeywords",(async(e,t,s)=>{const{language:a}=s;let o=e.emojiKeywords[a];if(o?.isLoading)return;e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{...o,isLoading:!0}}},(0,w.UF)(e);const n=await(0,b.px)("fetchEmojiKeywords",{language:a,fromVersion:o?o.version:0});if(o=(e=(0,w.mS)()).emojiKeywords[a],!n)return e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{...o,isLoading:!1}}},void(0,w.UF)(e);e={...e,emojiKeywords:{...e.emojiKeywords,[a]:{isLoading:!1,version:n.version,keywords:{...o?.keywords,...n.keywords}}}},(0,w.UF)(e)})),(0,w.aJ)("setStickerSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;a&&Ie((async()=>{const t=await(0,b.px)("searchStickers",{query:a});if(!t)return;e=(0,w.mS)();const{setsById:s,added:n}=e.stickers,i=t.sets.map((({id:e})=>e));n.setIds&&n.setIds.forEach((e=>{if(!i.includes(e)){const{title:t}=s[e]||{};t&&(0,ge.A)(t,a)&&i.unshift(e)}})),e=(0,S.MkE)(e,"search",t.hash,t.sets),e=(0,S.bG)(e,t.hash,i,o),(0,w.UF)(e)}))})),(0,w.aJ)("setGifSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;"string"==typeof a&&Ie((()=>{ye(e=(0,w.mS)(),a,e.config?.gifSearchUsername,void 0,o)}))})),(0,w.aJ)("searchMoreGifs",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{query:o,offset:n}=(0,C.nTw)(e,a).gifSearch;"string"==typeof o&&Ie((()=>{ye(e=(0,w.mS)(),o,e.config?.gifSearchUsername,n,a)}))})),(0,w.aJ)("loadStickersForEmoji",((e,t,s)=>{const{emoji:a}=s,{hash:o}=e.stickers.forEmoji;Ie((async()=>{e=(0,w.mS)(),e={...e,stickers:{...e.stickers,forEmoji:{...e.stickers.forEmoji,emoji:a}}},(0,w.UF)(e);const t=await(0,b.px)("fetchStickersForEmoji",{emoji:a,hash:o});e=(0,w.mS)(),t&&e.stickers.forEmoji.emoji===a&&(e=(0,S.f_N)(e,a,t.stickers,t.hash),(0,w.UF)(e))}))})),(0,w.aJ)("clearStickersForEmoji",(e=>({...e,stickers:{...e.stickers,forEmoji:{}}}))),(0,w.aJ)("loadCustomEmojiForEmoji",((e,t,s)=>{const{emoji:a}=s;return(0,S.G4z)(e,a)})),(0,w.aJ)("clearCustomEmojiForEmoji",(e=>({...e,customEmojis:{...e.customEmojis,forEmoji:{}}}))),(0,w.aJ)("loadFeaturedEmojiStickers",(async e=>{const t=await(0,b.px)("fetchFeaturedEmojiStickers");t&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,featuredIds:t.sets.map((({id:e})=>e)),byId:{...e.customEmojis.byId,...(0,h.dU)(t.sets.flatMap((e=>e.stickers||[])),"id")}},stickers:{...e.stickers,setsById:{...e.stickers.setsById,...(0,h.dU)(t.sets,"id")}}},(0,w.UF)(e))})),(0,w.aJ)("openStickerSet",(async(e,t,s)=>{const{stickerSetInfo:a,shouldIgnoreCache:o,tabId:n=(0,u.g0)()}=s;!o&&(0,C.ycM)(e,a)||await ve(e,t,a),e=(0,w.mS)();const i=(0,C.ycM)(e,a);i?.shortName&&(e=(0,A.w)(e,{openedStickerSetShortName:i.shortName},n),(0,w.UF)(e))})),(0,w.aJ)("loadRecentEmojiStatuses",(async e=>{const t=await(0,b.px)("fetchRecentEmojiStatuses");t&&(e=(0,w.mS)(),e=(0,S.T3R)(e,t.hash,t.emojiStatuses),(0,w.UF)(e))}));var we=s(17663),Se=s(62214);const Ae=(0,I.nF)((e=>e()),500,!1);async function Ce(e,t,s){if(!(0,Se.YE)(t)&&!(0,Se.WX)(t))return;const a=(0,C.O5q)(e,t.id,s);if(a)return a;const o=await(0,b.px)("fetchMessage",{chat:t,messageId:s});return"MESSAGE_DELETED"===o?void 0:o?.message}(0,w.aJ)("setGlobalSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,{chatId:n}=(0,C.nTw)(e,o).globalSearch;a&&!n&&Ae((async()=>{const[t,s]=await Promise.all([(0,b.px)("searchChats",{query:a}),(0,b.px)("fetchSponsoredPeer",{query:a})]);e=(0,w.mS)();const n=(0,C.xT4)(e,o);if(!t||!n||a!==n)return e=(0,S.RgT)(e,{chats:!1},o),void(0,w.UF)(e);const{accountResultIds:i,globalResultIds:r}=t;e=(0,S.RgT)(e,{chats:!1},o),e=(0,S.b8O)(e,{localResults:{peerIds:i},globalResults:{...(0,C.nTw)(e,o).globalSearch.globalResults,peerIds:r},sponsoredPeer:s},o),(0,w.UF)(e)}))})),(0,w.aJ)("setGlobalSearchDate",((e,t,s)=>{const{date:a,tabId:o=(0,u.g0)()}=s,n=a?(0,we.TI)(a):a;e=(0,S.b8O)(e,{minDate:a,maxDate:n,query:"",resultsByType:{...(0,C.nTw)(e,o).globalSearch.resultsByType,text:{totalCount:void 0,foundIds:[],nextOffsetId:0}}},o),(0,w.UF)(e),t.searchMessagesGlobal({type:"text",tabId:o})})),(0,w.aJ)("searchMessagesGlobal",((e,t,s)=>{const{type:o,context:n,shouldResetResultsByType:i,shouldCheckFetchingMessagesStatus:r,tabId:d=(0,u.g0)()}=s;r&&(e=(0,S.RgT)(e,{messages:!0},d),(0,w.UF)(e),e=(0,w.mS)());const{query:c,resultsByType:h,chatId:p}=(0,C.nTw)(e,d).globalSearch,{totalCount:m,foundIds:g,nextOffsetId:f,nextOffsetPeerId:I,nextOffsetRate:v}=!i&&h?.[o]||{};if(void 0!==m&&(!m||g&&g.length>=m))return;const A=p?(0,C.PVB)(e,p):void 0;!async function(e,t){const{query:s="",type:o,context:n,offsetRate:i,offsetId:r,offsetPeer:d,peer:c,maxDate:h,minDate:p,shouldResetResultsByType:m,tabId:g=(0,u.g0)()}=t;let f,I;if(c){const e=(0,b.px)("searchMessagesInChat",{peer:c,query:s,type:o,limit:a.wAs,offsetId:r,minDate:p,maxDate:h}),t=(0,y.vj)(c)&&c.isForum?(0,b.px)("fetchTopics",{chat:c,query:s,limit:a.mH$}):void 0,[n,i]=await Promise.all([e,t]);if(n){const{messages:e,totalCount:t,nextOffsetId:s}=n,{topics:a,count:o}=i||{};f={topics:a,totalTopicsCount:o,messages:e,totalCount:t,nextOffsetId:s}}}else if(f=await(0,b.px)("searchMessagesGlobal",{query:s,offsetRate:i,offsetId:r,offsetPeer:d,limit:a.wAs,type:o,context:n,maxDate:h,minDate:p}),(0,l.zq)(s)){const t=(0,l.vG)(s);"publicMessageLink"===t?.type?I=await async function(e,t){const{username:s,messageId:a}=t,o=(0,C.qn$)(e,s);if(o)return Ce(e,o,a);const{chat:n}=await(0,b.px)("getChatByUsername",s)??{};return n?Ce(e,n,a):void 0}(e,t):"privateMessageLink"===t?.type&&(I=await function(e,t){const{channelId:s,messageId:a}=t,o=(0,k.QE)(s),n=(0,C.hds)(e,o);if(n)return Ce(e,n,a)}(e,t))}e=(0,w.mS)(),m&&(e=(0,S.b8O)(e,{resultsByType:{...((0,C.nTw)(e,g).globalSearch||{}).resultsByType,[o]:void 0}},g));const v=(0,C.xT4)(e,g);if(!f||""!==s&&s!==v)return e=(0,S.RgT)(e,{messages:!1},g),void(0,w.UF)(e);I&&(f.totalCount=f.messages.unshift(I));const{messages:A,userStatusesById:M,totalCount:F,nextOffsetRate:P,nextOffsetId:T,nextOffsetPeerId:U}=f;M&&(e=(0,S.d2X)(e,M)),A.length&&(e=(0,S.KcS)(e,A)),e=(0,S.HyB)(e,A,F,o,P,T,U,g),f.topics&&(e=(0,S.mIA)(e,c.id,f.totalTopicsCount,f.topics));const x=f.topics?.map((({id:e})=>e)).sort(((e,t)=>t-e));e=(0,S.b8O)(e,{foundTopicIds:x},g),(0,w.UF)(e)}(e,{query:c,type:o,context:n,shouldResetResultsByType:i,offsetRate:v,offsetId:f,offsetPeer:I?(0,C.PVB)(e,I):void 0,peer:A,tabId:d})})),(0,w.aJ)("searchPopularBotApps",(async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).globalSearch.popularBotApps,n=o?.nextOffset;if(o?.peerIds&&!n)return;e=(0,S.RgT)(e,{botApps:!0},a),(0,w.UF)(e);const i=await(0,b.px)("fetchPopularAppBots",{offset:n});if(e=(0,w.mS)(),!i)return e=(0,S.RgT)(e,{botApps:!1},a),void(0,w.UF)(e);e=(0,S.b8O)(e,{popularBotApps:{peerIds:[...o?.peerIds||[],...i.peerIds],nextOffset:i.nextOffset}},a),e=(0,S.RgT)(e,{botApps:!1},a),(0,w.UF)(e)}));var Me=s(57309);async function ke(e,t,s,o,n,i=!1,r,...[d=(0,u.g0)()]){const c=r?e.currentUserId:t.id,l=await(0,b.px)("searchMessagesInChat",{peer:t,type:o,limit:2*a.Um,threadId:s,offsetId:n,isSavedDialog:r});if(!l)return;const{userStatusesById:p,messages:m,totalCount:g,nextOffsetId:f}=l,I=(0,h.dU)(m,"id"),v=Object.keys(I).map(Number);e=(0,w.mS)(),(0,C.BU_)(e,d)&&(e=(0,S.d2X)(e,p),e=(0,S.o4A)(e,c,I),e=(0,S.jU1)(e,c,s,o,v,g,f,d),(0,w.UF)(e),i||ke(e,t,s,o,f,!0,r,d))}(0,w.aJ)("performMiddleSearch",(async(e,t,s)=>{const{query:o,chatId:i,threadId:r=n.l3,tabId:d=(0,u.g0)()}=s||{};if(!i)return;const c=e.currentUserId,l=(0,v.cG)(i,r,c),h=l?String(r):i,p=h?(0,C.PVB)(e,h):void 0;let m=(0,C.TCk)(e,d);if(!p)return;m||(e=(0,S.$RI)(e,h,r,{},d),(0,w.UF)(e),e=(0,w.mS)()),m=(0,C.TCk)(e,d);const{results:g,savedTag:f,type:I,isHashtag:y}=m,A=g?.query===o,M=A?g?.nextOffsetId:void 0,k=A?g?.nextOffsetRate:void 0,F=A?g?.nextOffsetPeerId:void 0,P=A&&F?(0,C.hds)(e,F):void 0;if((y||!f)&&!o)return e=(0,S.$RI)(e,h,r,{fetchingQuery:void 0},d),void(0,w.UF)(e);let T;if(e=(0,S.$RI)(e,h,r,{fetchingQuery:o},d),(0,w.UF)(e),"chat"===I&&(T=await(0,b.px)("searchMessagesInChat",{peer:p,type:"text",query:y?`#${o}`:o,threadId:r,limit:a.gXr,offsetId:M,isSavedDialog:l,savedTag:f})),"myChats"===I&&(T=await(0,b.px)("searchMessagesGlobal",{type:"text",query:y?`#${o}`:o,limit:a.gXr,offsetId:M,offsetRate:k,offsetPeer:P})),"channels"===I&&(T=await(0,b.px)("searchHashtagPosts",{hashtag:o,limit:a.gXr,offsetId:M,offsetPeer:P,offsetRate:k})),!T)return;const{userStatusesById:U,messages:x,totalCount:B,nextOffsetId:N,nextOffsetRate:R,nextOffsetPeerId:J}=T,E=x.map(Me.D);e=(0,w.mS)(),m=(0,C.TCk)(e,d);const Y=m?.savedTag&&!(0,v.a0)(f,m.savedTag);if(!m||m?.fetchingQuery!==o||Y)return;const D=l?c:p.id;e=(0,S.d2X)(e,U),e=(0,S.KcS)(e,x),e=(0,S.$RI)(e,D,r,{fetchingQuery:void 0},d),e=(0,S.VmW)(e,D,r,{foundIds:E,totalCount:B,nextOffsetId:N,nextOffsetRate:R,nextOffsetPeerId:J,query:o||""},d),(0,w.UF)(e)})),(0,w.aJ)("searchHashtag",((e,t,s)=>{const{hashtag:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Xf0)(e,o);if(!n)return;const i=a.replace(/^#/,"");t.updateMiddleSearch({chatId:n.chatId,threadId:n.threadId,update:{isHashtag:!0,requestedQuery:i},tabId:o})})),(0,w.aJ)("searchSharedMediaMessages",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(!o||!n)return;const i=(0,v.cG)(o,n,e.currentUserId),r=i?String(n):o,d=(0,C.PVB)(e,r),c=(0,C.BU_)(e,a);if(!d||!c)return;const{currentType:l,resultsByType:h}=c,p=l&&h&&h[l],m=p?.nextOffsetId;l&&ke(e,d,n,l,m,void 0,i,a)})),(0,w.aJ)("searchChatMediaMessages",((e,t,s)=>{const{chatId:o,threadId:n,currentMediaMessageId:r,limit:d,direction:c,tabId:l=(0,u.g0)()}=s;if(!o||!n||!r)return;const p=(0,v.cG)(o,n,e.currentUserId),m=p?String(n):o,g=(0,C.hds)(e,m);if(!g)return;let f=(0,C.CuV)(e,l);if(!f){if(e=(0,S.tXQ)(e,o,n,l),(0,w.UF)(e),f=(0,C.CuV)(e,l),!f)return;e=(0,w.mS)()}!async function(e,t,s,o,n,r,d,c=a.laV,...[l=(0,u.g0)()]){const{isSynced:p}=e;if(!p||n.isLoading)return;let m=function(e,t){if((0,h.OX)(t,e.currentSegment.foundIds))return e.currentSegment;const s=e.segments.findIndex((e=>(0,h.OX)(t,e.foundIds)));if(-1===s)return void(e.currentSegment&&e.currentSegment.foundIds.length&&e.segments.push(e.currentSegment));const a=e.segments.splice(s,1)[0];return e.segments.push(e.currentSegment),a}(n,o);if(void 0===r&&(r=function(e,t){if(!t)return i.TN.Around;const s=t.foundIds.length,a=t.foundIds.indexOf(e);if(-1===a)return i.TN.Around;if(t.loadingState.areAllItemsLoadedBackwards&&t.loadingState.areAllItemsLoadedForwards)return;const o=9>Math.floor(s/2)?0:9,n=s-1;if(a<=o){if(t.loadingState.areAllItemsLoadedBackwards)return;return i.TN.Backwards}if(a>=n-o){if(t.loadingState.areAllItemsLoadedForwards)return;return i.TN.Forwards}}(o,m)),void 0===r)return;const g=function(e,t,s){return s?e===i.TN.Backwards?s.foundIds[0]:e===i.TN.Forwards?s.foundIds[s.foundIds.length-1]:t:t}(r,o,m),f=function(e,t){return e===i.TN.Backwards?0:e===i.TN.Forwards?-(t+1):-(Math.round(t/2)+1)}(r,c),I=d?e.currentUserId:t.id;e=(0,S.lwK)(e,I,s,!0,l),(0,w.UF)(e);const y=await(0,b.px)("searchMessagesInChat",{peer:t,type:"media",limit:c,threadId:s,offsetId:g,isSavedDialog:d,addOffset:f});if(e=(0,w.mS)(),!y)return e=(0,S.lwK)(e,I,s,!1,l),void(0,w.UF)(e);const{messages:A,userStatusesById:C}=y,M=(0,h.dU)(A,"id"),k=Object.keys(M).map(Number);e=(0,S.d2X)(e,C),e=(0,S.o4A)(e,I,M);const F=function(e,t,s,a){let o=Boolean(a?.loadingState.areAllItemsLoadedForwards),n=Boolean(a?.loadingState.areAllItemsLoadedBackwards);return s<t&&(e===i.TN.Forwards?o=!0:e===i.TN.Backwards&&(n=!0)),{areAllItemsLoadedForwards:o,areAllItemsLoadedBackwards:n}}(r,c,k.length,m),P=(0,v.Wm)(M,k,!1);m=(0,S.olz)(P,F,m),e=(0,S.Qb2)(e,I,s,m,n,l),e=(0,S.lwK)(e,I,s,!1,l),(0,w.UF)(e)}(e,g,n,r,f,c,p,d,l)})),(0,w.aJ)("searchMessagesByDate",(async(e,t,s)=>{const{timestamp:a,tabId:o=(0,u.g0)()}=s,{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.hds)(e,n);if(!i)return;const r=await(0,b.px)("findFirstMessageIdAfterDate",{chat:i,timestamp:a});r&&t.focusMessage({chatId:i.id,messageId:r,tabId:o})})),(0,w.aJ)("checkPublicLink",(async(e,t,s)=>{const{username:a,tabId:o=(0,u.g0)()}=s,{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;if((0,C.nTw)(e,o).management.progress===i.TD.InProgress)return;e=(0,S.H6X)(e,n,{isUsernameAvailable:void 0,checkedUsername:void 0},o),(0,w.UF)(e);const{result:r,error:d}=await(0,b.px)("checkChatUsername",{username:a});e=(0,w.mS)(),e=(0,S.G42)(e,!0===r?i.TD.Complete:i.TD.Error,o),e=(0,S.H6X)(e,n,{isUsernameAvailable:!0===r,checkedUsername:a,error:d},o),(0,w.UF)(e),void 0===r&&t.openLimitReachedModal({limit:"channelsPublic",tabId:o})})),(0,w.aJ)("updatePublicLink",(async(e,t,s)=>{const{username:a,shouldDisableUsernames:n,tabId:r=(0,u.g0)()}=s,{chatId:d}=(0,C.Xf0)(e,r)||{};if(!d)return;const c=await(0,o.Jm)(e,t,d,r);if(!c)return;e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.InProgress,r),(0,w.UF)(e);const l=await(0,b.px)("setChatUsername",{chat:c,username:a});n&&await(0,b.px)("deactivateAllUsernames",{chat:c}),e=(0,w.mS)(),e=(0,S.G42)(e,l?i.TD.Complete:i.TD.Error,r),e=(0,S.H6X)(e,c.id,{isUsernameAvailable:void 0,checkedUsername:void 0,error:void 0},r),(0,w.UF)(e)})),(0,w.aJ)("updatePrivateLink",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{},n=o&&(0,C.hds)(e,o);o&&n&&(0,b.px)("updatePrivateLink",{chat:n})})),(0,w.aJ)("setEditingExportedInvite",((e,t,s)=>{const{chatId:a,invite:o,tabId:n=(0,u.g0)()}=s;e=(0,S.H6X)(e,a,{editingInvite:o},n),(0,w.UF)(e)})),(0,w.aJ)("setOpenedInviteInfo",((e,t,s)=>{const{chatId:a,invite:o,tabId:n=(0,u.g0)()}=s,i=o?{inviteInfo:{invite:o}}:{inviteInfo:void 0};e=(0,S.H6X)(e,a,i,n),(0,w.UF)(e)})),(0,w.aJ)("loadExportedChatInvites",(async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a,adminId:o,isRevoked:n,limit:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a),c=(0,C.mBe)(e,o||e.currentUserId);if(!d||!c)return;const l=await(0,b.px)("fetchExportedChatInvites",{peer:d,admin:c,isRevoked:n,limit:i});if(!l)return;e=(0,w.mS)();const{invites:h}=l,p=n?{revokedInvites:h}:{invites:h};e=(0,S.H6X)(e,a,p,r),(0,w.UF)(e)})),(0,w.aJ)("editExportedChatInvite",(async(e,t,s)=>{const{chatId:a,link:o,isRevoked:n,expireDate:i,usageLimit:r,isRequestNeeded:d,title:c,tabId:l=(0,u.g0)()}=s,h=(0,C.hds)(e,a);if(!h)return;const p=await(0,b.px)("editExportedChatInvite",{peer:h,link:o,isRevoked:n,expireDate:i,usageLimit:r,isRequestNeeded:d,title:c});if(!p)return;const{oldInvite:m,newInvite:g}=p;e=(0,w.mS)();const{management:f}=(0,C.nTw)(e,l),I=(f.byChatId[a].invites||[]).filter((e=>e.link!==m.link)),v=[...f.byChatId[a].revokedInvites||[]];g.isRevoked?v.unshift(g):I.push(g),e=(0,S.H6X)(e,a,{invites:I,revokedInvites:v},l),(0,w.UF)(e)})),(0,w.aJ)("exportChatInvite",(async(e,t,s)=>{const{chatId:a,expireDate:o,usageLimit:n,isRequestNeeded:i,title:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a);if(!c)return;const l=await(0,b.px)("exportChatInvite",{peer:c,expireDate:o,usageLimit:n,isRequestNeeded:i,title:r});if(!l)return;e=(0,w.mS)();const h=(0,C.nTw)(e,d).management.byChatId[a].invites||[];e=(0,S.H6X)(e,a,{invites:[...h,l]},d),(0,w.UF)(e)})),(0,w.aJ)("deleteExportedChatInvite",(async(e,t,s)=>{const{chatId:a,link:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;if(!await(0,b.px)("deleteExportedChatInvite",{peer:i,link:o}))return;e=(0,w.mS)();const r=(0,C.nTw)(e,n).management.byChatId[a];e=(0,S.H6X)(e,a,{invites:r?.invites?.filter((e=>e.link!==o)),revokedInvites:r?.revokedInvites?.filter((e=>e.link!==o))},n),(0,w.UF)(e)})),(0,w.aJ)("deleteRevokedExportedChatInvites",(async(e,t,s)=>{const{chatId:a,adminId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.mBe)(e,o||e.currentUserId);i&&r&&await(0,b.px)("deleteRevokedExportedChatInvites",{peer:i,admin:r})&&(e=(0,w.mS)(),e=(0,S.H6X)(e,a,{revokedInvites:[]},n),(0,w.UF)(e))})),(0,w.aJ)("loadChatInviteImporters",(async(e,t,s)=>{const{chatId:a,link:o,offsetDate:n,offsetUserId:i,limit:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a),l=i?(0,C.mBe)(e,i):void 0;if(!c||i&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:n,offsetUser:l,limit:r});if(!h)return;const{importers:p}=h;e=(0,w.mS)();const m=(0,C.nTw)(e,d).management.byChatId[a]?.inviteInfo;m?.invite&&m.invite.link===o&&(e=(0,S.H6X)(e,a,{inviteInfo:{...m,importers:p}},d),(0,w.UF)(e))})),(0,w.aJ)("loadChatInviteRequesters",(async(e,t,s)=>{const{chatId:a,link:o,offsetDate:n,offsetUserId:i,limit:r,tabId:d=(0,u.g0)()}=s,c=(0,C.hds)(e,a),l=i?(0,C.mBe)(e,i):void 0;if(!c||i&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:n,offsetUser:l,limit:r,isRequested:!0});if(!h)return;const{importers:p}=h;e=(0,w.mS)();const m=(0,C.nTw)(e,d).management.byChatId[a]?.inviteInfo;m?.invite&&m.invite.link===o&&(e=(0,S.H6X)(e,a,{inviteInfo:{...m,requesters:p}},d),(0,w.UF)(e))})),(0,w.aJ)("loadChatJoinRequests",(async(e,t,s)=>{const{chatId:a,offsetDate:o=0,offsetUserId:n,limit:i=0}=s,r=(0,C.hds)(e,a),d=n?(0,C.mBe)(e,n):void 0;if(!r||n&&!d)return;const c=await(0,b.px)("fetchChatInviteImporters",{peer:r,offsetDate:o,offsetUser:d,limit:i,isRequested:!0});if(!c)return;const{importers:l}=c;e=(0,w.mS)(),e=(0,S.wix)(e,a,{joinRequests:l}),(0,w.UF)(e)})),(0,w.aJ)("hideChatJoinRequest",(async(e,t,s)=>{const{chatId:a,userId:o,isApproved:n}=s,i=(0,C.hds)(e,a),r=(0,C.mBe)(e,o);if(!i||!r)return;if(!await(0,b.px)("hideChatJoinRequest",{peer:i,user:r,isApproved:n}))return;e=(0,w.mS)();const d=(0,C.hds)(e,a);d&&(e=(0,S.wix)(e,a,{joinRequests:d.joinRequests?.filter((e=>e.userId!==o))}),(0,w.UF)(e))})),(0,w.aJ)("hideAllChatJoinRequests",(async(e,t,s)=>{const{chatId:a,isApproved:o,link:n}=s,i=(0,C.hds)(e,a);i&&await(0,b.px)("hideAllChatJoinRequests",{peer:i,isApproved:o,link:n})&&(e=(0,w.mS)(),(0,C.hds)(e,a)&&(e=(0,S.wix)(e,a,{joinRequests:[]}),e=(0,S.ltr)(e,a,{recentRequesterIds:[],requestsPending:0}),(0,w.UF)(e)))})),(0,w.aJ)("hidePeerSettingsBar",(async(e,t,s)=>{const{peerId:a}=s,o=(0,C.mBe)(e,a);o&&await(0,b.px)("hidePeerSettingsBar",o)&&(e=(0,w.mS)(),e=(0,S.weB)(e,a,{settings:void 0}),(0,w.UF)(e))})),(0,w.aJ)("uploadContactProfilePhoto",(async(e,t,s)=>{const{userId:a,file:o,isSuggest:n,tabId:r=(0,u.g0)()}=s,d=(0,C.mBe)(e,a);if(!d)return;if(e=(0,S.G42)(e,i.TD.InProgress,r),(0,w.UF)(e),!await(0,b.px)("uploadContactProfilePhoto",{user:d,file:o,isSuggest:n}))return e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.Error,r),void(0,w.UF)(e);e=(0,w.mS)(),(0,w.UF)(e);const{id:c,accessHash:l}=d;if(!await(0,b.px)("fetchFullUser",{id:c,accessHash:l}))return e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.Error,r),void(0,w.UF)(e);t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0}),e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.Complete,r),(0,w.UF)(e),o&&!n&&t.showNotification({message:f.yE("UserInfo.SetCustomPhoto.SuccessPhotoText",(0,v.u0)(d)),tabId:r})})),(0,w.aJ)("resetManagementError",((e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s||{};return(0,S.H6X)(e,a,{error:void 0},o)}));var Fe=s(37932),Pe=s(49763);let Te,Ue;function xe(e,t,s){const o=e.currentUserId,n=(0,v.cG)(t,s,o),i=n?String(s):t,r=(0,C.hds)(e,i);return(0,b.px)("fetchMessages",{chat:r,threadId:s,offsetId:n?void 0:r.lastReadInboxMessageId,addOffset:-(Math.round(a.yo2/2)+1),limit:a.yo2,isSavedDialog:n})}(0,w.aJ)("sync",((e,t)=>{a.Oig&&console.log(">>> START SYNC"),Te&&clearTimeout(Te),e=(0,w.mS)(),e={...e,isSyncing:!0},(0,w.UF)(e),Te=window.setTimeout((()=>{e=(0,w.mS)(),e={...e,isSyncing:!1},(0,w.UF)(e),Te=void 0}),15e3);const{loadAllChats:s,preloadTopChatMessages:o}=t;(0,Pe.Ts)(),s({listType:"active",whenFirstBatchDone:async()=>{await async function(e,t){let s=!1;e=(0,w.mS)();let o=!1;const i=Object.keys(e.messages.byChatId).reduce(((t,s)=>(t[s]=Object.keys(e.messages.byChatId[s].threadsById).reduce(((t,a)=>(t[Number(a)]=(0,h.Oy)({draft:(0,C.GA4)(e,s,Number(a)),editingId:(0,C.Ys6)(e,s,Number(a)),editingDraft:(0,C.U0A)(e,s,Number(a))}),t)),{}),t)),{}),r=Object.entries(e.chats.lastMessageIds.all||{}).map((([t,s])=>(0,C.O5q)(e,t,Number(s)))).filter(Boolean),d=Object.values(e.chats.lastMessageIds.saved||{}).map((t=>(0,C.O5q)(e,e.currentUserId,Number(t)))).filter(Boolean);for(const{id:i}of Object.values(e.byTabId)){e=(0,w.mS)();const{chatId:r,threadId:d}=(0,C.Xf0)(e,i)||{},c=d||n.l3,l=r&&d?(0,C.Vw0)(e,r,d):void 0,u=r?e.chats.byId[r]:void 0;if(r&&u){const[t,d]=await Promise.all([xe(e,r,c),c===n.l3||(0,v.cG)(u.id,c,e.currentUserId)?void 0:(0,b.px)("fetchDiscussionMessage",{chat:u,messageId:Number(c)})]);e=(0,w.mS)();const{chatId:p}=(0,C.Xf0)(e,i)||{};if(t&&p===r){const i=(0,C.zeq)(e,r),u=r===a.zv8?e.serviceNotifications.filter((({isDeleted:e})=>!e)).map((({message:e})=>e)):[],p=(0,C.pSx)(e,r),m=p?Object.values(p).map((({lastMessageId:e})=>i[e])).filter(Boolean):[],g=t.messages.map((({id:e})=>e)),f=(0,h.Up)(e.messages.byChatId[r].threadsById,g),I=((!t.messages.length||t.messages.some((({id:e})=>e===d?.firstMessageId)))&&d?.topMessages||[]).concat(t.messages,u),b=I.concat(m),v=(0,h.dU)(b,"id"),y=(0,h.Am)(I.map((({id:e})=>e)));o||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach((({id:t})=>{e=(0,A.w)(e,{tabThreads:{}},t)})),o=!0),e=(0,S.o4A)(e,r,v),e=(0,S.d4w)(e,r,c,y),Object.entries(f).forEach((([t,s])=>{s?.threadInfo&&(e=(0,S.eAk)(e,r,t,s.threadInfo))})),l&&!l.isCommentsInfo&&c!==n.l3&&(e=(0,S.eAk)(e,r,c,{...(0,h.Up)(l,["fromChannelId","fromMessageId"])})),Object.values(e.byTabId).forEach((({id:t})=>{const{chatId:s,threadId:a}=(0,C.Xf0)(e,t)||{};s===r&&a===c&&(e=(0,S.s3Z)(e,r,c,y,t))})),e=(0,S.h7P)(e,(0,h.dU)(t.chats,"id")),e=(0,S.CKT)(e,(0,h.dU)(t.users,"id")),s=!0}}(0,w.UF)(e),u?.isForum&&(t.loadTopics({chatId:r,force:!0}),d&&d!==n.l3&&t.loadTopicById({chatId:r,topicId:Number(d),shouldCloseChatOnError:!0}))}e=(0,w.mS)(),s||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach((({id:t})=>{e=(0,A.w)(e,{tabThreads:{}},t)}))),Object.keys(i).forEach((t=>{const s=i[t];Object.keys(s).forEach((s=>{e=(0,S.e49)(e,t,Number(s),i[t][Number(s)])}))})),e=(0,S.KcS)(e,r),e=(0,S.KcS)(e,d),(0,w.UF)(e),Object.values(e.byTabId).forEach((({id:s})=>{const{chatId:a,messageId:o}=(0,C.nTw)(e,s).audioPlayer;a&&o&&!(0,C.O5q)(e,a,o)&&t.closeAudioPlayer({tabId:s})}))}(e,t),e=(0,w.mS)(),e={...e,isSyncing:!1,isSynced:!0,isFetchingDifference:!1},(0,w.UF)(e),a.Oig&&console.log(">>> FINISH SYNC"),s({listType:"archived"}),o()}})})),(0,Fe.DW)((e=>{const{connectionState:t,authState:s,isSynced:a}=e,{isMasterTab:o}=(0,C.nTw)(e);!o||a||Ue?.connectionState===t&&Ue?.authState===s||"connectionStateReady"===t&&"authorizationStateReady"===s&&(0,w.ko)().sync(),Ue=e})),(0,w.aJ)("reportPeer",(async(e,t,s)=>{const{chatId:a,reason:o,description:n,tabId:i=(0,u.g0)()}=s;if(!a)return;const r=(0,C.hds)(e,a);if(!r)return;const d=await(0,b.px)("reportPeer",{peer:r,reason:o,description:n});t.showNotification({message:d?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:i})})),(0,w.aJ)("reportProfilePhoto",(async(e,t,s)=>{const{chatId:a,reason:o,description:n,photo:i,tabId:r=(0,u.g0)()}=s;if(!a)return;const d=(0,C.hds)(e,a);if(!d||!i)return;const c=await(0,b.px)("reportProfilePhoto",{peer:d,photo:i,reason:o,description:n});t.showNotification({message:c?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:r})})),(0,w.aJ)("loadAuthorizations",(async e=>{const t=await(0,b.px)("fetchAuthorizations");t&&(e=(0,w.mS)(),e={...e,activeSessions:{byHash:t.authorizations,orderedHashes:Object.keys(t.authorizations),ttlDays:t.ttlDays}},(0,w.UF)(e))})),(0,w.aJ)("terminateAuthorization",(async(e,t,s)=>{const{hash:a}=s;if(!await(0,b.px)("terminateAuthorization",a))return;e=(0,w.mS)();const{[a]:o,...n}=e.activeSessions.byHash;e={...e,activeSessions:{byHash:n,orderedHashes:e.activeSessions.orderedHashes.filter((e=>e!==a))}},(0,w.UF)(e)})),(0,w.aJ)("terminateAllAuthorizations",(async e=>{if(!await(0,b.px)("terminateAllAuthorizations"))return;const t=(e=(0,w.mS)()).activeSessions.orderedHashes.find((t=>e.activeSessions.byHash[t].isCurrent));if(!t)return;const s=e.activeSessions.byHash[t];e={...e,activeSessions:{byHash:{[t]:s},orderedHashes:[t]}},(0,w.UF)(e)})),(0,w.aJ)("changeSessionSettings",(async(e,t,s)=>{const{hash:a,areCallsEnabled:o,areSecretChatsEnabled:n,isConfirmed:i}=s;await(0,b.px)("changeSessionSettings",{hash:a,areCallsEnabled:o,areSecretChatsEnabled:n,isConfirmed:i})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,byHash:{...e.activeSessions.byHash,[a]:{...e.activeSessions.byHash[a],...void 0!==o?{areCallsEnabled:o}:void 0,...void 0!==n?{areSecretChatsEnabled:n}:void 0,...i&&{isUnconfirmed:void 0}}}}},(0,w.UF)(e))})),(0,w.aJ)("changeSessionTtl",(async(e,t,s)=>{const{days:a}=s;await(0,b.px)("changeSessionTtl",{days:a})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,ttlDays:a}},(0,w.UF)(e))})),(0,w.aJ)("loadWebAuthorizations",(async e=>{const t=await(0,b.px)("fetchWebAuthorizations");if(!t)return;const{webAuthorizations:s}=t;e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:s,orderedHashes:Object.keys(s)}},(0,w.UF)(e)})),(0,w.aJ)("terminateWebAuthorization",(async(e,t,s)=>{const{hash:a}=s;if(!await(0,b.px)("terminateWebAuthorization",a))return;e=(0,w.mS)();const{[a]:o,...n}=e.activeWebSessions.byHash;e={...e,activeWebSessions:{byHash:n,orderedHashes:e.activeWebSessions.orderedHashes.filter((e=>e!==a))}},(0,w.UF)(e)})),(0,w.aJ)("terminateAllWebAuthorizations",(async e=>{await(0,b.px)("terminateAllWebAuthorizations")&&(e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:{},orderedHashes:[]}},(0,w.UF)(e))})),(0,w.aJ)("loadAccountDaysTtl",(async(e,t,s)=>{const a=await(0,b.px)("fetchAccountTTL");a&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:a.days}},(0,w.UF)(e))})),(0,w.aJ)("setAccountTTL",(async(e,t,s)=>{const{days:a,tabId:o=(0,u.g0)()}=s||{};a&&await(0,b.px)("setAccountTTL",{days:a})&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:a}},(0,w.UF)(e),t.closeDeleteAccountModal({tabId:o}))}));const Be=(0,I.nF)((e=>e()),500,!1);(0,w.aJ)("loadFullUser",(async(e,t,s)=>{const{userId:a,withPhotos:o}=s,n=(0,C.mBe)(e,a);if(!n)return;const{id:i,accessHash:r}=n,d=await(0,b.px)("fetchFullUser",{id:i,accessHash:r});if(!d?.user)return;e=(0,w.mS)();const c=(0,C.vGo)(e,a),{user:l,fullInfo:u}=d,p=(0,C.IVq)(e,a),m=n.avatarPhotoId!==l.avatarPhotoId||c?.profilePhoto?.id!==u?.profilePhoto?.id||c?.fallbackPhoto?.id!==u?.fallbackPhoto?.id||c?.personalPhoto?.id!==u?.personalPhoto?.id;e=(0,S.TKu)(e,a,d.user),e=(0,S.weB)(e,a,d.fullInfo),e=(0,S.CKT)(e,(0,h.dU)(d.users,"id")),e=(0,S.h7P)(e,(0,h.dU)(d.chats,"id")),(0,w.UF)(e),(o||p?.count&&m)&&t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0})})),(0,w.aJ)("loadUser",(async(e,t,s)=>{const{userId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const n=await(0,b.px)("fetchUsers",{users:[o]});if(!n)return;const{users:i,userStatusesById:r}=n;e=(0,w.mS)(),e=(0,S.CKT)(e,(0,h.dU)(i,"id")),e=(0,S.wWy)(e,{...e.users.statusesById,...r}),(0,w.UF)(e)})),(0,w.aJ)("loadTopUsers",(async e=>{const{topPeers:{lastRequestedAt:t}}=e;if(t&&!((0,P.Fm)()-t>60))return;const s=await(0,b.px)("fetchTopUsers");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topPeers:{...e.topPeers,userIds:a,lastRequestedAt:(0,P.Fm)()}},(0,w.UF)(e)})),(0,w.aJ)("loadContactList",(async e=>{const t=await(0,b.px)("fetchContactList");if(!t)return;e=(0,w.mS)(),e=(0,S.d2X)(e,t.userStatusesById);const s=e=>e.lastName||e.firstName||"",a=new Intl.Collator("en-US"),o=t.users.sort(((e,t)=>a.compare(s(e),s(t)))).filter((e=>!e.isSelf));e={...e,contactList:{userIds:o.map((e=>e.id))}},(0,w.UF)(e)})),(0,w.aJ)("loadCurrentUser",(()=>{(0,b.px)("fetchCurrentUser")})),(0,w.aJ)("loadCommonChats",(async(e,t,s)=>{const{userId:a}=s;if((0,C.trm)(e))return;const o=(0,C.mBe)(e,a),n=(0,C.Ua4)(e,a);if(!o||(0,v.tv)(o)||n?.isFullyLoaded)return;const i=await(0,b.px)("fetchCommonChats",o,n?.maxId);if(!i)return;const{chatIds:r,count:d}=i,c=(0,h.Am)((n?.ids||[]).concat(r));e=(0,w.mS)(),e=(0,S.lWl)(e,o.id,{maxId:r.length?r[r.length-1]:void 0,ids:c,isFullyLoaded:c.length>=d}),(0,w.UF)(e)})),(0,w.aJ)("addNoPaidMessagesException",(async(e,t,s)=>{const{userId:a,shouldRefundCharged:o}=s,n=(0,C.mBe)(e,a);n&&await(0,b.px)("addNoPaidMessagesException",{user:n,shouldRefundCharged:o})&&(e=(0,w.mS)(),e=(0,S.weB)(e,a,{settings:void 0}),(0,w.UF)(e))})),(0,w.aJ)("openChatRefundModal",(async(e,t,s)=>{const{userId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.mBe)(e,a);if(!n)return;const i=await(0,b.px)("fetchPaidMessagesRevenue",{user:n});void 0!==i&&(e=(0,w.mS)(),e=(0,A.w)(e,{chatRefundModal:{userId:a,starsToRefund:i}},o),(0,w.UF)(e))})),(0,w.aJ)("updateContact",(async(e,t,s)=>{const{userId:a,isMuted:o=!1,firstName:n,lastName:r,shouldSharePhoneNumber:d,tabId:c=(0,u.g0)()}=s,l=(0,C.mBe)(e,a);if(!l)return;let h;if(t.updateChatMutedState({chatId:a,isMuted:o}),e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.InProgress,c),(0,w.UF)(e),!l.isContact&&l.phoneNumber)h=await(0,b.px)("importContact",{phone:l.phoneNumber,firstName:n,lastName:r});else{const{id:e,accessHash:t}=l;h=await(0,b.px)("updateContact",{id:e,accessHash:t,phoneNumber:"",firstName:n,lastName:r,shouldSharePhoneNumber:d})}h&&(t.loadPeerSettings({peerId:a}),t.loadPeerStories({peerId:a}),e=(0,w.mS)(),e=(0,S.TKu)(e,l.id,{firstName:n,lastName:r}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.Complete,c),e=(0,S.BOn)(e,c),(0,w.UF)(e)})),(0,w.aJ)("deleteContact",(async(e,t,s)=>{const{userId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const{id:n,accessHash:i}=o;await(0,b.px)("deleteContact",{id:n,accessHash:i})})),(0,w.aJ)("loadMoreProfilePhotos",(async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,shouldInvalidateCache:o,isPreload:n}=s,i=(0,k.L8)(a),r=i?(0,C.mBe)(e,a):void 0,d=i?void 0:(0,C.hds)(e,a),c=r||d,l=(0,C.IVq)(e,a);if(!c?.avatarPhotoId)return;if(l&&!o&&(n||!l.nextOffset))return;e=(0,S.Tqk)(e,a,!0),(0,w.UF)(e),e=(0,w.mS)();let u=(0,C.vGo)(e,a),h=(0,C.AWZ)(e,a);if(r&&!u){const{id:e,accessHash:t}=r,s=await(0,b.px)("fetchFullUser",{id:e,accessHash:t});if(!s?.user)return;u=s.fullInfo}if(d&&!h){const e=await(0,b.px)("fetchFullChat",d);if(!e?.fullInfo)return;h=e.fullInfo}const p=u||h;if(!p)return;const m=l?.nextOffset,g=!m||n||o?10:void 0,f=await(0,b.px)("fetchProfilePhotos",{peer:c,offset:m,limit:g});if(!f||!f.photos)return;e=(0,w.mS)();const{photos:I,count:v,nextOffsetId:y}=f;e=(0,S.LZP)(e,a,{newPhotos:I,count:v,nextOffset:y,fullInfo:p,shouldInvalidateCache:o}),(0,w.UF)(e)})),(0,w.aJ)("setUserSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;a&&Be((async()=>{const t=await(0,b.px)("searchChats",{query:a});e=(0,w.mS)();const s=(0,C.nTw)(e,o).userSearch.query;if(!t||!s||a!==s)return e=(0,S.Z0S)(e,!1,o),void(0,w.UF)(e);const{accountResultIds:n,globalResultIds:i}=t,r=n.filter(k.L8),d=i.filter(k.L8);e=(0,S.Z0S)(e,!1,o),e=(0,S.BFh)(e,{localUserIds:r,globalUserIds:d},o),(0,w.UF)(e)}))})),(0,w.aJ)("importContact",(async(e,t,s)=>{const{phoneNumber:a,firstName:o,lastName:n,tabId:i=(0,u.g0)()}=s,r=await(0,b.px)("importContact",{phone:a,firstName:o,lastName:n});r?(t.openChat({id:r,tabId:i}),e=(0,w.mS)(),e=(0,S.BOn)(e,i),(0,w.UF)(e)):t.showNotification({message:f.yE("Contacts.PhoneNumber.NotRegistred"),tabId:i})})),(0,w.aJ)("reportSpam",((e,t,s)=>{const{chatId:a}=s,o=(0,C.PVB)(e,a);o&&(0,b.px)("reportSpam",o)})),(0,w.aJ)("setEmojiStatus",(async(e,t,s)=>{const{emojiStatus:a,referrerWebAppKey:o,tabId:n=(0,u.g0)()}=s;if(!(0,C.g29)(e))return o&&t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}},tabId:n}),void t.openPremiumModal({initialSection:"emoji_status",tabId:n});const i=await(0,b.px)("updateEmojiStatus",a);if(o){if(!i)return void t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"SERVER_ERROR"}},tabId:n});t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_set"},tabId:n}),t.showNotification({message:{key:"BotSuggestedStatusUpdated"},customEmojiIconId:a.documentId,tabId:n})}})),(0,w.aJ)("saveCloseFriends",(async(e,t,s)=>{const{userIds:a}=s;await(0,b.px)("saveCloseFriends",a)&&(e=(0,w.mS)(),e.contactList?.userIds.forEach((t=>{const{isCloseFriend:s}=e.users.byId[t]||{};s&&!a.includes(t)&&(e=(0,S.TKu)(e,t,{isCloseFriend:void 0}))})),a.forEach((t=>{e=(0,S.TKu)(e,t,{isCloseFriend:!0})})),(0,w.UF)(e))})),(0,w.aJ)("openSuggestedStatusModal",(async(e,t,s)=>{const{customEmojiId:a,duration:o,botId:n,webAppKey:i,tabId:r=(0,u.g0)()}=s,d=await(0,b.px)("fetchCustomEmoji",{documentId:[a]});d?.[0]?(e=(0,w.mS)(),e=(0,A.w)(e,{suggestedStatusModal:{customEmojiId:a,duration:o,webAppKey:i,botId:n}},r),(0,w.UF)(e)):i&&t.sendWebAppEvent({webAppKey:i,event:{eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}},tabId:r})})),(0,w.aJ)("loadPeerSettings",(async(e,t,s)=>{const{peerId:a}=s;if((0,C.trm)(e))return;if(!(0,C.vGo)(e,a))return void t.loadFullUser({userId:a});const o=(0,C.mBe)(e,a);if(!o)return;const n=await(0,b.px)("fetchPeerSettings",o);if(!n)return;const{settings:i}=n;e=(0,w.mS)(),e=(0,S.weB)(e,a,{settings:i}),(0,w.UF)(e)})),(0,w.aJ)("markBotVerificationInfoShown",((e,t,s)=>{const{peerId:o}=s,n=e.settings.botVerificationShownPeerIds,i=(0,h.Am)([o,...n]).slice(0,a.qLe);e={...e,settings:{...e.settings,botVerificationShownPeerIds:i}},(0,w.UF)(e)}));const Ne=d.pz||d.Ni;class Re{constructor(e,t){this.features=e,this.onFail=t}preOpenIfNeeded(){Ne&&(this.preOpened=window.open("about:blank",void 0,this.features),this.preOpened?this.preOpened.blur():this.onFail?.())}open(e){if(this.preOpened)return this.preOpened.location.href=e,this.preOpened.focus(),void(this.preOpened=void 0);if(!Ne){const t=window.open(e,void 0,this.features);t?t.focus():this.onFail?.()}}cancelPreOpen(){this.preOpened?.close(),this.preOpened=void 0}}var Je=s(33204),Ee=s(59852),Ye=s(20179);function De(e,t,s,...[a=(0,u.g0)()]){const o=(0,C.nTw)(e,a);return(0,A.w)(e,{inlineBots:{...o.inlineBots,byUsername:{...o.inlineBots.byUsername,[t]:s}}},a)}function Le(e,t,...[s=(0,u.g0)()]){return(0,A.w)(e,{inlineBots:{...(0,C.nTw)(e,s).inlineBots,isLoading:t}},s)}function Oe(e,t,s,...[a=(0,u.g0)()]){const o=(0,C.nTw)(e,a),n=o.webApps.openedWebApps,i=n[t];if(!i)return e;const r={...i,...s},d=(0,Ye.rp)(r);return d?e=(0,A.w)(e,{webApps:{...o.webApps,openedWebApps:{...n,[d]:r}}},a):e}function Ge(e,t,s=!0,a=!0,...[o=(0,u.g0)()]){const n=(0,C.nTw)(e,o),i=(0,Ye.rp)(t);if(!i)return e;const r=[...n.webApps.openedOrderedKeys];r.includes(i)||r.push(i);const d=[...n.webApps.sessionKeys];d.includes(i)||d.push(i);const c=n.webApps.openedWebApps;return(0,A.w)(e,{webApps:{...n.webApps,...s&&{activeWebAppKey:i},isMoreAppsTabActive:!1,isModalOpen:a,modalState:"maximized",openedWebApps:{...c,[i]:t},openedOrderedKeys:r,sessionKeys:d}},o)}function Ve(e,t,s,...[a=(0,u.g0)()]){const o=(0,C.nTw)(e,a),{openedWebApps:n,openedOrderedKeys:i,activeWebAppKey:r}=o.webApps,d=n[t];if(!d)return e;if(!s&&d.shouldConfirmClosing)return Oe(e,t,{isCloseModalOpen:!0},a);const c={...n},l=(0,Ye.rp)(d);let h=i;l&&(delete c[l],h=i.filter((e=>e!==l)));const p=r===(0,Ye.rp)(d),m=Object.keys(c),g=m.length;return(0,A.w)(e,{webApps:{...o.webApps,...p&&{activeWebAppKey:g?m[g-1]:void 0},openedWebApps:c,openedOrderedKeys:h,...!g&&{sessionKeys:[]}}},a)}function je(e,...[t=(0,u.g0)()]){return Object.keys((0,C.nTw)(e,t).webApps.openedWebApps).length>0}function qe(e,t,...[s=(0,u.g0)()]){const a=(0,C.nTw)(e,s);return(0,A.w)(e,{webApps:{...a.webApps,isModalOpen:t}},s)}var We=s(30708);const ze=(0,I.sg)((e=>e()),500,!1);let Ke,_e;function He(e,t,s,a,o){const n={botId:t,requestUrl:a,webAppName:o};if(function(e,t,s){const a=(0,C.nTw)(e,s).webApps.openedWebApps,o=(0,Ye.rp)(t);return!!o&&a[o]}(e,n,s)){const t=(0,Ye.rp)(n);return t&&(e=function(e,t,...[s=(0,u.g0)()]){const a=(0,C.nTw)(e,s);return a.webApps.openedWebApps[t]?e=(0,A.w)(e,{webApps:{...a.webApps,isMoreAppsTabActive:!1,activeWebAppKey:t,modalState:"maximized"}},s):e}(e,t,s),(0,w.UF)(e)),!0}return!1}function Xe(e,t,s,a,...[o=(0,u.g0)()]){if("request"===a.type){e=(0,w.mS)();const t=(0,C.nTw)(e,o);if(!t.urlAuth)return;const{domain:s,bot:n,shouldRequestWriteAccess:i}=a;return e=(0,A.w)(e,{urlAuth:{...t.urlAuth,request:{domain:s,botId:n.id,shouldRequestWriteAccess:i}}},o),void(0,w.UF)(e)}const n="accepted"===a.type?a.url:s;window.open(n,"_blank","noopener"),t.closeUrlAuthModal({tabId:o})}async function $e(e,t,s,a,o){await(0,b.px)("sendMessage",{chat:e,replyInfo:s,text:t,sendAs:a,lastMessageId:o})}async function Qe(e,t,s,a,o,n=!1,...[i=(0,u.g0)()]){const{showDialog:r,showNotification:d,openUrl:c,openGame:l}=t;n&&(_e||(_e=new Re("popup,width=800,height=600",(()=>{d({message:"Allow browser to open popup window",tabId:i})}))),_e.preOpenIfNeeded());const h=await(0,b.px)("answerCallbackButton",{chatId:s.id,accessHash:s.accessHash,messageId:a,data:o,isGame:n});if(!h)return;const{message:p,alert:m,url:g}=h;m?r({data:{message:p||"Error"},tabId:i}):p?d({message:p,tabId:i}):g&&(n?g.includes("https://prizes.gamee.com/")?_e.open(g):(_e.cancelPreOpen(),l({url:g,chatId:s.id,messageId:a,tabId:i})):c({url:g,tabId:i}))}(0,w.aJ)("clickBotInlineButton",((e,t,s)=>{const{chatId:a,messageId:o,button:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a),d=(0,C.O5q)(e,a,o);if(r&&d)switch(n.type){case"command":t.sendBotCommand({command:n.text,tabId:i});break;case"url":{const{url:e}=n;t.openUrl({url:e,tabId:i});break}case"copy":(0,c.eM)(n.copyText),t.showNotification({message:(0,f.yE)("ExactTextCopied",n.copyText),tabId:i});break;case"callback":Qe(0,t,r,o,n.data,void 0,i);break;case"requestPoll":t.openPollModal({isQuiz:n.isQuiz,tabId:i});break;case"requestPhone":{const s=e.currentUserId?(0,C.mBe)(e,e.currentUserId):void 0;if(!s)return;t.showDialog({data:{phoneNumber:s.phoneNumber,firstName:s.firstName||"",lastName:s.lastName||"",userId:s.id},tabId:i});break}case"receipt":{const{receiptMessageId:e}=n;t.getReceipt({chatId:r.id,messageId:e,tabId:i});break}case"buy":t.openInvoice({type:"message",chatId:r.id,messageId:o,tabId:i});break;case"game":Qe(0,t,r,o,void 0,!0,i);break;case"switchBotInline":{const{query:e,isSamePeer:s}=n;t.switchBotInline({query:e,isSamePeer:s,messageId:o,tabId:i});break}case"userProfile":{const{userId:e}=n;t.openChatWithInfo({id:e,tabId:i});break}case"simpleWebView":{const{url:s}=n,a=(0,C.Y7C)(e,d);if(!a)return;const o=(0,Ee.A)();t.requestSimpleWebView({url:s,botId:a.id,theme:o,buttonText:n.text,tabId:i});break}case"webView":{const{url:s}=n,a=(0,C.Y7C)(e,d),o=d.viaBotId||a?.id;if(!o)return;const c=(0,Ee.A)();t.requestWebView({url:s,botId:o,peerId:r.id,theme:c,buttonText:n.text,tabId:i});break}case"urlAuth":{const{url:e}=n;t.requestBotUrlAuth({chatId:r.id,messageId:o,buttonId:n.buttonId,url:e,tabId:i});break}}})),(0,w.aJ)("sendBotCommand",((e,t,s)=>{const{command:a,chatId:o,tabId:n=(0,u.g0)()}=s,i=o?(0,C.hds)(e,o):(0,C.meB)(e,n),r=(0,C.Xf0)(e,n);if(!i||!r)return;const{threadId:d}=r;t.resetDraftReplyInfo({tabId:n}),t.clearWebPagePreview({tabId:n});const c=(0,C.ZZX)(e,i.id);$e(i,a,(0,C.GA4)(e,i.id,d)?.replyInfo,(0,C.VF$)(e,i.id),c)})),(0,w.aJ)("restartBot",(async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,{currentUserId:n}=e,i=(0,C.meB)(e,o),r=n&&(0,C.yps)(e,a);if(!n||!i||!r)return;const d=(0,C.ZZX)(e,i.id);await(0,b.px)("unblockUser",{user:r})&&(e=(0,w.mS)(),e=(0,S.OW3)(e,r.id),(0,w.UF)(e),$e(i,"/start",void 0,(0,C.VF$)(e,a),d))})),(0,w.aJ)("loadTopInlineBots",(async e=>{const{lastRequestedAt:t}=e.topInlineBots;if(t&&(0,P.Fm)()-t<60)return;const s=await(0,b.px)("fetchTopInlineBots");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topInlineBots:{...e.topInlineBots,userIds:a,lastRequestedAt:(0,P.Fm)()}},(0,w.UF)(e)})),(0,w.aJ)("loadTopBotApps",(async e=>{const{lastRequestedAt:t}=e.topBotApps;if(t&&(0,P.Fm)()-t<60)return;const s=await(0,b.px)("fetchTopBotApps");if(!s)return;const{ids:a}=s;e=(0,w.mS)(),e={...e,topBotApps:{...e.topBotApps,userIds:a,lastRequestedAt:(0,P.Fm)()}},(0,w.UF)(e)})),(0,w.aJ)("queryInlineBot",(async(e,t,s)=>{const{chatId:a,username:o,query:n,offset:i,tabId:r=(0,u.g0)()}=s;let d=(0,C.nTw)(e,r).inlineBots.byUsername[o];if(!1!==d){if(void 0===d){const{user:t,chat:s}=await(0,b.px)("fetchInlineBot",{username:o})||{};if(e=(0,w.mS)(),!t||!s)return e=De(e,o,!1,r),void(0,w.UF)(e);d={id:t.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=De(e,o,d,r),(0,w.UF)(e)}(n!==d.query||d.canLoadMore)&&ze((()=>{!async function(e,{username:t,inlineBotData:s,chatId:a,query:o,offset:n},...[i=(0,u.g0)()]){e=(0,w.mS)();const r=(0,C.mBe)(e,s.id),d=(0,C.hds)(e,a);if(!r||!d)return;const c=s.query!==o;e=De(e=Le(e,!0,i),t,{...s,query:o,...c&&{offset:void 0,results:[]}},i),(0,w.UF)(e);const l=await(0,b.px)("fetchInlineBotResults",{bot:r,chat:d,query:o,offset:c?void 0:n});e=(0,w.mS)();const h=(0,C.nTw)(e,i).inlineBots.byUsername[t];if(e=Le(e,!1,i),!l||!h||o!==h.query)return void(0,w.UF)(e);const p=new Set((h.results||[]).map((e=>e.id))),m=l.results.filter((e=>!p.has(e.id)));e=De(e,t,{...h,help:l.help,cacheTime:Date.now()+1e3*l.cacheTime,...m.length&&{isGallery:l.isGallery},...l.switchPm&&{switchPm:l.switchPm},...l.switchWebview&&{switchWebview:l.switchWebview},canLoadMore:l.results.length>0&&Boolean(l.nextOffset),results:""===h.offset||h.offset===l.nextOffset?l.results:(h.results||[]).concat(m),offset:m.length?l.nextOffset:""},i),(0,w.UF)(e)}(e,{username:o,inlineBotData:d,chatId:a,query:n,offset:i},r)}))}})),(0,w.aJ)("switchBotInline",((e,t,s)=>{const{query:a,isSamePeer:o,messageId:n,filter:i,tabId:r=(0,u.g0)()}=s;let{botId:d}=s;const c=(0,C.meB)(e,r);if(!c)return;if(!d&&n){const t=(0,C.O5q)(e,c.id,n);if(!t)return;const s=(0,C.Y7C)(e,t);d=t.viaBotId||s?.id}if(!d)return;const l=(0,C.mBe)(e,d);l&&t.openChatWithDraft({text:{text:`@${(0,v.Kl)(l)} ${a}`},chatId:o?c.id:void 0,filter:i,tabId:r})})),(0,w.aJ)("sendInlineBotApiResult",(async(e,t,s)=>{const{chat:a,id:o,queryId:n,replyInfo:i,sendAs:r,isSilent:d,scheduledAt:c,allowPaidStars:l}=s;await(0,b.px)("sendInlineBotResult",{chat:a,resultId:o,queryId:n,replyInfo:i,sendAs:r,isSilent:d,scheduleDate:c,allowPaidStars:l}),l&&t.loadStarStatus()})),(0,w.aJ)("sendInlineBotResult",(async(e,t,s)=>{const{id:a,queryId:o,isSilent:n,scheduledAt:i,threadId:r,chatId:d,tabId:c=(0,u.g0)()}=s;if(!a)return;const l=(0,C.hds)(e,d),h=(0,C.GA4)(e,d,r)?.replyInfo,p=(0,C.OEv)(e,d,r,h);t.resetDraftReplyInfo({tabId:c}),t.clearWebPagePreview({tabId:c});const f=await ne(e,d),I={chat:l,id:a,queryId:o,replyInfo:p,sendAs:(0,C.VF$)(e,d),isSilent:n,scheduledAt:i,allowPaidStars:f};f?(t.sendInlineBotApiResult({...I}),t.showNotification({localId:o,title:{key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}},message:{key:"MessageSentPaidToastText",variables:{amount:(0,g.K)((0,m.Yw)(),f)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage",tabId:c})):t.sendInlineBotApiResult(I)})),(0,w.aJ)("resetInlineBot",((e,t,s)=>{const{username:a,force:o,tabId:n=(0,u.g0)()}=s;let i=(0,C.nTw)(e,n).inlineBots.byUsername[a];i&&(!o&&Date.now()<i.cacheTime||(i={id:i.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=De(e,a,i,n),(0,w.UF)(e)))})),(0,w.aJ)("resetAllInlineBots",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).inlineBots.byUsername;Object.keys(o).forEach((e=>{t.resetInlineBot({username:e,tabId:a})}))})),(0,w.aJ)("startBot",(async(e,t,s)=>{const{botId:a,param:o}=s,n=(0,C.mBe)(e,a);if(!n)return;let i=(0,C.vGo)(e,a);if(!i){const e=await(0,b.px)("fetchFullUser",{id:n.id,accessHash:n.accessHash});i=e?.fullInfo}i?.isBlocked&&await(0,b.px)("unblockUser",{user:n}),await(0,b.px)("startBot",{bot:n,startParam:o})})),(0,w.aJ)("sharePhoneWithBot",(async(e,t,s)=>{const{botId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;let n=(0,C.vGo)(e,a);if(!n){const e=await(0,b.px)("fetchFullUser",{id:o.id,accessHash:o.accessHash});n=e?.fullInfo}n?.isBlocked&&await(0,b.px)("unblockUser",{user:o}),e=(0,w.mS)();const i=(0,C.hds)(e,a),r=(0,C.mBe)(e,e.currentUserId);if(!i)return;const d=(0,C.ZZX)(e,i.id);await(0,b.px)("sendMessage",{chat:i,contact:{mediaType:"contact",firstName:r.firstName||"",lastName:r.lastName||"",phoneNumber:r.phoneNumber||"",userId:r.id},lastMessageId:d})})),(0,w.aJ)("requestSimpleWebView",(async(e,t,s)=>{const{url:a,botId:o,theme:n,buttonText:i,isFromSideMenu:r,isFromSwitchWebView:d,startParam:c,tabId:l=(0,u.g0)()}=s;if(He(e,o,l,a))return;const h=(0,C.mBe)(e,o);if(!h)return;if(!(0,C.nTL)(e,o))return e=(0,A.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestSimpleWebView",payload:s}}},l),void(0,w.UF)(e);const p=await(0,b.px)("requestSimpleWebView",{url:a,bot:h,theme:n,startParam:c,isFromSideMenu:r,isFromSwitchWebView:d});p&&(e=Ge(e=(0,w.mS)(),{requestUrl:a,appName:h.firstName,url:p,botId:o,buttonText:i},!0,!0,l),(0,w.UF)(e))})),(0,w.aJ)("requestWebView",(async(e,t,s)=>{const{url:a,botId:o,peerId:i,theme:r,isSilent:d,buttonText:c,isFromBotMenu:l,startParam:h,isFullscreen:p,tabId:m=(0,u.g0)()}=s;if(He(e,o,m,a))return;const g=(0,C.mBe)(e,o);if(!g)return;const f=(0,C.PVB)(e,i);if(!f)return;if(!(0,C.nTL)(e,o))return e=(0,A.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestWebView",payload:s}}},m),void(0,w.UF)(e);const I=(0,C.Xf0)(e,m),{chatId:v,threadId:y=n.l3}=I||{},S=v?(0,C.GA4)(e,v,y)?.replyInfo:void 0,M=v?(0,C.OEv)(e,v,y,S):void 0,k=v?(0,C.VF$)(e,v):void 0,F=await(0,b.px)("requestWebView",{url:a,bot:g,peer:f,theme:r,isSilent:d,replyInfo:M,isFromBotMenu:l,startParam:h,sendAs:k,isFullscreen:p});if(!F)return;const{url:P,queryId:T,isFullScreen:U}=F;e=Ge(e=(0,w.mS)(),{requestUrl:a,url:P,appName:g.firstName,botId:o,peerId:i,queryId:T,replyInfo:M,buttonText:c},!0,!0,m),(0,w.UF)(e),U&&(0,L.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:m})})),(0,w.aJ)("requestMainWebView",(async(e,t,s)=>{const{botId:a,peerId:o,theme:n,startParam:i,mode:r,shouldMarkBotTrusted:d,tabId:c=(0,u.g0)()}=s;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:c});if(He(e,a,c))return;const l=(0,C.mBe)(e,a);if(!l)return;const h=(0,C.PVB)(e,o);if(!h)return;if(!(0,C.nTL)(e,a)){if(!d)return e=(0,A.w)(e,{botTrustRequest:{botId:a,type:"webApp",onConfirm:{action:"requestMainWebView",payload:s}}},c),void(0,w.UF)(e);t.markBotTrusted({botId:a,isWriteAllowed:!0,tabId:c})}const p=await(0,b.px)("requestMainWebView",{bot:l,peer:h,theme:n,startParam:i,mode:r});if(!p)return;const{url:m,queryId:g,isFullscreen:f}=p;e=Ge(e=(0,w.mS)(),{url:m,appName:l.firstName,botId:a,peerId:o,queryId:g,buttonText:""},!0,!0,c),(0,w.UF)(e),f&&(0,L.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:c})})),(0,w.aJ)("loadPreviewMedias",(async(e,t,s)=>{const{botId:a}=s,o=(0,C.mBe)(e,a);if(!o)return;const n=await(0,b.px)("fetchPreviewMedias",{bot:o});e=(0,w.mS)(),n&&(e={...e,users:{...e.users,previewMediaByBotId:{...e.users.previewMediaByBotId,[a]:n}}},(0,w.UF)(e))})),(0,w.aJ)("openWebAppsCloseConfirmationModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{isWebAppsCloseConfirmationModalOpen:!0},a)})),(0,w.aJ)("closeWebAppsCloseConfirmationModal",((e,t,s)=>{const{shouldSkipInFuture:a,tabId:o=(0,u.g0)()}=s||{};return e=(0,S.qoo)(e,{shouldSkipWebAppCloseConfirmation:Boolean(a)}),(0,A.w)(e,{isWebAppsCloseConfirmationModalOpen:void 0},o)})),(0,w.aJ)("requestAppWebView",(async(e,t,s)=>{const{botId:a,appName:o,startApp:n,mode:i,theme:r,isWriteAllowed:d,isFromConfirm:c,shouldSkipBotTrustRequest:l,tabId:h=(0,u.g0)()}=s;if(He(e,a,h,o))return;const p=(0,C.mBe)(e,a);if(!p)return;const m=Boolean(e.attachMenu.bots[p.id]);if(p.isAttachBot&&!c&&!m){const t=await(0,b.px)("loadAttachBot",{bot:p});if(t){e=(0,w.mS)();const a=t.bot;if(a.isDisclaimerNeeded||a.isForAttachMenu||a.isForSideMenu)return e=(0,A.w)(e,{requestedAttachBotInstall:{bot:a,onConfirm:{action:"requestAppWebView",payload:{...s,isFromConfirm:!0}}}},h),void(0,w.UF)(e)}}const g=await(0,b.px)("fetchBotApp",{bot:p,appName:o});if(e=(0,w.mS)(),!g)return void t.showNotification({message:(0,f.yE)("lng_username_app_not_found"),tabId:h});if(!l&&(g.isInactive||!(0,C.nTL)(e,a)))return s.shouldSkipBotTrustRequest=!0,e=(0,A.w)(e,{botTrustRequest:{botId:a,shouldRequestWriteAccess:g.shouldRequestWriteAccess,type:"botApp",onConfirm:{action:"requestAppWebView",payload:s}}},h),void(0,w.UF)(e);const I=(0,C.meB)(e,h),{url:v,isFullscreen:y}=await(0,b.px)("requestAppWebView",{peer:I||p,app:g,startParam:n,mode:i,isWriteAllowed:d,theme:r});if(e=(0,w.mS)(),!v)return;e=(0,w.mS)();const S=I?I.id:p.id;e=Ge(e,{url:v,appName:o&&p.firstName,peerId:S,botId:a,buttonText:""},!0,!0,h),(0,w.UF)(e),y&&(0,L.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:h})})),(0,w.aJ)("prolongWebView",(async(e,t,s)=>{const{botId:a,peerId:o,isSilent:n,replyInfo:i,queryId:r,tabId:d=(0,u.g0)()}=s,c=(0,C.mBe)(e,a);if(!c)return;const l=(0,C.hds)(e,o);if(!l)return;const h=(0,C.VF$)(e,o);await(0,b.px)("prolongWebView",{bot:c,peer:l,isSilent:n,replyInfo:i,queryId:r,sendAs:h})||t.closeActiveWebApp({tabId:d})})),(0,w.aJ)("sendWebViewData",((e,t,s)=>{const{bot:a,data:o,buttonText:n}=s;(0,b.px)("sendWebViewData",{bot:a,data:o,buttonText:n})})),(0,w.aJ)("loadAttachBots",(async e=>{await async function(e){const t=await(0,b.px)("loadAttachBots",{hash:void 0});if(t)return e=(0,w.mS)(),e={...e,attachMenu:{hash:t.hash,bots:t.bots}},(0,w.UF)(e),t}(e),(0,Je.A)({action:"loadAttachBots",payload:void 0},a.npx)})),(0,w.aJ)("toggleAttachBot",(async(e,t,s)=>{const{botId:a,isWriteAllowed:o,isEnabled:n}=s,i=(0,C.mBe)(e,a);i&&await(0,b.px)("toggleAttachBot",{bot:i,isWriteAllowed:o,isEnabled:n})})),(0,w.aJ)("callAttachBot",((e,t,s)=>{const{bot:a,startParam:o,isFromConfirm:i,tabId:r=(0,u.g0)()}=s,d="isFromSideMenu"in s&&s.isFromSideMenu,c=!a,l=!c&&!e.attachMenu.bots[a.id]||a?.isInactive||a?.isDisclaimerNeeded;if(!i&&l)return(0,A.w)(e,{requestedAttachBotInstall:{bot:a,onConfirm:{action:"callAttachBot",payload:{...s,isFromConfirm:!0}}}},r);const h=(0,Ee.A)();if(d&&t.requestSimpleWebView({botId:a.id,buttonText:"",isFromSideMenu:!0,startParam:o,theme:h,tabId:r}),"chatId"in s){const{chatId:e,threadId:i=n.l3,url:d}=s;t.openThread({chatId:e,threadId:i,tabId:r}),t.requestWebView({url:d,peerId:e,botId:c?e:a.id,theme:h,buttonText:"",isFromBotMenu:c,startParam:o,tabId:r})}})),(0,w.aJ)("confirmAttachBotInstall",(async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,{requestedAttachBotInstall:n}=(0,C.nTw)(e,o),{bot:i,onConfirm:r}=n;e=(0,A.w)(e,{requestedAttachBotInstall:void 0},o),(0,w.UF)(e);const d=(0,C.mBe)(e,i.id);if(d&&(t.markBotTrusted({botId:i.id,isWriteAllowed:a,tabId:o}),await(0,b.px)("toggleAttachBot",{bot:d,isWriteAllowed:a,isEnabled:!0}),r)){const{action:e,payload:s}=r;t[e](s)}})),(0,w.aJ)("requestBotUrlAuth",(async(e,t,s)=>{const{chatId:a,buttonId:o,messageId:n,url:i,tabId:r=(0,u.g0)()}=s,d=(0,C.hds)(e,a);if(!d)return;const c=await(0,b.px)("requestBotUrlAuth",{chat:d,buttonId:o,messageId:n});c&&(e=(0,w.mS)(),e=(0,A.w)(e,{urlAuth:{url:i,button:{buttonId:o,messageId:n,chatId:d.id}}},r),(0,w.UF)(e),Xe(e,t,i,c,r))})),(0,w.aJ)("acceptBotUrlAuth",(async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);if(!n.urlAuth?.button)return;const{button:i,url:r}=n.urlAuth,{chatId:d,messageId:c,buttonId:l}=i,h=(0,C.hds)(e,d);if(!h)return;const p=await(0,b.px)("acceptBotUrlAuth",{chat:h,messageId:c,buttonId:l,isWriteAllowed:a});p&&Xe(e=(0,w.mS)(),t,r,p,o)})),(0,w.aJ)("requestLinkUrlAuth",(async(e,t,s)=>{const{url:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("requestLinkUrlAuth",{url:a});n&&(e=(0,w.mS)(),e=(0,A.w)(e,{urlAuth:{url:a}},o),(0,w.UF)(e),Xe(e,t,a,n,o))})),(0,w.aJ)("acceptLinkUrlAuth",(async(e,t,s)=>{const{isWriteAllowed:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);if(!n.urlAuth?.url)return;const{url:i}=n.urlAuth,r=await(0,b.px)("acceptLinkUrlAuth",{url:i,isWriteAllowed:a});r&&Xe(e=(0,w.mS)(),t,i,r,o)})),(0,w.aJ)("closeUrlAuthModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{urlAuth:void 0},a)})),(0,w.aJ)("setBotInfo",(async(e,t,s)=>{const{bot:a,name:o,description:n,tabId:r=(0,u.g0)()}=s;let{langCode:d}=s;d||(d=(0,We.l)(e).language);const{currentUserId:c}=e;c&&a&&(e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.InProgress,r),(0,w.UF)(e),(o||n)&&await(0,b.px)("setBotInfo",{bot:a,langCode:d,name:o,about:n})&&(e=(0,w.mS)(),e=(0,S.TKu)(e,a.id,{firstName:o}),e=(0,S.weB)(e,a.id,{bio:n}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,S.G42)(e,i.TD.Complete,r),(0,w.UF)(e))})),(0,w.aJ)("toggleUserEmojiStatusPermission",(async(e,t,s)=>{const{botId:a,isEnabled:o,isBotAccessEmojiGranted:n}=s,i=(0,C.yps)(e,a);a&&i&&await(0,b.px)("toggleUserEmojiStatusPermission",{bot:i,isEnabled:o})&&(e=(0,w.mS)(),e=(0,S.weB)(e,a,{isBotCanManageEmojiStatus:o,isBotAccessEmojiGranted:n}),(0,w.UF)(e))})),(0,w.aJ)("toggleUserLocationPermission",((e,t,s)=>{const{botId:a,isAccessGranted:o}=s,n=(0,C.mBe)(e,a);n&&(e=(0,w.mS)(),e=(0,S.cxc)(e,n.id,{geolocation:o}),(0,w.UF)(e))})),(0,w.aJ)("startBotFatherConversation",(async(e,t,s)=>{const{param:n,tabId:i=(0,u.g0)()}=s;if(!Ke){const t=await(0,o.A$)(e,a.aFH);if(!t)return;Ke=t.id}n&&t.startBot({botId:Ke,param:n}),t.openChat({id:Ke,tabId:i})})),(0,w.aJ)("loadBotFreezeAppeal",(async e=>{const t=e.appConfig?.freezeAppealUrl;if(!t)return;const s=t?(0,l.l8)(t):void 0;if(!s)return;const a=await(0,o.A$)(e,s);e=(0,w.mS)(),e={...e,botFreezeAppealId:a?.id},(0,w.UF)(e)})),s(26943),(0,w.aJ)("loadPasswordInfo",(async e=>{const t=await(0,b.px)("getPasswordInfo");t&&(e=(0,w.mS)(),e=(0,S.qpc)(e,{hasPassword:t.hasPassword}),e=(0,S.keG)(e,{hint:t.hint}),(0,w.UF)(e))})),(0,w.aJ)("checkPassword",(async(e,t,s)=>{const{currentPassword:a,onSuccess:o}=s;e=(0,S.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const n=await(0,b.px)("checkPassword",a);e=(0,w.mS)(),e=(0,S.keG)(e,{isLoading:!1}),(0,w.UF)(e),n&&o()})),(0,w.aJ)("clearPassword",(async(e,t,s)=>{const{currentPassword:a,onSuccess:o}=s;e=(0,S.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const n=await(0,b.px)("clearPassword",a);e=(0,w.mS)(),e=(0,S.keG)(e,{isLoading:!1}),(0,w.UF)(e),n&&o()})),(0,w.aJ)("updatePassword",(async(e,t,s)=>{const{currentPassword:a,password:o,hint:n,email:i,onSuccess:r}=s;e=(0,S.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const d=await(0,b.px)("updatePassword",a,o,n,i);e=(0,w.mS)(),e=(0,S.keG)(e,{isLoading:!1}),(0,w.UF)(e),d&&r()})),(0,w.aJ)("updateRecoveryEmail",(async(e,t,s)=>{const{currentPassword:a,email:o,onSuccess:n,tabId:i=(0,u.g0)()}=s;e=(0,S.keG)(e,{isLoading:!0,errorKey:void 0}),e=(0,A.w)(e,{recoveryEmail:o},i),(0,w.UF)(e);const r=await(0,b.px)("updateRecoveryEmail",a,o);e=(0,w.mS)(),e=(0,S.keG)(e,{isLoading:!1,waitingEmailCodeLength:void 0}),e=(0,A.w)(e,{recoveryEmail:void 0},i),(0,w.UF)(e),r&&n()})),(0,w.aJ)("provideTwoFaEmailCode",((e,t,s)=>{const{code:a}=s;(0,b.px)("provideRecoveryEmailCode",a)})),(0,w.aJ)("clearTwoFaError",(e=>(0,S.keG)(e,{errorKey:void 0})));const Ze={missing_payment_information:{field:"cardNumber",message:"Incorrect card number"},invalid_number:{field:"cardNumber",message:"Incorrect card number"},number:{field:"cardNumber",message:"Incorrect card number"},exp_year:{field:"expiry",message:"Incorrect year"},exp_month:{field:"expiry",message:"Incorrect month"},invalid_expiry_year:{field:"expiry",message:"Incorrect year"},invalid_expiry_month:{field:"expiry",message:"Incorrect month"},cvc:{field:"cvv",message:"Incorrect CVV"},invalid_cvc:{field:"cvv",message:"Incorrect CVV"}};var et=s(86046);async function tt(e,t,s,...[a=(0,u.g0)()]){const o=(0,w.ko)(),n=e.stars?.balance;if(void 0===n)return;if(n.amount<s)return void o.openStarsBalanceModal({tabId:a});const i=(0,et.jA)(e,t);if(!i)return;e=(0,A.w)(e,{isPaymentFormLoading:!0},a),(0,w.UF)(e);const r=(0,Ee.A)(),d=await(0,b.px)("getPaymentForm",i,r);d&&(e=(0,w.mS)(),e=(0,A.w)(e,{isPaymentFormLoading:!1},a),(0,w.UF)(e),"error"in d?st(d.error,a):o.sendStarPaymentForm({directInfo:{inputInvoice:t,formId:d.formId},tabId:a}))}function st(e,t){"SLUG_INVALID"!==e?(0,w.ko)().showDialog({data:{message:e,hasErrorKey:!0},tabId:t}):(0,w.ko)().showNotification({message:{key:"PaymentInvoiceNotFound"},tabId:t})}(0,w.aJ)("validateRequestedInfo",((e,t,s)=>{const{requestInfo:a,saveInfo:o,tabId:n=(0,u.g0)()}=s,r=(0,C.aF2)(e,n);if(!r)return;const d=(0,et.jA)(e,r);d&&async function(e,t,s,a,...[o=(0,u.g0)()]){const n=await(0,b.px)("validateRequestedInfo",{inputInvoice:t,requestInfo:s,shouldSave:a});if(!n)return;const{id:r,shippingOptions:d}=n;e=(0,w.mS)(),e=(0,S.bbG)(e,r,o),d?.length?(e=(0,S.oFy)(e,d,o),e=(0,S.lwH)(e,i.tn.Shipping,o)):e=(0,S.lwH)(e,i.tn.Checkout,o),(0,w.UF)(e)}(e,d,a,o,n)})),(0,w.aJ)("openInvoice",(async(e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=(0,et.jA)(e,o);if(!n)return;e=(0,A.w)(e,{isPaymentFormLoading:!0},a),(0,w.UF)(e);const r=(0,Ee.A)(),d=await(0,b.px)("getPaymentForm",n,r);if(d){if(e=(0,w.mS)(),e=(0,A.w)(e,{isPaymentFormLoading:!1},a),"error"in d)return(0,w.UF)(e),void st(d.error,a);"regular"===d.type&&(e=(0,S._$X)(e,{inputInvoice:s,form:d,isPaymentModalOpen:!0,isExtendedMedia:s.isExtendedMedia,status:void 0},a),e=(0,S.lwH)(e,i.tn.Checkout,a)),"stars"===d.type&&(e=(0,A.w)(e,{starsPayment:{inputInvoice:o,form:d,status:"pending"}},a)),(0,w.UF)(e)}})),(0,w.aJ)("sendStarGift",((e,t,s)=>{const{gift:a,peerId:o,message:n,shouldHideName:i,shouldUpgrade:r,tabId:d=(0,u.g0)()}=s;tt(e,{type:"stargift",peerId:o,giftId:a.id,message:n,shouldHideName:i,shouldUpgrade:r||void 0},a.stars,d)})),(0,w.aJ)("buyStarGift",((e,t,s)=>{const{slug:a,peerId:o,stars:n,tabId:i=(0,u.g0)()}=s;tt(e,{type:"stargiftResale",slug:a,peerId:o},n,i)})),(0,w.aJ)("sendPremiumGiftByStars",((e,t,s)=>{const{userId:a,months:o,amount:n,message:i,tabId:r=(0,u.g0)()}=s;tt(e,{type:"premiumGiftStars",userId:a,months:o,message:i},n,r)})),(0,w.aJ)("getReceipt",(async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=a&&(0,C.hds)(e,a);if(!o||!i)return;const r=await(0,b.px)("getReceipt",i,o);r&&(e=(0,w.mS)(),e="stars"===r.receipt.type?(0,S.MeL)(e,r.receipt,n):(0,S.lEm)(e,r.receipt,n),(0,w.UF)(e))})),(0,w.aJ)("clearPaymentError",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,A.w)(e,{payment:{...(0,C.nTw)(e,a).payment,error:void 0}},a),(0,w.UF)(e)})),(0,w.aJ)("clearReceipt",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{payment:{...(0,C.nTw)(e,a).payment,receipt:void 0}},a)})),(0,w.aJ)("sendCredentialsInfo",((e,t,s)=>{const{credentials:o,tabId:n=(0,u.g0)()}=s,{nativeProvider:r}=(0,C.nTw)(e,n).payment.form,{data:d}=o;if("stripe"===r){const t=(0,C.EGt)(e,n);if(!t)return;!async function(e,t,s,...[a=(0,u.g0)()]){const o=function(e){const t=Object.keys(e).map((t=>`${t}=${e[t]}`)).join("&");return t.length>0?`?${t}`:""}({"card[number]":t.cardNumber,"card[exp_month]":t.expiryMonth,"card[exp_year]":t.expiryYear,"card[cvc]":t.cvv,"card[address_zip]":t.zip,"card[address_country]":t.country}),n=await fetch(`https://api.stripe.com/v1/tokens${o}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${s}`}}),r=await n.json();if(r.error){const t=function(e){const{message:t,code:s,param:a}=e,{field:o,message:n}=a?Ze[a]:Ze[s];return{field:o,message:n,description:t}}(r.error);return e=(0,w.mS)(),e=(0,A.w)(e,{payment:{...(0,C.nTw)(e,a).payment,status:"failed",error:{...t}}},a),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,S.yQW)(e,{type:r.type,id:r.id},a),e=(0,S.lwH)(e,i.tn.Checkout,a),(0,w.UF)(e)}(e,d,t,n)}else if("smartglocal"===r){const t=(0,C.Kt9)(e,n);if(!t)return;!async function(e,t,s,...[o=(0,u.g0)()]){const n={card:{number:t.cardNumber.replace(/\D+/g,""),expiration_month:t.expiryMonth,expiration_year:t.expiryYear,security_code:t.cvv.replace(/\D+/g,"")}},r=(0,C.nTw)(e,o).payment.form?.nativeParams.tokenizeUrl;let d;d=a.qKY?"https://tgb-playground.smart-glocal.com/cds/v1/tokenize/card":"https://tgb.smart-glocal.com/cds/v1/tokenize/card",r?.startsWith("https://")&&r.endsWith(".smart-glocal.com/cds/v1/tokenize/card")&&(d=r);const c=await fetch(d,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-PUBLIC-TOKEN":s},body:JSON.stringify(n)}),l=await c.json();if("ok"!==l.status){const t={descriptionKey:{key:"ErrorUnexpected"}};return e=(0,w.mS)(),e=(0,A.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:{...t}}},o),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,S.Mac)(e,{type:"card",token:l.data.token},o),e=(0,S.lwH)(e,i.tn.Checkout,o),(0,w.UF)(e)}(e,d,t,n)}})),(0,w.aJ)("sendPaymentForm",(async(e,t,s)=>{const{shippingOptionId:a,saveCredentials:o,savedCredentialId:n,tipAmount:i,tabId:r=(0,u.g0)()}=s,d=(0,C.PGw)(e,r),c=(0,C.nTw)(e,r).payment,{form:l,temporaryPassword:h,inputInvoice:p}=c;if(!p||!l)return;const{nativeProvider:m,formId:g}=l,f=(0,et.jA)(e,p);if(!f)return;e=(0,S._$X)(e,{status:"pending"},r),(0,w.UF)(e);const I={save:o,data:"stripe"===m?(0,C.e7$)(e,r):(0,C.G4m)(e,r)};await(0,b.px)("sendPaymentForm",{inputInvoice:f,formId:g,credentials:I,requestedInfoId:d,shippingOptionId:a,savedCredentialId:n,temporaryPassword:h?.value,tipAmount:i})&&(e=(0,w.mS)(),e=(0,S._$X)(e,{status:"paid"},r),e=(0,S.cYc)(e,r),(0,w.UF)(e),t.apiUpdate({"@type":"updatePaymentStateCompleted",paymentState:c,tabId:r}))})),(0,w.aJ)("sendStarPaymentForm",(async(e,t,s)=>{const{directInfo:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Osl)(e,o),i=n?.inputInvoice||a?.inputInvoice;if(!i)return;const r=(0,et.jA)(e,i);if(!r)return;const d=n.form?.formId||n.subscriptionInfo?.subscriptionFormId||a?.formId;e=(0,S.nv6)(e,{status:"pending"},o),(0,w.UF)(e);const c=await(0,b.px)("sendStarPaymentForm",{inputInvoice:r,formId:d});if(!c)return e=(0,w.mS)(),e=(0,S.nv6)(e,{status:"failed"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),void t.closeGiftModal({tabId:o});e=(0,w.mS)(),e=(0,S.nv6)(e,{status:"paid"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),"channelId"in c&&t.openChat({id:c.channelId,tabId:o}),t.apiUpdate({"@type":"updateStarPaymentStateCompleted",paymentState:a?{inputInvoice:i}:n,tabId:o}),t.loadStarStatus()})),(0,w.aJ)("setSmartGlocalCardInfo",((e,t,s)=>{const{tabId:a=(0,u.g0)(),type:o,token:n}=s;return(0,S.Mac)(e,{type:o,token:n},a)})),(0,w.aJ)("setPaymentStep",((e,t,s)=>{const{step:a,tabId:o=(0,u.g0)()}=s;return(0,S.lwH)(e,a??i.tn.Checkout,o)})),(0,w.aJ)("closePremiumModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(o.premiumModal)return(0,A.w)(e,{premiumModal:{promo:o.premiumModal.promo,isOpen:!1}},a)})),(0,w.aJ)("openPremiumModal",(async(e,t,s)=>{const{initialSection:a,fromUserId:o,isSuccess:n,isGift:i,monthsAmount:r,toUserId:d,tabId:c=(0,u.g0)()}=s||{};t.loadPremiumStickers();const l=await(0,b.px)("fetchPremiumPromo");l&&(e=(0,w.mS)(),e=(0,A.w)(e,{premiumModal:{promo:l.promo,initialSection:a,isOpen:!0,fromUserId:o,toUserId:d,isGift:i,monthsAmount:r,isSuccess:n}},c),(0,w.UF)(e),t.closeReactionPicker({tabId:c}))})),(0,w.aJ)("openGiveawayModal",(async(e,t,s)=>{const{chatId:a,prepaidGiveaway:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;const r=await(0,b.px)("getPremiumGiftCodeOptions",{chat:i}),d=await(0,b.px)("fetchStarsGiveawayOptions");r&&d&&(e=(0,w.mS)(),e=(0,A.w)(e,{giveawayModal:{chatId:a,gifts:r,isOpen:!0,prepaidGiveaway:o,starOptions:d}},n),(0,w.UF)(e))})),(0,w.aJ)("openGiftModal",(async(e,t,s)=>{const{forUserId:a,tabId:o=(0,u.g0)()}=s;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:o});const n=await(0,b.px)("getPremiumGiftCodeOptions",{});n&&(e=(0,w.mS)(),e=(0,A.w)(e,{giftModal:{forPeerId:a,gifts:n}},o),(0,w.UF)(e))})),(0,w.aJ)("openStarsGiftModal",(async(e,t,s)=>{const{forUserId:a,tabId:o=(0,u.g0)()}=s||{};if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:o});const n=await(0,b.px)("getStarsGiftOptions",{});e=(0,w.mS)(),e=(0,A.w)(e,{starsGiftModal:{isOpen:!0,forUserId:a,starsGiftOptions:n}},o),(0,w.UF)(e)})),(0,w.aJ)("validatePaymentPassword",(async(e,t,s)=>{const{password:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchTemporaryPaymentPassword",a);e=(0,w.mS)(),e=n?"error"in n?(0,S._$X)(e,{error:{messageKey:n.messageKey,field:"password"}},o):(0,S._$X)(e,{temporaryPassword:n,step:i.tn.Checkout},o):(0,S._$X)(e,{error:{messageKey:{key:"ErrorUnexpected"},field:"password"}},o),(0,w.UF)(e)})),(0,w.aJ)("openBoostModal",(async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n||!(0,v.WX)(n)&&!(0,v.Vs)(n))return;e=(0,A.w)(e,{boostModal:{chatId:a}},o),(0,w.UF)(e);const i=await(0,b.px)("fetchBoostStatus",{chat:n});if(!i)return void t.closeBoostModal({tabId:o});e=(0,w.mS)(),e=(0,A.w)(e,{boostModal:{chatId:a,boostStatus:i}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchMyBoosts");if(!r)return;e=(0,w.mS)();const d=(0,C.nTw)(e,o);d.boostModal&&(e=(0,A.w)(e,{boostModal:{...d.boostModal,myBoosts:r.boosts}},o),(0,w.UF)(e))})),(0,w.aJ)("openBoostStatistics",(async(e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.hds)(e,a);if(!n)return;e=(0,A.w)(e,{boostStatistics:{chatId:a}},o),(0,w.UF)(e);const[i,r,d]=await Promise.all([(0,b.px)("fetchBoostList",{chat:n}),(0,b.px)("fetchBoostList",{chat:n,isGifts:!0}),(0,b.px)("fetchBoostStatus",{chat:n})]);if(e=(0,w.mS)(),!i||!r||!d)return e=(0,A.w)(e,{boostStatistics:void 0},o),void(0,w.UF)(e);e=(0,A.w)(e,{boostStatistics:{chatId:a,boostStatus:d,nextOffset:i.nextOffset,boosts:{count:i.count,list:i.boostList},giftedBoosts:{count:r?.count,list:r?.boostList}}},o),(0,w.UF)(e)})),(0,w.aJ)("openMonetizationStatistics",((e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;(0,C.hds)(e,a)&&(e=(0,A.w)(e,{monetizationStatistics:{chatId:a}},o),(0,w.UF)(e))})),(0,w.aJ)("loadMoreBoosters",(async(e,t,s)=>{const{isGifts:a,tabId:o=(0,u.g0)()}=s||{};let n=(0,C.nTw)(e,o);if(!n.boostStatistics)return;const i=(0,C.hds)(e,n.boostStatistics.chatId);if(!i)return;e=(0,A.w)(e,{boostStatistics:{...n.boostStatistics,isLoadingBoosters:!0}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchBoostList",{chat:i,offset:n.boostStatistics.nextOffset,isGifts:a});if(!r)return;if(e=(0,w.mS)(),n=(0,C.nTw)(e,o),!n.boostStatistics)return;const d=(a?n.boostStatistics.giftedBoosts?.list||[]:n.boostStatistics.boosts?.list||[]).concat(r.boostList);e=(0,A.w)(e,{boostStatistics:{...n.boostStatistics,nextOffset:r.nextOffset,isLoadingBoosters:!1,[a?"giftedBoosts":"boosts"]:{count:r.count,list:d}}},o),(0,w.UF)(e)})),(0,w.aJ)("applyBoost",(async(e,t,s)=>{const{chatId:a,slots:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a);if(!i)return;const r=(0,C.AWZ)(e,a),d=r?.boostsApplied||0,c=o.length;let l=(0,C.nTw)(e,n);const h=l.boostModal?.boostStatus;if(h){const t=h.nextLevelBoosts?h.nextLevelBoosts-h.currentLevelBoosts:1,s=h.boosts+c,a=h.nextLevelBoosts&&s>=h.nextLevelBoosts,o=a?h.nextLevelBoosts:h.currentLevelBoosts,i=a?h.nextLevelBoosts+t:h.nextLevelBoosts;e=(0,A.w)(e,{boostModal:{...l.boostModal,boostStatus:{...h,level:a?h.level+1:h.level,currentLevelBoosts:o,nextLevelBoosts:i,hasMyBoost:!0,boosts:s}}},n),(0,w.UF)(e)}e=(0,w.mS)(),l=(0,C.nTw)(e,n);const p=l.boostModal?.myBoosts;if(p){const t=Math.floor(Date.now()/1e3),s=p.map((e=>o.includes(e.slot)?{...e,chatId:a,date:t,cooldownUntil:t+86400}:e));e=(0,A.w)(e,{boostModal:{...l.boostModal,myBoosts:s}},n),(0,w.UF)(e)}const m=await(0,b.px)("applyBoost",{slots:o,chat:i});if(e=(0,w.mS)(),m)l=(0,C.nTw)(e,n),r&&(e=(0,S.ltr)(e,a,{boostsApplied:d+o.length})),l.boostModal&&(e=(0,A.w)(e,{boostModal:{...l.boostModal,myBoosts:m.boosts}},n)),(0,w.UF)(e);else{const t=(0,C.nTw)(e,n).boostModal;t&&(e=(0,A.w)(e,{boostModal:{...t,boostStatus:h,myBoosts:p}},n),(0,w.UF)(e))}})),(0,w.aJ)("checkGiftCode",(async(e,t,s)=>{const{slug:a,message:o,tabId:n=(0,u.g0)()}=s,i=await(0,b.px)("checkGiftCode",{slug:a});i?(e=(0,w.mS)(),e=(0,A.w)(e,{giftCodeModal:{slug:a,info:i.code,message:o}},n),(0,w.UF)(e)):t.showNotification({message:f.yE("lng_gift_link_expired"),tabId:n})})),(0,w.aJ)("applyGiftCode",(async(e,t,s)=>{const{slug:a,tabId:o=(0,u.g0)()}=s;await(0,b.px)("applyGiftCode",{slug:a})&&(t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftCodeModal({tabId:o}))})),(0,w.aJ)("launchPrepaidGiveaway",(async(e,t,s)=>{const{chatId:a,giveawayId:o,paymentPurpose:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a);if(!r)return;const d=n?.additionalChannelIds?.map((t=>(0,C.hds)(e,t))).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"giveaway",chat:r,areWinnersVisible:n?.areWinnersVisible,additionalChannels:d,countries:n?.countries,prizeDescription:n.prizeDescription,untilDate:n.untilDate,currency:n.currency,amount:n.amount}})&&t.openBoostStatistics({chatId:a,tabId:i})})),(0,w.aJ)("launchPrepaidStarsGiveaway",(async(e,t,s)=>{const{chatId:a,giveawayId:o,paymentPurpose:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a);if(!r)return;const d=n?.additionalChannelIds?.map((t=>(0,C.hds)(e,t))).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"starsgiveaway",chat:r,areWinnersVisible:n?.areWinnersVisible,additionalChannels:d,countries:n?.countries,prizeDescription:n.prizeDescription,untilDate:n.untilDate,currency:n.currency,amount:n.amount,stars:n.stars,users:n.users}})&&t.openBoostStatistics({chatId:a,tabId:i})})),(0,w.aJ)("upgradeGift",((e,t,s)=>{const{gift:a,shouldKeepOriginalDetails:o,upgradeStars:n,tabId:i=(0,u.g0)()}=s,r=(0,et.HT)(e,a);r&&(e=(0,A.w)(e,{isWaitingForStarGiftUpgrade:!0},i),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftUpgradeModal({tabId:i}),t.closeGiftInfoModal({tabId:i}),n?tt(e,{type:"stargiftUpgrade",inputSavedGift:a,shouldKeepOriginalDetails:o||void 0},n,i):(0,b.px)("upgradeStarGift",{inputSavedGift:r,shouldKeepOriginalDetails:o||void 0}))})),(0,w.aJ)("transferGift",((e,t,s)=>{const{gift:a,recipientId:o,transferStars:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,o),d=(0,et.HT)(e,a);r&&d&&(e=(0,A.w)(e,{isWaitingForStarGiftTransfer:!0},i),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftTransferModal({tabId:i}),t.closeGiftInfoModal({tabId:i}),n?tt(e,{type:"stargiftTransfer",inputSavedGift:a,recipientId:o},n,i):(0,b.px)("transferStarGift",{inputSavedGift:d,toPeer:r}))})),(0,w.aJ)("openUniqueGiftBySlug",(async(e,t,s)=>{const{slug:a,tabId:o=(0,u.g0)()}=s,n=await(0,b.px)("fetchUniqueStarGift",{slug:a});n?t.openGiftInfoModal({gift:n,tabId:o}):t.showNotification({message:{key:"GiftWasNotFound"},tabId:o})})),(0,w.aJ)("processStarGiftWithdrawal",(async(e,t,s)=>{const{gift:a,password:o,tabId:n=(0,u.g0)()}=s;let i=(0,C.nTw)(e,n).giftWithdrawModal;if(!i)return;e=(0,A.w)(e,{giftWithdrawModal:{...i,isLoading:!0,errorKey:void 0}},n),(0,w.UF)(e);const r=(0,et.HT)(e,a);if(!r)return;const d=await(0,b.px)("fetchStarGiftWithdrawalUrl",{inputGift:r,password:o});if(d&&(e=(0,w.mS)(),i=(0,C.nTw)(e,n).giftWithdrawModal,i)){if("error"in d)return e=(0,A.w)(e,{giftWithdrawModal:{...i,isLoading:!1,errorKey:d.messageKey}},n),void(0,w.UF)(e);t.openUrl({url:d.url,shouldSkipModal:!0,tabId:n}),t.closeGiftWithdrawModal({tabId:n})}})),(0,w.aJ)("loadStarStatus",(async e=>{const t=e.stars,s=!t?.topupOptions,[a,o]=await Promise.all([(0,b.px)("fetchStarsStatus"),s?(0,b.px)("fetchStarsTopupOptions"):void 0]);!a||s&&!o||(e=(0,w.mS)(),e={...e,stars:{...t,balance:a.balance,topupOptions:o||t.topupOptions,history:{all:void 0,inbound:void 0,outbound:void 0},subscriptions:void 0}},a.history&&(e=(0,S.Psh)(e,"all",a.history,a.nextHistoryOffset)),a.subscriptions&&(e=(0,S.qEh)(e,a.subscriptions,a.nextSubscriptionOffset)),(0,w.UF)(e))})),(0,w.aJ)("loadStarsTransactions",(async(e,t,s)=>{const{type:a}=s,o=e.stars?.history[a],n=o?.nextOffset;if(o&&!n)return;const i=await(0,b.px)("fetchStarsTransactions",{isInbound:"inbound"===a||void 0,isOutbound:"outbound"===a||void 0,offset:n||""});i&&(e=(0,w.mS)(),e=(0,S.L_F)(e,i.balance),i.history&&(e=(0,S.Psh)(e,a,i.history,i.nextOffset)),(0,w.UF)(e))})),(0,w.aJ)("loadStarGifts",(async e=>{const t=await(0,b.px)("fetchStarGifts");if(!t)return;const s=(0,h.dU)(t,"id"),a={all:[],stock:[],limited:[],resale:[]},o=Object.keys(s),n=Object.values(s),i=n.map((e=>e.isLimited?e.id:void 0)).filter(Boolean),r=n.map((e=>e.availabilityRemains||!e.availabilityTotal?e.id:void 0)).filter(Boolean),d=n.map((e=>e.availabilityResale?e.id:void 0)).filter(Boolean);a.all=o,a.limited=i,a.stock=r,a.resale=d,n.forEach((e=>{const t=e.stars;a[t]||(a[t]=[]),a[t].push(e.id)})),e=(0,w.mS)(),e={...e,starGifts:{byId:s,idsByCategory:a}},(0,w.UF)(e)})),(0,w.aJ)("updateResaleGiftsFilter",((e,t,s)=>{const{filter:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);e=(0,A.w)(e,{resaleGifts:{...n.resaleGifts,filter:a}},o),n.resaleGifts.giftId&&t.loadResaleGifts({giftId:n.resaleGifts.giftId,shouldRefresh:!0,tabId:o}),(0,w.UF)(e)})),(0,w.aJ)("loadResaleGifts",(async(e,t,s)=>{const{giftId:o,shouldRefresh:n,tabId:i=(0,u.g0)()}=s;let r=(0,C.nTw)(e,i);if(r.resaleGifts.isLoading||r.resaleGifts.isAllLoaded&&!n)return;e=(0,A.w)(e,{resaleGifts:{...r.resaleGifts,isLoading:!0,...n&&{count:0,nextOffset:void 0,isAllLoaded:!1}}},i),(0,w.UF)(e),e=(0,w.mS)(),r=(0,C.nTw)(e,i);const d=r.resaleGifts.nextOffset,c=r.resaleGifts.attributesHash,l=r.resaleGifts.filter,p=await(0,b.px)("fetchResaleGifts",{giftId:o,offset:d,limit:a.bcN,attributesHash:c,filter:l});if(!p)return;const{chats:m,users:g}=p;e=(0,w.mS)(),r=(0,C.nTw)(e,i);const f=r.resaleGifts.gifts,I=n?p.gifts:f.concat(p.gifts),v=r.resaleGifts.updateIteration,y=r.resaleGifts.giftId!==o||n?v+1:v;e=(0,A.w)(e,{resaleGifts:{...r.resaleGifts,giftId:o,count:p.count||r.resaleGifts.count,gifts:I,attributes:p.attributes||r.resaleGifts.attributes,counters:p.counters||r.resaleGifts.counters,attributesHash:p.attributesHash,nextOffset:p.nextOffset,isLoading:!1,isAllLoaded:!p.nextOffset,updateIteration:y}},i),e=(0,S.CKT)(e,(0,h.dU)(g,"id")),e=(0,S.h7P)(e,(0,h.dU)(m,"id")),(0,w.UF)(e)})),(0,w.aJ)("resetResaleGifts",((e,t,s)=>{const{tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);return(0,A.w)(e,{resaleGifts:{updateIteration:n.resaleGifts.updateIteration+1,filter:a.hYe,count:0,gifts:[]}},o)})),(0,w.aJ)("loadPeerSavedGifts",(async(e,t,s)=>{const{peerId:a,shouldRefresh:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a);if(!i)return;e=(0,w.mS)();const r=(0,C.FDg)(e,a,n),d=r?.nextOffset;if(!o&&r&&!d)return;const c=(0,C.w0X)(e,a,n),l=await(0,b.px)("fetchSavedStarGifts",{peer:i,offset:o?"":d,filter:c});e=(0,w.mS)();const h=(0,C.w0X)(e,a,n);if(!l||h!==c)return;const p=r&&!o?r.gifts.concat(l.gifts):l.gifts;e=(0,S.xOA)(e,a,p,l.nextOffset,n),(0,w.UF)(e)})),(0,w.aJ)("reloadPeerSavedGifts",((e,t,s)=>{const{peerId:a}=s;Object.values(e.byTabId).forEach((s=>{(0,C.FDg)(e,a,s.id)&&t.loadPeerSavedGifts({peerId:a,shouldRefresh:!0,tabId:s.id})}))})),(0,w.aJ)("loadStarsSubscriptions",(async e=>{const t=e.stars?.subscriptions,s=t?.nextOffset;if(t&&!s)return;e=(0,S.Yzx)(e,!0),(0,w.UF)(e);const a=await(0,b.px)("fetchStarsSubscriptions",{offset:s||""});a&&(e=(0,w.mS)(),e=(0,S.L_F)(e,a.balance),e=(0,S.qEh)(e,a.subscriptions,a.nextOffset),(0,w.UF)(e))})),(0,w.aJ)("changeStarsSubscription",(async(e,t,s)=>{const{peerId:a,id:o,isCancelled:n}=s,i=a?(0,C.PVB)(e,a):void 0;a&&!i||(await(0,b.px)("changeStarsSubscription",{peer:i,subscriptionId:o,isCancelled:n}),t.loadStarStatus())})),(0,w.aJ)("fulfillStarsSubscription",(async(e,t,s)=>{const{peerId:a,id:o}=s,n=a?(0,C.PVB)(e,a):void 0;a&&!n||(await(0,b.px)("fulfillStarsSubscription",{peer:n,subscriptionId:o}),t.loadStarStatus())})),(0,w.aJ)("changeGiftVisibility",(async(e,t,s)=>{const{gift:a,shouldUnsave:o,tabId:n=(0,u.g0)()}=s,i="user"===a.type?e.currentUserId:a.chatId,r=(0,et.HT)(e,a);if(!r)return;const d=(0,C.nTw)(e,n).savedGifts.giftsByPeerId[i];if(d?.gifts?.length){const t=d.gifts.map((e=>e.inputGift&&(0,et.j6)(e.inputGift,a)?{...e,isUnsaved:o}:e));e=(0,S.xOA)(e,i,t,d.nextOffset,n),(0,w.UF)(e)}const c=await(0,b.px)("saveStarGift",{inputGift:r,shouldUnsave:o});if(e=(0,w.mS)(),!c)return e=(0,S.xOA)(e,i,d.gifts,d.nextOffset,n),void(0,w.UF)(e);Object.values(e.byTabId).forEach((s=>{(0,C.FDg)(e,i,n)&&t.loadPeerSavedGifts({peerId:i,shouldRefresh:!0,tabId:s.id})}))})),(0,w.aJ)("convertGiftToStars",(async(e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,n=(0,et.HT)(e,a);if(!n)return;if(!await(0,b.px)("convertStarGift",{inputSavedGift:n}))return;const i="user"===a.type?e.currentUserId:a.chatId;Object.values(e.byTabId).forEach((s=>{(0,C.FDg)(e,i,s.id)&&t.loadPeerSavedGifts({peerId:i,shouldRefresh:!0,tabId:s.id})})),t.openStarsBalanceModal({tabId:o})})),(0,w.aJ)("openGiftUpgradeModal",(async(e,t,s)=>{const{giftId:a,gift:o,peerId:n,tabId:i=(0,u.g0)()}=s,r=await(0,b.px)("fetchStarGiftUpgradePreview",{giftId:a});r&&(e=(0,w.mS)(),e=(0,A.w)(e,{giftUpgradeModal:{recipientId:n,gift:o,sampleAttributes:r}},i),(0,w.UF)(e))})),(0,w.aJ)("toggleSavedGiftPinned",(async(e,t,s)=>{const{gift:a,peerId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,o);if(!i)return;const r=(0,C.FDg)(e,o,n);if(!r)return;const d=e.appConfig?.savedGiftPinLimit,c=r.gifts.filter((e=>e.isPinned)),l=a.isPinned?c.filter((e=>e.gift.slug!==a.gift.slug)):[...c,a],h=(d?l.slice(-d):l).map((t=>(0,et.HT)(e,t.inputGift))).filter(Boolean);await(0,b.px)("toggleSavedGiftPinned",{inputSavedGifts:h,peer:i})&&Object.values(e.byTabId).forEach((s=>{(0,C.FDg)(e,o,s.id)&&t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:s.id})}))})),(0,w.aJ)("updateStarGiftPrice",(async(e,t,s)=>{const{gift:a,price:o}=s,n=(0,et.HT)(e,a);n&&await(0,b.px)("updateStarGiftPrice",{inputSavedGift:n,price:o})&&t.reloadPeerSavedGifts({peerId:e.currentUserId})}));var at=s(58554);let ot=0;(0,w.aJ)("loadAvailableReactions",(async e=>{const t=await(0,b.px)("fetchAvailableReactions");t&&(t.forEach((e=>{e.aroundAnimation&&at.hd(`sticker${e.aroundAnimation.id}`,n.qZ.BlobUrl),e.centerIcon&&at.hd(`sticker${e.centerIcon.id}`,n.qZ.BlobUrl),e.appearAnimation&&at.hd(`sticker${e.appearAnimation.id}`,n.qZ.BlobUrl),e.selectAnimation&&at.hd((0,v.mr)(e.selectAnimation,"full"),n.qZ.BlobUrl)})),e=(0,w.mS)(),e={...e,reactions:{...e.reactions,availableReactions:t}},(0,w.UF)(e),(0,Je.A)({action:"loadAvailableReactions",payload:void 0},a.npx))})),(0,w.aJ)("loadAvailableEffects",(async e=>{const t=await(0,b.px)("fetchAvailableEffects");if(!t)return;const{effects:s,emojis:a,stickers:o}=t,n=[],i=(0,h.dU)(s,"id");for(const e of s)if(e.effectAnimationId){const t={type:"emoji",emoticon:e.emoticon};n.push(t)}e=(0,w.mS)(),e={...e,availableEffectById:i,stickers:{...e.stickers,effect:{stickers:o,emojis:a}},reactions:{...e.reactions,effectReactions:n}},(0,w.UF)(e)})),(0,w.aJ)("interactWithAnimatedEmoji",((e,t,s)=>{const{emoji:a,x:o,y:n,startSize:i,isReversed:r,tabId:d=(0,u.g0)()}=s,c={id:ot++,animatedEffect:a,x:O(e,o)+40*Math.random()-20,y:n+40*Math.random()-20,startSize:i,isReversed:r};return(0,A.w)(e,{activeEmojiInteractions:[...(0,C.nTw)(e,d).activeEmojiInteractions||[],c]},d)})),(0,w.aJ)("sendEmojiInteraction",((e,t,s)=>{const{messageId:a,chatId:o,emoji:n,interactions:i}=s;if("connectionStateReady"!==e.connectionState)return;const r=(0,C.hds)(e,o);r&&n&&!(0,C.nZ4)(e,o)&&(0,b.px)("sendEmojiInteraction",{chat:r,messageId:a,emoticon:n,timestamps:i})})),(0,w.aJ)("sendDefaultReaction",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTJ)(e,a),r=(0,C.O5q)(e,a,o);i&&r&&!(0,v.Nb)(r)&&t.toggleReaction({chatId:a,messageId:o,reaction:i,tabId:n})})),(0,w.aJ)("toggleReaction",(async(e,t,s)=>{const{chatId:a,reaction:o,shouldAddToRecent:n,tabId:i=(0,u.g0)()}=s;let{messageId:r}=s;const d=(0,C.hds)(e,a);let c=(0,C.O5q)(e,a,r);if(!d||!c)return;const l=(0,C.nZ4)(e,a),m=Boolean(c.groupedId)&&!c.isInAlbum,g=m?(0,C.D_S)(e,a,c.groupedId)[0]:void 0;c=m&&(0,C.O5q)(e,a,g)||c,r=c?.id||r;const f=(0,v.uC)(c),I=f.some((e=>(0,v.a0)(e,o))),y=I?f.filter((e=>!(0,v.a0)(e,o))):[...f,o],S=(0,C.cO5)(e),[A,M]=(0,h.jB)(y,(e=>"paid"===e.type)),k=M.slice(-S),F=[...A,...k],P=(0,p.bj)(c);(0,C.xYJ)(e,"reactionEffects")&&(I?t.stopActiveReaction({containerId:P,reaction:o,tabId:i}):t.startActiveReaction({containerId:P,reaction:o,tabId:i})),e=G(e,c,F),(0,w.UF)(e);try{await(0,b.px)("sendReaction",{chat:d,messageId:r,reactions:k,shouldAddToRecent:n}),l&&t.loadSavedReactionTags()}catch(t){e=G(e=(0,w.mS)(),c,f),(0,w.UF)(e)}})),(0,w.aJ)("addLocalPaidReaction",((e,t,s)=>{const{chatId:a,messageId:o,count:n,shouldIgnoreDefaultPrivacy:i=!1,tabId:r=(0,u.g0)()}=s,d=e.settings.paidReactionPrivacy,c=i?s.isPrivate:"anonymous"===d?.type,l=i?s.peerId:"peer"===d?.type?d.peerId:void 0,h=(0,C.hds)(e,a),m=(0,C.O5q)(e,a,o);if(!h||!m)return;const g=m.reactions?.results||[],f=(0,v.Ny)(g,n,c,l);e=(0,S.r3y)(e,m.chatId,m.id,{reactions:{...g,results:f}}),(0,w.UF)(e);const I=(0,p.bj)(m);(0,C.xYJ)(e,"reactionEffects")&&t.startActiveReaction({containerId:I,reaction:{type:"paid"},tabId:r})})),(0,w.aJ)("sendPaidReaction",(async(e,t,s)=>{const{chatId:a,messageId:o,forcedAmount:n,tabId:i=(0,u.g0)()}=s,r=(0,C.hds)(e,a),d=(0,C.O5q)(e,a,o);if(!r||!d)return;const c=d.reactions?.results?.find((e=>"paid"===e.reaction.type)),l=n||c?.localAmount||0;if(l){t.resetLocalPaidReactions({chatId:a,messageId:o});try{await(0,b.px)("sendPaidReaction",{chat:r,messageId:o,count:l,isPrivate:c?.localIsPrivate,peerId:c?.localPeerId})}catch(e){"BALANCE_TOO_LOW"===e.message&&t.openStarsBalanceModal({originReaction:{chatId:a,messageId:o,amount:l},tabId:i})}}})),(0,w.aJ)("startActiveReaction",((e,t,s)=>{const{containerId:a,reaction:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTw)(e,n);if(!(0,C.xYJ)(e,"reactionEffects"))return;const r=i.activeReactions[a]||[];if(r.some((e=>(0,v.a0)(e,o))))return;const d=r.concat(o);return(0,A.w)(e,{activeReactions:{...i.activeReactions,[a]:d}},n)})),(0,w.aJ)("stopActiveReaction",((e,t,s)=>{const{containerId:a,reaction:o,tabId:n=(0,u.g0)()}=s,i=(0,C.nTw)(e,n),r=i.activeReactions[a]||[],d=o?r.filter((e=>!(0,v.a0)(e,o))):[],c=d.length?{...i.activeReactions,[a]:d}:(0,h.cJ)(i.activeReactions,[a]);return(0,A.w)(e,{activeReactions:c},n)})),(0,w.aJ)("setDefaultReaction",(async(e,t,s)=>{const{reaction:a}=s;await(0,b.px)("setDefaultReaction",{reaction:a})&&((e=(0,w.mS)()).config?(e={...e,config:{...e.config,defaultReaction:a}},(0,w.UF)(e)):t.loadConfig())})),(0,w.aJ)("stopActiveEmojiInteraction",((e,t,s)=>{const{id:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{activeEmojiInteractions:(0,C.nTw)(e,o).activeEmojiInteractions?.filter((e=>e.id!==a))},o)})),(0,w.aJ)("loadReactors",(async(e,t,s)=>{if((0,C.trm)(e))return;const{chatId:a,messageId:o,reaction:n}=s,i=(0,C.hds)(e,a),r=(0,C.O5q)(e,a,o);if(!i||!r)return;const d=r.reactors?.nextOffset,c=await(0,b.px)("fetchMessageReactionsList",{reaction:n,chat:i,messageId:o,offset:d});c&&(e=(0,w.mS)(),e=(0,S.r3y)(e,a,o,{reactors:c}),(0,w.UF)(e))})),(0,w.aJ)("loadMessageReactions",((e,t,s)=>{if((0,C.trm)(e))return;const{ids:a,chatId:o}=s,n=(0,C.hds)(e,o);n&&"connectionStateReady"===e.connectionState&&(0,b.px)("fetchMessageReactions",{ids:a,chat:n})})),(0,w.aJ)("sendWatchingEmojiInteraction",((e,t,s)=>{const{chatId:a,emoticon:o,x:n,y:i,startSize:r,isReversed:d,id:c,tabId:l=(0,u.g0)()}=s,h=(0,C.hds)(e,a),p=(0,C.nTw)(e,l);if(h&&p.activeEmojiInteractions?.some((e=>e.id===c))&&!(0,C.nZ4)(e,a))return"connectionStateReady"===e.connectionState&&(0,b.px)("sendWatchingEmojiInteraction",{chat:h,emoticon:o}),(0,A.w)(e,{activeEmojiInteractions:p.activeEmojiInteractions.map((t=>t.id===c?{...t,x:O(e,n),y:i,startSize:r,isReversed:d}:t))},l)})),(0,w.aJ)("fetchUnreadReactions",(async(e,t,s)=>{const{chatId:a,offsetId:o}=s,n=(0,C.hds)(e,a);if(!n)return;const i=await(0,b.px)("fetchUnreadReactions",{chat:n,offsetId:o,addOffset:o?-1:void 0});if(!i||!i.messages.length)return e=V(e=(0,w.mS)(),a,{unreadReactionsCount:0}),void(0,w.UF)(e);const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number);e=(0,w.mS)(),e=V(e=(0,S.o4A)(e,n.id,d),a,{unreadReactions:(0,h.Am)([...n.unreadReactions||[],...c]).sort(((e,t)=>t-e))}),(0,w.UF)(e)})),(0,w.aJ)("animateUnreadReaction",((e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,n=(0,C.meB)(e,o);if(!n)return;if(!n.unreadReactionsCount)return V(e,n.id,{unreadReactions:[]});const i=Math.max(n.unreadReactionsCount-a.length,0),r=(n.unreadReactions||[]).filter((e=>!a.includes(e)));e=V(e,n.id,{unreadReactions:r,unreadReactionsCount:i}),(0,w.UF)(e),t.markMessagesRead({messageIds:a,shouldFetchUnreadReactions:!0,tabId:o}),(0,C.xYJ)(e,"reactionEffects")&&(e=(0,w.mS)(),a.forEach((s=>{const a=(0,C.O5q)(e,n.id,s);if(!a)return;const{reaction:o,isOwn:i,isUnread:r}=a.reactions?.recentReactions?.[0]??{};if(o&&r&&!i){const e=(0,p.bj)(a);t.startActiveReaction({containerId:e,reaction:o,tabId:(0,u.g0)()})}})))})),(0,w.aJ)("focusNextReaction",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.meB)(e,a);if(!o?.unreadReactions)return o?.unreadReactionsCount?(0,S.wix)(e,o.id,{unreadReactionsCount:0}):void 0;t.focusMessage({chatId:o.id,messageId:o.unreadReactions[0],tabId:a,scrollTargetPosition:"end"}),t.markMessagesRead({messageIds:[o.unreadReactions[0]],tabId:a})})),(0,w.aJ)("readAllReactions",((e,t,s)=>{const{chatId:a,threadId:o=n.l3}=s,i=(0,C.hds)(e,a);if(i)return(0,b.px)("readAllReactions",{chat:i,threadId:o===n.l3?void 0:o}),o===n.l3?V(e,i.id,{unreadReactionsCount:void 0,unreadReactions:void 0}):void 0})),(0,w.aJ)("loadTopReactions",(async e=>{const t=await(0,b.px)("fetchTopReactions",{hash:e.reactions.hash.topReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,topReactions:t.reactions,hash:{...e.reactions.hash,topReactions:t.hash}}},(0,w.UF)(e))})),(0,w.aJ)("loadRecentReactions",(async e=>{const t=await(0,b.px)("fetchRecentReactions",{hash:e.reactions.hash.recentReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:t.reactions,hash:{...e.reactions.hash,recentReactions:t.hash}}},(0,w.UF)(e))})),(0,w.aJ)("clearRecentReactions",(async e=>{await(0,b.px)("clearRecentReactions")&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:[]}},(0,w.UF)(e))})),(0,w.aJ)("loadDefaultTagReactions",(async e=>{const t=await(0,b.px)("fetchDefaultTagReactions",{hash:e.reactions.hash.defaultTags});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,defaultTags:t.reactions,hash:{...e.reactions.hash,defaultTags:t.hash}}},(0,w.UF)(e))})),(0,w.aJ)("loadSavedReactionTags",(async e=>{const{hash:t}=e.savedReactionTags||{},s=await(0,b.px)("fetchSavedReactionTags",{hash:t});if(!s)return;e=(0,w.mS)();const a=(0,h.pA)(s.tags,(e=>[(0,v.Jj)(e.reaction),e]));e={...e,savedReactionTags:{hash:s.hash,byKey:a}},(0,w.UF)(e)})),(0,w.aJ)("editSavedReactionTag",(async(e,t,s)=>{const{reaction:a,title:o}=s;if(!await(0,b.px)("updateSavedReactionTag",{reaction:a,title:o}))return;e=(0,w.mS)();const n=e.savedReactionTags?.byKey;if(!n)return;const i=(0,v.Jj)(a),r={...n[i],title:o};e={...e,savedReactionTags:{...e.savedReactionTags,byKey:{...n,[i]:r}}},(0,w.UF)(e)})),(0,w.aJ)("loadStatistics",(async(e,t,s)=>{const{chatId:a,isGroup:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=await(0,b.px)(o?"fetchGroupStatistics":"fetchChannelStatistics",{chat:i,dcId:r.statisticsDcId});if(!d)return;const{stats:c}=d;e=(0,w.mS)(),e=(0,S.n8l)(e,a,c,n),(0,w.UF)(e)})),(0,w.aJ)("loadChannelMonetizationStatistics",(async(e,t,s)=>{const{peerId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.PVB)(e,a),i=(0,C.AWZ)(e,a);if(!n)return;const r=i?.statisticsDcId,d=await(0,b.px)("fetchChannelMonetizationStatistics",{peer:n,dcId:r});d&&(e=(0,w.mS)(),e=(0,S.$ry)(e,d,o),(0,w.UF)(e))})),(0,w.aJ)("loadMessageStatistics",(async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchMessageStatistics",{chat:i,messageId:o,dcId:d});c||(c={}),e=(0,w.mS)();const{viewsCount:l,forwardsCount:h,reactions:p}=(0,C.zeq)(e,a)[o]||{};c.viewsCount=l,c.forwardsCount=h,c.reactionsCount=p?.results?p?.results.reduce(((e,t)=>e+t.count),0):void 0,e=(0,S.gJI)(e,c,n),(0,w.UF)(e),t.loadMessagePublicForwards({chatId:a,messageId:o,tabId:n})})),(0,w.aJ)("loadMessagePublicForwards",(async(e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,n).statistics.currentMessage||{};if(c?.publicForwards&&!c.nextOffset)return;const l=await(0,b.px)("fetchMessagePublicForwards",{chat:i,messageId:o,dcId:d,offset:c.nextOffset}),{forwards:h,nextOffset:p,count:m}=l||{},g=c.publicForwardsData?.length&&h?.length&&(0,M.T)(c.publicForwardsData[c.publicForwardsData.length-1],h[0]);e=(0,w.mS)(),e=(0,S.gJI)(e,{...c,publicForwards:m||h?.length,publicForwardsData:(c.publicForwardsData||[]).concat(g?h.slice(1):h||[]),nextOffset:p},n),(0,w.UF)(e)})),(0,w.aJ)("loadStatisticsAsyncGraph",(async(e,t,s)=>{const{chatId:a,token:o,name:n,isPercentage:i,tabId:r=(0,u.g0)()}=s,d=(0,C.AWZ)(e,a);if(!d)return;const c=d.statisticsDcId,l=await(0,b.px)("fetchStatisticsAsyncGraph",{token:o,dcId:c,isPercentage:i});l&&(e=(0,w.mS)(),e=(0,S.RoI)(e,a,n,l,r),(0,w.UF)(e))})),(0,w.aJ)("loadStoryStatistics",(async(e,t,s)=>{const{chatId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchStoryStatistics",{chat:i,storyId:o,dcId:d});c||(c={}),e=(0,w.mS)();const l=(0,C.Msb)(e,a,o),{forwardsCount:h=0,viewsCount:p=0,reactionsCount:m=0}=l&&"views"in l&&l.views?l.views:{};c.viewsCount=p,c.forwardsCount=h,c.reactionsCount=m,e=(0,w.mS)(),e=(0,S.KXe)(e,c,n),(0,w.UF)(e),t.loadStoryPublicForwards({chatId:a,storyId:o,tabId:n})})),(0,w.aJ)("loadStoryPublicForwards",(async(e,t,s)=>{const{chatId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.hds)(e,a),r=(0,C.AWZ)(e,a);if(!i||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,n).statistics.currentStory||{};if(c?.publicForwards&&!c.nextOffset)return;const{publicForwards:l,count:h,nextOffset:p}=await(0,b.px)("fetchStoryPublicForwards",{chat:i,storyId:o,dcId:d,offset:c.nextOffset})||{};e=(0,w.mS)(),e=(0,S.KXe)(e,{...c,publicForwards:h||l?.length,publicForwardsData:(c.publicForwardsData||[]).concat(l||[]),nextOffset:p},n),(0,w.UF)(e)})),(0,w.aJ)("processMonetizationRevenueWithdrawalUrl",(async(e,t,s)=>{const{peerId:a,currentPassword:o,tabId:n=(0,u.g0)()}=s;e=(0,S.Zct)(e,{isLoading:!0},n),(0,w.UF)(e);const i=(0,C.PVB)(e,a);if(!i)return;const r=await(0,b.px)("fetchMonetizationRevenueWithdrawalUrl",{peer:i,currentPassword:o});r&&(e=(0,w.mS)(),e=(0,S.Zct)(e,{isLoading:!1,errorKey:"error"in r?r.messageKey:void 0},n),(0,w.UF)(e),"url"in r&&(t.openUrl({url:r.url,shouldSkipModal:!0,tabId:n,ignoreDeepLinks:!0}),t.closeMonetizationVerificationModal({tabId:n})))})),(0,w.aJ)("loadAllStories",(async e=>{let t=0;for(;e.stories.hasNext;){if(t++>=100)return void(a.Oig&&console.error("`actions/loadAllStories`: Infinite loop detected"));e=(0,w.mS)();const{stateHash:s,hasNext:o}=e.stories;if(s&&!o)return;const n=await(0,b.px)("fetchAllStories",{isFirstRequest:!s,stateHash:s});if(!n)return;(e=(0,w.mS)()).stories.stateHash=n.state,"peerStories"in n&&(e=(0,S.Niu)(e,n.peerStories),e=(0,S.Gzl)(e,n.peerStories),(e=(0,S.qsx)(e,n.stealthMode)).stories.hasNext=n.hasMore),(0,w.UF)(e)}})),(0,w.aJ)("loadAllHiddenStories",(async e=>{let t=0;for(;e.stories.hasNextInArchive;){if(t++>=100)return void(a.Oig&&console.error("`actions/loadAllHiddenStories`: Infinite loop detected"));e=(0,w.mS)();const{archiveStateHash:s,hasNextInArchive:o}=e.stories;if(s&&!o)return;const n=await(0,b.px)("fetchAllStories",{isFirstRequest:!s,stateHash:s,isHidden:!0});if(!n)return;(e=(0,w.mS)()).stories.archiveStateHash=n.state,"peerStories"in n&&(e=(0,S.Niu)(e,n.peerStories),e=(0,S.Gzl)(e,n.peerStories),(e=(0,S.qsx)(e,n.stealthMode)).stories.hasNextInArchive=n.hasMore),(0,w.UF)(e)}})),(0,w.aJ)("loadPeerSkippedStories",(async(e,t,s)=>{const{peerId:a}=s,o=(0,C.PVB)(e,a),n=(0,C._bp)(e,a);if(!o||!n)return;const i=Object.values(n.byId).reduce(((e,t)=>("content"in t||e.push(t.id),e)),[]);if(0===i.length)return;const r=await(0,b.px)("fetchPeerStoriesByIds",{peer:o,ids:i});r&&(e=(0,w.mS)(),e=(0,S.K4v)(e,a,r.stories,r.pinnedIds),(0,w.UF)(e))})),(0,w.aJ)("viewStory",(async(e,t,s)=>{const{peerId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a),r=(0,C.Msb)(e,a,o);if(!i||!r||!("content"in r))return;e=(0,S.SYp)(e,a,o,n),(0,w.UF)(e);const d=(0,P.Fm)();r.expireDate<d&&r.isInProfile&&(0,b.px)("viewStory",{peer:i,storyId:o}),(e.stories.byPeerId[a].lastReadId||0)<r.id&&await(0,b.px)("markStoryRead",{peer:i,storyId:o})&&(e=(0,w.mS)(),e=(0,S.Ahb)(e,a,o),(0,w.UF)(e))})),(0,w.aJ)("deleteStory",(async(e,t,s)=>{const{peerId:a,storyId:o}=s,n=(0,C.PVB)(e,a);n&&await(0,b.px)("deleteStory",{peer:n,storyId:o})&&(e=(0,w.mS)(),e=(0,S.ONz)(e,a,o),(0,w.UF)(e))})),(0,w.aJ)("toggleStoryInProfile",(async(e,t,s)=>{const{peerId:a,storyId:o,isInProfile:n}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=(0,C.Msb)(e,a,o),d=r&&"content"in r?r.isInProfile:void 0;e=(0,S.Xzz)(e,a,o,{isInProfile:n}),e=(0,S.KpR)(e,a,o,n),(0,w.UF)(e);const c=await(0,b.px)("toggleStoryInProfile",{peer:i,storyId:o,isInProfile:n});c?.length||(e=(0,w.mS)(),e=(0,S.Xzz)(e,a,o,{isInProfile:d}),e=(0,S.KpR)(e,a,o,d),(0,w.UF)(e))})),(0,w.aJ)("toggleStoryPinnedToTop",(async(e,t,s)=>{const{peerId:a,storyId:o}=s,n=(0,C.PVB)(e,a),i=(0,C._bp)(e,a);if(!n||!i)return;const r=(0,C.gVx)(e,a)?.map((e=>e.id))||[],d=r.includes(o)?r.filter((e=>e!==o)):[...r,o];e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[a]:{...i,pinnedIds:d.sort(((e,t)=>t-e))}}}},(0,w.UF)(e),await(0,b.px)("toggleStoryPinnedToTop",{peer:n,storyIds:d})||(e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[a]:{...i,pinnedIds:r}}}},(0,w.UF)(e))})),(0,w.aJ)("loadPeerStories",(async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a}=s,o=(0,C.PVB)(e,a);if(!o)return;const n=await(0,b.px)("fetchPeerStories",{peer:o});n&&(e=(0,w.mS)(),e=(0,S.K4v)(e,a,n.stories),n.lastReadStoryId&&(e=(0,S.Ahb)(e,a,n.lastReadStoryId)),(0,w.UF)(e))})),(0,w.aJ)("loadPeerProfileStories",(async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,offsetId:o}=s,n=(0,C.PVB)(e,a);let i=(0,C._bp)(e,a);if(!n||i?.isFullyLoaded)return;const r=await(0,b.px)("fetchPeerProfileStories",{peer:n,offsetId:o});r&&(e=(0,w.mS)(),e=(0,S.K4v)(e,a,r.stories,r.pinnedIds),i=(0,C._bp)(e,a),(0===Object.values(r.stories).length||i?.profileIds?.length&&i?.profileIds.length>=r.count)&&(e=(0,S.oeX)(e,a,!0)),(0,w.UF)(e))})),(0,w.aJ)("loadStoriesArchive",(async(e,t,s)=>{if((0,C.trm)(e))return;const{peerId:a,offsetId:o}=s,n=(0,C.PVB)(e,a);let i=(0,C._bp)(e,a);if(!n||i?.isArchiveFullyLoaded)return;const r=await(0,b.px)("fetchStoriesArchive",{peer:n,offsetId:o});r&&(e=(0,w.mS)(),e=(0,S.K4v)(e,a,r.stories,void 0,!0),i=(0,C._bp)(e,a),(0===Object.values(r.stories).length||i?.archiveIds?.length&&i?.archiveIds.length>=r.count)&&(e=(0,S.oeX)(e,a,!0,!0)),(0,w.UF)(e))})),(0,w.aJ)("loadPeerStoriesByIds",(async(e,t,s)=>{const{peerId:a,storyIds:o}=s,n=(0,C.PVB)(e,a);if(!n)return;const i=await(0,b.px)("fetchPeerStoriesByIds",{peer:n,ids:o});i&&(e=(0,w.mS)(),e=(0,S.K4v)(e,a,i.stories),(0,w.UF)(e))})),(0,w.aJ)("loadStoryViews",(async(e,t,s)=>{const{peerId:a,storyId:o}=s,n=(0,C.PVB)(e,a);if(!n)return;const i=await(0,b.px)("fetchStoriesViews",{peer:n,storyIds:[o]});i&&(e=(0,w.mS)(),e=(0,S.ZCo)(e,a,o,i.views),(0,w.UF)(e))})),(0,w.aJ)("loadStoryViewList",(async(e,t,s)=>{const{peerId:a,storyId:o,offset:n,areReactionsFirst:i,areJustContacts:r,query:d,limit:c,tabId:l=(0,u.g0)()}=s,h=(0,C.PVB)(e,a);if(!h)return;e=(0,S.dxy)(e,!0,l),(0,w.UF)(e);const p=await(0,b.px)("fetchStoryViewList",{peer:h,storyId:o,offset:n,areReactionsFirst:i,areJustContacts:r,limit:c,query:d});if(!p)return e=(0,w.mS)(),e=(0,S.dxy)(e,!1,l),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,S.X5v)(e,o,p.views,p.nextOffset,l),(0,w.UF)(e)})),(0,w.aJ)("reportStory",(async(e,t,s)=>{const{peerId:o,storyId:n,description:i="",option:r="",tabId:d=(0,u.g0)()}=s,c=(0,C.PVB)(e,o);if(!c)return;const l=await(0,b.px)("reportStory",{peer:c,storyId:n,description:i,option:r});if(!l)return;const{result:h,error:p}=l;if(p===a.zLi)return t.showNotification({message:(0,f.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find((e=>e.option===r)),a={title:h.title,options:h.options,subtitle:s?.text};e=(0,A.w)(e,{reportModal:{messageIds:[n],subject:"story",peerId:o,description:i,sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,s=t?.[t.length-1]?.options?.find((e=>e.option===r)),a={isOptional:h.isOptional,option:h.option,title:s?.text};e=(0,A.w)(e,{reportModal:{messageIds:[n],description:i,peerId:o,subject:"story",sections:t?[...t,a]:[a]}},d),(0,w.UF)(e)}}})),(0,w.aJ)("editStoryPrivacy",((e,t,s)=>{const{peerId:a,storyId:o,privacy:n}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=[...n.allowUserIds,...n.allowChatIds],d=[...n.blockUserIds,...n.blockChatIds],c=(0,v.wT)(e,{visibility:n.visibility,isUnspecified:n.isUnspecified,allowedIds:r,blockedIds:d,botsPrivacy:"none"});(0,b.px)("editStoryPrivacy",{peer:i,id:o,privacy:c})})),(0,w.aJ)("toggleStoriesHidden",(async(e,t,s)=>{const{peerId:a,isHidden:o}=s,n=(0,C.PVB)(e,a);n&&await(0,b.px)("toggleStoriesHidden",{peer:n,isHidden:o})&&(e=(0,w.mS)(),e=(0,S.VWO)(e,a,o),(0,w.UF)(e))})),(0,w.aJ)("loadStoriesMaxIds",(async(e,t,s)=>{const{peerIds:a}=s,o=a.map((t=>(0,C.PVB)(e,t))).filter(Boolean);if(!o.length)return;const n=await(0,b.px)("fetchStoriesMaxIds",{peers:o});if(!n)return;const i=[];e=(0,w.mS)(),n.forEach(((t,s)=>{const a=o[s];e=(0,S.kTB)(e,a.id,{maxStoryId:t,hasStories:0!==t}),0!==t&&i.push(a.id)})),(0,w.UF)(e),i?.forEach((e=>t.loadPeerStories({peerId:e})))})),(0,w.aJ)("sendStoryReaction",(async(e,t,s)=>{const{peerId:a,storyId:o,containerId:n,reaction:i,shouldAddToRecent:r,tabId:d=(0,u.g0)()}=s,c=(0,C.PVB)(e,a);if(!c)return;const l=(0,C.Msb)(e,a,o);if(!l||!("content"in l))return;const h=l.sentReaction;e=(0,S.k31)(e,a,o,i),(0,w.UF)(e),i?t.startActiveReaction({containerId:n,reaction:i,tabId:d}):t.stopActiveReaction({containerId:n,tabId:d});const p=await(0,b.px)("sendStoryReaction",{peer:c,storyId:o,reaction:i,shouldAddToRecent:r});e=(0,w.mS)(),p||(e=(0,S.k31)(e,a,o,h)),(0,w.UF)(e)})),(0,w.aJ)("activateStealthMode",((e,t,s)=>{const{isForPast:a=!0,isForFuture:o=!0}=s||{};(0,b.px)("activateStealthMode",{isForPast:a||!0,isForFuture:o||!0})})),s(88742);var nt=s(66414);(0,w.aJ)("processOpenChatOrThread",((e,t,s)=>{const{chatId:a,threadId:o=n.l3,type:i="thread",shouldReplaceHistory:r=!1,shouldReplaceLast:d=!1,tabId:c=(0,u.g0)()}=s,l=(0,C.Xf0)(e,c),h=(0,C.nTw)(e,c);return h.premiumModal?.promo&&h.premiumModal?.isOpen&&(e=(0,A.w)(e,{premiumModal:{...h.premiumModal,isOpen:!1}},c)),t.hideEffectInComposer({tabId:c}),t.closeStoryViewer({tabId:c}),t.closeStarsBalanceModal({tabId:c}),t.closeStarsTransactionModal({tabId:c}),l&&l.chatId===a&&l.threadId===o&&l.type===i||(a&&(e=(0,S.n4t)(e,a,o,"replyStack",[],c),e=(0,A.w)(e,{activeReactions:{},shouldPreventComposerAnimation:!0},c),e=(0,S._54)(e,a,o,c)),e=(0,S.T4Z)(e,c),e=(0,A.w)(e,{isStatisticsShown:!1,monetizationStatistics:void 0,boostStatistics:void 0,contentToBeScheduled:void 0,...a!==(0,C.nTw)(e,c).forwardMessages.toChatId&&{forwardMessages:{},isShareMessageModalShown:!1}},c)),t.updatePageTitle({tabId:c}),(0,S.MNF)(e,a,o,i,r,d,c)})),(0,w.aJ)("openChatInNewTab",((e,t,s)=>{const{chatId:a,threadId:o=n.l3}=s,i=(0,nt.dk)(a,"thread",o);d.cp?window.electron.openNewWindow(i):window.open(i,"_blank")})),(0,w.aJ)("openPreviousChat",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return t.updatePageTitle({tabId:a}),(0,S.MNF)(e,void 0,void 0,void 0,void 0,void 0,a)})),(0,w.aJ)("openChatWithInfo",((e,t,s)=>{const{profileTab:a,forceScrollProfileTab:o=!1,tabId:n=(0,u.g0)()}=s;e=(0,A.w)(e,{...(0,C.nTw)(e,n),isChatInfoShown:!0,nextProfileTab:a,forceScrollProfileTab:o},n),e={...e,lastIsChatInfoShown:!0},(0,w.UF)(e),t.openChat({...s,tabId:n})})),(0,w.aJ)("openThreadWithInfo",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;e=(0,A.w)(e,{...(0,C.nTw)(e,a),isChatInfoShown:!0},a),e={...e,lastIsChatInfoShown:!0},(0,w.UF)(e),t.openThread({...s,tabId:a})})),(0,w.aJ)("openChatWithDraft",((e,t,s)=>{const{chatId:a,text:o,threadId:i=n.l3,files:r,filter:d,tabId:c=(0,u.g0)()}=s;return a&&t.openThread({chatId:a,threadId:i,tabId:c}),(0,A.w)(e,{requestedDraft:{chatId:a,text:o,files:r,filter:d}},c)})),(0,w.aJ)("resetChatCreation",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{chatCreation:void 0},a)})),(0,w.aJ)("setNewChatMembersDialogState",((e,t,s)=>{const{newChatMembersProgress:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{newChatMembersProgress:a},o)})),(0,w.aJ)("openNextChat",((e,t,s)=>{const{targetIndexDelta:a,orderedIds:o,tabId:n=(0,u.g0)()}=s,{chatId:i}=(0,C.Xf0)(e,n)||{};if(!i)return void t.openChat({id:o[0],tabId:n});const r=o.indexOf(i);if(-1===r)return;const d=o[r+a];t.openChat({id:d,shouldReplaceHistory:!0,tabId:n})})),(0,w.aJ)("closeDeleteChatFolderModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{deleteFolderDialogModal:void 0},a)})),(0,w.aJ)("closeChatlistModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{chatlistModal:void 0},a)})),(0,w.aJ)("requestChatTranslation",((e,t,s)=>{const{chatId:a,toLanguageCode:o,tabId:n=(0,u.g0)()}=s;return(0,S.lcj)(e,a,o,n)})),(0,w.aJ)("closeChatInviteModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{chatInviteModal:void 0},a)})),(0,w.aJ)("toggleShowLastMessage",((e,t,s)=>{e={...e,chatFilters:{...e.chatFilters,shouldShowLastMessage:!e.chatFilters.shouldShowLastMessage}},(0,w.UF)(e)})),(0,w.aJ)("openWebAppTab",((e,t,s)=>{const{webApp:a,tabId:o=(0,u.g0)()}=s;a&&(e=Ge(e=(0,w.mS)(),a,!0,!0,o),(0,w.UF)(e))})),(0,w.aJ)("updateWebApp",((e,t,s)=>{const{key:a,update:o,tabId:n=(0,u.g0)()}=s;return Oe(e,a,o,n)})),(0,w.aJ)("closeActiveWebApp",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return e=function(e,...[t=(0,u.g0)()]){const s=(0,C.nTw)(e,t).webApps.activeWebAppKey;return s?Ve(e,s,!1,t):e}(e,a),je(e,a)?e:qe(e,!1,a)})),(0,w.aJ)("openMoreAppsTab",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{webApps:{...o.webApps,activeWebAppKey:void 0,isMoreAppsTabActive:!0}},a)})),(0,w.aJ)("closeMoreAppsTab",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),n=o.webApps.openedWebApps,i=Object.keys(n),r=i.length;return(0,A.w)(e,{webApps:{...o.webApps,isMoreAppsTabActive:!1,activeWebAppKey:r?i[r-1]:void 0,isModalOpen:r>0}},a)})),(0,w.aJ)("closeWebApp",((e,t,s)=>{const{key:a,skipClosingConfirmation:o,tabId:n=(0,u.g0)()}=s||{};return je(e=Ve(e,a,o,n),n)?e:qe(e,!1,n)})),(0,w.aJ)("closeWebAppModal",((e,t,s)=>{const{shouldSkipConfirmation:a,tabId:o=(0,u.g0)()}=s||{},n=!a&&!(0,We.l)(e).shouldSkipWebAppCloseConfirmation&&function(e,...[t=(0,u.g0)()]){return Object.keys((0,C.nTw)(e,t).webApps.openedWebApps).length>1}(e,o);return n?(t.openWebAppsCloseConfirmationModal({tabId:o}),e):(e=function(e,...[t=(0,u.g0)()]){const s=(0,C.nTw)(e,t),a=Object.fromEntries(Object.entries(s.webApps.openedWebApps).filter((([,e])=>e.shouldConfirmClosing))),o=Object.values(a);if(!(o.length>0))return(0,A.w)(e,{webApps:{...s.webApps,activeWebAppKey:void 0,openedWebApps:{},openedOrderedKeys:[],sessionKeys:[]}},t);const n=(0,C.ES7)(e,t),i=n?.shouldConfirmClosing?n:o[0],r=(0,Ye.rp)(i);r&&(a[r]={...i,isCloseModalOpen:!0});const d=s.webApps.openedOrderedKeys.filter((e=>a[e]));return(0,A.w)(e,{webApps:{...s.webApps,activeWebAppKey:r,isMoreAppsTabActive:!1,openedWebApps:a,openedOrderedKeys:d}},t)}(e,o),je(e,o)?e:qe(e,!1,o))})),(0,w.aJ)("changeWebAppModalState",((e,t,s)=>{const{state:a,tabId:o=(0,u.g0)()}=s;return function(e,t,...[s=(0,u.g0)()]){const a=(0,C.nTw)(e,s);return(0,A.w)(e,{webApps:{...a.webApps,modalState:t}},s)}(e,a,o)})),(0,w.aJ)("updateMiniAppCachedPosition",((e,t,s)=>{const{position:a}=s;return(0,S.qoo)(e,{miniAppsCachedPosition:a})})),(0,w.aJ)("updateMiniAppCachedSize",((e,t,s)=>{const{size:a}=s;return(0,S.qoo)(e,{miniAppsCachedSize:a})})),(0,w.aJ)("setWebAppPaymentSlug",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,o=(0,C.ES7)(e,a);if(o?.url)return Oe(e,(0,v.rp)(o),{slug:s.slug},a)})),(0,w.aJ)("cancelBotTrustRequest",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{botTrustRequest:void 0},a)})),(0,w.aJ)("markBotTrusted",((e,t,s)=>{const{botId:a,isWriteAllowed:o,tabId:n=(0,u.g0)()}=s,{trustedBotIds:i}=e,r=new Set(i);r.add(a),e={...e,trustedBotIds:Array.from(r)};const d=(0,C.nTw)(e,n);if(d.botTrustRequest?.onConfirm){const{action:e,payload:s}=d.botTrustRequest.onConfirm;t[e]({...s,isWriteAllowed:o})}e=(0,A.w)(e,{botTrustRequest:void 0},n),(0,w.UF)(e)})),(0,w.aJ)("sendWebAppEvent",((e,t,s)=>{const{event:a,webAppKey:o,tabId:n=(0,u.g0)()}=s,i=(0,C.wtp)(e,o,n);if(!i)return e;const r=i.plannedEvents?[...i.plannedEvents,a]:[a];return t.updateWebApp({key:o,update:{plannedEvents:r},tabId:n}),e})),(0,w.aJ)("cancelAttachBotInstall",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{requestedAttachBotInstall:void 0},a)})),(0,w.aJ)("requestAttachBotInChat",((e,t,s)=>{const{bot:a,filter:o,startParam:n,tabId:i=(0,u.g0)()}=s,r=(0,C.Xf0)(e,i)?.chatId,d=a.attachMenuPeerTypes?.filter((e=>"self"!==e&&o.includes(e)));d?.length?(e=(0,A.w)(e,{requestedAttachBotInChat:{bot:a,filter:d,startParam:n}},i),(0,w.UF)(e)):t.callAttachBot({chatId:r||a.id,bot:a,startParam:n,tabId:i})})),(0,w.aJ)("cancelAttachBotInChat",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{requestedAttachBotInChat:void 0},a)})),(0,w.aJ)("openEmojiStatusAccessModal",((e,t,s)=>{const{bot:a,webAppKey:o,tabId:n=(0,u.g0)()}=s;a&&o&&(e=(0,w.mS)(),e=(0,A.w)(e,{emojiStatusAccessModal:{bot:a,webAppKey:o}},n),(0,w.UF)(e))})),(0,w.aJ)("closeEmojiStatusAccessModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{emojiStatusAccessModal:void 0},a)})),(0,w.aJ)("openLocationAccessModal",((e,t,s)=>{const{bot:a,webAppKey:o,tabId:n=(0,u.g0)()}=s;a&&o&&(e=(0,w.mS)(),e=(0,A.w)(e,{locationAccessModal:{bot:a,webAppKey:o}},n),(0,w.UF)(e))})),(0,w.aJ)("closeLocationAccessModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{locationAccessModal:void 0},a)}));var it=s(81954),rt=s(80539),dt=s(3544),ct=s(49086),lt=s(86525);const ut=a.OzO+a.xB5;let ht;function pt(e,t,s){const{type:a,threadId:o}=(0,C.Xf0)(e)||{},n=f.yE,i=(0,C.hds)(e,t),r="scheduled"===a?(0,C.yFI)(e,t):(0,C.zeq)(e,t);if(!i||!r||!o)return;const d=s.map((e=>r[e])).filter((t=>(0,C.WAX)(e,t,o).canCopy)).sort(((e,t)=>e.id-t.id)),l=[],u=[];d.forEach((t=>{const s=(0,v.WX)(i)?i:(0,C.Y7C)(e,t),a=`> ${s?(0,y.F9)(n,s):t.forwardInfo?.hiddenUserName||""}:`,o=(0,v.ni)(e,t);l.push(a),l.push(`${function(e,t){const s=(0,w.mS)(),a=(0,dt.Su)(t),o=a?`${a} `:"",n=(0,ct.V)({message:t,shouldRenderAsHtml:!0})?.join(""),i=(0,lt.ni)(s,t);return`${o}${(0,dt.oL)(e,t,i,n,!0)}`}(n,t)}\n`),u.push(a),u.push(`${(0,dt.dS)(n,t,o,!1,0,!0)}\n`)})),(0,c.A)(l.join("\n"),u.join("\n"))}function mt(e,t){(0,w.aJ)(e,((e,s,a)=>{const{tabId:o=(0,u.g0)()}=a||{};return(0,A.w)(e,{[t]:void 0},o)}))}(0,w.aJ)("setScrollOffset",((e,t,s)=>{const{chatId:a,threadId:o,scrollOffset:n,tabId:i=(0,u.g0)()}=s;return e=(0,S.eww)(e,a,o,"lastScrollOffset",n),(0,S.n4t)(e,a,o,"scrollOffset",n,i)})),(0,w.aJ)("setEditingId",((e,t,s)=>{const{messageId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.Xf0)(e,o);if(!n)return;const{chatId:i,threadId:r,type:d}=n,c="scheduled"===d?"editingScheduledId":"editingId";return(0,S.eww)(e,i,r,c,a)})),(0,w.aJ)("setEditingDraft",((e,t,s)=>{const{text:a,chatId:o,threadId:n,type:i}=s,r="scheduled"===i?"editingScheduledDraft":"editingDraft";return(0,S.eww)(e,o,n,r,a)})),(0,w.aJ)("editLastMessage",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(!o||!n)return;const i=(0,C.zeq)(e,o),r=(0,C.rA3)(e,o,n,a);if(!i||!r)return;const d=(0,h.Uk)(r,(t=>Boolean(i[t]&&(0,C.WAX)(e,i[t],n).canEdit)));return d?(0,S.eww)(e,o,n,"editingId",d):void 0})),(0,w.aJ)("replyToNextMessage",((e,t,s)=>{const{targetIndexDelta:a,tabId:o=(0,u.g0)()}=s,{chatId:i,threadId:r}=(0,C.Xf0)(e,o)||{};if(!i||!r)return;const d=(0,C.zeq)(e,i),c=(0,C.rA3)(e,i,r,o);if(!d||!c)return;const l=(0,C.GA4)(e,i,r)?.replyInfo;let h;if((0,C.haw)(e,i,r,o)&&l?.replyToMsgId){const e=Object.keys(d),t=e.indexOf(l.replyToMsgId.toString())+a;h=t<=e.length+1&&t>=0?Number(e[t]):void 0}else if(r===n.l3)h=(0,C.ZZX)(e,i);else{const t=(0,C.Vw0)(e,i,r);h=t?.lastMessageId}t.updateDraftReplyInfo({replyToMsgId:h,replyToPeerId:void 0,quoteText:void 0,tabId:o}),t.focusMessage({chatId:i,threadId:r,messageId:h,tabId:o})})),(0,w.aJ)("openAudioPlayer",((e,t,s)=>{const{chatId:a,threadId:o,messageId:n,origin:i,volume:r,playbackRate:d,isMuted:c,timestamp:l,tabId:h=(0,u.g0)()}=s,p=(0,C.nTw)(e,h);return(0,A.w)(e,{audioPlayer:{chatId:a,threadId:o,messageId:n,timestamp:l,origin:i??p.audioPlayer.origin,volume:r??p.audioPlayer.volume,playbackRate:d||p.audioPlayer.playbackRate||e.audioPlayer.lastPlaybackRate,isPlaybackRateActive:void 0===p.audioPlayer.isPlaybackRateActive?e.audioPlayer.isLastPlaybackRateActive:p.audioPlayer.isPlaybackRateActive,isMuted:c||p.audioPlayer.isMuted}},h)})),(0,w.aJ)("setAudioPlayerVolume",((e,t,s)=>{const{volume:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,volume:a,isMuted:!1}},o)})),(0,w.aJ)("setAudioPlayerPlaybackRate",((e,t,s)=>{const{playbackRate:a,isPlaybackRateActive:o,tabId:n=(0,u.g0)()}=s;return e={...e,audioPlayer:{...e.audioPlayer,lastPlaybackRate:a,isLastPlaybackRateActive:o}},(0,A.w)(e,{audioPlayer:{...(0,C.nTw)(e,n).audioPlayer,playbackRate:a,isPlaybackRateActive:o}},n)})),(0,w.aJ)("setAudioPlayerMuted",((e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,isMuted:a}},o)})),(0,w.aJ)("setAudioPlayerOrigin",((e,t,s)=>{const{origin:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,origin:a}},o)})),(0,w.aJ)("closeAudioPlayer",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{audioPlayer:{volume:o.audioPlayer.volume,playbackRate:o.audioPlayer.playbackRate,isPlaybackRateActive:o.audioPlayer.isPlaybackRateActive,isMuted:o.audioPlayer.isMuted}},a)})),(0,w.aJ)("openPollResults",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.gjV)(e,(0,L.Ny)(),n),r=(0,C.nTw)(e,n);if(i){if(a!==r.pollResults.chatId||o!==r.pollResults.messageId)return(0,A.w)(e,{pollResults:{chatId:a,messageId:o,voters:{}}},n)}else window.setTimeout((()=>{e=(0,w.mS)(),e=(0,A.w)(e,{pollResults:{chatId:a,messageId:o,voters:{}}},n),(0,w.UF)(e)}),450)})),(0,w.aJ)("closePollResults",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{pollResults:{}},a)})),(0,w.aJ)("focusLastMessage",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:i,threadId:r,type:d}=o,c=(0,v.cG)(i,r,e.currentUserId);let l;if(r===n.l3)if("pinned"===d){const t=(0,C.fcC)(e,i,n.l3);if(!t?.length)return;l=t[t.length-1]}else l=(0,C.ZZX)(e,i);else if(c)l=(0,C.ZZX)(e,String(r),"saved");else{const t=(0,C.Vw0)(e,i,r);l=t?.lastMessageId}l&&t.focusMessage({chatId:i,threadId:r,messageListType:d,messageId:l,noHighlight:!0,noForumTopicPanel:!0,tabId:a})})),(0,w.aJ)("focusNextReply",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Xf0)(e,a);if(!o)return;const{chatId:n,threadId:i}=o,r=(0,C.jp_)(e,n,i,a);if(r&&0!==r.length){const s=r.pop();e=(0,S.n4t)(e,n,i,"replyStack",[...r],a),(0,w.UF)(e),t.focusMessage({chatId:n,threadId:i,messageId:s,tabId:a,noForumTopicPanel:!0})}else t.focusLastMessage({tabId:a})})),(0,w.aJ)("focusMessage",((e,t,s)=>{const{chatId:a,threadId:o=n.l3,messageListType:r="thread",noHighlight:d,groupedId:c,groupedChatId:l,replyMessageId:p,isResizingContainer:m,shouldReplaceHistory:g,noForumTopicPanel:I,quote:b,quoteOffset:v,scrollTargetPosition:y,timestamp:A,tabId:M=(0,u.g0)()}=s;let{messageId:k}=s;if(!(0,C.hds)(e,a))return void t.showNotification({message:(0,f.yE)("Conversation.ErrorInaccessibleMessage"),tabId:M});const F=A?()=>t.openMediaFromTimestamp({chatId:a,threadId:o,messageId:k,timestamp:A,tabId:M}):void 0;if(void 0!==c){const t=(0,C.VC8)(e,l,c);t?.length&&([k]=(0,h.oE)(t))}const P=(0,C.Xf0)(e,M),T=!P||a!==P.chatId||o!==P.threadId||r!==P.type;if(ht&&(clearTimeout(ht),ht=void 0),ht=window.setTimeout((()=>{e=(0,w.mS)(),e=(0,S.kV7)({global:e},M),e=(0,S.Xbp)(e,void 0,M),(0,w.UF)(e)}),d?ut:1500),e=(0,S.kV7)({global:e,chatId:a,messageId:k,threadId:o,noHighlight:d,isResizingContainer:m,quote:b,quoteOffset:v,scrollTargetPosition:y},M),e=(0,S.Xbp)(e,void 0,M),p){const t=(0,C.jp_)(e,a,o,M)||[];e=(0,S.n4t)(e,a,o,"replyStack",[...t,p],M)}T&&(e=(0,S.Xbp)(e,i.CC.Static,M));const U=(0,C.rA3)(e,a,o,M);if(U&&U.includes(k))return(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:a,threadId:o,type:r,shouldReplaceHistory:g,noForumTopicPanel:I,tabId:M}),void F?.();if(T&&(e=(0,S.n4t)(e,a,o,"viewportIds",void 0,M)),U&&!T){const t=k>U[0]?i.CC.Down:i.CC.Up;e=(0,S.Xbp)(e,t,M)}(0,it.o8)()&&(0,it.H$)(),(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:a,threadId:o,type:r,shouldReplaceHistory:g,noForumTopicPanel:I,tabId:M}),t.loadViewportMessages({chatId:a,threadId:o,tabId:M,shouldForceRender:!0,onLoaded:F})})),(0,w.aJ)("setShouldPreventComposerAnimation",((e,t,s)=>{const{shouldPreventComposerAnimation:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{shouldPreventComposerAnimation:a},o)})),(0,w.aJ)("openReplyMenu",((e,t,s)=>{const{fromChatId:a,messageId:o,quoteText:n,quoteOffset:i,tabId:r=(0,u.g0)()}=s;return(0,A.w)(e,{replyingMessage:{fromChatId:a,messageId:o,quoteText:n,quoteOffset:i},isShareMessageModalShown:!0},r)})),(0,w.aJ)("openForwardMenu",((e,t,s)=>{const{fromChatId:a,messageIds:o,storyId:n,groupedId:i,withMyScore:r,tabId:d=(0,u.g0)()}=s;let c;return i&&(c=(0,C.D_S)(e,a,i)),(0,A.w)(e,{forwardMessages:{fromChatId:a,messageIds:c||o,storyId:n,withMyScore:r},isShareMessageModalShown:!0},d)})),(0,w.aJ)("changeRecipient",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{forwardMessages:{...(0,C.nTw)(e,a).forwardMessages,toChatId:void 0,noAuthors:!1,noCaptions:!1},isShareMessageModalShown:!0},a)})),(0,w.aJ)("setForwardNoAuthors",((e,t,s)=>{const{noAuthors:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);return(0,A.w)(e,{forwardMessages:{...n.forwardMessages,noAuthors:a,noCaptions:a&&n.forwardMessages.noCaptions}},o)})),(0,w.aJ)("setForwardNoCaptions",((e,t,s)=>{const{noCaptions:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{forwardMessages:{...(0,C.nTw)(e,o).forwardMessages,noCaptions:a,noAuthors:a}},o)})),(0,w.aJ)("exitForwardMode",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,A.w)(e,{isShareMessageModalShown:!1,forwardMessages:{},replyingMessage:{}},a),(0,w.UF)(e)})),(0,w.aJ)("openForwardMenuForSelectedMessages",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages,r=i.filter((t=>{const s=(0,C.O5q)(e,n,t);return s&&(0,C.R4s)(e,s)}));r.length&&t.openForwardMenu({fromChatId:n,messageIds:r,tabId:a})})),(0,w.aJ)("cancelMediaDownload",((e,t,s)=>{const{media:a,tabId:o=(0,u.g0)()}=s,n=(0,v.VO)(a,"download");if(n)return(0,S.IwB)(e,[n],o)})),(0,w.aJ)("cancelMediaHashDownloads",((e,t,s)=>{const{mediaHashes:a,tabId:o=(0,u.g0)()}=s;return(0,S.IwB)(e,a,o)})),(0,w.aJ)("downloadMedia",((e,t,s)=>{const{media:a,originMessage:o,tabId:n=(0,u.g0)()}=s,i=(0,v.VO)(a,"download");if(!i)return;const r={size:"size"in a?a.size:0,format:(0,v.Cz)(a,"download"),filename:(0,v.sd)(a),originChatId:o?.chatId,originMessageId:o?.id};return(0,S.iRS)(e,i,r,n)})),(0,w.aJ)("downloadSelectedMessages",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages,{threadId:r}=(0,C.Xf0)(e,a)||{},d=(0,C.zeq)(e,n);d&&r&&i.map((e=>d[e])).filter((t=>(0,C.WAX)(e,t,r).canDownload)).forEach((e=>{const s=(0,v.ed)(e);s&&t.downloadMedia({media:s,originMessage:e,tabId:a})}))})),(0,w.aJ)("enterMessageSelectMode",((e,t,s)=>{const{messageId:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.meB)(e,o);return n?(0,S.l3i)(e,n.id,a,o):e})),(0,w.aJ)("toggleMessageSelection",((e,t,s)=>{const{messageId:a,groupedId:o,childMessageIds:n,withShift:i,tabId:r=(0,u.g0)()}=s,c=(0,C.Xf0)(e,r);if(!c)return;const{chatId:l,threadId:h,type:p}=c;e=(0,S.yrN)(e,l,h,p,a,o,n,i,r),(0,w.UF)(e),e.shouldShowContextMenuHint&&(t.disableContextMenuHint(),t.showNotification({message:`To **edit** or **reply**, close this menu. Then ${d.TF?"long tap":"right click"} on a message.`,tabId:r}))})),(0,w.aJ)("disableContextMenuHint",(e=>{if(e.shouldShowContextMenuHint)return{...e,shouldShowContextMenuHint:!1}})),(0,w.aJ)("exitMessageSelectMode",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,S.T4Z)(e,a)})),(0,w.aJ)("openPollModal",((e,t,s)=>{const{isQuiz:a,tabId:o=(0,u.g0)()}=s||{};return(0,A.w)(e,{pollModal:{isOpen:!0,isQuiz:a}},o)})),(0,w.aJ)("closePollModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{pollModal:{isOpen:!1}},a)})),(0,w.aJ)("checkVersionNotification",((e,t)=>{if(a.cOD&&Date.now()>Number(a.cOD)+2592e5)return;const s="10.9.52".split(".").slice(0,2).join("."),{serviceNotifications:o}=e;if(o.find((({version:e})=>e===s)))return;const n={chatId:a.zv8,date:(0,P.Fm)(),content:{text:(0,rt.Ay)("**Telegram Web A Digest**\n\nMany new features and useful optimizations have been added in recent months. Here is a brief overview of what's been happening in Web A since August.\n\n**September – November** \n\n✏️ __General__\n• [Reply Revolution](https://telegram.org/blog/reply-revolution#reply-revolution) – the app learned to quote specific parts of any message, making your responses 100% precise.\n• Also, [Quote Formatting](https://telegram.org/blog/reply-revolution#quote-formatting) have arrived.\n\n📣 __Channels__\n• Channels added [boosts](https://telegram.org/blog/channel-stories#stories-for-channels) and [giveaways.](https://telegram.org/blog/giveaways#free-telegram-premium) \n• Users also got an option to reassign their boosts between channels.\n\n🌄 __Stories__\n• Numerous improvements have been made to the animations flow, ensuring the stories bar expands more smoothly. Additionally, a package of optimizations has been added to enhance the performance of stories on mobile devices.\n• Stories have been introduced for [channels,](https://telegram.org/blog/channel-stories#stories-for-channels) and the story viewer has been updated with new gestures to expand and reply.\n\n⚙️ __Settings__\n• The app has added an option, 'Who can find me by phone number,' along with a setting under 'Privacy and Security' to manage the visibility of your bio.\n\n✨ __Extra__\n• Some further improvements have been made to the Mini Apps area.\n• New security notifications have been added to the chat list to alert you when your account is logged into from a new device.\n• New design for code blocks formatting.\n\n**December – February**\n\n✏️ __General__\n• [Saved Messages 2.0](https://telegram.org/blog/new-saved-messages-and-9-more#saved-messages-2-0) – including tags, My Notes, Replies and forwards from hidden authors.\n• [One-Time Voice Messages](https://telegram.org/blog/new-saved-messages-and-9-more#one-time-voice-and-video-messages) including both listening and recording. Added support for viewing One-Time Video Messages.\n• [Read-Time in Private Chats](https://telegram.org/blog/new-saved-messages-and-9-more#read-time-in-private-chats)\n• You can now replace media when editing messages.\n• The app learned to [preserve the selected mode](https://telegram.org/blog/similar-channels#improvements-for-topics) for topics in groups.\n• Whenever you create a small group, Web A suggests a name for it based on users' name you have added.\n\n📣 __Channels__ \n• Added [custom channel reactions.](https://telegram.org/blog/similar-channels#custom-reactions-for-channels)\n• Implemented [channel stories stats.](https://telegram.org/blog/similar-channels#story-stats-for-channels)\n• Channel emoji statuses.\n• [Similar Channels.](https://telegram.org/blog/similar-channels#similar-channels)\n\n👥 __Groups__\n• [9 new features for groups.](https://telegram.org/blog/february2024)\n\n🤖 __Bots__\n• Edit your bots info right from their profile.\n\n🌄 __Stories__\n• Added support for [forwarded stories](https://telegram.org/blog/posts-in-stories-and-more#view-reposts-and-more) and [channel posts in stories.](https://telegram.org/blog/posts-in-stories-and-more#share-posts-in-stories)\n\n✨ __Extra__\n• Giveaway Improvements: displaying winners list and additional prizes.\n\n**March**\n\n📣 __Channels__ \n• Admins will soon be able to launch giveaways in their channels.\n\n✨ __Extra__\n• Added support for Emoji v15.1.\n• Some design enhancements for shared contacts, links preview and more.\n",!0)},isOutgoing:!1};t.createServiceNotification({message:n,version:s})})),(0,w.aJ)("createServiceNotification",((e,t,s)=>{const{message:o,version:n}=s,{serviceNotifications:i}=e,r=Math.max((0,C.ZZX)(e,a.zv8)||0,...i.map((({id:e})=>e))),d=(i.length+1)/1e3,c=Math.floor(r)+d;o.previousLocalId=o.id,o.id=c;const l={id:c,message:o,version:n,isUnread:!0};e={...e,serviceNotifications:[...i.slice(-1e3),l]},(0,w.UF)(e),t.apiUpdate({"@type":"newMessage",id:o.id,chatId:o.chatId,message:o})})),(0,w.aJ)("openReactorListModal",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{reactorModal:{chatId:a,messageId:o}},n)})),(0,w.aJ)("closeReactorListModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{reactorModal:void 0},a)})),(0,w.aJ)("openSeenByModal",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{seenByModal:{chatId:a,messageId:o}},n)})),(0,w.aJ)("closeSeenByModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{seenByModal:void 0},a)})),(0,w.aJ)("openPrivacySettingsNoticeModal",((e,t,s)=>{const{chatId:a,isReadDate:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{privacySettingsNoticeModal:{chatId:a,isReadDate:o}},n)})),(0,w.aJ)("closePrivacySettingsNoticeModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{privacySettingsNoticeModal:void 0},a)})),(0,w.aJ)("openChatLanguageModal",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=o?(0,C.Rny)(e,a,o,n):(0,C.qZq)(e,a,n);return(0,A.w)(e,{chatLanguageModal:{chatId:a,messageId:o,activeLanguage:i}},n)})),(0,w.aJ)("closeChatLanguageModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{chatLanguageModal:void 0},a)})),(0,w.aJ)("copySelectedMessages",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages;pt(e,n,i)})),(0,w.aJ)("copyMessagesByIds",((e,t,s)=>{const{messageIds:a,tabId:o=(0,u.g0)()}=s,n=(0,C.meB)(e,o);a&&0!==a.length&&n&&pt(e,n.id,a)})),(0,w.aJ)("openOneTimeMediaModal",((e,t,s)=>{const{message:a,tabId:o=(0,u.g0)()}=s;e=(0,A.w)(e,{oneTimeMediaModal:{message:a}},o),(0,w.UF)(e)})),(0,w.aJ)("closeOneTimeMediaModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};e=(0,A.w)(e,{oneTimeMediaModal:void 0},a),(0,w.UF)(e)})),(0,w.aJ)("closeReportAdModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{reportAdModal:void 0},a)})),(0,w.aJ)("closeReportModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{reportModal:void 0},a)})),(0,w.aJ)("openPreviousReportAdModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).reportAdModal;if(o){if(1!==o.sections.length)return(0,A.w)(e,{reportAdModal:{...o,sections:o.sections.slice(0,-1)}},a);t.closeReportAdModal({tabId:a})}})),(0,w.aJ)("openPreviousReportModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).reportModal;if(o){if(1!==o.sections.length)return(0,A.w)(e,{reportModal:{...o,sections:o.sections.slice(0,-1)}},a);t.closeReportModal({tabId:a})}})),(0,w.aJ)("openPaidReactionModal",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{paidReactionModal:{chatId:a,messageId:o}},n)})),(0,w.aJ)("closePaidReactionModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{paidReactionModal:void 0},a)})),(0,w.aJ)("openDeleteMessageModal",((e,t,s)=>{const{chatId:a,messageIds:o,isSchedule:n,tabId:i=(0,u.g0)()}=s;e=(0,w.mS)(),e=(0,A.w)(e,{deleteMessageModal:{chatId:a,messageIds:o,isSchedule:n}},i),(0,w.UF)(e)})),(0,w.aJ)("closeDeleteMessageModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{deleteMessageModal:void 0},a)})),(0,w.aJ)("openAboutAdsModal",((e,t,s)=>{const{randomId:a,additionalInfo:o,canReport:n,sponsorInfo:i,tabId:r=(0,u.g0)()}=s||{};return(0,A.w)(e,{aboutAdsModal:{randomId:a,canReport:n,additionalInfo:o,sponsorInfo:i}},r)})),(0,w.aJ)("closeAboutAdsModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{aboutAdsModal:void 0},a)})),(0,w.aJ)("closePreparedInlineMessageModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{preparedMessageModal:void 0},a)})),(0,w.aJ)("closeSharePreparedMessageModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{sharePreparedMessageModal:void 0},a)})),(0,w.aJ)("updateSharePreparedMessageModalSendArgs",(async(e,t,s)=>{const{args:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);if(!n.sharePreparedMessageModal)return;if(!a)return e=(0,A.w)(e,{sharePreparedMessageModal:{...n.sharePreparedMessageModal,pendingSendArgs:void 0}},o),void(0,w.UF)(e);const i=await ne(e,a.peerId);e=(0,w.mS)(),e=(0,A.w)(e,{sharePreparedMessageModal:{...n.sharePreparedMessageModal,pendingSendArgs:{peerId:a.peerId,threadId:a.threadId,starsForSendMessage:i}}},o),(0,w.UF)(e)})),(0,w.aJ)("setGlobalSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s,{chatId:n,currentContent:r}=(0,C.nTw)(e,o).globalSearch,d=a&&r!==i.$C.BotApps?{chats:!n,messages:!0}:void 0;return(0,S.b8O)(e,{globalResults:{},localResults:{},resultsByType:void 0,fetchingStatus:d,query:a},o)})),(0,w.aJ)("setGlobalSearchClosing",((e,t,s)=>{const{tabId:a=(0,u.g0)(),isClosing:o}=s||{};return(0,S.b8O)(e,{isClosing:o},a)})),(0,w.aJ)("addRecentlyFoundChatId",((e,t,s)=>{const{id:a}=s,{recentlyFoundChatIds:o}=e;if(!o)return{...e,recentlyFoundChatIds:[a]};const n=o.filter((e=>e!==a));return n.unshift(a),n.length>10&&n.pop(),{...e,recentlyFoundChatIds:n}})),(0,w.aJ)("clearRecentlyFoundChats",(e=>({...e,recentlyFoundChatIds:void 0}))),(0,w.aJ)("setGlobalSearchContent",((e,t,s)=>{const{content:a,tabId:o=(0,u.g0)()}=s;return(0,S.GQ)(e,a,o)})),(0,w.aJ)("setGlobalSearchChatId",((e,t,s)=>{const{id:a,tabId:o=(0,u.g0)()}=s;return(0,S.b8O)(e,{chatId:a,query:void 0,resultsByType:void 0},o)})),(0,w.aJ)("openMiddleSearch",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(o&&n)return(0,S.$RI)(e,o,n,{},a)})),(0,w.aJ)("closeMiddleSearch",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(o&&n)return(0,S._54)(e,o,n,a)})),(0,w.aJ)("updateMiddleSearch",((e,t,s)=>{const{update:a,tabId:o=(0,u.g0)()}=s;let i,r;if(s.chatId)i=s.chatId,r=s.threadId||n.l3;else{const t=(0,C.Xf0)(e,o);if(!t)return;i=t.chatId,r=t.threadId}return(0,S.$RI)(e,i,r,a,o)})),(0,w.aJ)("resetMiddleSearch",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,a)||{};if(o&&n)return(0,S.zde)(e,o,n,a)})),(0,w.aJ)("setSharedMediaSearchType",((e,t,s)=>{const{mediaType:a,tabId:o=(0,u.g0)()}=s,{chatId:n,threadId:i}=(0,C.Xf0)(e,o)||{};if(n&&i)return(0,S.Tu_)(e,n,i,a,o)})),(0,w.aJ)("setStickerSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{stickerSearch:{query:a,resultIds:void 0}},o)})),(0,w.aJ)("setGifSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{gifSearch:{query:a,offset:void 0,results:void 0}},o)})),(0,w.aJ)("openFrozenAccountModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{isFrozenAccountModalOpen:!0},a)})),(0,w.aJ)("closeFrozenAccountModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{isFrozenAccountModalOpen:!1},a)})),(0,w.aJ)("openDeleteAccountModal",((e,t,s)=>{const{days:a,tabId:o=(0,u.g0)()}=s||{};a&&(e=(0,A.w)(e,{...(0,C.nTw)(e,o),deleteAccountModal:{selfDestructAccountDays:a}},o),(0,w.UF)(e))})),(0,w.aJ)("closeDeleteAccountModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{deleteAccountModal:void 0},a)})),(0,w.aJ)("setUserSearchQuery",((e,t,s)=>{const{query:a,tabId:o=(0,u.g0)()}=s;return(0,S.BFh)(e,{globalUserIds:void 0,localUserIds:void 0,fetchingStatus:Boolean(a),query:a},o)})),(0,w.aJ)("openAddContactDialog",((e,t,s)=>{const{userId:a,tabId:o=(0,u.g0)()}=s;return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:o}),e):(0,A.w)(e,{newContact:{userId:a}},o)})),(0,w.aJ)("openNewContactDialog",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:a}),e):(0,A.w)(e,{newContact:{isByPhoneNumber:!0}},a)})),(0,w.aJ)("closeNewContactDialog",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,S.BOn)(e,a)})),(0,w.aJ)("closeSuggestedStatusModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{suggestedStatusModal:void 0},a)})),mt("closeChatRefundModal","chatRefundModal"),s(11117);var gt=s(14235);const ft=/^\d+\.\d+(\.\d+)?$/;var It=s(99375);function bt(e){document.querySelectorAll('link[rel="icon"], link[rel="alternate icon"]').forEach((t=>{e?t.href.includes("favicon-unread")||(t.href=t.href.replace("favicon","favicon-unread")):t.href=t.href.replace("favicon-unread","favicon")}))}function vt(e){d.cp?window.electron.setWindowTitle(e):document.title!==e&&(document.title=e)}const yt=(0,I.sg)(vt,200,!1);let wt,St;(0,w.aJ)("toggleChatInfo",((e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s||{},n=void 0!==a?a:!(0,C.nTw)(e,o).isChatInfoShown;return e=(0,A.w)(e,{isChatInfoShown:n},o),{...e,lastIsChatInfoShown:n}})),(0,w.aJ)("setLeftColumnWidth",((e,t,s)=>{const{leftColumnWidth:a}=s;return{...e,leftColumnWidth:a}})),(0,w.aJ)("resetLeftColumnWidth",(e=>({...e,leftColumnWidth:void 0}))),(0,w.aJ)("toggleManagement",((e,t,s)=>{const{force:a,tabId:o=(0,u.g0)()}=s||{},{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.nTw)(e,o);return(0,A.w)(e,{management:{byChatId:{...i.management.byChatId,[n]:{...i.management.byChatId[n],isActive:void 0!==a?a:!(i.management.byChatId[n]||{}).isActive}}}},o)})),(0,w.aJ)("requestNextManagementScreen",((e,t,s)=>{const{screen:a,tabId:o=(0,u.g0)()}=s||{},{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.nTw)(e,o);return(0,A.w)(e,{management:{byChatId:{...i.management.byChatId,[n]:{...i.management.byChatId[n],isActive:!0,nextScreen:a}}}},o)})),(0,w.aJ)("closeManagement",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{};if(!o)return;const n=(0,C.nTw)(e,a);return(0,A.w)(e,{management:{byChatId:{...n.management.byChatId,[o]:{...n.management.byChatId[o],isActive:!1}}}},a)})),(0,w.aJ)("processOpenChatOrThread",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;if((0,L.Ny)()||(0,L.Bb)())return(0,A.w)(e,{isLeftColumnShown:0===(0,C.nTw)(e,a).messageLists.length},a)})),(0,w.aJ)("resetNextProfileTab",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{chatId:o}=(0,C.Xf0)(e,a)||{};if(o)return(0,A.w)(e,{nextProfileTab:void 0,forceScrollProfileTab:!1},a)})),(0,w.aJ)("toggleStatistics",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{isStatisticsShown:!o.isStatisticsShown,statistics:{...o.statistics,currentMessageId:void 0,currentStoryId:void 0}},a)})),(0,w.aJ)("toggleMessageStatistics",((e,t,s)=>{const{tabId:a=(0,u.g0)(),messageId:o}=s||{};return(0,A.w)(e,{statistics:{...(0,C.nTw)(e,a).statistics,currentMessageId:o,currentStoryId:void 0}},a)})),(0,w.aJ)("toggleStoryStatistics",((e,t,s)=>{const{tabId:a=(0,u.g0)(),storyId:o}=s||{};return(0,A.w)(e,{statistics:{...(0,C.nTw)(e,a).statistics,currentStoryId:o,currentMessageId:void 0}},a)})),(0,w.aJ)("toggleLeftColumn",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{isLeftColumnShown:!(0,C.nTw)(e,a).isLeftColumnShown},a)})),(0,w.aJ)("addRecentEmoji",((e,t,s)=>{const{emoji:a}=s,{recentEmojis:o}=e;if(!o)return{...e,recentEmojis:[a]};const n=o.filter((e=>e!==a));return n.unshift(a),n.length>32&&n.pop(),{...e,recentEmojis:n}})),(0,w.aJ)("addRecentSticker",((e,t,s)=>{const{sticker:a}=s,{recent:o}=e.stickers;if(!o)return{...e,stickers:{...e.stickers,recent:{hash:"0",stickers:[a]}}};const n=o.stickers.filter((e=>e.id!==a.id));return n.unshift(a),{...e,stickers:{...e.stickers,recent:{...o,stickers:n}}}})),(0,w.aJ)("addRecentCustomEmoji",((e,t,s)=>{const{documentId:a}=s,{recentCustomEmojis:o}=e;if(!o)return{...e,recentCustomEmojis:[a]};const n=o.filter((e=>e!==a));return n.unshift(a),n.length>32&&n.pop(),{...e,recentCustomEmojis:n}})),(0,w.aJ)("clearRecentCustomEmoji",(e=>({...e,recentCustomEmojis:[]}))),(0,w.aJ)("reorderStickerSets",((e,t,s)=>{const{order:a,isCustomEmoji:o}=s;return{...e,stickers:{...e.stickers,added:{setIds:o?e.stickers.added.setIds:a}},customEmojis:{...e.customEmojis,added:{setIds:o?a:e.customEmojis.added.setIds}}}})),(0,w.aJ)("showNotification",((e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s,n=o.localId;o.localId||=(0,gt.A)();const i=[...(0,C.nTw)(e,a).notifications],r=i.findIndex((e=>n?e.localId===o.localId:e.message===o.message));return-1!==r&&i.splice(r,1),i.push(o),(0,A.w)(e,{notifications:i},a)})),(0,w.aJ)("showAllowedMessageTypesNotification",((e,t,s)=>{const{chatId:a,messageListType:o,tabId:n=(0,u.g0)()}=s;if((0,C.WA9)(e,a)&&"scheduled"===o)return void t.showNotification({message:{key:"DescriptionScheduledPaidMessagesNotAllowed"},tabId:n});const i=(0,C.hds)(e,a);if(!i)return;const r=(0,C.AWZ)(e,a),{canSendPlainText:d,canSendPhotos:c,canSendVideos:l,canSendDocuments:p,canSendAudios:m,canSendStickers:g,canSendRoundVideos:I,canSendVoices:b}=(0,v.Q_)(i,r),y=(0,h.oE)([d?"Chat.SendAllowedContentTypeText":void 0,c?"Chat.SendAllowedContentTypePhoto":void 0,l?"Chat.SendAllowedContentTypeVideo":void 0,b?"Chat.SendAllowedContentTypeVoiceMessage":void 0,I?"Chat.SendAllowedContentTypeVideoMessage":void 0,p?"Chat.SendAllowedContentTypeFile":void 0,m?"Chat.SendAllowedContentTypeMusic":void 0,g?"Chat.SendAllowedContentTypeSticker":void 0]).map((e=>f.yE(e)));if(!y.length)return void t.showNotification({message:f.yE("Chat.SendNotAllowedText"),tabId:n});const w=f.yE("AutoDownloadSettings.LastDelimeter"),S=y.join(", ").replace(/,([^,]*)$/,`${w}$1`);t.showNotification({message:f.yE("Chat.SendAllowedContentText",S),tabId:n})})),(0,w.aJ)("dismissNotification",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,o=(0,C.nTw)(e,a).notifications.filter((({localId:e})=>e!==s.localId));return(0,A.w)(e,{notifications:o},a)})),(0,w.aJ)("showDialog",((e,t,s)=>{const{data:a,tabId:o=(0,u.g0)()}=s;if("message"in a&&a.hasErrorKey&&!(0,It.Ay)(a))return e;const n=[...(0,C.nTw)(e,o).dialogs];if("message"in a){const e=n.findIndex((e=>e.message===a.message));-1!==e&&n.splice(e,1)}return n.push(a),(0,A.w)(e,{dialogs:n},o)})),(0,w.aJ)("dismissDialog",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=[...(0,C.nTw)(e,a).dialogs];return o.pop(),(0,A.w)(e,{dialogs:o},a)})),(0,w.aJ)("toggleSafeLinkModal",((e,t,s)=>{const{url:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{safeLinkModalUrl:a},o)})),(0,w.aJ)("openHistoryCalendar",((e,t,s)=>{const{selectedAt:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{historyCalendarSelectedAt:a},o)})),(0,w.aJ)("closeHistoryCalendar",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{historyCalendarSelectedAt:void 0},a)})),(0,w.aJ)("openGame",((e,t,s)=>{const{url:a,chatId:o,messageId:n,tabId:i=(0,u.g0)()}=s,r=(0,C.O5q)(e,o,n);if(!r)return;const d=r.viaBotId||(0,C.Y7C)(e,r)?.id;if(d){if(!(0,C.nTL)(e,d))return e=(0,A.w)(e,{botTrustRequest:{botId:d,type:"game",onConfirm:{action:"openGame",payload:s}}},i),void(0,w.UF)(e);e=(0,A.w)(e,{openedGame:{url:a,chatId:o,messageId:n}},i),(0,w.UF)(e)}})),(0,w.aJ)("closeGame",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{openedGame:void 0},a)})),(0,w.aJ)("requestConfetti",((e,t,s)=>{const{tabId:a=(0,u.g0)(),...o}=s;if((0,C.PKK)(e))return(0,A.w)(e,{confetti:{lastConfettiTime:Date.now(),...o}},a)})),(0,w.aJ)("requestWave",((e,t,s)=>{const{startX:o,startY:n,tabId:i=(0,u.g0)()}=s;if(!d.J6||!(0,C.PKK)(e))return;const r=(0,C.nTw)(e,i),c=r.wave?.lastWaveTime||0;return Date.now()-c<a.S4O?void 0:(0,A.w)(e,{wave:{lastWaveTime:Date.now(),startX:o,startY:n}},i)})),(0,w.aJ)("updateAttachmentSettings",((e,t,s)=>{const{shouldCompress:a,shouldSendGrouped:o,isInvertedMedia:n,webPageMediaSize:i}=s;return{...e,attachmentSettings:{shouldCompress:a??e.attachmentSettings.shouldCompress,shouldSendGrouped:o??e.attachmentSettings.shouldSendGrouped,isInvertedMedia:n,webPageMediaSize:i}}})),(0,w.aJ)("requestEffectInComposer",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;return(0,A.w)(e,{shouldPlayEffectInComposer:!0},a)})),(0,w.aJ)("hideEffectInComposer",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s;return(0,A.w)(e,{shouldPlayEffectInComposer:void 0},a)})),(0,w.aJ)("setPaidMessageAutoApprove",(e=>({...e,settings:{...e.settings,byKey:{...e.settings.byKey,shouldPaidMessageAutoApprove:!0}}}))),(0,w.aJ)("setReactionEffect",((e,t,s)=>{const{chatId:a,threadId:o,reaction:n,tabId:i=(0,u.g0)()}=s,r="emoji"===n?.type&&n.emoticon;if(!r)return;const d=Object.values(e.availableEffectById).find((e=>e.effectAnimationId&&e.emoticon===r)),c=d?.id,l=(0,C.g29)(e);!d?.isPremium||l?c&&(t.requestEffectInComposer({tabId:i}),t.saveEffectInDraft({chatId:a,threadId:o,effectId:c})):t.openPremiumModal({initialSection:"effects",tabId:i})})),(0,w.aJ)("openLimitReachedModal",((e,t,s)=>{const{limit:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{limitReachedModal:{limit:a}},o)})),(0,w.aJ)("closeLimitReachedModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{limitReachedModal:void 0},a)})),(0,w.aJ)("closeStickerSetModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{openedStickerSetShortName:void 0},a)})),(0,w.aJ)("openCustomEmojiSets",((e,t,s)=>{const{setIds:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{openedCustomEmojiSetIds:a},o)})),(0,w.aJ)("closeCustomEmojiSets",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{openedCustomEmojiSetIds:void 0},a)})),(0,w.aJ)("updateLastRenderedCustomEmojis",((e,t,s)=>{const{ids:o}=s,{lastRendered:n}=e.customEmojis;return{...e,customEmojis:{...e.customEmojis,lastRendered:(0,h.Am)([...n,...o]).slice(0,a.GW0)}}})),(0,w.aJ)("openCreateTopicPanel",((e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;return(0,C.meB)(e,o)||t.openChat({id:a,tabId:o}),(0,A.w)(e,{createTopicPanel:{chatId:a}},o)})),(0,w.aJ)("closeCreateTopicPanel",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{createTopicPanel:void 0},a)})),(0,w.aJ)("openEditTopicPanel",((e,t,s)=>{const{chatId:a,topicId:o,tabId:n=(0,u.g0)()}=s;return(0,C.meB)(e,n)||t.openChat({id:a,tabId:n}),(0,A.w)(e,{editTopicPanel:{chatId:a,topicId:o}},n)})),(0,w.aJ)("closeEditTopicPanel",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{editTopicPanel:void 0},a)})),(0,w.aJ)("updateArchiveSettings",((e,t,s)=>{const{archiveSettings:a}=e,{isHidden:o=a.isHidden,isMinimized:n=a.isMinimized}=s;return{...e,archiveSettings:{isHidden:o,isMinimized:n}}})),(0,w.aJ)("openMapModal",((e,t,s)=>{const{geoPoint:a,zoom:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{mapModal:{point:a,zoom:o}},n)})),(0,w.aJ)("closeMapModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{mapModal:void 0},a)})),(0,w.aJ)("checkAppVersion",(e=>{fetch(`version.txt?${Date.now()}`).then((e=>e.text())).then((t=>{(function(e,t){const s=e.trim();return!!ft.test(s)&&s!==t})(t=t.trim(),"10.9.52")&&(e=(0,w.mS)(),e={...e,isAppUpdateAvailable:!0},(0,w.UF)(e))})).catch((e=>{a.Oig&&console.error("[checkAppVersion failed] ",e)}))})),(0,w.aJ)("setIsElectronUpdateAvailable",((e,t,s)=>{e=(0,w.mS)(),e={...e,isElectronUpdateAvailable:Boolean(s.isAvailable)},(0,w.UF)(e)})),(0,w.aJ)("afterHangUp",(e=>{(0,C.nTw)(e,(0,u.g0)()).multitabNextAction&&(0,u.I)()})),(0,w.aJ)("onTabFocusChange",((e,t,s)=>{const{isBlurred:a,tabId:o=(0,u.g0)()}=s;return a?(wt&&clearInterval(wt),wt=window.setInterval((()=>{t.updatePageTitle({tabId:o})}),500)):(clearInterval(wt),wt=void 0),e=(0,A.w)(e,{isBlurred:a},o),{...e,initialUnreadNotifications:a?(0,Pe.vp)():void 0}})),(0,w.aJ)("updatePageTitle",((e,t,s)=>{const{tabId:o=(0,u.g0)()}=s||{},{canDisplayChatInTitle:n}=(0,We.l)(e),i=e.currentUserId,r=e.config?.isTestServer,c=r?"[T] ":"";if(document.title.includes(a.LaL))return bt(!1),void vt(`${c}${a.j0M} ${a.LaL}`);if(e.initialUnreadNotifications&&Math.round(Date.now()/1e3)%2==0){const t=(0,Pe.vp)()-e.initialUnreadNotifications;if(t>0)return vt(`${c}${t} notification${t>1?"s":""}`),void bt(!0)}bt(!1);const l=(0,C.Xf0)(e,o);if(l&&n&&!e.passcode.isScreenLocked){const{chatId:t,threadId:s}=l,a=(0,C.hds)(e,t);if(a){const o=(0,v.Js)(f.yE,a,t===i),n=(0,C.S0q)(e,t,s);return a.isForum&&n?void yt(`${c}${o} › ${n.title}`):void yt(`${c}${o}`)}}vt(d.cp?"":`${c}${a.j0M}`)})),(0,w.aJ)("closeInviteViaLinkModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s??{};return(0,A.w)(e,{inviteViaLinkModal:void 0},a)})),(0,w.aJ)("closeCollectibleInfoModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s??{};return(0,A.w)(e,{collectibleInfoModal:void 0},a)})),(0,w.aJ)("setShouldCloseRightColumn",((e,t,s)=>{const{value:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{shouldCloseRightColumn:a},o)})),(0,w.aJ)("refreshLangPackFromCache",((e,t,s)=>{(0,m.K1)(s.langCode)})),(0,w.aJ)("processPremiumFloodWait",((e,t,s)=>{const{isUpload:a}=s,{bandwidthPremiumDownloadSpeedup:o,bandwidthPremiumUploadSpeedup:n,bandwidthPremiumNotifyPeriod:i}=e.appConfig||{},{lastPremiumBandwithNotificationDate:r}=e.settings;if(o&&n&&i&&!(r&&Date.now()<r+1e3*i))return Object.values(e.byTabId).filter((e=>!e.isBlurred)).map((e=>e.id)).forEach((e=>{t.showNotification({title:f.yE(a?"UploadSpeedLimited":"DownloadSpeedLimited"),message:f.yE(a?"UploadSpeedLimitedMessage":"DownloadSpeedLimitedMessage",a?n:o),duration:6e3,tabId:e})})),{...e,settings:{...e.settings,lastPremiumBandwithNotificationDate:Date.now()}}}));let At,Ct=0;(0,Fe.DW)((e=>{const{updatePageTitle:t,updateIsOnline:s}=(0,w.ko)(),a=e.passcode.isScreenLocked!==St,o=Object.values(e.byTabId).filter((e=>e.isBlurred)).length,n=(0,C.nTw)(e,(0,u.g0)()).isMasterTab;a&&t(),o!==Ct&&n&&(At&&clearTimeout(At),At=window.setTimeout((()=>{e=(0,w.mS)();const t=Object.values(e.byTabId).filter((e=>e.isBlurred)).length;s({isOnline:t!==(0,u.gb)().length})}),100)),St=e.passcode.isScreenLocked,Ct=o})),(0,w.aJ)("persistExpandedState",((e,t,s)=>{const{id:a,isExpanded:o}=s,n={...e.expandedState,[a]:o};e={...e,expandedState:n},(0,w.UF)(e)})),(0,w.aJ)("closePaymentModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a).payment.status||"cancelled",n=(0,C.nTw)(e,a).starsBalanceModal;return t.processOriginStarsPayment({originData:n,status:o,tabId:a}),e=(0,S.GSI)(e,a),(0,S._$X)(e,{status:o},a)})),(0,w.aJ)("resetPaymentStatus",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return e=(0,S._$X)(e,{status:void 0},a),(0,S.nv6)(e,{status:void 0},a)})),(0,w.aJ)("addPaymentError",((e,t,s)=>{const{error:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:a}},o)})),(0,w.aJ)("closeGiveawayModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{giveawayModal:void 0},a)})),(0,w.aJ)("closeGiftCodeModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{giftCodeModal:void 0},a)})),(0,w.aJ)("updateGiftProfileFilter",((e,t,s)=>{const{filter:a,peerId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,n),r=i.savedGifts.filter;let d={...r,...a};d.shouldIncludeUnlimited||d.shouldIncludeLimited||d.shouldIncludeUnique||(d={...r,shouldIncludeUnlimited:!0,shouldIncludeLimited:!0,shouldIncludeUnique:!0,...a}),d.shouldIncludeDisplayed||d.shouldIncludeHidden||(d={...r,shouldIncludeDisplayed:!0,shouldIncludeHidden:!0,...a}),e=(0,A.w)(e,{savedGifts:{...i.savedGifts,giftsByPeerId:{[o]:i.savedGifts.giftsByPeerId[o]},filter:d}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:i.id})})),(0,w.aJ)("resetGiftProfileFilter",((e,t,s)=>{const{peerId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.nTw)(e,n);e=(0,A.w)(e,{savedGifts:{...i.savedGifts,giftsByPeerId:{[o]:i.savedGifts.giftsByPeerId[o]},filter:{...a.tBS}}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:i.id})})),(0,w.aJ)("openPaymentMessageConfirmDialogOpen",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{isPaymentMessageConfirmDialogOpen:!0},a)})),(0,w.aJ)("closePaymentMessageConfirmDialogOpen",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{isPaymentMessageConfirmDialogOpen:!1},a)}));var Mt=s(12859);(0,w.aJ)("openMediaViewer",((e,t,s)=>{const{chatId:a,threadId:o=n.l3,messageId:i,timestamp:r,mediaIndex:d,isAvatarView:c,isSponsoredMessage:l,origin:h,withDynamicLoading:p,standaloneMedia:m,tabId:g=(0,u.g0)()}=s,f=(0,C.nTw)(e,g);return(0,A.w)(e,{mediaViewer:{...f.mediaViewer,chatId:a,threadId:o,messageId:i,mediaIndex:d||0,isAvatarView:c,isSponsoredMessage:l,origin:h,standaloneMedia:m,isHidden:!1,withDynamicLoading:p,timestamp:r},forwardMessages:{},isShareMessageModalShown:!1},g)})),(0,w.aJ)("closeMediaViewer",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{volume:o,isMuted:n,playbackRate:i,isHidden:r}=(0,C.nTw)(e,a).mediaViewer;return(0,A.w)(e,{mediaViewer:{volume:o,isMuted:n,isHidden:r,playbackRate:i}},a)})),(0,w.aJ)("openMediaFromTimestamp",((e,t,s)=>{const{chatId:a,messageId:o,threadId:n,timestamp:r,tabId:d=(0,u.g0)()}=s,c=(0,C.O5q)(e,a,o);if(!c)return;const l=(0,T.Q)(c),h=(0,C.gMr)(e,c),p=(0,v.Dk)(c),m=p?.duration;if(m){if(m<=r)return;return"video"===p.mediaType?void t.openMediaViewer({chatId:a,messageId:o,threadId:n,origin:i.TQ.Inline,timestamp:r,tabId:d}):void t.openAudioPlayer({chatId:a,messageId:o,threadId:n,origin:i.d9.Inline,timestamp:r,tabId:d})}const g=h?(0,v.Dk)(h):void 0,f=g?.duration;!f||f<=r||("video"!==g.mediaType?t.openAudioPlayer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:i.d9.Inline,timestamp:r,tabId:d}):t.openMediaViewer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:i.TQ.Inline,timestamp:r,tabId:d}))})),(0,w.aJ)("updateLastPlaybackTimestamp",((e,t,s)=>{const{chatId:a,messageId:o,timestamp:n}=s,i=e.messages.playbackByChatId[a]?.byId||{};return n?{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[a]:{byId:{...i,[o]:n}}}}}:{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[a]:{byId:(0,h.cJ)(i,[o])}}}}})),(0,w.aJ)("setMediaViewerVolume",((e,t,s)=>{const{volume:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,volume:a,isMuted:!1}},o)})),(0,w.aJ)("setMediaViewerPlaybackRate",((e,t,s)=>{const{playbackRate:a,tabId:o=(0,u.g0)()}=s;return e={...e,mediaViewer:{...e.mediaViewer,lastPlaybackRate:a}},(0,A.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,playbackRate:a}},o)})),(0,w.aJ)("setMediaViewerMuted",((e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isMuted:a}},o)})),(0,w.aJ)("setMediaViewerHidden",((e,t,s)=>{const{isHidden:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isHidden:a}},o)}));var kt=s(70934),Ft=s(57751),Pt=s(42385),Tt=s(20714);let Ut=!1;(0,I.yu)((()=>{const e=(0,w.mS)();e.isInited&&e.passcode.hasPasscode&&!Ut&&1===Object.keys(e.byTabId).length&&(0,Ft.rE)()})),(0,w.aJ)("setPasscode",(async(e,t,s)=>{const{passcode:a,tabId:o=(0,u.g0)()}=s;e=(0,S.Vg3)(e,{isLoading:!0}),(0,w.UF)(e),await(0,kt.IG)(a);const n=JSON.stringify({...(0,Ft.CX)(),userId:e.currentUserId});e=(0,w.mS)();const r=(0,Pt.Mm)((0,S.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}));try{await(0,kt.yp)(n,r),(0,u.ZQ)(),e=(0,w.mS)(),e=(0,S.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}),(0,w.UF)(e),(0,Pt.Bo)(!0)}catch(s){(0,kt.m)(),e=(0,w.mS)(),e=(0,S.Vg3)(e,{isLoading:!1}),(0,w.UF)(e),t.showNotification({message:"Failed to set passcode",tabId:o}),t.openSettingsScreen({screen:i.VS.PasscodeDisabled,tabId:o})}})),(0,w.aJ)("clearPasscode",(e=>((0,kt.WN)(),localStorage.removeItem(a.ozB),(0,S.XQb)(e)))),(0,w.aJ)("unlockScreen",((e,t,s)=>{const a=Object.values(e.byTabId),{sessionJson:o,globalJson:n}=s,i=JSON.parse(o);(0,Ft.AA)(i);const r=e;(e=JSON.parse(n)).byTabId=r.byTabId,(0,Pt.e)(e,(0,h.mg)(Tt.HB)),e=(0,S.Vg3)(e,{isScreenLocked:!1,error:void 0,invalidAttemptsCount:0}),(0,w.UF)(e),(0,u.ZQ)(),a.forEach((({id:e,isMasterTab:s})=>t.init({tabId:e,isMasterTab:s}))),t.initApi()})),(0,w.aJ)("logInvalidUnlockAttempt",(e=>{const t=(e.passcode?.invalidAttemptsCount??0)+1;return(0,S.Vg3)(e,{invalidAttemptsCount:t,timeoutUntil:t>=5?Date.now()+15e3:void 0})})),(0,w.aJ)("resetInvalidUnlockAttempts",(e=>(0,S.Vg3)(e,{invalidAttemptsCount:0,timeoutUntil:void 0}))),(0,w.aJ)("setPasscodeError",((e,t,s)=>{const{error:a}=s;return(0,S.Vg3)(e,{error:a})})),(0,w.aJ)("clearPasscodeError",(e=>(0,S.Vg3)(e,{error:void 0}))),(0,w.aJ)("skipLockOnUnload",(()=>{Ut=!0})),(0,w.aJ)("processOriginStarsPayment",((e,t,s)=>{const{originData:a,status:o,tabId:n=(0,u.g0)()}=s,{originStarsPayment:i,originReaction:r,originGift:d,topup:c}=a||{};if((i||r||d||c)&&(t.closeStarsBalanceModal({tabId:n}),"paid"===o))return i&&(e=(0,A.w)(e,{starsPayment:i},n)),r&&t.sendPaidReaction({chatId:r.chatId,messageId:r.messageId,forcedAmount:r.amount,tabId:n}),d&&t.sendStarGift({...d,tabId:n}),e})),(0,w.aJ)("openGiftRecipientPicker",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:a}),e):(0,A.w)(e,{isGiftRecipientPickerOpen:!0},a)})),mt("closeGiftRecipientPicker","isGiftRecipientPickerOpen"),(0,w.aJ)("openStarsGiftingPickerModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{starsGiftingPickerModal:{isOpen:!0}},a)})),mt("closeStarsGiftingPickerModal","starsGiftingPickerModal"),(0,w.aJ)("openPrizeStarsTransactionFromGiveaway",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.O5q)(e,a,o);if(!i)return;const r=(0,et.D5)(i);return r?(0,S.V5q)(e,r,n):void 0})),(0,w.aJ)("openStarsBalanceModal",((e,t,s)=>{const{originStarsPayment:a,originReaction:o,originGift:n,topup:i,shouldIgnoreBalance:r,tabId:d=(0,u.g0)()}=s||{},c=e.stars?.balance;if(!(!r&&c&&i&&i.balanceNeeded<=c.amount))return e=(0,S.Y1r)(e,d),t.loadStarStatus(),(0,A.w)(e,{starsBalanceModal:{originStarsPayment:a,originReaction:o,originGift:n,topup:i}},d);t.showNotification({message:f.yE("StarsTopupLinkEnough"),actionText:f.yE("StarsTopupLinkTopupAnyway"),action:{action:"openStarsBalanceModal",payload:{topup:i,shouldIgnoreBalance:!0,tabId:d}},icon:"star",tabId:d})})),mt("closeStarsBalanceModal","starsBalanceModal"),(0,w.aJ)("closeStarsPaymentModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.Osl)(e,a);let n=o?.status;return n&&"pending"!==n||(n="cancelled"),(0,A.w)(e,{starsPayment:{status:n}},a)})),(0,w.aJ)("openStarsTransactionModal",((e,t,s)=>{const{transaction:a,tabId:o=(0,u.g0)()}=s;return(0,S.V5q)(e,a,o)})),(0,w.aJ)("openStarsTransactionFromGift",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s||{},i=(0,C.O5q)(e,a,o);if(!i)return;const r=(0,et.M6)(i);return r?(0,S.V5q)(e,r,n):void 0})),mt("closeStarsTransactionModal","starsTransactionModal"),(0,w.aJ)("openStarsSubscriptionModal",((e,t,s)=>{const{subscription:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{starsSubscriptionModal:{subscription:a}},o)})),mt("closeStarsSubscriptionModal","starsSubscriptionModal"),mt("closeGiftModal","giftModal"),(0,w.aJ)("closeStarsGiftModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{starsGiftModal:{isOpen:!1}},a)})),(0,w.aJ)("openGiftInfoModalFromMessage",((e,t,s)=>{const{chatId:a,messageId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.O5q)(e,a,o);if(!i||!i.content.action)return;const r=i.content.action;if("starGift"!==r.type&&"starGiftUnique"!==r.type)return;const d="starGift"===r.type?r:void 0,c="starGiftUnique"===r.type?r:void 0,l=r.peerId||(i.isOutgoing?i.chatId:e.currentUserId),h=r.savedId?{type:"chat",chatId:a,savedId:r.savedId}:{type:"user",messageId:o},p=r.fromId||(i.isOutgoing?e.currentUserId:i.chatId),m={date:i.date,gift:r.gift,message:d?.message,starsToConvert:d?.starsToConvert,isNameHidden:d?.isNameHidden,isUnsaved:!r.isSaved,fromId:p,messageId:i.id,isConverted:d?.isConverted,upgradeMsgId:d?.upgradeMsgId,canUpgrade:d?.canUpgrade,alreadyPaidUpgradeStars:d?.alreadyPaidUpgradeStars,inputGift:h,canExportAt:c?.canExportAt,savedId:r.savedId,transferStars:c?.transferStars};t.openGiftInfoModal({peerId:l,gift:m,tabId:n})})),(0,w.aJ)("openGiftInfoModal",((e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s,n="peerId"in s?s.peerId:void 0,i="recipientId"in s?s.recipientId:void 0;return(0,A.w)(e,{giftInfoModal:{peerId:n,gift:a,recipientId:i}},o)})),(0,w.aJ)("openGiftResalePriceComposerModal",((e,t,s)=>{const{gift:a,peerId:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{giftResalePriceComposerModal:{peerId:o,gift:a}},n)})),mt("closeGiftInfoModal","giftInfoModal"),mt("closeGiftResalePriceComposerModal","giftResalePriceComposerModal"),mt("closeGiftUpgradeModal","giftUpgradeModal"),(0,w.aJ)("openGiftWithdrawModal",((e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s||{};return(0,A.w)(e,{giftWithdrawModal:{gift:a}},o)})),mt("closeGiftWithdrawModal","giftWithdrawModal"),(0,w.aJ)("openGiftStatusInfoModal",((e,t,s)=>{const{emojiStatus:a,tabId:o=(0,u.g0)()}=s||{};return(0,A.w)(e,{giftStatusInfoModal:{emojiStatus:a}},o)})),(0,w.aJ)("closeGiftStatusInfoModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{giftStatusInfoModal:void 0},a)})),(0,w.aJ)("clearGiftWithdrawError",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),n=o?.giftWithdrawModal;if(n)return(0,A.w)(e,{giftWithdrawModal:{...n,errorKey:void 0}},a)})),(0,w.aJ)("openGiftTransferModal",((e,t,s)=>{const{gift:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{giftTransferModal:{gift:a}},o)})),mt("closeGiftTransferModal","giftTransferModal"),(0,w.aJ)("processOpenChatOrThread",((e,t,s)=>{const{chatId:a,tabId:o=(0,u.g0)()}=s;return a?(0,A.w)(e,{reactionPicker:{chatId:a,messageId:void 0,position:void 0}},o):(0,A.w)(e,{reactionPicker:void 0},o)})),(0,w.aJ)("openMessageReactionPicker",((e,t,s)=>{const{chatId:a,messageId:o,position:n,tabId:i=(0,u.g0)()}=s;return(0,A.w)(e,{reactionPicker:{chatId:a,messageId:o,position:n}},i)})),(0,w.aJ)("openStoryReactionPicker",((e,t,s)=>{const{peerId:a,storyId:o,position:n,sendAsMessage:i,tabId:r=(0,u.g0)()}=s;return(0,A.w)(e,{reactionPicker:{storyPeerId:a,storyId:o,sendAsMessage:i,position:n}},r)})),(0,w.aJ)("openEffectPicker",((e,t,s)=>{const{position:a,chatId:o,tabId:n=(0,u.g0)()}=s;return(0,A.w)(e,{reactionPicker:{position:a,chatId:o,isForEffects:!0}},n)})),(0,w.aJ)("closeReactionPicker",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{reactionPicker:{...o.reactionPicker,messageId:void 0,position:void 0,storyId:void 0,storyPeerId:void 0,isForEffects:void 0}},a)})),(0,w.aJ)("resetLocalPaidReactions",((e,t,s)=>{const{chatId:a,messageId:o}=s,n=(0,C.O5q)(e,a,o);if(!n)return;const{reactions:i}=n;if(!i)return;const r=i.results.map((e=>{if(e.localAmount){if(!e.count)return;return{...e,localAmount:void 0,localPreviousChosenOrder:void 0,chosenOrder:e.localPreviousChosenOrder}}return e})).filter(Boolean);return Object.values(e.byTabId).forEach((({id:e})=>{t.dismissNotification({localId:(0,p.bj)(n),tabId:e})})),(0,S.r3y)(e,a,o,{reactions:{...i,results:r}})})),(0,w.aJ)("openStoryViewer",(async(e,t,s)=>{const{peerId:a,storyId:o,isSinglePeer:n,isSingleStory:i,isPrivate:r,isArchive:d,origin:c,tabId:l=(0,u.g0)()}=s,h=(0,C.PVB)(e,a);if(!h)return;const p=(0,C.nTw)(e,l),m=(0,C._bp)(e,a);if(o&&(!m||!m.byId[o])){const t=await(0,b.px)("fetchPeerStoriesByIds",{peer:h,ids:[o]});if(!t)return;e=(0,w.mS)(),e=(0,S.K4v)(e,a,t.stories)}const g=p.storyViewer.storyList||(0,C.R3Q)(e,a,o,i,n,r,d);e=(0,A.w)(e,{storyViewer:{...p.storyViewer,peerId:a,storyId:o||(0,C._$$)(e,a)||(0,C.dNJ)(e,a),isSinglePeer:n,isPrivate:r,isArchive:d,isSingleStory:i,viewModal:void 0,origin:c,storyList:g}},l),(0,w.UF)(e)})),(0,w.aJ)("openStoryViewerByUsername",(async(e,t,s)=>{const{username:a,storyId:n,origin:i,tabId:r=(0,u.g0)()}=s,d=await(0,o.A$)(e,a);d&&t.openStoryViewer({peerId:d.id,storyId:n,isSinglePeer:!0,isSingleStory:!0,origin:i,tabId:r})})),(0,w.aJ)("closeStoryViewer",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},{isMuted:o,isRibbonShown:n,isArchivedRibbonShown:i,storyId:r}=(0,C.nTw)(e,a).storyViewer;return r?e=(0,A.w)(e,{storyViewer:{isMuted:o,isRibbonShown:n,isArchivedRibbonShown:i,lastViewedByPeerId:void 0,storyList:void 0}},a):e})),(0,w.aJ)("setStoryViewerMuted",((e,t,s)=>{const{isMuted:a,tabId:o=(0,u.g0)()}=s;return(0,A.w)(e,{storyViewer:{...(0,C.nTw)(e,o).storyViewer,isMuted:a}},o)})),(0,w.aJ)("toggleStoryRibbon",((e,t,s)=>{const{isShown:a,isArchived:o,tabId:n=(0,u.g0)()}=s,i=e.stories.orderedPeerIds[o?"archived":"active"];return i?.length?(0,A.w)(e,{storyViewer:{...(0,C.nTw)(e,n).storyViewer,[o?"isArchivedRibbonShown":"isRibbonShown"]:a}},n):e})),(0,w.aJ)("openPreviousStory",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),{peerId:n,storyId:i,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:a});if(!n||!i)return;const l=(0,C.PVB)(e,n);if(!(0,C._bp)(e,n)||!l)return;const{peerIds:h,storyIdsByPeerId:p}=c,m=(p[n]??[]).indexOf(i);let g,f;if(m>0)g=m-1,f=n;else{const e=h.indexOf(n)-1;if(r||e<0)return;f=h[e],g=(p?.[f]?.length||1)-1}const I=p?.[f]?.[g];return I?(0,A.w)(e,{storyViewer:{...o.storyViewer,peerId:f,storyId:I}},a):void 0})),(0,w.aJ)("openNextStory",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a),{peerId:n,storyId:i,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:a});if(!n||!i)return;const l=(0,C.PVB)(e,n);if(!(0,C._bp)(e,n)||!l)return;const{peerIds:h,storyIdsByPeerId:p}=c,m=p[n]??[],g=m.indexOf(i);let f,I;if(g<m.length-1)f=g+1,I=n;else{const e=h.indexOf(n)+1;if(r||e>h.length-1)return void t.closeStoryViewer({tabId:a});I=h[e],f=0}const b=p?.[I]?.[f];return b?(0,A.w)(e,{storyViewer:{...o.storyViewer,peerId:I,storyId:b}},a):void 0})),(0,w.aJ)("openStoryViewModal",((e,t,s)=>{const{storyId:a,tabId:o=(0,u.g0)()}=s,n=(0,C.nTw)(e,o);return(0,A.w)(e,{storyViewer:{...n.storyViewer,viewModal:{storyId:a,nextOffset:"",isLoading:!0}}},o)})),(0,w.aJ)("closeStoryViewModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{storyViewer:(0,h.cJ)(o.storyViewer,["viewModal"])},a)})),(0,w.aJ)("copyStoryLink",(async(e,t,s)=>{const{peerId:a,storyId:o,tabId:n=(0,u.g0)()}=s,i=(0,C.PVB)(e,a);if(!i)return;const r=await(0,b.px)("fetchStoryLink",{peer:i,storyId:o});r&&((0,c.eM)(r),t.showNotification({message:f.yE("LinkCopied"),tabId:n}))})),(0,w.aJ)("sendMessage",(async(e,t,s)=>{const{tabId:a=(0,u.g0)()}=s,{storyId:o,peerId:n}=(0,C.V9I)(e,a);if(!Boolean(o&&n))return;if(void 0===await ne(e,n))return;const{gif:i,sticker:r,isReaction:d}=s;let c;c=i?"Story.Tooltip.GifSent":r?"Story.Tooltip.StickerSent":d?"Story.Tooltip.ReactionSent":"Story.Tooltip.MessageSent",t.showNotification({message:f.yE(c),actionText:f.yE("Story.ToastViewInChat"),action:[{action:"closeStoryViewer",payload:void 0},{action:"openChat",payload:{id:n}}],tabId:a})})),(0,w.aJ)("openStoryPrivacyEditor",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!0}},a)})),(0,w.aJ)("closeStoryPrivacyEditor",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{},o=(0,C.nTw)(e,a);return(0,A.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!1}},a)})),(0,w.aJ)("toggleStealthModal",((e,t,s)=>{const{isOpen:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);return(0,A.w)(e,{storyViewer:{...n.storyViewer,isStealthModalOpen:a}},o)})),(0,w.aJ)("clearStoryViews",((e,t,s)=>{const{isLoading:a,tabId:o=(0,u.g0)()}=s||{},n=(0,C.nTw)(e,o);return n.storyViewer.viewModal?(0,A.w)(e,{storyViewer:{...n.storyViewer,viewModal:{...n.storyViewer.viewModal,views:void 0,isLoading:a,nextOffset:""}}},o):e})),(0,w.aJ)("updateStoryView",((e,t,s)=>{const{userId:a,isUserBlocked:o,areStoriesBlocked:n,tabId:i=(0,u.g0)()}=s,r=(0,C.nTw)(e,i),{viewModal:d}=r.storyViewer;if(!d?.storyId)return;const c=d?.views?.map((e=>e.peerId===a?{...e,isUserBlocked:o||void 0,areStoriesBlocked:n||void 0}:e));return(0,A.w)(e,{storyViewer:{...r.storyViewer,viewModal:{...d,views:c}}},i)})),(0,w.aJ)("closeBoostModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{boostModal:void 0},a)})),(0,w.aJ)("closeBoostStatistics",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{boostStatistics:void 0},a)})),(0,w.aJ)("openMonetizationVerificationModal",((e,t,s)=>{const{tabId:a=(0,u.g0)(),chatId:o}=s||{};return(0,A.w)(e,{monetizationVerificationModal:{chatId:o}},a)})),(0,w.aJ)("closeMonetizationVerificationModal",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{monetizationVerificationModal:void 0},a)})),(0,w.aJ)("clearMonetizationVerificationError",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,S.Zct)(e,{errorKey:void 0},a)})),(0,w.aJ)("closeMonetizationStatistics",((e,t,s)=>{const{tabId:a=(0,u.g0)()}=s||{};return(0,A.w)(e,{monetizationStatistics:void 0},a)})),(0,w.aJ)("setActiveWorkspaceId",((e,t,s)=>{e={...e,workspaces:{...e.workspaces,activeId:s}},(0,w.UF)(e)})),(0,w.aJ)("setWorkspaceSelectedItemId",((e,t,s)=>{e={...e,workspaces:{...e.workspaces,selectedItemId:s}},(0,w.UF)(e)})),(0,w.aJ)("setWorkspaceSidebarOpen",((e,t,s)=>{e={...e,workspaces:{...e.workspaces,sidebarIsOpen:s}},(0,w.UF)(e)})),(0,w.aJ)("loadWebContentsViewUrl",((e,t,s)=>{const{url:a}=s;e={...e,webContentsViewIsLoading:!0,webContentsViewError:void 0},(0,w.UF)(e),t.openChat({id:void 0,tabId:(0,u.g0)()}),window.electron?.setWebContentsViewVisible(!0),window.electron?.setWebContentsViewUrl(a).then((()=>{e=(0,w.mS)(),e={...e,webContentsViewIsLoading:!1,webContentsViewIsVisible:!0},(0,w.UF)(e)})).catch((t=>{e=(0,w.mS)(),e={...e,webContentsViewIsLoading:!1,webContentsViewIsVisible:!1,webContentsViewError:t},(0,w.UF)(e)}))})),(0,w.aJ)("closeWebContentsView",((e,t,s)=>{e={...e,webContentsViewIsVisible:!1,webContentsViewIsLoading:!1,webContentsViewError:void 0},(0,w.UF)(e),window.electron?.setWebContentsViewVisible(!1)})),(0,w.aJ)("closeWebContentsTab",((e,t,s)=>{const{tabId:a}=s;e={...e,webContentsViewIsVisible:!1,webContentsViewIsLoading:!1,webContentsViewError:void 0},(0,w.UF)(e),window.electron?.closeWebContentsTab(a)})),s(4990);const xt=new Set(["boostLevel","isForum","isLinkedInDiscussion","fakeType","restrictionReason","isJoinToSend","isJoinRequest","type"]);(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateChat":{const a=(0,C.hds)(e,s.id),{isForum:o,lastReadOutboxMessageId:n}=a||{};s.chat.lastReadOutboxMessageId&&n&&s.chat.lastReadOutboxMessageId<n&&(s={...s,chat:(0,h.cJ)(s.chat,["lastReadInboxMessageId"])}),e=(0,S.wix)(e,s.id,s.chat),a?.areStoriesHidden!==s.chat.areStoriesHidden&&(e=(0,S.VWO)(e,s.id,s.chat.areStoriesHidden||!1)),(0,w.UF)(e);const i=(0,C.hds)(e,s.id);if(s.noTopChatsRequest||(0,C.mJZ)(e,s.id)||i?.isNotJoined||t.loadTopChats(),s.chat.id&&(0,F.Kz)({chatId:s.chat.id,lastReadInboxMessageId:s.chat.lastReadInboxMessageId}),Object.values(e.byTabId).forEach((({id:a})=>{const{chatId:n}=(0,C.Xf0)(e,a)||{},i=s;n===i.id&&"isForum"in i.chat&&o!==i.chat.isForum&&(o&&t.closeForumPanel({tabId:a}),t.openChat({id:n,tabId:a}))})),a){const e=s.chat;Object.keys(e).filter((t=>a[t]!==e[t])).some((e=>xt.has(e)))&&t.invalidateFullInfo({peerId:s.id})}return}case"updateChatJoin":{const a=(0,C.P4G)(e,s.id),o=(0,C.hds)(e,s.id);if(e=(0,S.wix)(e,s.id,{isNotJoined:!1}),(0,w.UF)(e),o&&t.requestChatUpdate({chatId:o.id}),t.loadFullChat({chatId:s.id,force:!0}),!a)return;return e=(0,w.mS)(),e=(0,S.ec2)(e,a,[s.id]),void(0,w.UF)(e)}case"updateChatLeave":{e=(0,S.CX_)(e,s.id);const t=(0,C.hds)(e,s.id);if(t&&(0,v.WX)(t)){const a=(0,C.zeq)(e,s.id);if(a){const s=Object.keys(a).map(Number).filter(p.iL);e=(0,S.AH0)(e,t.id,s)}}return e}case"updateChatInbox":return(0,S.wix)(e,s.id,s.chat);case"updateChatTypingStatus":{const{id:t,threadId:a=n.l3,typingStatus:o}=s;return e=(0,S.eww)(e,t,a,"typingStatus",o),(0,w.UF)(e),void setTimeout((()=>{e=(0,w.mS)();const s=(0,C.C5H)(e,t,a,"typingStatus");o&&s&&o.timestamp===s.timestamp&&(e=(0,S.eww)(e,t,a,"typingStatus",void 0),(0,w.UF)(e))}),6e3)}case"newMessage":{const{message:t}=s;if(t.senderId===e.currentUserId&&!t.isFromScheduled)return;const o=(0,p.iL)(t.id),n=(0,C.hds)(e,s.chatId);if(!n)return;const i=Boolean(s.message.id&&s.message.hasUnreadMention);if(!o||n.id===a.zv8){e=(0,S.wix)(e,s.chatId,{unreadCount:n.unreadCount?n.unreadCount+1:1}),i&&(e=(0,S.Wez)(e,s.chatId,n,[s.message.id],!0));const a=n.isForum?(0,C.nkm)(e,t):void 0;a&&(e=(0,S.TwA)(e,s.chatId,a.id,{unreadCount:a.unreadCount?a.unreadCount+1:1}))}return(0,w.UF)(e),void(0,F.Oq)({chat:n,message:t})}case"updateCommonBoxMessages":case"updateChannelMessages":{const{ids:t,messageUpdate:a}=s;return t.forEach((t=>{const o="channelId"in s?s.channelId:(0,C.Egn)(e,t),n=(0,C.hds)(e,o);a.reactions&&n?.unreadReactionsCount&&!(0,v.pU)(e,a.reactions)&&(e=V(e,o,{unreadReactionsCount:Math.max(n.unreadReactionsCount-1,0)||void 0,unreadReactions:n.unreadReactions?.filter((e=>e!==t))})),!a.hasUnreadMention&&n?.unreadMentionsCount&&(e=(0,S.pWt)(e,o,n,[t],!0))})),e}case"updateChatFullInfo":return(0,S.ltr)(e,s.id,s.fullInfo);case"updatePinnedChatIds":{const{ids:o,folderId:n}=s,i=n===a._E9?"archived":"active";return o?{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[i]:o.length?o:void 0}}}:(t.loadPinnedDialogs({listType:i}),e)}case"updatePinnedSavedDialogIds":{const{ids:t}=s;return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:t.length?t:void 0}}}}case"updateChatPinned":{const{id:t,isPinned:o}=s,n=(0,C.P4G)(e,t);if(!n)return;const{[n]:i}=e.chats.orderedPinnedIds;let r=i||[];if(o){if(!r.includes(t)){if("active"===n&&r.length>=a.FZw){const t=e.chats.listIds.active;r=r.filter((e=>t&&t.includes(e)))}r=[t,...r]}}else r=r.filter((e=>e!==t));return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[n]:r.length?r:void 0}}}}case"updateSavedDialogPinned":{const{id:t,isPinned:a}=s,{saved:o}=e.chats.orderedPinnedIds;let n=o||[];return a?n.includes(t)||(n=[t,...n]):n=n.filter((e=>e!==t)),{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:n.length?n:void 0}}}}case"updateChatListType":{const{id:t,folderId:a}=s;return(0,S.KrP)(e,t,a)}case"updateChatFolder":{const{id:t,folder:a}=s,{byId:o,orderedIds:n}=e.chatFolders,i=void 0===a;Object.values(e.byTabId).forEach((({id:s})=>{const a=(0,C.nTw)(e,s);Object.values(o)[a.activeChatFolder-1]?.id===t&&(e=(0,A.w)(e,{activeChatFolder:0},s))}));const r=i?(0,h.cJ)(o,[t]):{...o,[t]:a},d=i?n?.filter((e=>e!==t)):n?.includes(t)?n:[...n||[],t];return{...e,chatFolders:{...e.chatFolders,byId:r,orderedIds:d,invites:(0,h.cJ)(e.chatFolders.invites,[t])}}}case"updateChatFoldersOrder":{const{orderedIds:t}=s;return{...e,chatFolders:{...e.chatFolders,orderedIds:t}}}case"updateRecommendedChatFolders":{const{folders:t}=s;return{...e,chatFolders:{...e.chatFolders,recommended:t}}}case"updateChatMembers":{const t=(0,C.AWZ)(e,s.id),{replacedMembers:a,addedMember:o,deletedMemberId:n}=s;if(!t)return;let i=!1,r=t?.members?[...t.members]:[];if(a)r=a,i=!0;else if(o)r.length&&r.some((e=>e.userId===o.userId))||(r.push(o),i=!0);else if(r.length&&n){const e=r.findIndex((e=>e.userId===n));e>-1&&(r.slice(e,1),i=!0)}if(i){const t=r.filter((({isOwner:e,isAdmin:t})=>e||t));return e=(0,S.wix)(e,s.id,{membersCount:r.length}),e=(0,S.ltr)(e,s.id,{members:r,adminMembersById:(0,h.dU)(t,"userId")})}return}case"draftMessage":{const{chatId:t,threadId:a,draft:o}=s;if(!e.chats.byId[t])return;return e=(0,S.eww)(e,t,a||n.l3,"draft",o),e=(0,S.wix)(e,t,{draftDate:o?.date})}case"updatePendingJoinRequests":{const{chatId:a,requestsPending:o,recentRequesterIds:n}=s;if(!e.chats.byId[a])return;return e=(0,S.ltr)(e,a,{requestsPending:o,recentRequesterIds:n}),(0,w.UF)(e),void t.loadChatJoinRequests({chatId:a})}case"updatePinnedTopic":{const{chatId:t,topicId:a,isPinned:o}=s;if(!e.chats.byId[t])return;return e=(0,S.TwA)(e,t,a,{isPinned:o}),void(0,w.UF)(e)}case"updatePinnedTopicsOrder":{const{chatId:t,order:a}=s;if(!e.chats.byId[t])return;return e=(0,S.mPd)(e,t,a),void(0,w.UF)(e)}case"updateTopic":{const{chatId:a,topicId:o}=s,n=(0,C.hds)(e,a);if(!n?.isForum)return;return void t.loadTopicById({chatId:a,topicId:o})}case"updateTopics":{const{chatId:a}=s,o=(0,C.hds)(e,a);if(!o?.isForum)return;return void t.loadTopics({chatId:a,force:!0})}case"updateViewForumAsMessages":{const{chatId:t,isEnabled:a}=s,o=(0,C.hds)(e,t);if(!o?.isForum)return;e=(0,S.wix)(e,t,{isForumAsMessages:a}),(0,w.UF)(e);break}case"updateNewProfilePhoto":{const{peerId:a,photo:o}=s;e=(0,S.wix)(e,a,{avatarPhotoId:o.id}),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0});break}case"updateDeleteProfilePhoto":{const{peerId:a,photoId:o}=s,n=(0,C.PVB)(e,a);if(!n)return;o&&n.avatarPhotoId!==o?e=(0,S.sol)(e,a,o):(e=(0,S.wix)(e,a,{avatarPhotoId:void 0}),e=(0,S.Khb)(e,a,void 0)),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:a,shouldInvalidateCache:!0});break}}}));const Bt=(0,s(8718).By)((function(){let e=(0,w.mS)();e=(0,S.wWy)(e,{...e.users.statusesById,...Nt}),(0,w.UF)(e),Nt={}}));let Nt={};(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"deleteContact":return(0,S.MOQ)(e,s.id);case"updateUser":{Object.values(e.byTabId).forEach((({id:a})=>{(0,C.nZ4)(e,s.id)&&s.user.isPremium!==(0,C.g29)(e)&&(s.user.isPremium&&e.byTabId[a].premiumModal&&t.openPremiumModal({isSuccess:!0,tabId:a}),e={...e,translations:{byChatId:{}}})}));const a=(0,C.mBe)(e,s.id);return e=(0,S.TKu)(e,s.id,s.user),s.fullInfo&&(e=(0,S.weB)(e,s.id,s.fullInfo)),a?.areStoriesHidden!==s.user.areStoriesHidden&&(e=(0,S.VWO)(e,s.id,s.user.areStoriesHidden||!1)),e}case"updateRequestUserUpdate":t.loadFullUser({userId:s.id});break;case"updateUserEmojiStatus":return e=(0,S.TKu)(e,s.userId,{emojiStatus:s.emojiStatus}),e=(0,S.wix)(e,s.userId,{emojiStatus:s.emojiStatus});case"updateUserStatus":return Nt[s.userId]=s.status,void Bt();case"updateUserFullInfo":{const{id:t,fullInfo:a}=s;return(0,S.weB)(e,t,a)}case"updateBotMenuButton":{const{botId:t,button:a}=s,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,S.weB)(e,t,{botInfo:{...o.botInfo,menuButton:a}})}case"updateBotCommands":{const{botId:t,commands:a}=s,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,S.weB)(e,t,{botInfo:{...o.botInfo,commands:a}})}case"updatePeerSettings":{const{id:a,settings:o}=s,n=(0,C.vGo)(e,a);return n?.botInfo?e=(0,S.weB)(e,a,{settings:o}):void t.loadFullUser({userId:a})}}})),(0,w.aJ)("apiUpdate",((e,t,s)=>{if("updateStickerSet"===s["@type"])return(0,S.v9P)(e,s.id,s.stickerSet)})),(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateEntities":{const{users:t,chats:a,threadInfos:o,polls:n}=s;t&&(e=(0,S.g18)(e,t)),a&&(e=(0,S.Nl5)(e,a)),o&&(e=(0,S.Ng8)(e,o)),n&&n.forEach((t=>{e=(0,S.J81)(e,t.id,t)})),(0,w.UF)(e);break}case"updatePeerBlocked":return s.isBlocked?(0,S.P6h)(e,s.id):s.isBlockedFromStories?e:(0,S.OW3)(e,s.id);case"updateResetContactList":e={...e,contactList:{userIds:[]}},(0,w.UF)(e);break;case"updateConfig":t.loadConfig();break;case"updateNewAuthorization":t.loadAuthorizations();break;case"updateFavoriteStickers":t.loadFavoriteStickers();break;case"updateRecentStickers":t.loadRecentStickers();break;case"updateRecentReactions":t.loadRecentReactions();break;case"updateRecentEmojiStatuses":t.loadRecentEmojiStatuses();break;case"updateSavedReactionTags":t.loadSavedReactionTags();break;case"updateMoveStickerSetToTop":{const a=s.isCustomEmoji?e.customEmojis.added.setIds:e.stickers.added.setIds;if(!a?.some((e=>e===s.id)))return e;const o=[s.id,...a.filter((e=>e!==s.id))];t.reorderStickerSets({order:o,isCustomEmoji:s.isCustomEmoji});break}case"updateStickerSets":t.loadStickerSets();break;case"updateStickerSetsOrder":{const a=s.order.filter((t=>Boolean(e.stickers.setsById[t])));t.reorderStickerSets({order:a,isCustomEmoji:s.isCustomEmoji});break}case"updateSavedGifs":t.loadSavedGifs();break;case"updatePrivacy":e={...e,settings:{...e.settings,privacy:{...e.settings.privacy,[s.key]:s.rules}}},(0,w.UF)(e);break;case"updatePaymentVerificationNeeded":Object.values(e.byTabId).forEach((({id:t})=>{e=(0,S._te)(e,s.url,t),e=(0,S.lwH)(e,i.tn.ConfirmPayment,t)})),(0,w.UF)(e);break;case"updateWebViewResultSent":Object.values(e.byTabId).forEach((e=>{Object.entries(e.webApps.openedWebApps).forEach((([a,o])=>{o.queryId===s.queryId&&(t.resetDraftReplyInfo({tabId:e.id}),t.closeWebApp({key:a,tabId:e.id}))}))}));break;case"updateStory":e=(0,S.K4v)(e,s.peerId,{[s.story.id]:s.story}),e=(0,S.Gzl)(e,{[s.peerId]:(0,C._bp)(e,s.peerId)}),(0,w.UF)(e);break;case"deleteStory":e=(0,S.ONz)(e,s.peerId,s.storyId),(0,w.UF)(e);break;case"updateReadStories":e=(0,S.Ahb)(e,s.peerId,s.lastReadId),(0,w.UF)(e);break;case"updateSentStoryReaction":{const{peerId:t,storyId:a,reaction:o}=s;if(!(0,C.Msb)(e,t,a))return e;e=(0,S.Xzz)(e,t,a,{sentReaction:o}),(0,w.UF)(e);break}case"updateStealthMode":e=(0,S.qsx)(e,s.stealthMode),(0,w.UF)(e);break;case"updateAttachMenuBots":t.loadAttachBots();break;case"updatePremiumFloodWait":t.processPremiumFloodWait({isUpload:s.isUpload});break;case"updatePaidReactionPrivacy":e={...e,settings:{...e.settings,paidReactionPrivacy:s.private}},(0,w.UF)(e);break;case"updateLangPackTooLong":(0,m.eg)(s.langCode);break;case"updateLangPack":(0,m.DV)(s.version,s.strings,s.keysToRemove);break;case"newMessage":{const o=s.message.content?.action;if(!s.message.isOutgoing&&s.message.chatId!==a.zv8)return;if("starGiftUnique"!==o?.type)return;const n=o.gift;Object.values(e.byTabId).forEach((({id:a})=>{const o=(0,C.nTw)(e,a);if(o.isWaitingForStarGiftUpgrade&&(t.openUniqueGiftBySlug({slug:n.slug,tabId:a}),t.showNotification({title:{key:"GiftUpgradedTitle"},message:{key:"GiftUpgradedDescription"},tabId:a}),t.requestConfetti({withStars:!0,tabId:a}),e=(0,A.w)(e,{isWaitingForStarGiftUpgrade:void 0},a)),o.isWaitingForStarGiftTransfer){const o=s.message.chatId,i=o?(0,C.PVB)(e,o):void 0;i&&(t.focusMessage({chatId:i.id,messageId:s.message.id,tabId:a}),t.showNotification({message:{key:"GiftTransferSuccessMessage",variables:{gift:{key:"GiftUnique",variables:{title:n.title,number:n.number}},peer:(0,y.F9)((0,m.Yw)(),i)}},tabId:a})),t.requestConfetti({withStars:!0,tabId:a}),e=(0,A.w)(e,{isWaitingForStarGiftTransfer:void 0},a)}})),(0,w.UF)(e)}}})),(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateDefaultNotifySettings":return(0,S.p92)(e,s.peerType,s.settings);case"updateChatNotifySettings":{const{chatId:t,settings:a}=s;e=(0,S.m1I)(e,t,a),(0,w.UF)(e);break}case"updateTopicNotifySettings":{const{chatId:t,topicId:a,settings:o}=s;e=(0,S.TwA)(e,t,a,{notifySettings:o}),(0,w.UF)(e);break}}})),(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateTwoFaStateWaitCode":return{...e,twoFaSettings:{...e.twoFaSettings,isLoading:!1,waitingEmailCodeLength:s.length}};case"updateTwoFaError":return{...e,twoFaSettings:{...e.twoFaSettings,errorKey:s.messageKey}}}}));var Rt=s(80840),Jt=s(71331);(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updateGroupCall":{if("discarded"===s.call.connectionState)return e.groupCalls.activeGroupCallId?void("leaveGroupCall"in t&&t.leaveGroupCall({shouldRemove:!0,tabId:(0,u.g0)()})):(0,Rt.um)(e,s.call.id);const a=(0,Jt.Ip)(e,s.call.id),o=a?.chatId;return o&&(e=(0,S.wix)(e,o,{isCallNotEmpty:a.participantsCount>0||Boolean(a.participants?.length)})),(0,Rt.h9)(e,s.call.id,(0,h.cJ)(s.call,["connectionState"]),void 0,s.call.participantsCount)}case"updateGroupCallChatId":return(0,C.hds)(e,s.chatId)&&(e=(0,S.ltr)(e,s.chatId,{groupCallId:s.call.id})),e;case"updateGroupCallParticipants":{const{groupCallId:t,participants:a,nextOffset:o}=s,{currentUserId:n}=e;e=(0,w.mS)(),a.forEach((s=>{s.id&&(e=(0,Rt.c5)(e,t,s.id,s,Boolean(o)||n===s.id))})),o&&(e=(0,Rt.h9)(e,t,{nextOffset:o}));const i=(0,Jt.Ip)(e,t),r=i?.chatId;return r&&(e=(0,S.wix)(e,r,{isCallNotEmpty:i.participantsCount>0||Boolean(i.participants?.length)})),e}case"updatePhoneCall":{if(!d.OL)return;const{phoneCall:a,currentUserId:o}=e,{call:n}=s;if(a)return"discarded"===n.state?(t.playGroupCallSound({sound:"end"}),"hangUp"in t&&t.hangUp({tabId:(0,u.g0)()}),{...e,...n.needRating&&{ratingPhoneCall:n}}):void 0;if(n?.adminId!==o&&"requested"===n.state)return(0,I.aj)((()=>{e=(0,w.mS)();const t=(0,Jt.uu)(e);t&&(0,F.DJ)({call:n,user:t})})),(0,Mt.JD)(),(0,Mt.re)(e,t,n.isVideo,(0,u.g0)()),e={...e,phoneCall:n},(0,A.w)(e,{isCallPanelVisible:!1},(0,u.g0)())}}}));var Et=s(17142);(0,w.aJ)("apiUpdate",((e,t,s)=>{switch(s["@type"]){case"updatePaymentStateCompleted":{const{paymentState:a,tabId:o}=s,n=a.form,{invoice:i}=n,{totalAmount:r,currency:d}=i,c=a.inputInvoice;if("stars"===c?.type)t.closeStarsBalanceModal({tabId:o}),t.showNotification({message:f.yE("StarsAcquiredInfo",c.stars),title:f.yE("StarsAcquired"),icon:"star",tabId:o}),t.requestConfetti({withStars:!0,tabId:o});else if("giftcode"===c?.type){const s=(0,C.nTw)(e,o).giftModal;s&&c?.userIds[0]===s.forPeerId&&(t.showNotification({message:{key:"GiftSent"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}else t.showNotification({tabId:o,message:f.yE("PaymentInfoHint",[(0,Et.A)(r,d,f.Yw().code),n.title])});(0,w.UF)(e);break}case"updateStarPaymentStateCompleted":{const{paymentState:a,tabId:o}=s,{inputInvoice:n,subscriptionInfo:i,form:r}=a;if("chatInviteSubscription"===n?.type&&i){const e=i.subscriptionPricing.amount;t.showNotification({tabId:o,title:f.yE("StarsSubscriptionCompleted"),message:f.yE("StarsSubscriptionCompletedText",[e,i.title],void 0,e),icon:"star"})}if(r?.invoice.subscriptionPeriod){const e=r.invoice.totalAmount;t.showNotification({tabId:o,title:f.yE("StarsSubscriptionCompleted"),message:f.yE("StarsSubscriptionCompletedText",[e,r.title],void 0,e),icon:"star"})}if("giftcode"===n?.type){if(!n.userIds)return;const s=(0,C.nTw)(e,o).giftModal;s&&n.userIds[0]===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("premiumGiftStars"===n?.type){const s=(0,C.nTw)(e,o).giftModal;s&&n.userId===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("starsgift"===n?.type){if(!n.userId)return;const t=(0,C.nTw)(e,o).starsGiftModal;t?.isOpen&&n.userId===t.forUserId&&(e=(0,A.w)(e,{starsGiftModal:{...t,isCompleted:!0}},o))}if("stargift"===n?.type){if(!n.peerId)return;const s=(0,C.nTw)(e,o).giftModal;s&&n.peerId===s.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("stargiftResale"===n?.type){const s=(0,C.nTw)(e,o).giftInfoModal;s&&(t.showNotification({message:{key:"StarsGiftBought"},tabId:o}),s.peerId&&t.reloadPeerSavedGifts({peerId:s.peerId}),t.reloadPeerSavedGifts({peerId:n.peerId}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftInfoModal({tabId:o}))}break}case"updateStarsBalance":if(!e.stars)return;e=(0,S.L_F)(e,s.balance),(0,w.UF)(e),t.loadStarStatus()}}));const Yt="workspaces",Dt="webContentsViewFavicons";var Lt=s(70758);const Ot=new class{store=Lt.q;findChatFolderIndex(e,t){return e.chatFolders.findIndex((e=>e.id===t))}findLinkFolderIndex(e,t){return e.linkFolders.findIndex((e=>e.id===t))}findLinkIndex(e,t){return e.links.findIndex((e=>e.id===t))}getWorkspaces=async()=>await this.store.get(Yt)??[];addWorkspace=async e=>{await this.store.update(Yt,((t=[])=>t.length<3?[...t,e]:t))};deleteWorkspace=async e=>{await this.store.update(Yt,((t=[])=>t.filter((t=>t.id!==e))))};renameWorkspace=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>s.id===e?{...s,title:t}:s))))};updateWorkspaceChats=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{if(s.id===e){const e=t.map((e=>({chatId:e})));return{...s,chats:e}}return s}))))};addLinkIntoWorkspace=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{if(s.id===e){const e=s.links??[];return{...s,links:[...e,t]}}return s}))))};deleteLink=async e=>{await this.store.update(Yt,((t=[])=>t.map((t=>-1===this.findLinkIndex(t,e)?t:{...t,links:t.links.filter((t=>t.id!==e))}))))};addChatFolder=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{if(s.id===e){const e=s.chatFolders??[];return{...s,chatFolders:[...e,t]}}return s}))))};deleteChatFolder=async e=>{await this.store.update(Yt,((t=[])=>t.map((t=>-1===this.findChatFolderIndex(t,e)?t:{...t,chatFolders:t.chatFolders.filter((t=>t.id!==e))}))))};renameChatFolder=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{const a=this.findChatFolderIndex(s,e);return-1===a?s:{...s,chatFolders:s.chatFolders.map(((e,s)=>s===a?{...e,title:t}:e))}}))))};updateChatFolderChats=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{const a=this.findChatFolderIndex(s,e);if(-1===a)return s;const o=t.map((e=>({chatId:e})));return{...s,chatFolders:s.chatFolders.map(((e,t)=>t===a?{...e,chats:o}:e))}}))))};addLinkFolder=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{if(s.id===e){const e=s.linkFolders??[];return{...s,linkFolders:[...e,t]}}return s}))))};deleteLinkFolder=async e=>{await this.store.update(Yt,((t=[])=>t.map((t=>-1===this.findLinkFolderIndex(t,e)?t:{...t,linkFolders:t.linkFolders.filter((t=>t.id!==e))}))))};renameLinkFolder=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{const a=this.findLinkFolderIndex(s,e);return-1===a?s:{...s,linkFolders:s.linkFolders.map(((e,s)=>s===a?{...e,title:t}:e))}}))))};updateLinkFolderLinks=async(e,t)=>{await this.store.update(Yt,((s=[])=>s.map((s=>{const a=this.findLinkFolderIndex(s,e);return-1===a?s:{...s,linkFolders:s.linkFolders.map(((e,s)=>s===a?{...e,links:t}:e))}}))))}},Gt=(e,t)=>e.find((e=>e.chatFolders.some((e=>e.id===t))))||void 0,Vt=(e,t)=>e.find((e=>e.linkFolders.some((e=>e.id===t))))||void 0;(0,w.aJ)("loadAllWorkspaces",(async e=>{const t=await Ot.getWorkspaces();t&&(e=(0,w.mS)(),e={...e,workspaces:{...e.workspaces,areLoaded:!0,byOrder:t}}),(0,w.UF)(e)})),(0,w.aJ)("createInitialWorkspace",((e,t,s)=>{const a=e.chats.orderedPinnedIds.active?.map((e=>({chatId:e})))||[],o=Object.values(e.chatFolders.byId).map((e=>({id:crypto.randomUUID(),title:e.title.text,chats:e.includedChatIds.map((e=>({chatId:e})))}))),n={id:crypto.randomUUID(),title:"Personal",iconName:"lamp",chats:a,links:[],chatFolders:o,linkFolders:[]};Ot.addWorkspace(n),e={...e,workspaces:{...e.workspaces,byOrder:[...e.workspaces.byOrder,n]}},(0,w.UF)(e)})),(0,w.aJ)("addNewWorkspace",(async(e,t,s)=>{const{title:a,iconName:o}=s,n={id:crypto.randomUUID(),title:a,iconName:o,chats:[],links:[],chatFolders:[],linkFolders:[]};await Ot.addWorkspace(n),e=(0,w.mS)(),e={...e,workspaces:{...e.workspaces,byOrder:[...e.workspaces.byOrder,n]}},(0,w.UF)(e)})),(0,w.aJ)("deleteWorkspace",((e,t,s)=>{const{workspaceId:a}=s;Ot.deleteWorkspace(a),e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.filter((e=>e.id!==a))}},(0,w.UF)(e)})),(0,w.aJ)("renameWorkspace",((e,t,s)=>{const{workspaceId:a,newTitle:o}=s;Ot.renameWorkspace(a,o),e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===a?{...e,title:o}:e))}},(0,w.UF)(e)})),(0,w.aJ)("updateWorkspaceChats",((e,t,s)=>{const{workspaceId:a,chatIds:o}=s,n=o.map((e=>({chatId:e})));Ot.updateWorkspaceChats(a,o),e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===a?{...e,chats:n}:e))}},(0,w.UF)(e)})),(0,w.aJ)("deleteChatFromWorkspace",((e,t,s)=>{const{workspaceId:a,chatId:o}=s,n=e.workspaces.byOrder.find((e=>e.id===a));if(!n)return;const i=n.chats.filter((e=>e.chatId!==o)).map((e=>e.chatId));Ot.updateWorkspaceChats(a,i);const r={...n,chats:(n.chats??[]).filter((e=>e.chatId!==o))};e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===n.id?r:e))}},(0,w.UF)(e)})),(0,w.aJ)("addLinkIntoWorkspace",((e,t,s)=>{const{workspaceId:a,title:o,url:n}=s,i={id:crypto.randomUUID(),title:o,url:n};Ot.addLinkIntoWorkspace(a,i),e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===a?{...e,links:[...e.links||[],i]}:e))}},(0,w.UF)(e)})),(0,w.aJ)("deleteLinkFromWorkspace",((e,t,s)=>{const{linkId:a}=s;Ot.deleteLink(a);const o=((e,t)=>e.find((e=>e.links.some((e=>e.id===t))))||void 0)(e.workspaces.byOrder,a);if(!o)return;const n={...o,links:(o.links??[]).filter((e=>e.id!==a))};e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===o.id?n:e))}},(0,w.UF)(e)})),(0,w.aJ)("addChatFolderIntoWorkspace",((e,t,s)=>{const{workspaceId:a,title:o}=s,n={id:crypto.randomUUID(),title:o,chats:[]},i=e.workspaces.byOrder.find((e=>e.id===a));if(!i)return;Ot.addChatFolder(a,n);const r={...i,chatFolders:[...i.chatFolders||[],n]};e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===a?r:e))}},(0,w.UF)(e)})),(0,w.aJ)("deleteChatFolderFromWorkspace",((e,t,s)=>{const{chatFolderId:a}=s;Ot.deleteChatFolder(a);const o=Gt(e.workspaces.byOrder,a);if(!o)return;const n={...o,chatFolders:(o.chatFolders??[]).filter((e=>e.id!==a))};e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===o.id?n:e))}},(0,w.UF)(e)})),(0,w.aJ)("renameChatFolderInWorkspace",((e,t,s)=>{const{chatFolderId:a,newTitle:o}=s;Ot.renameChatFolder(a,o);const n=Gt(e.workspaces.byOrder,a);n&&(e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===n.id?{...e,chatFolders:e.chatFolders.map((e=>e.id===a?{...e,title:o}:e))}:e))}},(0,w.UF)(e))})),(0,w.aJ)("updateChatFolderChats",((e,t,s)=>{const{chatFolderId:a,chatIds:o}=s;Ot.updateChatFolderChats(a,o);const n=Gt(e.workspaces.byOrder,a);if(!n)return;const i=o.map((e=>({chatId:e})));e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===n.id?{...e,chatFolders:e.chatFolders.map((e=>e.id===a?{...e,chats:i}:e))}:e))}},(0,w.UF)(e)})),(0,w.aJ)("deleteChatFromChatsFolder",((e,t,s)=>{const{chatFolderId:a,chatId:o}=s,n=Gt(e.workspaces.byOrder,a);if(!n)return;const i=n.chatFolders.find((e=>e.id===a));if(!i)return;const r=i.chats.filter((e=>e.chatId!==o)).map((e=>e.chatId));Ot.updateChatFolderChats(a,r),e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===n.id?{...e,chatFolders:e.chatFolders.map((e=>e.id===a?{...e,chats:r.map((e=>({chatId:e})))}:e))}:e))}},(0,w.UF)(e)})),(0,w.aJ)("addLinkFolderIntoWorkspace",((e,t,s)=>{const{workspaceId:a,title:o}=s,n={id:crypto.randomUUID(),title:o,links:[]};Ot.addLinkFolder(a,n);const i=e.workspaces.byOrder.find((e=>e.id===a));if(!i)return;const r={...i,linkFolders:[...i.linkFolders||[],n]};e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===a?r:e))}},(0,w.UF)(e)})),(0,w.aJ)("deleteLinkFolderFromWorkspace",((e,t,s)=>{const{linkFolderId:a}=s;Ot.deleteLinkFolder(a);const o=Vt(e.workspaces.byOrder,a);if(!o)return;const n={...o,linkFolders:(o.linkFolders??[]).filter((e=>e.id!==a))};e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===o.id?n:e))}},(0,w.UF)(e)})),(0,w.aJ)("renameLinkFolderInWorkspace",((e,t,s)=>{const{linkFolderId:a,newTitle:o}=s;Ot.renameLinkFolder(a,o);const n=Vt(e.workspaces.byOrder,a);n&&(e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===n.id?{...e,linkFolders:e.linkFolders.map((e=>e.id===a?{...e,title:o}:e))}:e))}},(0,w.UF)(e))})),(0,w.aJ)("updateLinkFolderLinks",((e,t,s)=>{const{linkFolderId:a,links:o}=s;Ot.updateLinkFolderLinks(a,o);const n=Vt(e.workspaces.byOrder,a);n&&(e={...e,workspaces:{...e.workspaces,byOrder:e.workspaces.byOrder.map((e=>e.id===n.id?{...e,linkFolders:e.linkFolders.map((e=>e.id===a?{...e,links:o}:e))}:e))}},(0,w.UF)(e))}));var jt=s(84051),qt=s(61433),Wt=s(31791),zt=s(66644),Kt=s(87357),_t=s(25903),Ht=s(55148),Xt=s(80089),$t=s(32625),Qt=s(14737),Zt=s(30857),es=s(39351),ts=s(17712);const ss=document.querySelector('meta[name="viewport"]'),as=ss?.getAttribute("content")||"";function os(e){e.preventDefault()}var ns=s(21511),is=s(35297),rs=s(61157),ds=s(60138),cs=s(90423),ls=s(80464),us=s(20021);const hs=e=>{const{isActive:t}=e,s=(0,ls.A)(Xt.ar.Calls,"ActiveCallHeader",!t);return s?(0,us.Y)(s,{}):void 0},ps=e=>{const{groupCallId:t}=e,s=(0,ls.A)(Xt.ar.Calls,"GroupCall",!t);return s?(0,us.Y)(s,{...e}):void 0},ms=e=>{const{isActive:t}=e,s=(0,ls.A)(Xt.ar.Calls,"PhoneCall",!t);return s?(0,us.Y)(s,{}):void 0},gs=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Calls,"RatePhoneCallModal",!t);return s?(0,us.Y)(s,{...e}):void 0},fs=e=>{const{customEmojiSetIds:t}=e,s=(0,ls.A)(Xt.ar.Extra,"CustomEmojiSetsModal",!t);return s?(0,us.Y)(s,{...e}):void 0},Is=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"DeleteMessageModal",!t);return s?(0,us.Y)(s,{...e}):void 0},bs=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"StickerSetModal",!t);return s?(0,us.Y)(s,{...e}):void 0};var vs=s(26120),ys=s(14242),ws=s(74984);const Ss=(0,jt.ph)((({isForAppBadge:e})=>{(0,ws.ic)();const t=(0,Pe.vp)(),s=(0,es.A)();if((0,jt.vJ)((()=>{e&&(0,vs.q)(t)}),[e,t]),!e&&t)return(0,us.Y)("div",{className:"unread-count active",children:(0,ys.Vw)(s,t)})}));var As=s(11778),Cs=s(55994),Ms=s(31880),ks=s(2178),Fs=s(29886),Ps=s(41257),Ts=s(41036),Us=s(52745);const xs=e=>{const t=(0,ls.A)(Xt.ar.Extra,"ArchivedChats");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})};function Bs(e){const t=e.workspaces.activeId;return e.workspaces.byOrder.find((e=>e.id===t))}var Ns=s(11462),Rs=s(59030),Js=s(50680),Es=s(64493),Ys=s(18276),Ds=s(71429),Ls=s(24433);const Os=({isShown:e,onNewPrivateChat:t,onNewChannel:s,onNewGroup:a,isAccountFrozen:o})=>{const[n,i]=(0,jt.J0)(!1),{openFrozenAccountModal:r}=(0,w.ko)();(0,jt.vJ)((()=>{e||i(!1)}),[e]);const d=(0,Rs.A)(),c=(0,Kt.A)("NewChatButton",e&&"revealed",n&&"menu-is-open"),l=(0,jt.hb)((()=>{o?r():i(!n)}),[n,o]),u=(0,jt.hb)((()=>{i(!1)}),[]),h=(0,jt.Kr)((()=>(0,us.FD)(us.FK,{children:[(0,us.Y)(Ls.A,{icon:"channel",onClick:s,children:d("NewChannel")}),(0,us.Y)(Ls.A,{icon:"group",onClick:a,children:d("NewGroup")}),(0,us.Y)(Ls.A,{icon:"user",onClick:t,children:d("NewMessageTitle")})]})),[d,s,a,t]);return(0,us.FD)("div",{className:c,dir:d.isRtl?"rtl":void 0,children:[(0,us.FD)(Es.A,{round:!0,color:"primary",className:n?"active":"",onClick:l,ariaLabel:d(n?"Close":"NewMessageTitle"),tabIndex:-1,children:[(0,us.Y)(Ys.A,{name:"new-chat-filled"}),(0,us.Y)(Ys.A,{name:"close"})]}),(0,us.Y)(Ds.A,{isOpen:n,positionX:d.isRtl?"left":"right",positionY:"bottom",autoClose:!0,onClose:u,children:h})]})},Gs=e=>{const t=(0,ls.A)(Xt.ar.Extra,"LeftSearch");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Vs=e=>{const t=(0,ls.A)(Xt.ar.Extra,"ContactList");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})};var js=s(36393),qs=s(63152),Ws=s(41118);const zs=(0,jt.ph)((0,w.EK)((e=>({shouldShowLastMessage:e.chatFilters.shouldShowLastMessage})))((({folderType:e="all",category:t,shouldShowLastMessage:s})=>{const{toggleShowLastMessage:a}=(0,w.ko)(),[o,n]=(0,jt.J0)(!1);return(0,us.FD)("div",{className:"hjhOgeZl",children:[(0,us.FD)("div",{className:"av16FjtA",children:[(0,us.Y)(js.A,{className:"NgWRBmMj",onChange:()=>{}}),(0,us.Y)("div",{className:"cfmGcOVB",onClick:()=>n(!0),children:(0,us.Y)(Ys.A,{name:"filter",className:"aTGKveLA"})}),(0,us.Y)(Ds.A,{id:"attach-menu-controls",isOpen:o,positionX:"right",positionY:"top",onClose:()=>n(!1),className:"L_WpfPqo",onCloseAnimationEnd:()=>n(!1),ariaLabelledBy:"attach-menu-button",children:(0,us.FD)(Ls.A,{icon:"unread",onClick:()=>a(),children:[(0,us.Y)("span",{className:"list-item-ellipsis",style:"margin-right: 1.25rem;",children:"Show last message"}),(0,us.Y)(qs.A,{id:"last-message",label:"yo",checked:s,onChange:()=>a(),noAnimation:!0})]},"comments")})]}),(0,us.Y)(Ws.A,{isActive:!0,folderType:e,category:t,shouldShowLastMessage:s})]})})));var Ks=s(35033),_s=s(79882),Hs=s(32754);const Xs=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>{const s=(0,C.xyP)(e,t);return{chat:(0,C.hds)(e,t),topics:s?.topicsById}}))((({workspaceId:e,chatId:t,chatFolderId:s,chat:a,topics:o})=>{const{deleteChatFromWorkspace:n,deleteChatFromChatsFolder:i,markChatMessagesRead:r}=(0,w.ko)(),d=(0,es.A)(),c=(0,jt.hb)((()=>{s?i({chatFolderId:s,chatId:t}):n({workspaceId:e,chatId:t})}),[s,t,e]),l=(0,jt.Kr)((()=>{const e={title:"Remove",icon:"delete",destructive:!0,handler:c},s=a?.unreadCount||a?.hasUnreadMark||Object.values(o||{}).some((({unreadCount:e})=>e))?{title:d("ChatListContextMaskAsRead"),icon:"readchats",handler:()=>r({id:t})}:void 0;return(0,h.oE)([s,e])}),[a,t,c,d,o]);return(0,us.Y)(Hs.A,{chatId:t,orderDiff:0,animationType:_s.I.Opacity,isStatic:!0,avatarSize:"tiny",contextActions:l})})));var $s=s(38116),Qs=s(43888);const Zs="AvqXNTyJ",ea="_apvQnw3",ta="as2g8nJj",sa=(0,jt.ph)((({workspaceId:e,chatFolder:t,isHighlighted:s,selectForAddingChats:a})=>{const{renameChatFolderInWorkspace:o,deleteChatFolderFromWorkspace:n}=(0,w.ko)(),[i,r]=(0,jt.J0)(!1),[d,c]=(0,jt.J0)("folder"),l=(0,jt.hb)((e=>{0!==e.length&&(o({chatFolderId:t.id,newTitle:e}),r(!1))}),[t.id]),u=(0,jt.hb)((()=>{n({chatFolderId:t.id})}),[t.id]),p=(0,jt.Kr)((()=>{const e={title:"Rename",icon:"edit",handler:()=>{r(!0)}},t={title:"Delete",icon:"delete",destructive:!0,handler:u};return(0,h.oE)([e,t])}),[u]),m=(0,Kt.A)(ta,"eHIt6WY_");return(0,us.Y)(Qs.A,{id:t.id,isInitiallyExpanded:!1,children:({isExpandedByDefault:o,onChange:n})=>(0,us.Y)($s.A,{title:t.title,leftIconName:d,isHighlighted:s,isExpandedByDefault:o,withInnerPadding:!0,onChange:e=>{n(e),c(e?"folder-badge":"folder")},isRenaming:i,onAddClick:a,onRenameFinish:l,onRenameCancel:()=>r(!1),contextActions:p,className:m,children:t.chats.map((s=>(0,us.Y)(Xs,{workspaceId:e,chatId:s.chatId,chatFolderId:t.id},s.chatId)))},t.id)})})),aa=(0,jt.ph)((({workspaceId:e,onCreationFinishOrCancel:t})=>{const{addChatFolderIntoWorkspace:s}=(0,w.ko)(),a=(0,jt.hb)((a=>{0!==a.length&&(s({title:a,workspaceId:e}),t())}),[t,e]);return(0,us.FD)("div",{style:"display: flex; align-items: center; gap: 0.5rem; padding: 0.25rem;",children:[(0,us.Y)("div",{className:ea,children:(0,us.Y)(Ys.A,{name:"folder"})}),(0,us.Y)($s.A,{isRenaming:!0,onRenameFinish:e=>a(e),onRenameCancel:t,className:ta})]})})),oa=new class{store=Lt.q;getFavicon=async e=>{const t=await this.store.get(Dt);return t?.find((t=>t.url===e))?.faviconUrl||""};addFavicon=async(e,t)=>{const s={url:e,faviconUrl:t};await this.store.update(Dt,((e=[])=>[...e,s]))}};var na=s(22720);const ia=(0,jt.ph)((({id:e,url:t,title:s,selected:a})=>{const{setWorkspaceSelectedItemId:o,deleteLinkFromWorkspace:n,loadWebContentsViewUrl:i}=(0,w.ko)(),[r,d]=(0,jt.J0)(void 0),c=(0,jt.hb)((()=>{n({linkId:e})}),[e]),l=(0,jt.Kr)((()=>{const e={title:"Delete",icon:"delete",destructive:!0,handler:c};return(0,h.oE)([e])}),[c]),u=e=>new URL(e).hostname.replace(/^www\./,""),p=(0,jt.hb)(((e,t)=>{try{return u(e)===u(t)}catch(e){return!1}}),[]);(0,jt.vJ)((()=>{const e=window.electron.on(Wt.v.ON_WEB_CONTENTS_TAB_META_DATA,(e=>{p(e.url,t)&&oa.getFavicon(u(t)).then((s=>{s||(oa.addFavicon(u(t),e.metaData.faviconUrl||""),d(e.metaData.faviconUrl))}))}));return oa.getFavicon(u(t)).then((t=>{t&&(d(t),e())})),()=>{e()}}),[p,t]);const m=(0,Kt.A)(ta,"cI1rjKE5",a&&Zs),g=(0,Kt.A)(ea,r&&"gC2sXBAd");return(0,us.Y)(na.A,{isStatic:!0,ripple:!0,withPortalForMenu:!0,className:m,onClick:()=>{o(e),i({url:t})},contextActions:l,children:(0,us.FD)("div",{className:"encVC8WH",children:[(0,us.Y)("div",{className:g,children:r?(0,us.Y)("img",{src:r,alt:"favicon"}):(0,us.Y)(Ys.A,{name:"link"})}),(0,us.Y)("div",{className:"ANmwTSsf",children:s})]})})})),ra=(0,jt.ph)((({workspaceId:e,onCreationFinishOrCancel:t})=>{const{addLinkIntoWorkspace:s}=(0,w.ko)(),[a,o]=(0,jt.J0)({title:"",url:""}),[n,i]=(0,jt.J0)("url"),r=(0,jt.hb)((r=>{if(0!==r.length)if("url"===n)o((e=>({...e,url:r}))),i("title");else{const o={...a,title:r};s({workspaceId:e,title:o.title,url:o.url}),t()}}),[n,a,s,e,t]);return(0,us.FD)("div",{style:"display: flex; align-items: center; gap: 0.5rem; padding: 0.25rem;",children:[(0,us.Y)("div",{className:ea,children:(0,us.Y)(Ys.A,{name:"link"})}),(0,us.Y)($s.A,{isRenaming:!0,placeholder:"url"===n?"Enter URL...":"Enter title...",onRenameFinish:r,onRenameCancel:t,className:ta})]})}));var da=s(54960),ca=s(3325);const la=(0,jt.ph)((({activeEntity:e,activeEntityType:t,onClose:s,handleStartAddingNewSection:o})=>{const{updateWorkspaceChats:n,updateChatFolderChats:i}=(0,w.ko)(),[r,d]=(0,jt.J0)(""),c=(0,ws.Rh)(a.DSF),l=(0,jt.Kr)((()=>{const e=c||[];return(0,h.Am)((0,y.PU)({ids:e,query:r,type:"chat"}))}),[c,r]),[u,p]=(0,jt.J0)(!1);(0,jt.vJ)((()=>{if(!e){const e=setTimeout((()=>{p(!1)}),300);return()=>clearTimeout(e)}p(!0)}),[e]);const m=(0,jt.hb)((s=>{if(e&&t)switch(t){case"workspace":n({workspaceId:e.id,chatIds:s});break;case"chatFolder":i({chatFolderId:e.id,chatIds:s})}}),[e,t]),g=(0,Kt.A)("EFNIDECD");return(0,us.Y)(ca.A,{containerSelector:"#middle-column-left-sidebar-portals",className:"lH1aZt8f",children:(0,us.Y)(Ts.Ay,{name:"slideFade",direction:"inverse",activeKey:e?1:0,className:u?"DNMnisg2":void 0,children:(0,us.FD)("div",{className:g,children:[e&&(0,us.FD)("div",{className:"URiT03b8",children:[(0,us.FD)("div",{className:"wy0UyH42",children:[(0,us.Y)("div",{className:"eznyVno2",children:e.title}),(0,us.Y)(Ys.A,{name:"close",className:"CmCGRSdM",onClick:s})]}),(0,us.Y)(js.A,{onChange:d}),(0,us.Y)(da.A,{itemIds:l,selectedIds:e.chats.map((e=>e.chatId)),filterValue:r,categoryPlaceholderKey:"FilterChatTypes",searchInputId:"new-group-picker-search",withDefaultPadding:!0,withPeerTypes:!0,allowMultiple:!0,itemInputType:"checkbox",className:"Ba7RPaWG",onSelectedIdsChange:m})]}),(0,us.Y)("div",{className:"BeqhC0P8",onClick:s})]})})})})),ua=(0,jt.ph)((({workspaceId:e,sectionTitle:t,children:s,onAddClick:a})=>{const o=`accordion-saved-state-${e}-${t}`;return(0,us.Y)(Qs.A,{id:o,children:({isExpandedByDefault:e,onChange:n})=>(0,us.Y)($s.A,{onAddClick:a,title:t,isExpandedByDefault:e,onChange:n,className:"EWCVwPyr",children:s},o)})})),ha=(0,jt.ph)((0,w.EK)((e=>({selectedItemId:e.workspaces.selectedItemId})))((({workspace:e,selectedItemId:t})=>{const{setWorkspaceSidebarOpen:s}=(0,w.ko)(),[a,o]=(0,jt.J0)(void 0),[n,i]=(0,jt.J0)(void 0),[r,d]=(0,jt.J0)(!1),[c,l]=(0,jt.J0)(!1),u=(0,jt.hb)((()=>{o(void 0),i(void 0),s(!1)}),[]),h=(0,jt.hb)(((e,t)=>{o(e),i(t),s(!0)}),[]);(0,jt.vJ)((()=>{if(a)if("workspace"===n)h(e,"workspace");else if("chatFolder"===n){const t=e.chatFolders.find((e=>e.id===a.id));h(t,"chatFolder")}}),[a,n,h,e]),(0,jt.vJ)((()=>{u()}),[u,e.id]);const p=(0,Kt.A)("ab9U0vie","custom-scroll"),m=(0,Kt.A)("HMWbdBdv","workspace"===n&&Zs);return(0,us.FD)("div",{className:p,children:[(0,us.FD)("div",{className:m,children:[(0,us.Y)("div",{className:"SQn_a9FN",children:e?.title}),(0,us.FD)("div",{className:"fwbMPfWp",children:[(0,us.Y)(Ys.A,{className:"r92L6xyW",name:"link",onClick:()=>l(!0)}),(0,us.Y)(Ys.A,{className:"BBU33Lnk",name:"folder",onClick:()=>d(!0)}),(0,us.Y)(Ys.A,{className:"mU_Qr03D",name:"add",onClick:()=>h(e,"workspace")})]})]}),(0,us.Y)("div",{className:"rX0i5mUl",children:e?.chats.map((t=>(0,us.Y)(Xs,{workspaceId:e.id,chatId:t.chatId},t.chatId)))}),(e.chatFolders.length>0||r)&&(0,us.FD)(ua,{workspaceId:e.id,sectionTitle:"Folders",onAddClick:()=>d(!0),children:[e.chatFolders.map((t=>(0,us.Y)(sa,{workspaceId:e.id,chatFolder:t,isHighlighted:a?.id===t.id,selectForAddingChats:()=>h(t,"chatFolder")},t.id))),r&&(0,us.Y)(aa,{workspaceId:e.id,onCreationFinishOrCancel:()=>d(!1)})]}),(e.links.length>0||c)&&(0,us.FD)(ua,{workspaceId:e.id,sectionTitle:"Links",onAddClick:()=>l(!0),children:[e.links.map((e=>(0,us.Y)(ia,{id:e.id,url:e.url,title:e.title,selected:t===e.id},e.id))),c&&(0,us.Y)(ra,{workspaceId:e.id,onCreationFinishOrCancel:()=>l(!1)})]}),(0,us.Y)(la,{activeEntity:a,activeEntityType:n,onClose:u,handleStartAddingNewSection:()=>d(!0)})]})}))),pa=Object.keys(i.Bn).length/2;let ma;const ga=(0,jt.ph)((0,w.EK)((e=>({activeWorkspace:Bs(e)})))((({content:e,searchQuery:t,searchDate:s,contactsFilter:o,shouldSkipTransition:n,isAppUpdateAvailable:r,isElectronUpdateAvailable:c,isForumPanelOpen:l,onReset:u,onTopicSearch:h,isAccountFrozen:p,activeWorkspace:m})=>{const{openLeftColumnContent:g}=(0,w.ko)(),[f,I]=(0,jt.J0)(d.TF),[b,v]=(0,jt.J0)(!1);(0,jt.vJ)((()=>{window.electron?.getIsAutoUpdateEnabled().then(v)}),[]);const{shouldRenderForumPanel:y,handleForumPanelAnimationEnd:S,handleForumPanelAnimationStart:A}=(0,Ns.A)(l),C=l&&e===i.Bn.ChatList,{shouldRender:M,transitionClassNames:k}=(0,Js.A)(r||c),F=(0,jt.li)(!1),P=(0,ts.A)((()=>{e===i.Bn.ChatList&&(F.current=!0,I(!0))})),T=(0,ts.A)((()=>{F.current=!1,ma&&(clearTimeout(ma),ma=void 0),ma=window.setTimeout((()=>{F.current||I(!1)}),250)})),U=(0,ts.A)((()=>{g({contentKey:i.Bn.Contacts})})),x=(0,ts.A)((()=>{d.cp&&!b?window.open(`${a.yq6}/get`,"_blank","noopener"):c?window.electron?.installUpdate():window.location.reload()})),B=(0,ts.A)((()=>{g({contentKey:i.Bn.NewChannelStep1})})),N=(0,ts.A)((()=>{g({contentKey:i.Bn.NewGroupStep1})}));(0,jt.vJ)((()=>{let t;return e!==i.Bn.ChatList?t=window.setTimeout((()=>{I(!1)}),250):(F.current||d.TF)&&I(!0),()=>{t&&(clearTimeout(t),t=void 0)}}),[e]);const R=(0,Rs.A)();return(0,us.FD)("div",{id:"LeftColumn-main",onMouseEnter:d.TF?void 0:P,onMouseLeave:d.TF?void 0:T,children:[(0,us.Y)(Ts.Ay,{name:"none",renderCount:pa,activeKey:e,shouldCleanup:!0,cleanupExceptionKey:i.Bn.ChatList,shouldWrap:!0,wrapExceptionKey:i.Bn.ChatList,children:a=>{switch(e){case i.Bn.Workspace:return m?(0,us.Y)(ha,{workspace:m}):void 0;case i.Bn.ChatList:return(0,us.Y)(zs,{});case i.Bn.Saved:return(0,us.Y)(zs,{folderType:"saved"});case i.Bn.AllUnread:return(0,us.Y)(zs,{category:"unread"});case i.Bn.Groups:return(0,us.Y)(zs,{category:"groups"});case i.Bn.Channels:return(0,us.Y)(zs,{category:"channels"});case i.Bn.Bots:return(0,us.Y)(zs,{category:"bots"});case i.Bn.GlobalSearch:return(0,us.Y)(Gs,{searchQuery:t,searchDate:s,isActive:a,onReset:u});case i.Bn.Contacts:return(0,us.Y)(Vs,{filter:o,isActive:a,onReset:u});default:return}}}),M&&(0,us.Y)(Es.A,{fluid:!0,badge:!0,className:(0,Kt.A)("btn-update",k),onClick:x,children:R("lng_update_telegram")}),y&&(0,us.Y)(Ks.A,{isOpen:l,isHidden:!C,onTopicSearch:h,onOpenAnimationStart:A,onCloseAnimationEnd:S}),(0,us.Y)(Os,{isShown:f,onNewPrivateChat:U,onNewChannel:B,onNewGroup:N,isAccountFrozen:p})]})}))),fa=e=>{const t=(0,ls.A)(Xt.ar.Extra,"NewChat");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Ia=e=>{const t=(0,ls.A)(Xt.ar.Extra,"Settings");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})};var ba=function(e){return e[e.Main=0]="Main",e[e.Settings=1]="Settings",e[e.Archived=2]="Archived",e[e.NewGroup=3]="NewGroup",e[e.NewChannel=4]="NewChannel",e}(ba||{});const va=Object.keys(ba).length/2,ya=(0,jt.ph)((0,w.EK)((e=>{const t=(0,C.nTw)(e),{globalSearch:{query:s,minDate:a},shouldSkipHistoryAnimations:o,activeChatFolder:n,leftColumn:i,nextFoldersAction:r,storyViewer:{isArchivedRibbonShown:d}}=t,{currentUserId:c,passcode:{hasPasscode:l},isAppUpdateAvailable:u,isElectronUpdateAvailable:h,archiveSettings:p}=e,m=(0,C.meB)(e),g=Boolean(m?.id),f=(0,C.clw)(e),I=t.forumPanelChatId,b=(0,C.trm)(e);return{searchQuery:s,searchDate:a,isFirstChatFolderActive:0===n,shouldSkipHistoryAnimations:o,currentUserId:c,hasPasscode:l,nextFoldersAction:r,isChatOpen:g,isAppUpdateAvailable:u,isElectronUpdateAvailable:h,isForumPanelOpen:f,forumPanelChatId:I,isClosingSearch:t.globalSearch.isClosing,archiveSettings:p,isArchivedStoryRibbonShown:d,isAccountFrozen:b,contentKey:i.contentKey,settingsScreen:i.settingsScreen}}))((function({ref:e,contentKey:t,settingsScreen:s,searchQuery:a,searchDate:o,isFirstChatFolderActive:n,shouldSkipHistoryAnimations:r,currentUserId:c,hasPasscode:l,nextFoldersAction:u,isChatOpen:h,isAppUpdateAvailable:p,isElectronUpdateAvailable:m,isForumPanelOpen:g,forumPanelChatId:f,isClosingSearch:I,archiveSettings:b,isArchivedStoryRibbonShown:v,isAccountFrozen:y}){const{setGlobalSearchQuery:S,setGlobalSearchClosing:A,setGlobalSearchChatId:C,resetChatCreation:M,setGlobalSearchDate:k,loadPasswordInfo:F,clearTwoFaError:P,openChat:T,openLeftColumnContent:U,openSettingsScreen:x}=(0,w.ko)(),[B,N]=(0,jt.J0)(""),[R,J]=(0,Ms.A)(),[E,Y]=(0,jt.J0)(0);let D=ba.Main;switch(t){case i.Bn.Archived:D=ba.Archived;break;case i.Bn.Settings:D=ba.Settings;break;case i.Bn.NewChannelStep1:case i.Bn.NewChannelStep2:D=ba.NewChannel;break;case i.Bn.NewGroupStep1:case i.Bn.NewGroupStep2:D=ba.NewGroup}const L=(0,ts.A)((e=>{function a(){U({contentKey:void 0}),x({screen:void 0}),N(""),A({isClosing:!0}),M(),setTimeout((()=>{S({query:""}),k({date:void 0}),C({id:void 0}),A({isClosing:!1}),Y(Date.now())}),250)}if(!0!==e)if(t!==i.Bn.NewGroupStep2)if(t!==i.Bn.NewChannelStep2){if(t===i.Bn.NewGroupStep1){const e=document.getElementById("new-group-picker-search");e&&e.blur()}if(t===i.Bn.Settings)switch(s){case i.VS.EditProfile:case i.VS.Folders:case i.VS.General:case i.VS.Notifications:case i.VS.DataStorage:case i.VS.Privacy:case i.VS.Performance:case i.VS.ActiveSessions:case i.VS.Language:case i.VS.Stickers:case i.VS.Experimental:return void x({screen:i.VS.Main});case i.VS.GeneralChatBackground:return void x({screen:i.VS.General});case i.VS.GeneralChatBackgroundColor:return void x({screen:i.VS.GeneralChatBackground});case i.VS.PrivacyPhoneNumber:case i.VS.PrivacyAddByPhone:case i.VS.PrivacyLastSeen:case i.VS.PrivacyProfilePhoto:case i.VS.PrivacyBio:case i.VS.PrivacyBirthday:case i.VS.PrivacyGifts:case i.VS.PrivacyPhoneCall:case i.VS.PrivacyPhoneP2P:case i.VS.PrivacyForwarding:case i.VS.PrivacyGroupChats:case i.VS.PrivacyVoiceMessages:case i.VS.PrivacyMessages:case i.VS.PrivacyBlockedUsers:case i.VS.ActiveWebsites:case i.VS.TwoFaDisabled:case i.VS.TwoFaEnabled:case i.VS.TwoFaCongratulations:case i.VS.PasscodeDisabled:case i.VS.PasscodeEnabled:case i.VS.PasscodeCongratulations:return void x({screen:i.VS.Privacy});case i.VS.PasscodeNewPasscode:return void x({screen:l?i.VS.PasscodeEnabled:i.VS.PasscodeDisabled});case i.VS.PasscodeChangePasscodeCurrent:case i.VS.PasscodeTurnOff:return void x({screen:i.VS.PasscodeEnabled});case i.VS.PasscodeNewPasscodeConfirm:return void x({screen:i.VS.PasscodeNewPasscode});case i.VS.PasscodeChangePasscodeNew:return void x({screen:i.VS.PasscodeChangePasscodeCurrent});case i.VS.PasscodeChangePasscodeConfirm:return void x({screen:i.VS.PasscodeChangePasscodeNew});case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyPhoneNumberDeniedContacts:return void x({screen:i.VS.PrivacyPhoneNumber});case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyLastSeenDeniedContacts:return void x({screen:i.VS.PrivacyLastSeen});case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:return void x({screen:i.VS.PrivacyProfilePhoto});case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyBioDeniedContacts:return void x({screen:i.VS.PrivacyBio});case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyBirthdayDeniedContacts:return void x({screen:i.VS.PrivacyBirthday});case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyGiftsDeniedContacts:return void x({screen:i.VS.PrivacyGifts});case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:return void x({screen:i.VS.PrivacyPhoneCall});case i.VS.PrivacyPhoneP2PAllowedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:return void x({screen:i.VS.PrivacyPhoneP2P});case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyForwardingDeniedContacts:return void x({screen:i.VS.PrivacyForwarding});case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:return void x({screen:i.VS.PrivacyVoiceMessages});case i.VS.PrivacyGroupChatsAllowedContacts:case i.VS.PrivacyGroupChatsDeniedContacts:return void x({screen:i.VS.PrivacyGroupChats});case i.VS.TwoFaNewPassword:return void x({screen:i.VS.TwoFaDisabled});case i.VS.TwoFaNewPasswordConfirm:return void x({screen:i.VS.TwoFaNewPassword});case i.VS.TwoFaNewPasswordHint:return void x({screen:i.VS.TwoFaNewPasswordConfirm});case i.VS.TwoFaNewPasswordEmail:return void x({screen:i.VS.TwoFaNewPasswordHint});case i.VS.TwoFaNewPasswordEmailCode:return void x({screen:i.VS.TwoFaNewPasswordEmail});case i.VS.TwoFaChangePasswordCurrent:case i.VS.TwoFaTurnOff:case i.VS.TwoFaRecoveryEmailCurrentPassword:return void x({screen:i.VS.TwoFaEnabled});case i.VS.TwoFaChangePasswordNew:return void x({screen:i.VS.TwoFaChangePasswordCurrent});case i.VS.TwoFaChangePasswordConfirm:return void x({screen:i.VS.TwoFaChangePasswordNew});case i.VS.TwoFaChangePasswordHint:return void x({screen:i.VS.TwoFaChangePasswordConfirm});case i.VS.TwoFaRecoveryEmail:return void x({screen:i.VS.TwoFaRecoveryEmailCurrentPassword});case i.VS.TwoFaRecoveryEmailCode:return void x({screen:i.VS.TwoFaRecoveryEmail});case i.VS.FoldersCreateFolder:case i.VS.FoldersEditFolder:return void x({screen:i.VS.Folders});case i.VS.FoldersShare:return void x({screen:i.VS.FoldersEditFolder});case i.VS.FoldersIncludedChatsFromChatList:case i.VS.FoldersExcludedChatsFromChatList:return void x({screen:i.VS.FoldersEditFolderFromChatList});case i.VS.FoldersEditFolderFromChatList:case i.VS.FoldersEditFolderInvites:return U({contentKey:i.Bn.ChatList}),void x({screen:i.VS.Main});case i.VS.QuickReaction:case i.VS.CustomEmoji:return void x({screen:i.VS.Stickers});case i.VS.DoNotTranslate:return void x({screen:i.VS.Language});case i.VS.PrivacyNoPaidMessages:return void x({screen:i.VS.PrivacyMessages})}t===i.Bn.ChatList&&n?U({contentKey:i.Bn.GlobalSearch}):a()}else U({contentKey:i.Bn.NewChannelStep1});else U({contentKey:i.Bn.NewGroupStep1});else a()})),O=(0,ts.A)((e=>{t!==i.Bn.Contacts?(U({contentKey:i.Bn.GlobalSearch}),e!==a&&S({query:e})):N(e)})),G=(0,ts.A)((()=>{U({contentKey:i.Bn.GlobalSearch}),S({query:""}),C({id:f})}));(0,jt.vJ)((()=>{const e=t===i.Bn.Archived,s=t===i.Bn.ChatList,a=!h&&!g;return e&&a||!s&&!e||n&&a?(0,As.A)((()=>{L()})):void 0}),[n,t,L,h,g]);const V=(0,ts.A)((e=>{t!==i.Bn.GlobalSearch&&(e.preventDefault(),U({contentKey:i.Bn.GlobalSearch}))})),j=(0,ts.A)((e=>{e.preventDefault(),T({id:c,shouldReplaceHistory:!0})})),q=(0,ts.A)((e=>{e.preventDefault(),U({contentKey:i.Bn.Archived})})),W=(0,ts.A)((e=>{e.preventDefault(),U({contentKey:i.Bn.Settings})}));(0,ks.v)((0,jt.Kr)((()=>({"Mod+Shift+F":V,...!d.$M&&{"Mod+Shift+S":j},...d.lE&&{"Mod+0":j,"Mod+9":q},...d.MP&&d.lE&&{"Mod+,":W}})),[])),(0,jt.vJ)((()=>{P(),s===i.VS.Privacy&&F()}),[P,F,s]),(0,is.A)((()=>{u&&J(u)}),[J,u]);const z=(0,Ps.i)((0,Fs.A)(D===ba.Settings?s:-1));return(0,jt.vJ)((()=>{if(d.TF)return(0,Cs.P)(e.current,{excludedClosestSelector:".ProfileInfo, .color-picker, .hue-picker",selectorToPreventScroll:"#Settings .custom-scroll",onSwipeRightStart:L,onCancel:()=>{U({contentKey:i.Bn.Settings}),x({screen:z.current})}})}),[z,e]),(0,us.Y)(Ts.Ay,{ref:e,name:r?"none":d.Uh,renderCount:va,activeKey:D,shouldCleanup:!0,cleanupExceptionKey:ba.Main,shouldWrap:!0,wrapExceptionKey:ba.Main,id:"LeftColumn",withSwipeControl:!0,children:function(e){switch(D){case ba.Archived:return(0,us.Y)(xs,{isActive:e,onReset:L,onTopicSearch:G,foldersDispatch:J,isForumPanelOpen:g,archiveSettings:b,isStoryRibbonShown:v});case ba.Settings:return(0,us.Y)(Ia,{isActive:e,currentScreen:s,foldersState:R,foldersDispatch:J,shouldSkipTransition:r,onReset:L});case ba.NewChannel:return(0,us.Y)(fa,{isActive:e,isChannel:!0,content:t,onReset:L},E);case ba.NewGroup:return(0,us.Y)(fa,{isActive:e,content:t,onReset:L},E);default:return(0,us.Y)(ga,{content:t,isClosingSearch:I,searchQuery:a,searchDate:o,contactsFilter:B,foldersDispatch:J,onSearchQuery:O,onReset:L,shouldSkipTransition:r,isAppUpdateAvailable:p,isElectronUpdateAvailable:m,isForumPanelOpen:g,onTopicSearch:G,isAccountFrozen:y})}}})}))),wa=({isOpen:e})=>{const t=(0,ls.A)(Xt.ar.Extra,"MediaViewer",!e);return t?(0,us.Y)(t,{}):void 0},Sa=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ReactionPicker",!t);return s?(0,us.Y)(s,{...e}):void 0};var Aa=s(26072);const Ca=(0,jt.ph)((0,w.EK)((e=>({messageLists:(0,C.nTw)(e).messageLists})))((({messageLists:e})=>{const{openChat:t}=(0,w.ko)(),s=()=>{t({id:void 0},{forceSyncOnIOs:!0})},a=({chatId:e,type:t,threadId:a})=>{(0,Aa.A)({isActive:!0,hash:(0,nt.az)(e,t,a),onBack:s})};return(0,us.Y)("div",{children:e?.map(((e,t)=>(0,us.Y)(a,{...e},`${e.chatId}_${e.threadId}_${e.type}_${t}`)))})})));var Ma=s(95807),ka=s(65632),Fa=s(23565),Pa=s(73767),Ta=s(37661),Ua=s(93545),xa=s(39751),Ba=s(67054),Na=s(83414);let Ra,Ja;function Ea(e){return Math.max(0,e)}var Ya=s(48196),Da=s(58674);const La=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"PrivacySettingsNoticeModal",!t);return s?(0,us.Y)(s,{...e}):void 0},Oa=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"SeenByModal",!t);return s?(0,us.Y)(s,{...e}):void 0},Ga=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"UnpinAllMessagesModal",!t);return s?(0,us.Y)(s,{...e}):void 0},Va=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ChatLanguageModal",!t);return s?(0,us.Y)(s,{...e}):void 0};var ja=s(41510);const qa=e=>{const{activeEmojiInteraction:t}=e,s=(0,ls.A)(Xt.ar.Extra,"EmojiInteractionAnimation",!t);return s?(0,us.Y)(s,{...e}):void 0};var Wa=s(10722);const za=(0,jt.ph)((({icon:e,ariaLabelLang:t,unreadCount:s,onClick:a,onReadAll:o,className:n})=>{const i=(0,Rs.A)(),r=(0,es.A)(),d=(0,jt.li)(),{isContextMenuOpen:c,handleContextMenu:l,handleContextMenuClose:u,handleContextMenuHide:h}=(0,Wa.A)(d,!o);return(0,us.FD)("div",{className:(0,Kt.A)("Y2NKrpKj",n),ref:d,children:[(0,us.Y)(Es.A,{color:"secondary",round:!0,className:"cxwA6gDO",onClick:a,onContextMenu:l,ariaLabel:i(t),children:(0,us.Y)(Ys.A,{name:e,className:"F4zNUFhH"})}),Boolean(s)&&(0,us.Y)("div",{className:"GovSzpfQ",children:(0,ys.Vw)(r,s)}),o&&(0,us.Y)(Ds.A,{isOpen:c,onClose:u,onCloseAnimationEnd:h,autoClose:!0,positionX:"right",positionY:"bottom",children:(0,us.Y)(Ls.A,{icon:"readchats",onClick:o,children:i("MarkAllAsRead")})})]})})),Ka="UMXbiYB3",_a=(0,jt.ph)((0,w.EK)((e=>{const t=(0,C.Xf0)(e);if(!t)return{};const{chatId:s,threadId:a,type:o}=t,i=(0,C.hds)(e,s),r=Boolean((0,C.TCk)(e)),d=i&&a===n.l3&&"thread"===o&&!r;return{messageListType:o,chatId:s,threadId:a,reactionsCount:d?i.unreadReactionsCount:void 0,unreadReactions:d?i.unreadReactions:void 0,unreadMentions:d?i.unreadMentions:void 0,mentionsCount:d?i.unreadMentionsCount:void 0,unreadCount:d?i.unreadCount:void 0}}))((({withScrollDown:e,canPost:t,messageListType:s,chatId:a,threadId:o,unreadCount:n,unreadReactions:i,unreadMentions:r,reactionsCount:d,mentionsCount:c,withExtraShift:l})=>{const{focusNextReply:u,focusNextReaction:h,focusNextMention:p,fetchUnreadReactions:m,readAllMentions:g,readAllReactions:f,fetchUnreadMentions:I}=(0,w.ko)(),b=(0,jt.li)(),v=Boolean(d),y=Boolean(c),S=(0,ts.A)((()=>{a&&f({chatId:a,threadId:o})})),A=(0,ts.A)((()=>{a&&g({chatId:a,threadId:o})}));(0,jt.vJ)((()=>{v&&a&&!i?.length&&m({chatId:a})}),[a,m,v,i?.length]),(0,jt.vJ)((()=>{v&&a&&m({chatId:a})}),[a,m,v]),(0,jt.vJ)((()=>{y&&a&&!r?.length&&I({chatId:a})}),[a,I,y,r?.length]),(0,jt.vJ)((()=>{y&&a&&I({chatId:a})}),[a,I,y]);const C=(0,ts.A)((()=>{if(e)if("thread"===s)u();else{const e=b.current.parentElement.querySelector(".Transition_slide-active > .MessageList"),t=e.querySelectorAll(".message-list-item"),s=t[t.length-1];if(!s)return;(0,it.Ay)({container:e,element:s,position:"end",margin:20})}})),M=(0,Kt.A)("VWoOZCD5",(e||Boolean(d)||Boolean(c))&&"iozW83la",(Boolean(d)||Boolean(c))&&!e&&"UBa5kAK5",!t&&"yzzjqibi",!l&&"wDwOdyQH");return(0,us.FD)("div",{ref:b,className:M,children:[(0,us.Y)(za,{icon:"heart-outline",ariaLabelLang:"AccDescrReactionMentionDown",onClick:h,onReadAll:S,unreadCount:d,className:(0,Kt.A)("eO_Fz8SD",!v&&Ka,!y&&"gn3iLVq1")}),(0,us.Y)(za,{icon:"mention",ariaLabelLang:"AccDescrMentionDown",onClick:p,onReadAll:A,unreadCount:c,className:!y&&Ka}),(0,us.Y)(za,{icon:"arrow-down",ariaLabelLang:"AccDescrPageDown",onClick:C,unreadCount:n,className:"u62x81QI"})]})}))),Ha=(0,jt.ph)((function(){const e=(0,es.A)(),{openFrozenAccountModal:t}=(0,w.ko)(),s=(0,ts.A)((()=>{t()}));return(0,us.FD)("div",{className:"GuZke_HG",onClick:s,children:[(0,us.Y)("div",{className:"oLWeN4mA",children:e("ComposerTitleFrozenAccount")}),(0,us.Y)("div",{className:"ZxTe54MY",children:e("ComposerSubtitleFrozenAccount")})]})})),Xa={Container:"CNDwHkEN",container:"CNDwHkEN",Block:"uFAetXJ1",block:"uFAetXJ1",accent:"QxYLhMDG",title:"MLwbofFC",bannerWelcome:"L3Wf8lF1",banner:"hWxQ67sc",content:"YCRpguuU",paragraph:"RXAZ_gr0",NavigationButtons:"XfmxOz8M",navigationButtons:"XfmxOz8M",button:"m0b6dumZ"},$a=s.p+"notlost-banner-features.41e1227f3709f4eef4e3.svg",Qa=s.p+"notlost-banner-welcome.eb53c9dba75597d39682.svg",Za=()=>(0,us.FD)(us.FK,{children:[(0,us.Y)("img",{src:Qa,className:Xa.bannerWelcome,alt:"Welcome to NotLost"}),(0,us.FD)("div",{className:Xa.content,children:[(0,us.FD)("div",{className:Xa.paragraph,children:[(0,us.Y)(Ys.A,{name:"boost-outline"}),(0,us.FD)("div",{children:["We kicked off development in",(0,us.Y)("span",{className:Xa.accent,children:" May 2025 "}),"— after months of thinking, prototyping, and testing ideas."]})]}),(0,us.FD)("div",{className:Xa.paragraph,children:[(0,us.Y)(Ys.A,{name:"heart-outline"}),(0,us.FD)("div",{children:["All with the mission to bring thoughtful features that make",(0,us.Y)("span",{className:Xa.accent,children:" Telegram work better "}),"for people who live in it daily."]})]}),(0,us.FD)("div",{className:Xa.paragraph,children:[(0,us.Y)(Ys.A,{name:"group"}),(0,us.FD)("div",{children:["If you share our vision, join the",(0,us.Y)("span",{className:Xa.accent,children:" community "}),"and let us know what you'd love to see in the future of NotLost."]})]}),(0,us.Y)("div",{})]})]}),eo=()=>(0,us.FD)(us.FK,{children:[(0,us.Y)("img",{src:$a,className:Xa.banner,alt:"Features"}),(0,us.FD)("div",{className:Xa.content,children:[(0,us.FD)("div",{className:Xa.paragraph,children:[(0,us.Y)(Ys.A,{name:"folder"}),(0,us.FD)("div",{children:[(0,us.Y)("span",{className:Xa.accent,children:" Spaces "}),(0,us.FD)("div",{children:["Now you can create entire spaces with favorite chats,"," ","unlimited chat folders, useful links and notes (coming soon)."]})]})]}),(0,us.FD)("div",{className:Xa.paragraph,children:[(0,us.Y)(Ys.A,{name:"link"}),(0,us.FD)("div",{children:[(0,us.Y)("span",{className:Xa.accent,children:" Embeded links "}),(0,us.Y)("div",{children:"You can add links into your space and they will open in app."})]})]}),(0,us.FD)("div",{className:Xa.paragraph,children:[(0,us.Y)(Ys.A,{name:"forums"}),(0,us.FD)("div",{children:[(0,us.Y)("span",{className:Xa.accent,children:" Sidebar "}),(0,us.Y)("div",{children:"New sidebar at the left with predefined filters (unreads, channels etc.) to navigate more easily."})]})]}),(0,us.Y)("div",{})]})]}),to=(0,jt.ph)((()=>{const e=["intro","features"],[t,s]=(0,jt.J0)(e[0]),a=e.indexOf(t),o=e[a+1],n=e[a-1],i=t===e[0],r=t===e[e.length-1];return(0,us.FD)("div",{className:Xa.container,children:[(0,us.Y)("div",{className:Xa.block,children:(0,us.FD)(Ts.Ay,{activeKey:a,name:"slideFade",shouldCleanup:!0,children:["intro"===t&&(0,us.Y)(Za,{}),"features"===t&&(0,us.Y)(eo,{})]})}),(0,us.FD)("div",{className:Xa.navigationButtons,children:[(0,us.Y)("div",{className:Xa.leftButton,children:!i&&(0,us.FD)(Es.A,{onClick:()=>{i||s(e[a-1])},color:"dark",size:"tiny",noForcedUpperCase:!0,pill:!0,className:Xa.button,children:[(0,us.Y)(Ys.A,{name:"arrow-left",style:"font-size: 0.875rem; margin-right: 0.25rem;"}),n]})}),(0,us.Y)("div",{className:Xa.rightButton,children:!r&&(0,us.FD)(Es.A,{onClick:()=>{r||s(e[a+1])},color:"dark",size:"tiny",noForcedUpperCase:!0,pill:!0,className:Xa.button,children:[o,(0,us.Y)(Ys.A,{name:"arrow-right",style:"font-size: 0.875rem; margin-left: 0.25rem;"})]})})]})]})}));var so=s(9718),ao=s(16460);function oo(e){return"albumId"in e}function no(e,t,s,a,o){let n;const i=[{originalDate:e[0].date,datetime:(0,we.CS)(1e3*e[0].date),senderGroups:[[]]}];return e.forEach(((r,d)=>{const c=i[i.length-1],l=c.senderGroups[c.senderGroups.length-1];r.isInAlbum?n?(n.messages.push(r),r.hasComments&&(n.commentsMessage=r),r.content.text&&!n.hasMultipleCaptions&&(n.captionMessage?(n.hasMultipleCaptions=!0,n.captionMessage=void 0):n.captionMessage=r)):n={albumId:r.groupedId,messages:[r],mainMessage:r,hasMultipleCaptions:!1}:(r.content.paidMedia?.extendedMedia.length||0)>1?l.push({albumId:`paid-${r.id}`,messages:[r],mainMessage:r,hasMultipleCaptions:!1,isPaidMedia:!0}):l.push(r);const u=e[d+1];!n||u&&u.groupedId&&u.groupedId===n.albumId||(l.push(n),n=void 0);const h=l[l.length-1];if(u&&!n){const e=(0,we.CS)(1e3*u.date);if(c.datetime!==e){const t={originalDate:u.date,datetime:e,senderGroups:[[]]};i.push(t)}else(u.id===t||r.senderId!==u.senderId||!o&&r.paidMessageStars||r.isOutgoing!==u.isOutgoing||r.postAuthorTitle!==u.postAuthorTitle||(0,v._P)(r)&&"phoneCall"!==r.content.action?.type||(0,v._P)(u)&&"phoneCall"!==u.content.action?.type||r.inlineButtons||u.inlineButtons||u.date-r.date>600||s&&(r.id===s||h&&"mainMessage"in h&&h.mainMessage?.id===s)&&u.id!==s||a&&r.forwardInfo?.fromId!==u.forwardInfo?.fromId)&&c.senderGroups.push([])}})),i}var io=s(54464),ro=s(82117),co=s(37859),lo=s(81686);var uo=s(56133);var ho=s(82855);const po=(0,jt.ph)((0,w.EK)(((e,{userId:t})=>{const{stickers:s}=e.stickers.greeting,a=(0,C.hds)(e,t);if(!a)return{};const o=(0,C.mBe)(e,t),n=(0,C.vGo)(e,t),i=(0,C.yHC)(e,a.id);return{defaultStickers:s,lastUnreadMessageId:i&&i.id!==a.lastReadInboxMessageId?i.id:void 0,connectionState:e.connectionState,currentMessageList:(0,C.Xf0)(e),businessIntro:n?.businessIntro,user:o}}))((({defaultStickers:e,connectionState:t,lastUnreadMessageId:s,currentMessageList:a,businessIntro:o,user:n})=>{const{loadGreetingStickers:i,sendMessage:r,markMessageListRead:d}=(0,w.ko)(),c=(0,Rs.A)(),l=(0,jt.li)(),u=(0,jt.Kr)((()=>{if(o?.sticker)return o.sticker;if(!e?.length)return;const t=Math.floor(Math.random()*e.length);return e[t]}),[o?.sticker,e]);(0,jt.vJ)((()=>{e?.length||"connectionStateReady"!==t||i()}),[t,i,e]),(0,jt.vJ)((()=>{"connectionStateReady"===t&&s&&d({maxId:s})}),[t,d,s]);const h=(0,ts.A)((()=>{a&&r({sticker:{...u,isPreloadedGlobally:!0},messageList:a})})),p=o?.title||c("Conversation.EmptyPlaceholder"),m=o?.description||c("Conversation.GreetingText");return(0,us.FD)("div",{className:"osdROIcA",children:[(0,us.FD)("div",{className:"c3NtU3JZ",children:[(0,us.Y)("p",{className:"n2KO1cAv",dir:"auto",children:p}),(0,us.Y)("p",{className:"MVSedxKc",dir:"auto",children:m}),(0,us.Y)("div",{ref:l,className:"qsfxNv7L",onClick:h,children:u&&(0,us.Y)(ho.A,{containerRef:l,sticker:u,size:160,shouldLoop:!0})})]}),o&&(0,us.Y)("div",{className:"WIbO6rja",children:c("Chat.EmptyStateIntroFooter",(0,v.Yg)(n))})]})})));var mo=s(52491),go=s(64713),fo=s(83868),Io=s(4961),bo=s(62587),vo=s(26875),yo=s(92108),wo=s(96530),So=s(65843),Ao=s(55158);const Co="ubFGDy3d",Mo="kpMdEhns",ko="mtKNWJmZ",Fo="BH_g_jqY",Po=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>{const{countryList:{phoneCodes:s}}=e,a=(0,C.hds)(e,t),o=(0,C.vGo)(e,t),n=(0,C.Ua4)(e,t);let i,r=!1;return(0,C.yps)(e,t)&&(o?i=o.botInfo:r=!0),{chat:a,userFullInfo:o,botInfo:i,isLoadingFullUser:r,phoneCodeList:s,commonChats:n}}))((({chat:e,chatId:t,botInfo:s,isLoadingFullUser:a,phoneCodeList:o,commonChats:n,userFullInfo:i})=>{const{loadCommonChats:r,openChatWithInfo:d}=(0,w.ko)(),c=(0,Rs.A)(),l=(0,es.A)(),{phoneCountry:u,registrationMonth:h,nameChangeDate:p,photoChangeDate:m}=i?.settings||{};(0,jt.vJ)((()=>{r({userId:t})}),[t]);const g=(0,jt.Kr)((()=>{if(o&&u)return(0,go.gH)(o,u)}),[o,u]),f=(0,bo.A)(s?.photo?(0,v.Fi)(s.photo):void 0),I=(0,bo.A)(s?.gif?(0,v.sC)(s.gif,"full"):void 0),b=s?.photo?(0,v.Xn)(s.photo):s?.gif?(0,v.NZ)(s.gif):void 0,y=s&&!s.description&&!s.gif&&!s.photo,S=!g||!h,A=(0,v.Rl)(t),{width:M,height:k}=b||{},F=(0,ts.A)((e=>{(0,fo.A)(e),d({id:t,shouldReplaceHistory:!0,profileTab:"commonChats",forceScrollProfileTab:!0})})),P=p&&e?(0,us.Y)("div",{className:"local-action-message",children:(0,us.Y)("span",{children:l("UserUpdatedName",{user:e.title,time:(0,we.vm)(l,p)},{withNodes:!0,withMarkdown:!0})})},"security-name-message"):void 0,T=m&&e?(0,us.Y)("div",{className:"local-action-message",children:(0,us.Y)("span",{children:l("UserUpdatedPhoto",{user:e.title,time:(0,we.vm)(l,m)},{withNodes:!0,withMarkdown:!0})})},"security-photo-message"):void 0,U=(0,jt.Kr)((()=>{const e=[];if(g&&e.push([c("PrivacyPhone"),(0,us.FD)("span",{className:"TYJGFKqJ",children:[(0,us.Y)("span",{className:"WuX68A65",children:(0,Io.A)((0,mo.D0)(g?.iso2))}),g?.defaultName]})]),h&&e.push([l("ContactInfoRegistration"),(0,we.BR)(l.code,h)]),i?.commonChatsCount){const t=(0,w.mS)(),s=n?.ids.slice(0,3).map((e=>(0,C.PVB)(t,e))).filter(Boolean);e.push([l("ChatNonContactUserGroups"),(0,us.FD)(wo.A,{className:"yIJ4jRxH",onClick:F,children:[(0,us.Y)("span",{className:"_MPDNfhr",children:l("ChatGroups",{count:i.commonChatsCount},{pluralValue:i.commonChatsCount})}),Boolean(s?.length)&&(0,us.Y)(vo.A,{size:"micro",peers:s}),(0,us.Y)(Ys.A,{name:"next",className:"KYcoeDmo"})]})])}return e}),[l,c,g,h,n,i]);return(0,us.FD)("div",{className:(0,Kt.A)("tFPZHCMt","empty"),children:[a&&S&&(0,us.Y)("span",{children:c("Loading")}),y&&S&&!a&&(0,us.Y)("span",{children:c("NoMessages")}),s&&(0,us.FD)("div",{className:(0,Kt.A)(Co,"kXKBpNnb"),style:(0,Ma.A)(M?`width: ${M}px`:void 0),children:[f&&(0,us.Y)("img",{className:ko,src:f,width:M,height:k,alt:"Bot info"}),I&&(0,us.Y)(So.A,{canPlay:!0,className:ko,src:I,loop:!0,disablePictureInPicture:!0,muted:!0,playsInline:!0,style:(0,Ma.A)(Boolean(M)&&`width: ${M}px`,Boolean(k)&&`height: ${k}px`)}),b&&!f&&!I&&(0,us.Y)(Ao.A,{className:ko,width:M,height:k,forceAspectRatio:!0}),A&&(0,us.Y)("div",{className:Mo,children:c("VerifyChatInfo")}),!A&&s.description&&(0,us.FD)("div",{className:Mo,children:[(0,us.Y)("p",{className:"H__cBlx8",children:c("BotInfoTitle")}),(0,Io.A)(s.description,["br","emoji","links"])]})]}),!S&&e&&(0,us.FD)("div",{className:(0,Kt.A)(Co,"niS9Gfcl"),children:[(0,us.Y)("h3",{className:"RyB2zw9K",children:(0,Io.A)((0,v.Js)(l,e))}),(0,us.Y)("p",{className:(0,Kt.A)("n9OcHdnh",Fo),children:l("ChatNonContactUserSubtitle")}),(0,us.Y)(yo.A,{keyClassName:Fo,data:U}),!e?.isVerified&&(0,us.FD)("div",{className:(0,Kt.A)("sCB3zhO3",Fo),children:[(0,us.Y)(Ys.A,{name:"info-filled"}),(0,us.Y)("p",{className:"dlaTjW_s",children:l("ContactInfoNotVerified")})]})]}),P,T]})})));var To=s(5912);const Uo=d.Ni?1e3:350;var xo=s(63988),Bo=s(5718),No=s(4523),Ro=s(17010),Jo=s(21849);const Eo="FHxnbOg6",Yo=(0,jt.ph)((0,w.EK)(((e,t)=>{const{message:s,withAvatar:a}=t,{chatId:o}=s,n=(0,C.nZ4)(e,o),i=(0,v.DX)(o),r=(0,v.Qe)(o),d=!n&&(0,v.zP)(s),c=a||d;return{sender:(0,C.Y7C)(e,s),canShowSender:c,originSender:(0,C.Szq)(e,s),isChatWithSelf:n,isRepliesChat:i,isAnonymousForwards:r}}))((({message:e,withAvatar:t,children:s,id:o,appearanceOrder:n,sender:i,canShowSender:r,originSender:d,isChatWithSelf:c,isRepliesChat:l,isAnonymousForwards:u,canPost:h})=>{const{openChat:p,updateInsertingPeerIdMention:m}=(0,w.ko)(),g=(0,jt.li)(),{forwardInfo:f}=e,I=r?i:void 0,b=(0,es.A)(),S=n<=0,[A,C]=(0,Ta.A)(S);(0,jt.vJ)((()=>{S||setTimeout(C,n*a.zq7)}),[n,C,S]);const M=f&&(c||l||u||!I)?d:I,k=M&&(0,y.mO)(M),F=(0,ts.A)((()=>{M&&p({id:M.id})})),P=(0,ts.A)((()=>{M&&document.querySelector(a.m$5)&&m({peerId:M.id})})),T=(0,ts.A)((()=>{F()})),{ref:U,shouldRender:x}=(0,ns.A)({isOpen:t&&A,withShouldRender:!0}),{isContextMenuOpen:B,contextMenuAnchor:N,handleContextMenu:R,handleContextMenuClose:J,handleContextMenuHide:E}=(0,Wa.A)(g),Y=(0,ts.A)((()=>U.current)),D=(0,ts.A)((()=>document.querySelector(".Transition_slide-active > .MessageList"))),L=(0,ts.A)((()=>g?.current?.querySelector(`.${Eo} .bubble`))),O=(0,ts.A)((()=>({withPortal:!0}))),G=h&&M&&(k||Boolean((0,v.Kl)(M))),V=Boolean(N)&&(k||G),j=(0,Kt.A)("sender-group-container","Tk8btfOT");return(0,us.FD)("div",{id:o,className:j,ref:g,children:[x&&(0,us.Y)("div",{ref:U,className:"UPrRM3Ks",children:function(){const e=!M&&f?f.hiddenUserName:void 0;return(0,us.Y)(Jo.A,{size:"small",className:"jdvqXfYh",peer:M,text:e,onClick:M?T:void 0,onContextMenu:R})}()}),s,V&&(0,us.Y)(Ds.A,{isOpen:B,anchor:N,getTriggerElement:Y,getRootElement:D,getLayout:O,getMenuElement:L,className:Eo,onClose:J,onCloseAnimationEnd:E,withPortal:!0,autoClose:!0,children:(0,us.FD)(us.FK,{children:[k&&(0,us.Y)(Ls.A,{icon:"comments",onClick:F,children:b("SendMessage")}),G&&(0,us.Y)(Ls.A,{icon:"mention",onClick:P,children:b("ContextMenuItemMention")})]})})]})})));var Do=s(18501),Lo=s(35127),Oo=s(81949),Go=s(86070),Vo=s(48906),jo=s(51644);const qo=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"SponsoredContextMenuContainer",!t);return s?(0,us.Y)(s,{...e}):void 0};var Wo=s(25477);const zo=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>{const s=(0,C.v8U)(e,t),a=(0,C.yuw)(e),o=s?(0,v.ed)(s):void 0,n=o&&(0,v.$r)(a,o);return{message:s,theme:(0,C.SJA)(e),isDownloading:n,canAutoLoadMedia:s?(0,C.wwb)(e,s):void 0,canAutoPlayMedia:s?(0,C.OEt)(e,s):void 0}}))((({chatId:e,message:t,containerRef:s,theme:a,observeIntersectionForLoading:o,observeIntersectionForPlaying:n,isDownloading:r,canAutoLoadMedia:c,canAutoPlayMedia:l})=>{const{viewSponsored:u,openUrl:h,hideSponsored:p,clickSponsored:m,openMediaViewer:g,openAboutAdsModal:f}=(0,w.ko)(),I=(0,Rs.A)(),b=(0,jt.li)(),y=(0,jt.li)(),S=Boolean(t),{isMobile:A}=(0,L.Ay)(),{observe:C}=(0,To.BL)({rootRef:s,debounceMs:200,threshold:1}),{isContextMenuOpen:M,contextMenuAnchor:k,handleBeforeContextMenu:F,handleContextMenu:P,handleContextMenuClose:T,handleContextMenuHide:U}=(0,Wa.A)(y,void 0,!0,d.Ni);(0,jt.vJ)((()=>S?C(b.current,(e=>{e.isIntersecting&&t?.randomId&&u({randomId:t.randomId})})):void 0),[t?.randomId,S,C,u]);const x=(0,ts.A)((()=>{p()})),{photo:B,video:N}=t?(0,v.r_)(t):{photo:void 0,video:void 0},R=N?.isGif,J=Boolean(B||N),E=(0,ts.A)((()=>{t&&(m({randomId:t.randomId,isMedia:!(!B&&!R)||void 0}),h({url:t.url,shouldSkipModal:!0}))})),Y=(0,ts.A)((()=>{t&&(m({randomId:t.randomId,isMedia:!0}),g({origin:i.TQ.SponsoredMessage,chatId:e,isSponsoredMessage:!0}))})),D=(0,ts.A)((()=>{t&&f({randomId:t.randomId,canReport:t.canReport,additionalInfo:t.additionalInfo,sponsorInfo:t.sponsorInfo})})),O=(0,jt.Kr)((()=>{let e,t,s="";if(B||N){let s;B?s=(0,Lo.yA)({media:B,isMobile:A}).width:N&&(s=(0,Lo.yA)({media:N,isMobile:A}).width),s&&(s<Lo.MC&&(t=s),e=Math.max((0,Lo.nP)(),s))}return e&&(s=`width: ${e+0}px`),{contentWidth:t,noMediaCorners:!1,style:s}}),[B,N,A]),{contentWidth:G,style:V}=O;if(t&&t.content)return(0,us.FD)("div",{ref:y,className:"SponsoredMessage Message open sponsored-media-preview",children:[(0,us.FD)("div",{className:"message-content media has-shadow has-solid-background has-appendix",dir:"auto",style:V,onMouseDown:e=>{(0,io.l)(e),F(e)},onContextMenu:P,children:[(0,us.FD)(Go.A,{peerColor:t.peerColor,className:"content-inner",dir:"auto",children:[function(){if(t)return B?(0,us.Y)(jo.A,{photo:B,theme:a,canAutoLoad:c,isDownloading:r,observeIntersection:o,noAvatars:!0,onClick:E,forcedWidth:G}):N?(0,us.Y)(Wo.A,{video:N,observeIntersectionForLoading:o,observeIntersectionForPlaying:n,noAvatars:!0,canAutoLoad:c,canAutoPlay:l,isDownloading:r,onClick:R?E:Y,forcedWidth:G}):void 0}(),t.photo&&(0,us.Y)(Jo.A,{size:"large",photo:t.photo,className:(0,Kt.A)("channel-avatar",I.isRtl&&"is-rtl")}),(0,us.FD)("span",{className:(0,Kt.A)("message-title message-type",J&&"has-media"),children:[t.isRecommended?I("Message.RecommendedLabel"):I("SponsoredMessage"),(0,us.Y)(Oo.A,{onClick:D,className:"ad-about",children:I("SponsoredMessageAdWhatIsThis")})]}),function(){if(t)return(0,us.FD)(us.FK,{children:[(0,us.Y)("div",{className:"message-title message-peer",dir:"auto",children:t.title}),Boolean(t.content?.text)&&(0,us.Y)("div",{className:"text-content with-meta",dir:"auto",ref:b,children:(0,us.Y)("span",{className:"text-content-inner",dir:"auto",children:(0,Do.fd)({text:t.content.text.text,entities:t.content.text.entities})})}),(0,us.Y)(Es.A,{className:"SponsoredMessage__button",size:"tiny",color:"translucent",isRectangular:!0,onClick:E,children:t.buttonText})]})}()]}),(0,us.Y)(Vo.A,{}),(0,us.FD)("div",{className:"message-action-buttons",children:[(0,us.Y)(Es.A,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:I("Close"),onClick:x,children:(0,us.Y)(Ys.A,{name:"close",className:"sponsored-action-icon"})}),t.canReport&&(0,us.Y)(Es.A,{className:"message-action-button",color:"translucent-white",round:!0,size:"tiny",ariaLabel:I("More"),onClick:P,onContextMenu:P,children:(0,us.Y)(Ys.A,{name:"more",className:"sponsored-action-icon"})})]})]}),k&&(0,us.Y)(qo,{isOpen:M,anchor:k,triggerRef:y,randomId:t.randomId,canReport:t.canReport,sponsorInfo:t.sponsorInfo,additionalInfo:t.additionalInfo,onClose:T,onCloseAnimationEnd:U})]},"sponsored-message")}))),Ko=(0,jt.ph)((({canShowAds:e,chatId:t,threadId:s,messageIds:o,messageGroups:r,getContainerHeight:c,isViewportNewest:l,isUnread:u,isComments:p,isEmptyThread:m,withUsers:f,isChannelChat:b,noAvatars:S,containerRef:A,anchorIdRef:M,memoUnreadDividerBeforeIdRef:k,memoFirstUnreadIdRef:F,type:P,isReady:T,hasLinkedChat:U,isSchedule:x,shouldRenderAccountInfo:B,nameChangeDate:N,photoChangeDate:R,noAppearanceAnimation:J,isSavedDialog:E,onScrollDownToggle:Y,onNotchToggle:D,onIntersectPinnedMessage:O,canPost:G})=>{const{openHistoryCalendar:V}=(0,w.ko)(),j=jt.OV,q=(0,Na.A)((()=>T&&!j()),[T,j]),W=!E&&!x,{observeIntersectionForReading:z,observeIntersectionForLoading:K,observeIntersectionForPlaying:_}=function(e,t,s,a,o){const{markMessageListRead:n,markMentionsRead:i,animateUnreadReaction:r,scheduleForViewsIncrement:d}=(0,w.ko)(),{isMobile:c}=(0,L.Ay)(),l=c?300:500,{observe:u,freeze:h,unfreeze:p}=(0,To.BL)({rootRef:t,throttleMs:150},(t=>{if("thread"!==e||(0,rs.g)())return;let c=0;const l=[],u=[],h=[],p=[],m=[];t.forEach((e=>{const{isIntersecting:t,target:s}=e,{dataset:a}=s,o=Number(a.lastMessageId||a.messageId),n="true"===a.shouldUpdateViews,i=a.albumMainId?Number(a.albumMainId):void 0;t?(o>c&&(c=o),a.hasUnreadMention&&l.push(o),a.hasUnreadReaction&&u.push(o),a.isPinned&&h.push(i||o),n&&m.push(i||o)):a.isPinned&&p.push(i||o)})),s.current&&c>=s.current&&n({maxId:c}),l.length&&i({chatId:o,messageIds:l}),u.length&&r({messageIds:u}),(h.length||p.length)&&a({viewportPinnedIdsToAdd:h,viewportPinnedIdsToRemove:p}),m.length&&d({chatId:o,ids:m})}));(0,rs.A)(h,p);const{observe:m}=(0,To.BL)({rootRef:t,throttleMs:Uo,margin:l}),{observe:g}=(0,To.BL)({rootRef:t,throttleMs:Uo});return{observeIntersectionForReading:u,observeIntersectionForLoading:m,observeIntersectionForPlaying:g}}(P,A,F,O,t),{withHistoryTriggers:H,backwardsTriggerRef:X,forwardsTriggerRef:$,fabTriggerRef:Q}=function(e,t,s,a,o,n,r,c,l){const{loadViewportMessages:u}=(0,w.ko)(),[h,p]=(0,jt.Kr)((()=>"thread"===e?[(0,I.sg)((()=>u({direction:i.TN.Backwards})),1e3,!0,!1),(0,I.sg)((()=>u({direction:i.TN.Forwards})),1e3,!0,!1)]:[]),[u,s]),m=(0,jt.li)(),g=(0,jt.li)(),f=(0,jt.li)(),b=(0,ts.A)((()=>{if(!l)return;if(!s?.length)return r(!1),void c(!1);if(!o)return r(!0),void c(!0);const e=t.current,a=f.current;if(!e||!a)return;const{offsetHeight:i,scrollHeight:d,scrollTop:u}=e,h=a.offsetTop,p=Math.round(h-u-i),m=p<=1;0!==d&&(r(n?!m:!(p<=50)),c(!m))})),{observe:v}=(0,To.BL)({rootRef:t,margin:d.et},(e=>{p&&h&&e.forEach((({isIntersecting:e,target:t})=>{e&&("backwards-trigger"===t.className&&h(),"forwards-trigger"===t.className&&p())}))})),y=s&&s.length>1;(0,To.mv)(m,y?v:void 0),(0,To.mv)(g,y?v:void 0);const{observe:S,freeze:A,unfreeze:C}=(0,To.BL)({rootRef:t,margin:100,throttleScheduler:zt.YS},b);(0,To.mv)(f,S);const{observe:M,freeze:k,unfreeze:F}=(0,To.BL)({rootRef:t,margin:1,throttleScheduler:zt.YS},b);(0,To.mv)(f,M),(0,jt.vJ)((()=>{l&&b()}),[l,b]);const P=(0,ts.A)((()=>{A(),k(),setTimeout((()=>{F(),C()}),350)}));(0,is.A)(P,[P,s]);const T=(0,xo.D7)(a,200);return(0,Bo.R)(P,[P,T]),{withHistoryTriggers:y,backwardsTriggerRef:m,forwardsTriggerRef:g,fabTriggerRef:f}}(P,A,o,c,l,u,Y,D,T),Z=(0,Rs.A)(),ee=(0,es.A)(),te=(0,us.Y)("div",{className:(0,Kt.A)("unread-divider","local-action-message"),children:(0,us.Y)("span",{children:Z("UnreadMessages")})},"unread-messages"),se=(e,t)=>{if(e.paidMessageStars){const s=t?.messages?.length||1,a=e.paidMessageStars*s;return(0,us.Y)("div",{className:(0,Kt.A)("local-action-message"),children:(0,us.Y)("span",{children:e.isOutgoing?ee("ActionPaidOneMessageOutgoing",{amount:(0,g.K)(ee,a)}):(()=>{const t=(0,C.Y7C)((0,w.mS)(),e),s=t?(0,y.F9)(ee,t):"";return ee("ActionPaidOneMessageIncoming",{user:s,amount:(0,g.K)(ee,a)})})()})},`paid-messages-action-${e.id}`)}},ae=J?0:r.reduce(((e,t)=>e+t.senderGroups.flat().length),0);let oe=0;const ne=(0,Pa.A)(o),ie=Boolean(o&&ne&&o[o.length-2]===ne[ne.length-1]),re=r.map(((e,t,o)=>{const i=function(e,t,a){return e.senderGroups.map(((e,o,i)=>{if(1===e.length&&!oo(e[0])&&(0,v._P)(e[0])&&"phoneCall"!==e[0].content.action?.type){const n=e[0],r=o===i.length-1&&t===a.length-1;return(0,h.oE)([n.id===k.current&&te,(0,us.Y)(No.A,{message:n,threadId:s,observeIntersectionForBottom:z,observeIntersectionForLoading:K,observeIntersectionForPlaying:_,memoFirstUnreadIdRef:F,appearanceOrder:ae-++oe,isJustAdded:r&&ie,isLastInList:r,getIsMessageListReady:q,onIntersectPinnedMessage:O},n.id)])}let r;const d=e.map(((d,c)=>{const l=oo(d)?d.mainMessage:d,u=oo(d)?d:void 0,g=(0,v.Ie)(l),I=oo(d),y=e[c+1];l.previousLocalId&&M.current===(0,v.GZ)(l.previousLocalId)&&(M.current=(0,v.GZ)(l.id));const w=!I&&l.groupedId?l.groupedId:void 0,A=y&&!oo(y)?y.groupedId:void 0,C=l.id===s,T={isFirstInGroup:0===c,isLastInGroup:c===e.length-1,isFirstInDocumentGroup:Boolean(w&&w!==r),isLastInDocumentGroup:Boolean(w&&w!==A),isLastInList:c===e.length-1&&o===i.length-1&&t===a.length-1};r=w;const x=(0,v.sj)(l),B=(0,v.u7)(l)?`${l.date}_${x}`:x,N=!1===U||!b;return(0,h.oE)([l.id===k.current&&te,l.paidMessageStars&&!f&&se(l,u),(0,us.Y)(Ro.A,{message:l,observeIntersectionForBottom:z,observeIntersectionForLoading:K,observeIntersectionForPlaying:_,album:u,noAvatars:S,withAvatar:T.isLastInGroup&&f&&!g&&(!C||!p),withSenderName:T.isFirstInGroup&&f&&!g,threadId:s,messageListType:P,noComments:N,noReplies:!N||s!==n.l3||"scheduled"===P,appearanceOrder:ae-++oe,isJustAdded:T.isLastInList&&ie,isFirstInGroup:T.isFirstInGroup,isLastInGroup:T.isLastInGroup,isFirstInDocumentGroup:T.isFirstInDocumentGroup,isLastInDocumentGroup:T.isLastInDocumentGroup,isLastInList:T.isLastInList,memoFirstUnreadIdRef:F,onIntersectPinnedMessage:O,getIsMessageListReady:q},B),l.id===s&&(0,us.Y)("div",{className:"local-action-message",children:(0,us.Y)("span",{children:Z(m?p?"NoComments":"NoReplies":"DiscussionStarted")})},"discussion-started")])})).flat();if(!f)return d;const c=e[e.length-1],l=oo(c)?c.mainMessage:c,u=(0,v.sj)(l),g=ae-oe,I=l.id===s,y=(0,v.Ie)(l),w=e[0],A=oo(w)?w.mainMessage:w,C=(0,v.sj)(A),T=`${C}-${u}`,x=C===u?`message-group-${C}`:`message-group-${C}-${u}`,B=f&&!y&&(!I||!p);return(0,us.Y)(Yo,{id:x,message:l,withAvatar:B,appearanceOrder:g,canPost:G,children:d},T)}))}(e,t,o);return(0,us.FD)("div",{className:(0,Kt.A)("message-date-group",!(N||R)&&0===t&&"first-message-date-group"),onMouseDown:io.l,teactFastList:!0,children:[(0,us.Y)("div",{className:(0,Kt.A)("sticky-date",W&&"interactive"),onMouseDown:io.l,onClick:W?()=>V({selectedAt:e.datetime}):void 0,children:(0,us.FD)("span",{dir:"auto",children:[x&&e.originalDate===a.NkL&&Z("MessageScheduledUntilOnline"),x&&e.originalDate!==a.NkL&&Z("MessageScheduledOn",(0,we.F5)(Z,e.datetime,void 0,!0)),!x&&(0,we.F5)(Z,e.datetime)]})},"date-header"),i.flat()]},e.datetime)}));return(0,us.FD)("div",{className:"messages-container",teactFastList:!0,children:[H&&(0,us.Y)("div",{ref:X,className:"backwards-trigger"},"backwards-trigger"),B&&(0,us.Y)(Po,{chatId:t},`account_info_${t}`),re.flat(),H&&(0,us.Y)("div",{ref:$,className:"forwards-trigger"},"forwards-trigger"),(0,us.Y)("div",{ref:Q,className:"fab-trigger"},"fab-trigger"),e&&l&&(0,us.Y)(zo,{chatId:t,containerRef:A,observeIntersectionForLoading:K,observeIntersectionForPlaying:_},t)]})}));var _o=s(38102);const Ho=3*x.$,Xo=(0,jt.ph)((({isChatWithSelf:e,type:t,isGroupChatJustCreated:s,topic:a})=>{const o=(0,Rs.A)();return"scheduled"===t?function(e){return(0,us.Y)("div",{className:"empty",children:(0,us.Y)("span",{children:e("ScheduledMessages.EmptyPlaceholder")})})}(o):e?function(e){return(0,us.Y)("div",{className:"NoMessages",children:(0,us.FD)("div",{className:"wrapper",children:[(0,us.Y)(Ys.A,{name:"cloud-download",className:"no-messages-icon"}),(0,us.Y)("h3",{className:"title",children:e("Conversation.CloudStorageInfo.Title")}),(0,us.FD)("ul",{className:"description",children:[(0,us.Y)("li",{children:e("Conversation.ClousStorageInfo.Description1")}),(0,us.Y)("li",{children:e("Conversation.ClousStorageInfo.Description2")}),(0,us.Y)("li",{children:e("Conversation.ClousStorageInfo.Description3")}),(0,us.Y)("li",{children:e("Conversation.ClousStorageInfo.Description4")})]})]})})}(o):s?function(e){return(0,us.Y)("div",{className:"NoMessages",children:(0,us.FD)("div",{className:"wrapper",dir:e.isRtl?"rtl":void 0,children:[(0,us.Y)("h3",{className:"title",children:e("EmptyGroupInfo.Title")}),(0,us.Y)("p",{className:"description",children:e("EmptyGroupInfo.Subtitle")}),(0,us.FD)("ul",{className:"list-checkmarks",children:[(0,us.Y)("li",{children:e("EmptyGroupInfo.Line1")}),(0,us.Y)("li",{children:e("EmptyGroupInfo.Line2")}),(0,us.Y)("li",{children:e("EmptyGroupInfo.Line3")}),(0,us.Y)("li",{children:e("EmptyGroupInfo.Line4")})]})]})})}(o):a?function(e,t){return(0,us.Y)("div",{className:"NoMessages",children:(0,us.FD)("div",{className:"wrapper",children:[(0,us.Y)(_o.A,{topic:t,size:Ho,className:"no-messages-icon topic-icon"}),(0,us.Y)("h3",{className:"title",children:e("Chat.EmptyTopicPlaceholder.Title")}),(0,us.Y)("p",{className:"description topic-description",children:(0,Io.A)(e("Chat.EmptyTopicPlaceholder.Text"),["br"])})]})})}(o,a):(0,us.Y)("div",{className:"empty",children:(0,us.Y)("span",{children:o("NoMessages")})})}));var $o=s(78376),Qo=s(64489),Zo=s(85118);const en=(0,jt.ph)((0,w.EK)(((e,{userId:t})=>{const s=(0,C.SJA)(e),{patternColor:a}=(0,C.Gyz)(e,s)||{},o=(0,C.mBe)(e,t);return{patternColor:a,userName:(0,v.u0)(o)}}))((function({patternColor:e,userName:t,paidMessagesStars:s}){const a=(0,Rs.A)(),o=(0,es.A)(),{openPremiumModal:n,openStarsBalanceModal:i}=(0,w.ko)(),r=(0,ts.A)((()=>n())),d=(0,ts.A)((()=>{i({})}));return(0,us.Y)("div",{className:"J2RfusJI",children:(0,us.FD)("div",{className:"C90W_KKX",children:[(0,us.FD)("div",{className:"Qi7tZATP",children:[(0,us.Y)(Qo.A,{tgsUrl:$o.w.Unlock,size:54,color:e,className:"lfcZJyxp"}),(0,us.Y)(Ys.A,{name:"comments-sticker",className:"zd5EAc5e"})]}),(0,us.Y)("span",{className:"E_YZ3IQs",children:s?o("FirstMessageInPaidMessagesChat",{user:t,amount:(0,g.U)(o,s,{asFont:!0,className:"C_e1ij6A",containerClassName:"IL_EHscS"})},{withNodes:!0,withMarkdown:!0}):(0,Io.A)(a("MessageLockedPremium",t),["simple_markdown"])}),(0,us.Y)(Es.A,{color:"translucent-black",size:"default",pill:!0,onClick:s?d:r,className:"Nz8BOo0i",children:s?(0,us.FD)(us.FK,{children:[o("ButtonBuyStars"),(0,us.Y)(Zo.A,{preset:"button"})]}):a("MessagePremiumUnlock")})]})})}))),tn=(0,I.sg)((e=>e()),200,!1),sn=(0,jt.ph)((0,w.EK)(((e,{chatId:t,threadId:s,type:o})=>{const i=e.currentUserId,r=(0,C.hds)(e,t),d=(0,C.vGo)(e,t);if(!r)return{currentUserId:i};const c=(0,C.vRX)(e,t,s,o),l="scheduled"===o?(0,C.yFI)(e,t):(0,C.zeq)(e,t),u=(0,v.cG)(t,s,i);if(!(s===n.l3||u||r?.isForum||l&&s&&l[Number(s)]))return{currentUserId:i};const{isRestricted:h,restrictionReason:p}=r,m=(0,C.yHC)(e,t,u?"saved":"all"),g=(0,C.kdX)(e,t),f=s===n.l3&&!c&&!r.unreadCount&&!g&&m&&!m.groupedId,I=(0,C.yps)(e,t),b=Boolean(d?.settings?.canAddContact),y=d?.settings?.nameChangeDate,w=d?.settings?.photoChangeDate,S=(0,C.S0q)(e,t,s),A=(0,k.L8)(t)?void 0:(0,C.AWZ)(e,t),M=!(0,C.Vw0)(e,t,s)?.messagesCount,F=!(0,C.g29)(e)||(0,C.vGo)(e,i)?.areAdsEnabled,P=(0,C.trm)(e),T=Boolean(d?.businessIntro),U=e.isAppConfigLoaded;return{areAdsEnabled:F,isChatLoaded:!0,isRestricted:h,restrictionReason:p,isChannelChat:(0,v.WX)(r),isGroupChat:(0,v.YE)(r),isChannelWithAvatars:r.areProfilesShown,isCreator:r.isCreator,isChatWithSelf:(0,C.nZ4)(e,t),isSystemBotChat:(0,v.DX)(t),isAnonymousForwards:(0,v.Qe)(t),isBot:Boolean(I),isNonContact:b,nameChangeDate:y,photoChangeDate:w,isSynced:e.isSynced,messageIds:c,messagesById:l,firstUnreadId:(0,C.RjD)(e,t,s),isViewportNewest:"thread"!==o||(0,C.haw)(e,t,s),focusingId:g,isSelectModeActive:(0,C.rTV)(e),hasLinkedChat:A?Boolean(A.linkedChatId):void 0,channelJoinInfo:A?.joinInfo,topic:S,noMessageSendingAnimation:!(0,C.xYJ)(e,"messageSendingAnimations"),isServiceNotificationsChat:t===a.zv8,isForum:r.isForum,isEmptyThread:M,currentUserId:i,isChatProtected:(0,C.ryq)(e,t),...f&&{lastMessage:m},isAccountFrozen:P,hasCustomGreeting:T,isAppConfigLoaded:U}}))((({chatId:e,threadId:t,type:s,isChatLoaded:o,isForum:r,isChannelChat:d,isGroupChat:c,isChannelWithAvatars:l,canPost:u,isSynced:m,isReady:g,isChatWithSelf:f,isSystemBotChat:b,isAnonymousForwards:y,isCreator:S,isBot:A,isNonContact:M,nameChangeDate:F,photoChangeDate:P,messageIds:T,messagesById:U,firstUnreadId:x,isComments:B,isViewportNewest:N,isRestricted:R,restrictionReason:J,isEmptyThread:E,focusingId:Y,isSelectModeActive:D,lastMessage:L,hasLinkedChat:O,withBottomShift:G,withDefaultBg:V,topic:j,noMessageSendingAnimation:q,isServiceNotificationsChat:W,currentUserId:z,isContactRequirePremium:K,paidMessagesStars:_,areAdsEnabled:H,channelJoinInfo:X,isChatProtected:$,onIntersectPinnedMessage:Q,onScrollDownToggle:Z,onNotchToggle:ee,isAccountFrozen:te,hasCustomGreeting:se,isAppConfigLoaded:ae})=>{const{loadViewportMessages:oe,setScrollOffset:ne,loadSponsoredMessages:ie,loadMessageReactions:re,copyMessagesByIds:de,loadMessageViews:ce,loadPeerStoriesByIds:le,loadFactChecks:ue}=(0,w.ko)(),he=(0,jt.li)(),pe=(0,jt.li)("thread"===s&&(0,C.j_4)((0,w.mS)(),e,t)||(0,C.rKQ)((0,w.mS)(),e,t)||0),me=(0,jt.li)(),ge=(0,jt.li)(),fe=(0,jt.li)(),Ie=(0,jt.li)(),be=(0,jt.li)(),ve=(0,jt.li)(),ye=(0,jt.li)(!1),we=(0,jt.li)(Boolean(L)),Se=(0,v.cG)(e,t,z),Ae=Se&&t!==a.Ckz,Ce=Boolean(T),Me=(0,k.L8)(e),ke=Boolean(!Me&&!d||f||b||y||l);(0,is.A)((()=>{Ce&&(0,I.aj)((()=>{we.current=!1}))}),[Ce]),(0,is.A)((()=>{Ie.current=x}),[x]),(0,jt.vJ)((()=>{H&&(d||A)&&m&&g&&ae&&ie({peerId:e})}),[e,m,g,d,A,H,ae]),(0,is.A)((()=>{Ce&&(be.current=Ie.current)}),[Ce]),(0,is.A)((()=>{ve.current=Y}),[Y]),(e=>{const t=(0,ts.A)((t=>{const s=(0,lo.A)();s&&s.length>1&&(t.preventDefault(),e({messageIds:s}))}));(0,ks.v)((0,jt.Kr)((()=>({"Mod+C":t})),[]))})(de);const Fe=(0,jt.Kr)((()=>{if(!T?.length||!U)return;const e=[];T.forEach(((t,a,o)=>{const n=e[e.length-1],i=U[t];if(!i)return;const{shouldAppendJoinMessage:r,shouldAppendJoinMessageAfterCurrent:d}=(()=>{if(X&&"thread"===s)return n&&n.date<X.joinedDate&&X.joinedDate<=i.date?{shouldAppendJoinMessage:!0,shouldAppendJoinMessageAfterCurrent:!1}:a===o.length-1&&i.date<X.joinedDate?{shouldAppendJoinMessage:!0,shouldAppendJoinMessageAfterCurrent:!0}:void 0})()||{};if(d&&e.push(i),r){const t=d?i.id:n?.id||i.id-1;e.push({id:an(t),chatId:i.chatId,date:X.joinedDate,isOutgoing:!1,content:{action:{mediaType:"action",type:"channelJoined",inviterId:X?.inviterId,isViaRequest:X?.isViaRequest||void 0}}})}d||e.push(i)}));const a="scheduled"===s||W?["date","id"]:["id"];return e.length?no((0,h.My)(e,a),be.current,r?void 0:Number(t),f,ke):void 0}),[ke,T,U,s,W,r,t,f,X]);(0,$t.A)((()=>{if(!T||!U||"scheduled"===s||te)return;if(!d&&!c)return;const t=T.filter((e=>{const t=U[e];return t&&t.reactions?.results.length&&!t.content.action}));t.length&&re({chatId:e,ids:t})}),2e4),(0,$t.A)((()=>{if(!T||!U||"scheduled"===s)return;const e=T.map((e=>U[e]?.content.storyData)).filter(Boolean);if(!e.length)return;const t=e.reduce(((e,t)=>{const{peerId:s,id:a}=t;return e[s]||(e[s]=[]),e[s].push(a),e}),{});Object.entries(t).forEach((([e,t])=>{le({peerId:e,storyIds:t})}))}),3e5),(0,$t.A)((()=>{if(!T||!U||t!==n.l3||"scheduled"===s)return;const a=(0,w.mS)(),o=T.filter((t=>(0,C.Vw0)(a,e,t)?.isCommentsInfo||void 0!==U[t]?.viewsCount));o.length&&ce({chatId:e,ids:o})}),2e4,!0),(0,$t.A)((()=>{if(!T||!U||t!==n.l3||"scheduled"===s)return;const a=T.filter((e=>U[e]?.factCheck?.shouldFetch));a.length&&ue({chatId:e,ids:a})}),5e3);const Pe=(0,jt.Kr)((()=>{if("thread"===s)return(0,I.sg)((()=>oe({direction:i.TN.Around})),1e3,!0,!1)}),[oe,T]),{isScrolled:Te,updateStickyDates:Ue}=function(){const[e,t]=(0,Ta.A)(!1),s=(0,uo.A)(1e3,!0);return{isScrolled:e,updateStickyDates:(0,ts.A)((e=>{t(),document.body.classList.contains("is-scrolling-messages")||(0,zt.RK)((()=>{document.body.classList.add("is-scrolling-messages")})),s((()=>{const t=function(e){const t=e.querySelectorAll(".sticky-date"),s=e.scrollTop,a=getComputedStyle(e),o=parseInt(a.getPropertyValue("--middle-header-panes-height"),10);return Array.from(t).find((e=>{const{offsetTop:t,offsetHeight:a}=e,n=t-s;return-a<=n&&n<=o+10}))}(e);(0,zt.RK)((()=>{const e=document.querySelector(".stuck");e&&e.classList.remove("stuck"),t&&t.classList.add("stuck"),document.body.classList.remove("is-scrolling-messages")}))}))}))}}(),xe=(0,ts.A)((()=>{if(ye.current)return void(ye.current=!1);const a=he.current;a&&(ve.current||Ue(a),tn((()=>{const o=(0,w.mS)();Boolean((0,C.nTw)(o).focusedMessage?.chatId)||Q({shouldCancelWaiting:!0}),a.parentElement&&(pe.current=a.scrollHeight-a.scrollTop,"thread"===s&&ne({chatId:e,threadId:t,scrollOffset:pe.current}))})))})),[Be,Ne]=function(e,t){const[s,a]=(0,jt.Ul)(),o=(0,ts.A)((e=>{a(e.contentRect.height)}));(0,Ua.A)(e,o),(0,jt.vJ)((()=>{const a=Number(e.current.dataset.normalHeight)||0,o=s();o&&o>a&&t&&(e.current.dataset.normalHeight=String(o))}),[t,e,s]);const n=(0,jt.li)();return[s,n]}(he,u&&!D);(0,jt.vJ)((()=>{if(!Pe||!o||R||Y)return;if(T&&(0,p.iL)(T[T.length-1]))return;const e=he.current;(!T||1===T.length||T.length<a.yo2/2&&e.firstElementChild.clientHeight<=e.offsetHeight)&&Pe()}),[o,T,Pe,Y,R]);const Re=(0,Ps.i)((()=>{if(!T||!fe.current)return;const e=fe.current.filter((e=>T.includes(Number(e.dataset.messageId)))),t=e[1]||e[0];t&&(me.current=t.id,ge.current=t.getBoundingClientRect().top)}));(0,is.A)((()=>(0,zt.Uj)((()=>Re.current()))),[T,N,Re]),(0,jt.vJ)((()=>Re.current()),[Be,Re]),(0,co.A)((([e,t])=>{const s=Be(),o=Ne.current;if(Ne.current=s,T===e&&N===t&&s!==o&&void 0===o)return;const n=he.current;fe.current=Array.from(n.querySelectorAll(".message-list-item"));const i=fe.current[fe.current.length-1],r=Ie.current?n.querySelector(`#${(0,v.GZ)(Ie.current)}`):void 0,d=T&&e&&T[T.length-1]!==e[e.length-1],c=T?.[0]!==e?.[0]&&T?.length===a.yo2/2+1,l=d&&!c;N&&l&&T&&T.length<a.yo2/2&&!n.parentElement.classList.contains("force-messages-scroll")&&(0,zt.Uj)((()=>n.firstElementChild.clientHeight<=2*n.offsetHeight))&&((0,qt.YM)(n.parentElement,"force-messages-scroll"),n.parentElement.classList.add("force-messages-scroll"),setTimeout((()=>{n.parentElement&&(0,qt.HW)(n.parentElement,"force-messages-scroll")}),500)),(0,zt.gm)((()=>{const{scrollTop:e,scrollHeight:a,offsetHeight:d}=n,c=pe.current;let u=c-(o||d);l&&(u-=i?i.offsetHeight:0);const h=N&&t&&u<=50,p=T&&ve.current===T[T.length-1];l&&h&&!p&&(0,zt.YS)((()=>{const e=!(0,rs.g)()||!r;(0,it.Ay)({container:n,element:e?i:r,position:e?"end":"start",margin:20,forceDuration:q?0:void 0})}));const m=void 0!==o&&o!==s;if(m&&(0,it.o8)())return;const g=me.current&&n.querySelector(`#${me.current}`),f=!g&&be.current&&n.querySelector(".unread-divider");let I;if(h&&m)I=a-d;else if(g){const t=g.getBoundingClientRect().top;I=e+(t-(ge.current||0))}else I=f?Math.min((0,ao.A)(f,n).top-10,a-c):a-c;return()=>{(0,so.A)(n,Math.ceil(I)),(0,it._v)(),pe.current=Math.max(Math.ceil(a-I),d),ve.current||(ye.current=!0,(0,zt.YS)((()=>{ye.current=!1})))}}))}),[T,N,Be,Ne,q]),(0,ro.A)((([e])=>{void 0!==e&&(0,jt.VK)(200+a.xB5)}),[D]);const Je=Boolean(!ke||d&&!l),Ee=(0,k.L8)(e)&&!f&&!A&&!y&&"thread"===s&&(!Fe&&!L&&T&&(!fe.current||0===fe.current.length)||1===T?.length&&"contactSignUp"===U?.[T[0]]?.content.action?.type||"contactSignUp"===L?.content?.action?.type),Ye=c&&S&&1===T?.length&&"chatCreate"===U?.[T[0]]?.content.action?.type,De=1===T?.length&&"topicCreate"===U?.[T[0]]?.content.action?.type,Le=(0,Kt.A)("MessageList custom-scroll",Je&&"no-avatars",!u&&"no-composer","pinned"===s&&"type-pinned",G&&"with-bottom-shift",V&&"with-default-bg",D&&"select-mode-active",Te&&"scrolled",!g&&"is-animating",Ae&&"saved-dialog",$&&"hide-on-print"),Oe=T&&Fe||L;return(0,jt.vJ)((()=>{Oe||Z(!1)}),[Oe,Z]),(0,us.Y)("div",{ref:he,className:Le,onScroll:xe,onMouseDown:io.l,children:R?(0,us.Y)("div",{className:"empty",children:(0,us.Y)("span",{children:J?J.text:"This is a private "+(d?"channel":"chat")})}):_&&Me&&!Oe&&!se?(0,us.Y)(en,{paidMessagesStars:_,userId:e}):K&&!Oe?(0,us.Y)(en,{userId:e}):!A&&!M||Oe?Ee?(0,us.Y)(po,{userId:e},e):T&&(!Fe||Ye||De)?(0,us.Y)(Xo,{chatId:e,topic:j,type:s,isChatWithSelf:f,isGroupChatJustCreated:Ye}):Oe?(0,us.Y)(Ko,{canShowAds:H&&d,chatId:e,isComments:B,isChannelChat:d,isSavedDialog:Se,messageIds:T||[L.id],messageGroups:Fe||no([L]),getContainerHeight:Be,isViewportNewest:Boolean(N),isUnread:Boolean(x),isEmptyThread:E,withUsers:ke,noAvatars:Je,containerRef:he,anchorIdRef:me,memoUnreadDividerBeforeIdRef:be,memoFirstUnreadIdRef:Ie,threadId:t,type:s,isReady:g,hasLinkedChat:O,isSchedule:!!Fe&&"scheduled"===s,shouldRenderAccountInfo:A||M,nameChangeDate:F,photoChangeDate:P,noAppearanceAnimation:!Fe||!we.current,onScrollDownToggle:Z,onNotchToggle:ee,onIntersectPinnedMessage:Q,canPost:u}):(0,us.Y)(Us.A,{color:"white",backgroundColor:"dark"}):(0,us.Y)(Po,{chatId:e})})})));function an(e){return e+1e-6}const on=e=>{const{isActive:t}=e,s=(0,ls.A)(Xt.ar.Extra,"MessageSelectToolbar",!t);return s?(0,us.Y)(s,{...e}):void 0};let nn=function(e){return e[e.waitingForNetwork=0]="waitingForNetwork",e[e.syncing=1]="syncing",e[e.online=2]="online",e}({});var rn=s(38218),dn=s(51083),cn=s(17751),ln=s(48553),un=s(53827),hn=s(49642),pn=s(88792),mn=s(14),gn=s(24909),fn=s(56863);const In=s.p+"telegram-logo-filled.67469f6dc5e301e8e0bd.svg",bn={width:200,height:200},vn=115;var yn=s(48885),wn=s(22699),Sn=s(82497),An=s(42452);const Cn={.5:.66,.75:.8,1:1,1.5:1.4,2:1.8},Mn=Object.keys(Cn).sort().map(Number);function kn(e){const{title:t,performer:s,fileName:a}=e;return(0,us.FD)(us.FK,{children:[(0,us.Y)("div",{className:"title",dir:"auto",children:(0,Io.A)(t||a)}),s&&(0,us.Y)("div",{className:"subtitle",dir:"auto",children:(0,Io.A)(s)})]})}function Fn(e,t){return(0,us.FD)(us.FK,{children:[(0,us.Y)("div",{className:"title",dir:"auto",children:t&&(0,Io.A)(t)}),(0,us.Y)("div",{className:"subtitle",dir:"auto",children:e})]})}const Pn=(0,w.EK)(((e,{isHidden:t})=>{const{audioPlayer:s}=(0,C.nTw)(e),{chatId:a,messageId:o}=s,n=!t&&a&&o?(0,C.O5q)(e,a,o):void 0,i=n&&(0,C.Y7C)(e,n),r=n&&(0,C.hds)(e,n.chatId),{volume:d,playbackRate:c,isMuted:l,isPlaybackRateActive:u,timestamp:h}=(0,C.nTw)(e).audioPlayer;return{message:n,sender:i,chat:r,volume:d,playbackRate:c,isPlaybackRateActive:u,isMuted:l,timestamp:h}}))((({message:e,className:t,noUi:s,sender:o,chat:n,volume:i,playbackRate:r,isPlaybackRateActive:c,isMuted:l,isFullWidth:u,timestamp:h,onPaneStateChange:p})=>{const{setAudioPlayerVolume:m,setAudioPlayerPlaybackRate:g,setAudioPlayerMuted:f,focusMessage:I,closeAudioPlayer:b}=(0,w.ko)(),S=(0,Rs.A)(),{isMobile:A}=(0,L.Ay)(),C=(0,mn.A)(e),{audio:M,voice:k,video:F}=C?(0,v.r_)(C):{},P=Boolean(k||F),T=P||(M?.duration||0)>a.CVm,U=o?(0,y.F9)(S,o):void 0,B=C&&(0,v.EO)(C,"inline"),N=B&&at.Ih(B),R=((e,t,s)=>{const a=(0,Rs.A)(),{audio:o,voice:n}=e?(0,v.r_)(e):{},i=o?o.title||o.fileName:n?"Voice message":"",r=o?.performer||t&&(0,y.F9)(a,t),d=s&&(0,v.Js)(a,s)||"Telegram",c=o&&(0,v.AB)(o)&&(0,v.VO)(o,"pictogram"),l=t&&(0,v.cP)(t,"big"),u=o&&c||n&&l,h=(0,bo.A)(u),p=(0,jt.Kr)((()=>function(e,t,s){if(!s)return bn;if(e){if(!e.thumbnailSizes?.length)return;const t=e.thumbnailSizes.find((e=>"m"===e.type));return t||e.thumbnailSizes[0]}return t?x.cf:void 0}(o,n,h)),[o,h,n]),{result:m}=(0,fn.A)((()=>function(e,t){if(!e)return Promise.resolve(In);if(!t)return(0,gn.y)(e,vn,vn);const s=Math.min(t.width,t.height);if(s<vn){const t=vn/s;return(0,gn.s)(e,t)}return Promise.resolve(e)}(h,p)),[h,p],In);return(0,jt.Kr)((()=>(0,hn.wp)({title:i,artist:r,album:d,artwork:[{src:m}]})),[d,r,i,m])})(C,o,n),{playPause:J,stop:E,isPlaying:Y,requestNextTrack:D,requestPreviousTrack:O,isFirst:G,isLast:V,setVolume:j,toggleMuted:q,setPlaybackRate:W,setCurrentTime:z}=(0,pn.A)(e&&(0,un.dj)(e),e?(0,v.Fk)(e):0,P?"voice":"audio",N,void 0,R,void 0,!0,void 0,void 0,e&&(0,v.Nb)(e),!0),K=Boolean(e),{ref:_}=(0,ns.A)({isOpen:K,shouldForceOpen:u}),{ref:H,shouldRender:X}=(0,yn.A)({isOpen:K,isDisabled:!u,ref:_,onStateChange:p}),{isContextMenuOpen:$,handleBeforeContextMenu:Q,handleContextMenu:Z,handleContextMenuClose:ee,handleContextMenuHide:te}=(0,Wa.A)(_,!X);(0,jt.vJ)((()=>{h&&z(h)}),[h,z]);const se=(0,ts.A)((()=>{const{chatId:e,id:t}=C;I({chatId:e,messageId:t})})),ae=(0,ts.A)((()=>{E&&(Y&&J(),b(),(0,hn.Eg)(),E())})),oe=(0,ts.A)((e=>{j&&(m({volume:e/100}),j(e/100))})),ne=(0,ts.A)((()=>{d.TF&&!d.pz||q&&(q(),f({isMuted:!l}))})),ie=(0,ts.A)(((e,t=!0)=>{if(!W)return;const s=Cn[e],a=1!==e&&t;g({playbackRate:s,isPlaybackRateActive:a}),W(a?s:1)})),re=(0,ts.A)((()=>{ee();const e=Number(Object.entries(Cn).find((([,e])=>e===r))?.[0])||1,t=!c;ie(t&&1===e?2:e,t)})),de=(0,ts.A)((()=>{const e=Object.entries(Cn).find((([,e])=>e===r))?.[0]||1,t=`${1===r?2:e}Х`;return(0,us.FD)("div",{className:"playback-wrapper",children:[$&&(0,us.Y)("div",{className:"playback-backdrop",onClick:ee}),(0,us.Y)(Es.A,{round:!0,className:(0,Kt.A)("playback-button",c&&"applied",$&&"on-top"),color:"translucent",size:"smaller",ariaLabel:"Playback Rate",ripple:!A,onMouseEnter:Z,onClick:re,onMouseDown:Q,onContextMenu:Z,children:(0,us.Y)("span",{className:(0,Kt.A)("playback-button-inner",4===t.length&&"small",5===t.length&&"tiny"),children:t})})]})})),ce=(0,jt.Kr)((()=>0===i||l?"muted":i<.3?"volume-1":i<.6?"volume-2":"volume-3"),[i,l]);if(!s&&X)return(0,us.FD)("div",{className:(0,Kt.A)("AudioPlayer",u?"full-width-player":"mini-player",t),dir:S.isRtl?"rtl":void 0,ref:H,children:[(0,us.FD)("div",{className:"AudioPlayer-content",onClick:se,children:[M?kn(M):Fn(S("AttachAudio"),U),(0,us.Y)(An.A,{})]}),(0,us.Y)(Es.A,{round:!0,ripple:!A,color:"translucent",size:"smaller",className:"player-button",disabled:G?.(),onClick:O,ariaLabel:"Previous track",children:(0,us.Y)(Ys.A,{name:"skip-previous"})}),(0,us.FD)(Es.A,{round:!0,ripple:!A,color:"translucent",size:"smaller",className:(0,Kt.A)("toggle-play","player-button",Y?"pause":"play"),onClick:J,ariaLabel:Y?"Pause audio":"Play audio",children:[(0,us.Y)(Ys.A,{name:"play"}),(0,us.Y)(Ys.A,{name:"pause"})]}),(0,us.Y)(Es.A,{round:!0,ripple:!A,color:"translucent",size:"smaller",className:"player-button",disabled:V?.(),onClick:D,ariaLabel:"Next track",children:(0,us.Y)(Ys.A,{name:"skip-next"})}),(0,us.FD)("div",{className:"volume-button-wrapper",children:[(0,us.Y)(Es.A,{round:!0,className:"player-button volume-button",color:"translucent",size:"smaller",ariaLabel:"Volume",onClick:ne,ripple:!A,children:(0,us.Y)(Ys.A,{name:ce})}),!d.pz&&(0,us.FD)("div",{className:"volume-slider-wrapper",children:[(0,us.Y)("div",{className:"volume-slider-spacer"}),(0,us.Y)("div",{className:"volume-slider",children:(0,us.Y)(Sn.A,{bold:!0,value:l?0:100*i,onChange:oe})})]})]}),T&&(0,us.Y)(wn.A,{forceOpen:$,positionX:"right",positionY:"top",className:"playback-rate-menu",trigger:de,onClose:ee,onHide:te,onMouseEnterBackdrop:ee,children:Mn.map((e=>function(e,t,s,a){const o=t===Cn[e]&&a||1===e&&!a;return(0,us.FD)(Ls.A,{onClick:()=>s(e),icon:o?"check":void 0,customIcon:o?void 0:(0,us.Y)(Ys.A,{name:"placeholder"}),children:[e,"X"]},e)}(e,r,ie,c)))}),(0,us.Y)(Es.A,{round:!0,className:"player-close",color:"translucent",size:"smaller",onClick:ae,ariaLabel:"Close player",children:(0,us.Y)(Ys.A,{name:"close"})})]})})),Tn=(0,jt.ph)((0,w.EK)(((e,{chatId:t,threadId:s,messageListType:a,isMobile:o})=>{const{isLeftColumnShown:i,shouldSkipHistoryAnimations:r,audioPlayer:d,messageLists:c}=(0,C.nTw)(e),l=(0,C.hds)(e,t),u=(0,C.PVB)(e,t),{chatId:h,messageId:p}=d,m=h&&p?(0,C.O5q)(e,h,p):void 0;let g;if("pinned"===a){const a=(0,C.fcC)(e,t,s);g=a?.length}else if("scheduled"===a){const a=(0,C.K3w)(e,t,s);g=a?.length}else if("thread"===a&&s!==n.l3){const a=(0,C.Vw0)(e,t,s);g=a?.messagesCount||0}const f=(0,C.C5H)(e,t,s,"typingStatus"),I=u?.emojiStatus,b=I&&e.customEmojis.byId[I.documentId],y="collectible"===I?.type?I.slug:void 0,w=(0,v.cG)(t,s,e.currentUserId);return{typingStatus:f,isLeftColumnShown:i,isRightColumnShown:(0,C.gjV)(e,o),isSelectModeActive:(0,C.rTV)(e),audioMessage:m,chat:l,messagesCount:g,isChatWithSelf:(0,C.nZ4)(e,t),shouldSkipHistoryAnimations:r,currentTransitionKey:Math.max(0,c.length-1),connectionState:e.connectionState,isSyncing:e.isSyncing,isFetchingDifference:e.isFetchingDifference,emojiStatusSticker:b,emojiStatusSlug:y,isSavedDialog:w}}))((({chatId:e,threadId:t,messageListType:s,isMobile:o,typingStatus:r,isSelectModeActive:d,isLeftColumnShown:c,audioMessage:l,chat:u,messagesCount:h,isComments:p,isChatWithSelf:m,shouldSkipHistoryAnimations:g,currentTransitionKey:f,connectionState:I,isSyncing:b,isFetchingDifference:v,getCurrentPinnedIndex:y,getLoadingPinnedId:S,emojiStatusSticker:A,emojiStatusSlug:C,isSavedDialog:M,onFocusPinnedMessage:F})=>{const{openThreadWithInfo:P,openChat:T,openPreviousChat:U,toggleLeftColumn:x,exitMessageSelectMode:B,openPremiumModal:N,openStickerSet:R,updateMiddleSearch:J,openUniqueGiftBySlug:E}=(0,w.ko)(),Y=(0,Rs.A)(),D=(0,jt.li)(!0),{isTablet:O}=(0,L.Ay)(),{width:G}=(0,xa.A)(),{isDesktop:V}=(0,L.Ay)(),j=G<=a.j7z,q=O&&c,W=(0,jt.li)(),z=(0,ts.A)((()=>{J({chatId:e,threadId:t,update:{}})})),K=(0,ts.A)((s=>{s.target.closest(".title > .custom-emoji")||P({chatId:e,threadId:t})})),{onMouseDown:_,onMouseUp:H,onMouseLeave:X,onTouchStart:$,onTouchEnd:Q}=(0,rn.A)({onStart:z,onClick:K,threshold:500}),Z=(0,ts.A)((()=>{setTimeout((()=>{D.current=!0}),450)})),ee=(0,ts.A)((()=>{C?E({slug:C}):N({fromUserId:e})})),te=(0,ts.A)((()=>{C?E({slug:C}):R({stickerSetInfo:A.stickerSetInfo})})),se=(0,ts.A)((e=>{if(D.current){if(D.current=!1,o){const e=document.querySelector(a.m$5);e?.blur()}if(d)return B(),void Z();if("thread"===s&&0===f)return!O||q?(e.stopPropagation(),T({id:void 0},{forceOnHeavyAnimation:!0})):x(),void Z();U(),Z()}})),ae=(0,Pa.A)(f),oe=void 0!==ae&&ae<f?ae:void 0,ne=Boolean(l),ie=V&&ne,{connectionStatusText:re}=function(e,t,s,a,o,n){let i,r,d;return i=function(){const[e,t]=(0,jt.J0)(window.navigator.onLine);return(0,jt.vJ)((()=>{function e(){t(window.navigator.onLine)}return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("offline",e),window.removeEventListener("online",e)}}),[]),e}()&&"connectionStateConnecting"!==t?s?nn.syncing:nn.online:nn.waitingForNetwork,r=i===nn.online||n?"none":a?"middleHeader":o?"minimized":"overlay",i===nn.waitingForNetwork?d=e("WaitingForNetwork"):i===nn.syncing&&(d=e("Updating")),"middleHeader"===r&&(d=d.toLowerCase().replace(/\.+$/,"")),{connectionStatus:i,connectionStatusPosition:r,connectionStatusText:d}}(Y,I,b||v,!0);function de(e=!1,t=!1){return(0,us.FD)("div",{className:"back-button",children:[(0,us.Y)(Es.A,{round:!0,size:"smaller",color:"translucent",onClick:se,ariaLabel:Y(e?"Close":"Back"),children:(0,us.Y)("div",{className:(0,Kt.A)("animated-close-icon",!e&&"state-back")})}),t&&(0,us.Y)(Ss,{})]})}return(0,us.FD)("div",{className:"MiddleHeader",ref:W,children:[(0,us.Y)(Ts.Ay,{name:g?"none":"slideFade",activeKey:f,shouldCleanup:!0,cleanupExceptionKey:oe,children:"thread"===s&&(t===n.l3||M||u?.isForum)?function(){const s=M?Y("SavedMessages"):void 0,a=M?String(t):e;return(0,us.FD)(us.FK,{children:[(j||f>0)&&de(q,!M),(0,us.Y)("div",{className:"chat-info-wrapper",onMouseDown:_,onMouseUp:H,onMouseLeave:X,onTouchStart:$,onTouchEnd:Q,children:(0,k.L8)(a)?(0,us.Y)(cn.A,{userId:a,typingStatus:r,status:re||s,withDots:Boolean(re),withFullInfo:!0,withMediaViewer:!0,withStory:!m,withUpdatingStatus:!0,isSavedDialog:M,storyViewerOrigin:i.G9.MiddleHeaderAvatar,emojiStatusSize:22,noRtl:!0,onEmojiStatusClick:ee},a):(0,us.Y)(dn.A,{chatId:a,threadId:M?void 0:t,typingStatus:r,status:re||s,withDots:Boolean(re),withMediaViewer:t===n.l3,withFullInfo:t===n.l3,withUpdatingStatus:!0,withStory:!0,isSavedDialog:M,storyViewerOrigin:i.G9.MiddleHeaderAvatar,emojiStatusSize:22,onEmojiStatusClick:te,noRtl:!0},a)})]})}():(0,us.FD)(us.FK,{children:[de(),(0,us.Y)("h3",{children:void 0!==h?"thread"===s?h?Y(p?"Comments":"Replies",h,"i"):Y(p?"CommentsTitle":"RepliesTitle"):"pinned"===s?Y("PinnedMessagesCount",h,"i"):"scheduled"===s?m?Y("Reminders"):Y("messages",h,"i"):void 0:Y("Loading")})]})}),(0,us.FD)("div",{className:"header-tools",children:[ie&&(0,us.Y)(Pn,{}),(0,us.Y)(ln.A,{chatId:e,threadId:t,messageListType:s,isMobile:o,canExpandActions:!ie})]})]})})));var Un=s(15283),xn=s(63744),Bn=s(35049),Nn=s(89873);const Rn=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>{const s=(0,C.yps)(e,t),a=(0,C.v8U)(e,t);return{isBot:Boolean(s),sponsoredMessage:a}}))((({chatId:e,isBot:t,messageListType:s,sponsoredMessage:a,onPaneStateChange:o})=>{const{viewSponsored:n,openUrl:i,clickSponsored:r,openAboutAdsModal:d}=(0,w.ko)(),c=(0,es.A)(),l=Boolean(t&&a&&"thread"===s),u=(0,mn.A)(a),{ref:h,shouldRender:p}=(0,yn.A)({isOpen:l,withResizeObserver:!0,onStateChange:o}),{isContextMenuOpen:m,contextMenuAnchor:g,handleBeforeContextMenu:f,handleContextMenu:I,handleContextMenuClose:b,handleContextMenuHide:v}=(0,Wa.A)(h,!p,!0),y=(0,ts.A)((()=>{u&&(r({randomId:u.randomId}),i({url:u.url,shouldSkipModal:!0}))})),S=(0,ts.A)((e=>{if(!u)return;const{randomId:t,additionalInfo:s,canReport:a,sponsorInfo:o}=u;e.stopPropagation(),d({randomId:t,additionalInfo:s,canReport:a,sponsorInfo:o})}));if((0,jt.vJ)((()=>{p&&u&&n({randomId:u.randomId})}),[p,u,e]),!p||!u)return;const{randomId:A,canReport:C,additionalInfo:M,sponsorInfo:k}=u,{peerColor:F,content:P,photo:T,title:U}=u;return(0,us.FD)(us.FK,{children:[(0,us.FD)("div",{ref:h,className:"yMkfzjus",onClick:y,onMouseDown:f,onContextMenu:I,children:[(0,us.FD)("div",{className:(0,Kt.A)("__w9Ejd3",F&&(0,Bn.a)(F)),children:[(0,us.FD)("span",{className:"wdU19Be7",children:[c("SponsoredMessageAd"),(0,us.Y)(Oo.A,{onClick:S,className:"SrgXYpPk",children:c("SponsoredMessageAdWhatIsThis")})]}),(0,us.Y)("div",{className:"u2vIptvT",children:U}),P.text&&(0,us.Y)("div",{className:"SVG6BaX3",children:(0,Do.fd)({text:P.text.text,entities:P.text.entities})})]}),T&&(0,us.Y)(Jo.A,{size:"large",photo:T,className:"AQFE1t4V"})]}),g&&(0,us.Y)(Nn.A,{isOpen:m,anchor:g,triggerRef:h,randomId:A,additionalInfo:M,canReport:C,sponsorInfo:k,onClose:b,onCloseAnimationEnd:v})]})})));var Jn=s(87412);const En=(0,jt.ph)((0,w.EK)(((e,{peerId:t})=>{const s=(0,C.kBv)(e,t),a=s?.botVerification;return{botVerification:a,wasShown:e.settings.botVerificationShownPeerIds.includes(t)}}))((({peerId:e,wasShown:t,botVerification:s,onPaneStateChange:a})=>{const o=Boolean(!t&&s),{markBotVerificationInfoShown:n}=(0,w.ko)(),{ref:i,shouldRender:r}=(0,yn.A)({isOpen:o,onStateChange:a}),d=(0,ts.A)((()=>{n({peerId:e})}));if((0,Qt.A)(d,t?void 0:5e3),r&&s)return(0,us.FD)("div",{ref:i,className:"sAWttcxl",children:[(0,us.Y)("span",{className:"tK9d2y8u",children:(0,us.Y)(Jn.A,{documentId:s.iconId,size:16})}),s.description]})})));var Yn=s(19806),Dn=s(94189);const Ln=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>({currentUserId:e.currentUserId,peer:(0,C.PVB)(e,t)})))((({chatId:e,className:t,isAutoArchived:s,canReportSpam:a,canAddContact:o,canBlockContact:n,peer:i,currentUserId:r,onPaneStateChange:d})=>{const{openAddContactDialog:c,blockUser:l,reportSpam:u,deleteChat:h,leaveChannel:p,deleteChatUser:m,deleteHistory:g,toggleChatArchived:f,hidePeerSettingsBar:I}=(0,w.ko)(),b=(0,Rs.A)(),[S,A,C]=(0,Ta.A)(),[M,k]=(0,jt.J0)(!0),[F,P]=(0,jt.J0)(!0),T=(0,mn.A)(i),U=T&&(0,y.vj)(T)?T:void 0,x=T&&(0,y.mO)(T)?T:void 0,B=U&&(0,v.yn)(U),N=(0,mn.A)(o),R=(0,mn.A)(n),J=(0,mn.A)(a),E=(0,mn.A)(s),Y=(0,ts.A)((()=>{c({userId:e}),E&&f({id:e})})),D=(0,ts.A)((()=>{C(),l({userId:e}),J&&M&&u({chatId:e}),F&&h({chatId:e})})),L=(0,ts.A)((()=>{I({peerId:e})})),O=(0,ts.A)((()=>{C(),u({chatId:e}),B?(m({chatId:e,userId:r}),g({chatId:e,shouldDeleteForAll:!1})):p({chatId:e})})),G=Boolean((o||n||a)&&i);(0,jt.vJ)((()=>{G||C()}),[G]);const{ref:V,shouldRender:j}=(0,yn.A)({isOpen:G,onStateChange:d});if(j)return(0,us.FD)("div",{ref:V,className:(0,Kt.A)("ChatReportPane",t),dir:b.isRtl?"rtl":void 0,children:[N&&(0,us.Y)(Es.A,{isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:Y,children:b("lng_new_contact_add")}),R&&(0,us.Y)(Es.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:A,children:b("lng_new_contact_block")}),J&&!R&&(0,us.Y)(Es.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:A,children:b("lng_report_spam_and_leave")}),(0,us.Y)(Es.A,{round:!0,ripple:!0,size:"smaller",color:"translucent",onClick:L,ariaLabel:b("Close"),children:(0,us.Y)(Ys.A,{name:"close"})}),(0,us.FD)(Dn.A,{isOpen:S,onClose:C,title:b("BlockUserTitle",x?(0,v.u0)(x):(0,v.Js)(b,U)),text:x?b("UserInfo.BlockConfirmationTitle",(0,v.Yg)(x)):b("Chat.Confirm.ReportSpam.Channel"),confirmIsDestructive:!0,confirmLabel:b("Block"),confirmHandler:x?D:O,children:[x&&(0,us.Y)(Yn.A,{className:"dialog-checkbox",label:b("DeleteThisChat"),checked:F,onCheck:P}),x&&a&&(0,us.Y)(Yn.A,{className:"ChatReportPane--Checkbox dialog-checkbox",label:b("ReportChat"),checked:M,onCheck:k})]})]})})));var On=s(85449),Gn=s(19129),Vn=s(49746),jn=s(11217),qn=s(22867),Wn=s(93809),zn=s(68292),Kn=s(27860),_n=s(18653),Hn=s(57474);const Xn={"pinned-message-border":"L5TQCriM",pinnedMessageBorder:"L5TQCriM","pinned-message-border-wrapper-1":"v5sJGzfS",pinnedMessageBorderWrapper1:"v5sJGzfS","pinned-message-border-wrapper":"p6PQhvds",pinnedMessageBorderWrapper:"p6PQhvds","pinned-message-border-mark":"M2PQZgBd",pinnedMessageBorderMark:"M2PQZgBd"};function $n(e,t,s,a,o){return`M${e},${t+o}a${o},${o},0,0,1,\n  ${s},0v${a-2*o}a${o},${o},0,0,1,${-s},0Z`}const Qn=(0,jt.ph)((({count:e,index:t})=>{const s=(0,jt.li)(),a=(0,jt.Kr)((()=>function(e,t){const s=e-t-1,a=function(e){let t=8;return 1===e?t=36:2===e?t=17:3===e?t=11:(4===e||e>3)&&(t=7.5),t}(e),o=function(e,t){let s=36;return 1===e?s=36:2===e?s=17:3===e?s=1===t?12:11:(4===e||e>3)&&(s=7.5),s}(e,s),n=function(e,t){return e<=3?36:t*e+2*(e-1)}(e,a),i=`clipPath${e}`,r=function(e,t,s){let a="";if(3===s)a=$n(0,0,2,t,1)+$n(0,12,2,t+1,1)+$n(0,25,2,t,1);else for(let e=0;e<s;e++)a+=$n(0,(t+2)*e,2,t,1);return`<clipPath id="${e}">\n      <path d="${a}" />\n    </clipPath>`}(i,a,e),d=function(e,t,s){return 1===s?0:2===s?0===e?0:t+2:3===s?0===e?0:1===e?12:25:(t+2)*e}(s,a,e),c=function(e,t,s,a){return t<=4||e<=1?0:e>=t-2?a-36:(s+4)/2+(e-2)*(s+2)}(s,e,a,n);return{markHeight:o,clipPath:r,markTranslateY:d,trackTranslateY:c,trackHeight:n,clipPathId:i}}(e,t)),[e,t]);if((0,jt.Nf)((()=>{if(!s.current)return;const{trackHeight:e,trackTranslateY:t,markHeight:o,markTranslateY:n,clipPathId:i,clipPath:r}=a,d=s.current.firstElementChild;if(s?.current){const a=s.current,{style:c}=a;c.height=`${e}px`,c.transform=`translateY(-${t}px)`,c.clipPath=`url("#${i}")`;const l=a.querySelector("svg"),u=a.querySelector("div"),h=a.querySelector("defs");l||d&&(d.innerHTML=`<svg height="0" width="0"><defs> ${r} </defs></svg>`),h&&(h.innerHTML=r),u&&(u.style.height=`${o}px`,u.style.transform=`translateY(${n}px)`)}}),[a]),1===e)return(0,us.Y)("div",{className:Xn.pinnedMessageBorder,children:(0,us.Y)("div",{className:Xn.pinnedMessageBorderWrapper1,ref:s})});const{trackHeight:o,trackTranslateY:n,markHeight:i,markTranslateY:r,clipPathId:d}=a;return(0,us.Y)("div",{className:(0,Kt.A)(Xn.pinnedMessageBorder,e>4&&Xn.pinnedMessageBorderMask),children:(0,us.FD)("div",{className:Xn.pinnedMessageBorderWrapper,ref:s,style:`clip-path: url("#${d}"); width: 2px;\n          height: ${o}px; transform: translateY(-${n}px);`,children:[(0,us.Y)("span",{}),(0,us.Y)("div",{className:Xn.pinnedMessageBorderMark,style:`--height: ${i}px; --translate-y: ${r}px; --translate-track: ${n}px;`})]})})})),Zn="LFRysfVa",ei="E_C4DXKN",ti="ljzqevcj",si=1.125*x.$,ai=(0,jt.ph)((0,w.EK)(((e,{chatId:t,threadId:s,messageListType:a})=>{const o=(0,C.hds)(e,t),i=e.isSynced,r=(0,v.cG)(t,s,e.currentUserId),d=(0,C.zeq)(e,t),c={chat:o,isSynced:i};if("thread"!==a||!d)return c;if(s!==n.l3&&!r&&!o?.isForum){const a=Number(s),o=a?(0,C.O5q)(e,t,a):void 0,n=o?(0,C.Szq)(e,o):void 0;return{...c,pinnedMessageIds:a,messagesById:d,canUnpin:!1,topMessageSender:n}}const l=r?void 0:(0,C.fcC)(e,t,s);if(l?.length){const t=d[l[0]],{canUnpin:a=!1}=t&&1===l.length&&(0,C.WAX)(e,t,s)||{};return{...c,pinnedMessageIds:l,messagesById:d,canUnpin:a}}return c}))((({chatId:e,threadId:t,canUnpin:s,getLoadingPinnedId:a,pinnedMessageIds:o,messagesById:i,isFullWidth:r,topMessageSender:c,getCurrentPinnedIndex:l,className:u,chat:h,isSynced:p,shouldHide:m,onPaneStateChange:g,onFocusPinnedMessage:f})=>{const{clickBotInlineButton:I,focusMessage:b,openThread:S,pinMessage:A,loadPinnedMessages:C}=(0,w.ko)(),M=(0,es.A)(),k=(0,Gn.A)(l),F=Array.isArray(o)?o[k]:o,P=i&&F?i[F]:void 0,T=Array.isArray(o)?o.length:o?1:0,U=Math.max(T-k,1),B=c?(0,y.F9)(M,c):void 0,N=P&&(0,v.zX)(P),R=N?.isGif?N:void 0,J=Boolean(R&&!R.previewPhotoSizes?.length),E=(0,qn.A)(P),Y=P&&(0,v.EO)(P,J?"full":"pictogram"),D=(0,bo.A)(Y),L=P&&(0,v.y2)(P),O=Boolean((0,Gn.A)(a)),G=(0,Wn.A)([O],450)&&O,V=(0,mn.A)(P,!0);(0,jt.vJ)((()=>{p&&(t===n.l3||h?.isForum)&&C({chatId:e,threadId:t})}),[e,t,p,h?.isForum]),(0,Vn.A)(e,F,P);const j=Boolean(P)&&!m,{ref:q}=(0,ns.A)({isOpen:j,noOpenTransition:!0,shouldForceOpen:r}),{ref:W,shouldRender:z}=(0,yn.A)({isOpen:j,isDisabled:!r,ref:q,onStateChange:g}),[K,_,H]=(0,Ta.A)(),X=(0,ts.A)((()=>{H(),A({chatId:e,messageId:P.id,isUnpin:!0})})),$=P&&(0,v.rK)(P),Q=(0,ts.A)((()=>{$&&I({chatId:P.chatId,messageId:P.id,button:$})})),Z=(0,ts.A)((()=>{S({chatId:e,threadId:t,type:"pinned"})})),ee=(0,ts.A)((s=>{const n=s.shiftKey&&Array.isArray(o)?o[(0,Ba.A)(o.length,o.indexOf(F)-2)]:F;a()||(b({chatId:e,threadId:t,messageId:n,noForumTopicPanel:!0}),f(n))})),[te,se,ae]=(0,Ta.A)(),{handleClick:oe,handleMouseDown:ne}=(0,jn.Q)(ee);if(z&&V)return(0,us.FD)("div",{ref:W,className:(0,Kt.A)("HeaderPinnedMessageWrapper","tE8PJzpv",r?"gutn4asD":"lrBhOgvf",u),children:[(T>1||G)&&(0,us.FD)(Es.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:M("EventLogFilterPinnedMessages"),onClick:G?void 0:Z,children:[O&&(0,us.Y)(Hn.A,{color:"blue",className:(0,Kt.A)("yvd9_9PF",Zn,!G&&ei)}),(0,us.Y)(Ys.A,{name:"pin-list",className:(0,Kt.A)(Zn,G&&ei)})]}),s&&(0,us.Y)(Es.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:M("UnpinMessageAlertTitle"),onClick:_,children:(0,us.Y)(Ys.A,{name:"close"})}),(0,us.Y)(Dn.A,{isOpen:K,onClose:H,text:M("PinnedConfirmUnpin"),confirmLabel:M("DialogUnpin"),confirmHandler:X}),(0,us.FD)("div",{className:(0,Kt.A)("ayLUtX1S",te&&"WVjde2rq"),onClick:oe,onMouseDown:ne,dir:M.isRtl?"rtl":void 0,children:[(0,us.Y)(Qn,{count:T,index:k}),(0,us.Y)(Ts.Ay,{activeKey:V.id,name:"slideVertical",className:"Gp431jU4",children:function(e,t,s,a){const{width:o,height:n}=(0,x.mr)(),i=t||e,r=s&&t;return(0,us.FD)("div",{className:"XjjZeOUy",children:[e&&!a&&!r&&(0,us.Y)("img",{className:ti,src:i,width:o,height:n,alt:"",draggable:!1}),r&&!a&&(0,us.Y)("video",{src:t,width:o,height:n,playsInline:!0,disablePictureInPicture:!0,className:ti}),e&&(0,us.Y)(Kn.A,{thumbDataUri:i,isVisible:Boolean(a),width:o,height:n})]})}(E,D,J,L)}),(0,us.FD)("div",{className:(0,Kt.A)("ETMw73qH",E&&"BWZytkCB"),dir:M.isRtl?"rtl":void 0,children:[(0,us.FD)("div",{className:"IWpRWVBg",dir:M.isRtl?"rtl":void 0,children:[!B&&(0,us.Y)(zn.A,{text:1===T?M("PinnedMessageTitleSingle"):M("PinnedMessageTitle",{index:U},{pluralValue:T})}),B&&(0,Io.A)(B)]}),(0,us.Y)(Ts.Ay,{activeKey:V.id,name:"slideVerticalFade",className:"mA1i07pG",children:(0,us.Y)("p",{dir:"auto",className:"k19QLKaH",children:(0,us.Y)(_n.A,{message:V,truncateLength:256,noEmoji:Boolean(E),emojiSize:si})})})]}),(0,us.Y)(An.A,{}),$&&(0,us.Y)(Es.A,{size:"tiny",className:"fpQMpARI",onClick:Q,shouldStopPropagation:!0,onMouseEnter:d.TF?void 0:se,onMouseLeave:d.TF?void 0:ae,children:(0,On.A)(M,$)})]})]})}))),oi={root:"xqcWnBH4",message:"CJhqoyif",messageStars:"sZR8zqEk",messageStarIcon:"AKXOpk8S"},ni=(0,jt.ph)((0,w.EK)(((e,{peerId:t})=>{const s=(0,C.hds)(e,t),a=(0,C.vGo)(e,t),o=a?.settings?.chargedPaidMessageStars;return{chargedPaidMessageStars:o,chat:s}}))((({chargedPaidMessageStars:e,chat:t,peerId:s,onPaneStateChange:a})=>{const o=Boolean(e),n=(0,es.A)(),{openChatRefundModal:i}=(0,w.ko)(),{ref:r,shouldRender:d}=(0,yn.A)({isOpen:o,onStateChange:a}),c=(0,ts.A)((()=>{i({userId:s})}));if(!d||!e)return;const l=n("PaneMessagePaidMessageCharge",{peer:t?(0,y.F9)(n,t):void 0,amount:(0,g.U)(n,e,{asFont:!0,className:oi.messageStarIcon,containerClassName:oi.messageStars})},{withMarkdown:!0,withNodes:!0});return(0,us.FD)("div",{ref:r,className:oi.root,children:[(0,us.Y)("div",{className:oi.message,children:l}),(0,us.Y)(Es.A,{isText:!0,noForcedUpperCase:!0,pill:!0,fluid:!0,size:"tiny",className:oi.button,onClick:c,children:n("RemoveFeeTitle")})]})}))),ii={height:0},ri=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>{const{audioPlayer:s}=(0,C.nTw)(e),a=(0,C.hds)(e,t),o=(0,C.vGo)(e,t),{chatId:n,messageId:i}=s,r=n&&i?(0,C.O5q)(e,n,i):void 0,d=Boolean((0,C.TCk)(e));return{chat:a,userFullInfo:o,isAudioPlayerRendered:Boolean(r),isMiddleSearchOpen:d}}))((({className:e,chatId:t,threadId:s,messageListType:a,chat:o,userFullInfo:i,getCurrentPinnedIndex:r,getLoadingPinnedId:d,isAudioPlayerRendered:c,isMiddleSearchOpen:l,onFocusPinnedMessage:u})=>{const{settings:h}=i||{},{isDesktop:p}=(0,L.Ay)(),[m,g]=(0,jt.Ul)(ii),[f,I]=(0,jt.Ul)(ii),[b,v]=(0,jt.Ul)(ii),[y,w]=(0,jt.Ul)(ii),[S,A]=(0,jt.Ul)(ii),[C,M]=(0,jt.Ul)(ii),[k,F]=(0,jt.Ul)(ii),P=(0,jt.li)(!0),{shouldRender:T,ref:U}=(0,ns.A)({isOpen:!l,withShouldRender:!0,noMountTransition:!0});if((0,Un.A)((()=>{P.current=!1})),(0,Bo.R)((()=>{const e=m(),t=C(),s=f(),a=[e,b(),y(),t,s,S(),k()],o=P.current,n=a.reduce(((e,t)=>e+t.height),0),i=document.getElementById("MiddleColumn");i&&((0,yn.S)(a,o),(0,qt.Tv)(i,{"--middle-header-panes-height":`${n}px`}))}),[m,b,f,y,S,C,k]),T)return(0,us.FD)("div",{ref:U,className:(0,Kt.A)("oCUr3DTX",e),children:[(0,us.Y)(Pn,{isFullWidth:!0,onPaneStateChange:g,isHidden:p}),s===n.l3&&!o?.isForum&&(0,us.Y)(xn.A,{chatId:t,onPaneStateChange:v}),(0,us.Y)(Ln,{chatId:t,canAddContact:h?.canAddContact,canBlockContact:h?.canBlockContact,canReportSpam:h?.canReportSpam,isAutoArchived:h?.isAutoArchived,onPaneStateChange:w}),(0,us.Y)(En,{peerId:t,onPaneStateChange:M}),(0,us.Y)(ni,{peerId:t,onPaneStateChange:F}),(0,us.Y)(ai,{chatId:t,threadId:s,messageListType:a,onFocusPinnedMessage:u,getLoadingPinnedId:d,getCurrentPinnedIndex:r,onPaneStateChange:I,isFullWidth:!0}),(0,us.Y)(Rn,{chatId:t,messageListType:a,onPaneStateChange:A})]})}))),di=(0,jt.ph)((0,w.EK)(((e,{userId:t})=>{const s=(0,C.mBe)(e,t);return{userName:(0,v.u0)(s)}}))((function({userName:e}){const t=(0,Rs.A)(),{openPremiumModal:s}=(0,w.ko)(),a=(0,ts.A)((()=>s()));return(0,us.FD)("div",{children:[(0,us.Y)("div",{children:t("Chat.MessagingRestrictedPlaceholder",e)}),(0,us.Y)(wo.A,{isPrimary:!0,onClick:a,children:t("Chat.MessagingRestrictedPlaceholderAction")})]})}))),ci=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ReactorListModal",!t);return s?(0,us.Y)(s,{...e}):void 0},li=e=>{const{isActive:t}=e,s=(0,ls.A)(Xt.ar.Extra,"MiddleSearch",!t,!0);return s?(0,us.Y)(s,{...e}):void 0},ui=(0,jt.ph)((({errorMessage:e})=>(0,us.FD)("div",{className:"webContentsError",children:[(0,us.Y)("div",{className:"webContentsErrorTitle",children:"Hmmm..."}),(0,us.Y)(Qo.A,{size:160,tgsUrl:$o.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,us.Y)("div",{className:"webContentsErrorMessage",children:e})]}))),hi=450+a.xB5,pi=(0,jt.ph)((0,w.EK)(((e,{isMobile:t})=>{const s=(0,C.SJA)(e),{isBlurred:o,background:i,backgroundColor:r,patternColor:d}=(0,C.Gyz)(e,s)||{},{messageLists:c,isLeftColumnShown:l,activeEmojiInteractions:u,seenByModal:h,reactorModal:p,shouldSkipHistoryAnimations:m,chatLanguageModal:g,privacySettingsNoticeModal:f}=(0,C.nTw)(e),I=(0,C.Xf0)(e),{leftColumnWidth:b}=e,y={theme:s,customBackground:i,backgroundColor:r,patternColor:d,isLeftColumnShown:l,isRightColumnShown:(0,C.gjV)(e,t),isBackgroundBlurred:o,hasActiveMiddleSearch:Boolean((0,C.TCk)(e)),isSelectModeActive:(0,C.rTV)(e),isSeenByModalOpen:Boolean(h),isPrivacySettingsNoticeModalOpen:Boolean(f),isReactorListModalOpen:Boolean(p),isChatLanguageModalOpen:Boolean(g),withInterfaceAnimations:(0,C.PKK)(e),currentTransitionKey:Math.max(0,c.length-1),activeEmojiInteractions:u,leftColumnWidth:b,workspaceSidebarIsOpen:e.workspaces.sidebarIsOpen,webContentsViewIsLoading:e.webContentsViewIsLoading,webContentsViewIsVisible:e.webContentsViewIsVisible,webContentsViewError:e.webContentsViewError};if(!I)return y;const{chatId:w,threadId:S,type:A}=I,M=(0,k.L8)(w),F=(0,C.hds)(e,w),P=(0,C.yps)(e,w),T=(0,C.fcC)(e,w,S),U=w?(0,C.AWZ)(e,w):void 0,x=w?(0,C.vGo)(e,w):void 0,B=(0,C.Vw0)(e,w,S),N=Boolean(!B?.isCommentsInfo&&B?.fromChannelId),R=(0,C.S0q)(e,w,S),J=F&&(0,v.__)(F,R,N,U),E=(0,C.I_m)(e,w),Y="pinned"===A,D="thread"===A&&S===n.l3,L=Boolean(F&&(0,v.WX)(F)),O=Boolean(F&&D&&(L||(0,v.Vs)(F))&&F.isNotJoined&&!F.joinRequests),G=Boolean(F?.isNotJoined&&F.isJoinToSend),V=Boolean(F?.isNotJoined&&F.isJoinRequest),j=!!M&&(0,C.apd)(e,w),q=Boolean(P&&j),W=!q&&E,z=j&&!P,K=Boolean(F&&(0,v.YE)(F)&&!U),_=(0,C.GA4)(e,w,S)?.replyInfo,H=!!F?.isForum&&S===n.l3&&!_&&(0,C.S0q)(e,w,a.HxB)?.isClosed,X=(0,C.pSx)(e,w),$=(0,v.cG)(w,S,e.currentUserId),Q=$&&S!==a.Ckz,Z=F&&(M||F?.isCreator||!L&&!(0,v.Sq)(F,"pinMessages")||(0,v.ub)(F,"pinMessages")),ee=(0,C.vGo)(e,w),te=ee?.isContactRequirePremium,se=(0,C.WA9)(e,w),ae=(0,C.trm)(e),oe=e.botFreezeAppealId,ne=oe?(0,C.hds)(e,oe):void 0;return{...y,chatId:w,threadId:S,messageListType:A,chat:F,draftReplyInfo:_,isPrivate:M,arePeerSettingsLoaded:Boolean(x?.settings),isComments:N,canPost:!Y&&(!F||J)&&!E&&!(G&&F?.isNotJoined)&&!H&&!$&&(!ae||ne?.id===w),isPinnedMessageList:Y,currentUserBannedRights:F?.currentUserBannedRights,defaultBannedRights:F?.defaultBannedRights,pinnedMessagesCount:T?T.length:0,shouldSkipHistoryAnimations:m,isChannel:L,canSubscribe:O,canStartBot:W,canRestartBot:q,shouldJoinToSend:G,shouldSendJoinRequest:V,shouldLoadFullChat:K,pinnedIds:T,canUnpin:Z,canUnblock:z,isSavedDialog:$,canShowOpenChatButton:Q,isContactRequirePremium:te,topics:X,paidMessagesStars:se,isAccountFrozen:ae,freezeAppealChat:ne}}))((function({leftColumnRef:e,chatId:t,threadId:s,isComments:o,messageListType:n,isMobile:i,chat:r,draftReplyInfo:c,isPrivate:l,isPinnedMessageList:u,canPost:p,currentUserBannedRights:m,defaultBannedRights:g,pinnedMessagesCount:f,customBackground:I,theme:b,backgroundColor:y,patternColor:S,isLeftColumnShown:A,isRightColumnShown:M,isBackgroundBlurred:k,leftColumnWidth:F,hasActiveMiddleSearch:P,isSelectModeActive:T,isSeenByModalOpen:U,isPrivacySettingsNoticeModalOpen:Y,isReactorListModalOpen:D,isChatLanguageModalOpen:O,withInterfaceAnimations:G,shouldSkipHistoryAnimations:V,currentTransitionKey:j,isChannel:q,arePeerSettingsLoaded:W,canSubscribe:z,canStartBot:K,canRestartBot:_,activeEmojiInteractions:H,shouldJoinToSend:X,shouldSendJoinRequest:$,shouldLoadFullChat:Q,pinnedIds:Z,canUnpin:ee,canUnblock:te,isSavedDialog:se,canShowOpenChatButton:ae,isContactRequirePremium:oe,topics:ne,paidMessagesStars:ie,isAccountFrozen:re,freezeAppealChat:de,workspaceSidebarIsOpen:ce,webContentsViewIsLoading:le,webContentsViewError:ue,webContentsViewIsVisible:he}){const{openChat:pe,openPreviousChat:me,unpinAllMessages:ge,loadUser:fe,loadPeerSettings:Ie,exitMessageSelectMode:be,joinChannel:ve,sendBotCommand:ye,restartBot:we,showNotification:Se,loadFullChat:Ae,setLeftColumnWidth:Ce,resetLeftColumnWidth:Me,unblockUser:ke}=(0,w.ko)(),Fe=(0,jt.li)(void 0),{width:Pe}=(0,xa.A)(),{isTablet:Te,isDesktop:Ue}=(0,L.Ay)(),xe=(0,Rs.A)(),[Be,Ne]=(0,jt.J0)(ja.I.None),[Re,Je]=(0,jt.J0)(!1),Ee=Re&&(!i||!P),[Ye,De]=(0,jt.J0)(),[Le,Oe]=(0,jt.J0)(!1),{handleIntersectPinnedMessage:Ge,handleFocusPinnedMessage:Ve,getCurrentPinnedIndex:je,getLoadingPinnedId:qe}=function(e,t,s){const[a,o]=(0,jt.Ul)({}),[n,i]=(0,jt.Ul)(),r=e?`${e}_${t}`:void 0,d=(0,Na.A)((()=>a()[r]??0),[a,r]);return(0,jt.vJ)((()=>{Ra=void 0,i(void 0)}),[e,o,i,t]),(0,jt.vJ)((()=>{if(!r)return;const e=a()[r],t=s?.length||0;e>=t&&o({...a(),[r]:Ea(t-1)})}),[a,r,s?.length,o]),{handleIntersectPinnedMessage:(0,ts.A)((({viewportPinnedIdsToAdd:d=[],viewportPinnedIdsToRemove:c=[],shouldCancelWaiting:l})=>{if(!(e&&t&&r&&s?.length))return;if(l)return Ja=void 0,void i(void 0);const u=n();if(u){const e=s.indexOf(u);o({...a(),[r]:Ea(e)}),i(void 0)}Ra=(0,h.Am)((Ra?.filter((e=>!c.includes(e)))??[]).concat(d));const p=(0,C.kdX)((0,w.mS)(),e)||Ja;if(Ja&&Ra.includes(Ja)&&(Ja=void 0),p){const e=s.findIndex((e=>e<p));o({...a(),[r]:Ea(e)})}else if(Ra.length){const e=Math.max(...Ra),t=s.indexOf(e);o({...a(),[r]:Ea(t)})}})),handleFocusPinnedMessage:(0,ts.A)((n=>{if(!e||!t||!s?.length)return;Ja=n;const d=(0,w.mS)(),c=(0,C.gCU)(d,e,t),l=c?.includes(n)||(0,C.Lzh)(d,e,t,n),u=s.indexOf(n),h=(0,Ba.A)(s.length,u+1);l?o({...a(),[r]:h}):i(s[h])})),getCurrentPinnedIndex:d,getLoadingPinnedId:n}}(t,s,Z),We=i?hi:void 0,ze=(0,Fa.A)(t,We),Ke=(0,Fa.A)(s,We),_e=(0,Fa.A)(n,We),He=(0,Fa.A)(z,We),Xe=(0,Fa.A)(K,We),$e=(0,Fa.A)(_,We),Qe=(0,Fa.A)(te,We),Ze=(0,Fa.A)(p,We)&&!$e&&!Xe&&!He&&!Qe&&t!==a.Xab&&!oe,et=(0,Fa.A)(Ee,We)&&t!==a.Xab,tt=(0,Fa.A)(q,We),st=(0,Fa.A)(X,We),at=(0,Fa.A)($,We),ot=(0,Fa.A)(t?Ge:void 0,We),nt=(0,Pa.A)(j),it=void 0!==nt&&nt<j?nt:void 0,{isReady:rt,handleCssTransitionEnd:dt,handleSlideTransitionStop:ct}=function(e,t,s,a,o){const[n,i]=(0,jt.J0)(!o),r=(0,Zt.A)(),d=void 0!==s&&s!==t;return d&&(e?(i(!1),setTimeout((()=>{i(!0)}),hi)):r()),(0,is.A)((()=>{e||i(!0)}),[e]),{isReady:n&&!d,handleCssTransitionEnd:e?function(e){"transform"===e.propertyName&&e.target===e.currentTarget&&i(Boolean(a))}:void 0,handleSlideTransitionStop:e?function(){i(!0)}:void 0}}(!V&&G,j,nt,t,i);(0,jt.vJ)((()=>t?(0,As.A)((()=>{pe({id:void 0})})):void 0),[t,pe]),(0,is.A)((()=>{Ne(ja.I.None),De(void 0)}),[t]),(0,jt.vJ)((()=>{if(!d.pz&&!d.Ni)return;const{visualViewport:e}=window;if(!e)return;const t=()=>{const t=e.height!==document.documentElement.clientHeight;(0,zt.RK)((()=>{document.body.classList.toggle("keyboard-visible",t),(0,zt.YS)((()=>{!t&&e.offsetTop&&(0,zt.RK)((()=>{window.scrollTo({top:0})}))}))}))};return e.addEventListener("resize",t),()=>{e.removeEventListener("resize",t)}})),(0,jt.vJ)((()=>{l&&fe({userId:t})}),[t,l,fe]),(0,jt.vJ)((()=>{W||Ie({peerId:t})}),[t,l,W]),(0,jt.vJ)((()=>{t&&Q&&rt&&Ae({chatId:t})}),[Q,t,rt,Ae]);const{initResize:lt,resetResize:ut,handleMouseUp:ht}=function(e,t,s,a,o){const[n,i,r]=(0,Ta.A)(),[d,c]=(0,jt.J0)(0),[l,u]=(0,jt.J0)(0),h=(0,ts.A)((t=>{(0,zt.RK)((()=>{if(!e.current)return;const s=t?`${t}px`:"";e.current.style.width=s,o&&e.current.style.setProperty(o,s)}))}));function p(){(0,zt.RK)((()=>{document.body.classList.remove("cursor-ew-resize")}))}return(0,jt.Nf)((()=>{e.current&&a&&h(a)}),[o,e,a,h]),(0,jt.vJ)((()=>{if(!n)return;const s=e=>{const t=Math.ceil(l+e.clientX-d);h(t)};function a(){o(),t(e.current.offsetWidth)}function o(){p(),document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",a,!1),document.removeEventListener("blur",a,!1),r()}return document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",a,!1),document.addEventListener("blur",a,!1),o}),[l,d,e,t,n,r,h]),{initResize:function(t){t.preventDefault(),(0,zt.RK)((()=>{document.body.classList.add("cursor-ew-resize")})),c(t.clientX),u(e.current.offsetWidth),i()},resetResize:function(e){e.preventDefault(),h(void 0),s()},handleMouseUp:p}}(e,(e=>Ce({leftColumnWidth:e})),Me,F,"--left-column-width"),pt=(0,ts.A)((e=>{const{items:t}=e.dataTransfer||{},s=d.Yw||t&&t.length>0&&Array.from(t).filter((e=>"text/uri-list"!==e.type)).every((e=>function(e){return"file"===e.kind&&e.type&&a.gex.has(e.type)}(e)||function(e){return"file"===e.kind&&e.type&&a.fNs.has(e.type)}(e)));Ne(s?ja.I.QuickFile:ja.I.Document)})),mt=(0,ts.A)((()=>{Ne(ja.I.None)})),gt=(0,ts.A)((()=>{Oe(!0)})),ft=(0,ts.A)((()=>{Oe(!1)})),It=(0,ts.A)((()=>{pe({id:String(s)})})),bt=(0,ts.A)((()=>{ge({chatId:t,threadId:s}),ft(),me()})),vt=(0,ts.A)((()=>{pe({id:t})})),yt=(0,ts.A)((()=>{ve({chatId:t}),at&&Se({message:xe(q?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")})})),wt=(0,ts.A)((()=>{ye({command:"/start"})})),St=(0,ts.A)((()=>{we({chatId:t})})),At=(0,ts.A)((()=>{ke({userId:t})})),Ct=(0,ka.A)(b,I),Mt=(0,Kt.A)(d.So?"mask-image-disabled":"mask-image-enabled"),kt=(0,Kt.A)("C6IaXYew","nXhZtCma",I&&"K1xhz7U5",y&&"CwoXMwaR",I&&k&&"JBrOVLsX",M&&"Lyw3O8XE"),Ft=(0,Kt.A)("messaging-disabled",!T&&"shown"),Pt=(0,v.gU)(xe,m,g),Tt=(0,v.zc)(xe,r,s,ne,Boolean(c)),Ut=Pt??Tt??(oe?(0,us.Y)(di,{userId:t}):void 0)??(re&&de?.id!==t?(0,us.Y)(Ha,{}):void 0),{composerHiddenScale:xt,toolbarHiddenScale:Bt,composerTranslateX:Nt,toolbarTranslateX:Rt,unpinHiddenScale:Jt,toolbarForUnpinHiddenScale:Et}=(0,jt.Kr)((()=>function(e,t){const s=e<=a.c2m?x.$:2*x.$,o=function(e){if(e>a.gQx){const t=Math.min(Math.max(.25*e,J),R),s=Math.min(.25*e,R);return Math.min(e-t-s,N)}if(e>a.j7z){const t=Math.min(Math.max(.4*e,J),R);return Math.min(e-t,N)}return e>N?N:e}(e),n=e<=a.c2m?3.375*x.$:4*x.$,i=t?o-s-n:o-s,r=e>a.c2m?Math.min(o-s,B):o-s,d=r/i,c=i/r;return{composerHiddenScale:d,toolbarHiddenScale:c,composerTranslateX:t?n/2*c:0,toolbarTranslateX:t?n/2*-1*d:0,unpinHiddenScale:r/E,toolbarForUnpinHiddenScale:E/r}}(Pe,Ze)),[Ze,Pe]),Yt=(0,Kt.A)("middle-column-footer",!Ze&&"no-composer",Ze&&Ye&&!T&&"with-notch");(0,Aa.A)({isActive:T,onBack:be}),(0,Ya.A)(S);const Dt=Boolean(!u&&!se&&!Ze&&!$e&&!Xe&&!He&&Ut)||re&&de?.id!==t,Lt=Boolean($e||He||at||Xe||u&&ee||ae||Qe),Ot=Boolean(Dt||T);(0,Ua.A)(Fe,(e=>{Gt(e.target.getBoundingClientRect())}));const Gt=(0,jt.hb)((e=>{const t=ce?e.left+300+1:e.left+1,s=ce?e.width-300-1:e.width-1;window.electron?.setWebContentsViewBounds({x:t,y:e.top,height:window.innerHeight-22,width:s})}),[ce]);return(0,jt.vJ)((()=>{const e=Fe.current?.getBoundingClientRect();e&&Gt(e)}),[Gt,ce]),(0,us.FD)("div",{ref:Fe,id:"MiddleColumn",className:Mt,onTransitionEnd:dt,style:(0,Ma.A)(`--composer-hidden-scale: ${xt}`,`--toolbar-hidden-scale: ${Bt}`,`--unpin-hidden-scale: ${Jt}`,`--toolbar-unpin-hidden-scale: ${Et},`,`--composer-translate-x: ${Nt}px`,`--toolbar-translate-x: ${Rt}px`,`--pattern-color: ${S}`,y&&`--theme-background-color: ${y}`),onClick:Te&&A?vt:void 0,children:[Ue&&(0,us.Y)("div",{className:"resize-handle",onMouseDown:lt,onMouseUp:ht,onDoubleClick:ut}),(0,us.Y)("div",{className:kt,style:Ct?`--custom-background: ${Ct}`:void 0}),(0,us.Y)("div",{id:"middle-column-portals"}),(0,us.Y)("div",{id:"middle-column-left-sidebar-portals",style:"height: 100%"}),le&&(0,us.Y)("div",{className:"webContentsShimmer"}),ue&&(0,us.Y)(ui,{errorMessage:ue}),!t&&!he&&(0,us.Y)(to,{}),Boolean(ze&&Ke)&&(0,us.FD)(us.FK,{children:[(0,us.FD)("div",{className:"messages-layout",onDragEnter:Ze?pt:void 0,children:[(0,us.Y)(ri,{chatId:ze,threadId:Ke,messageListType:_e,getCurrentPinnedIndex:je,getLoadingPinnedId:qe,onFocusPinnedMessage:Ve},ze),(0,us.Y)(Tn,{chatId:ze,threadId:Ke,messageListType:_e,isComments:o,isMobile:i,getCurrentPinnedIndex:je,getLoadingPinnedId:qe,onFocusPinnedMessage:Ve}),(0,us.FD)(Ts.Ay,{name:V?"none":G?"slide":"fade",activeKey:j,shouldCleanup:!0,cleanupExceptionKey:it,isBlockingAnimation:!0,onStop:ct,children:[(0,us.Y)(sn,{chatId:ze,threadId:Ke,type:_e,isComments:o,canPost:Ze,onScrollDownToggle:Je,onNotchToggle:De,isReady:rt,isContactRequirePremium:oe,paidMessagesStars:ie,withBottomShift:Lt,withDefaultBg:Boolean(!I&&!y),onIntersectPinnedMessage:ot},`${ze}-${Ke}-${_e}`),(0,us.FD)("div",{className:Yt,children:[Ze&&(0,us.Y)(Da.A,{type:"messageList",chatId:ze,threadId:Ke,messageListType:_e,dropAreaState:Be,onDropHide:mt,isReady:rt,isMobile:i,editableInputId:a.CfG,editableInputCssSelector:a.m$5,inputId:"message-input-text"}),u&&ee&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.FD)(Es.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button unpin-all-button",onClick:gt,children:[(0,us.Y)(Ys.A,{name:"unpin"}),(0,us.Y)("span",{children:xe("Chat.Pinned.UnpinAll",f,"i")})]})}),ae&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.Y)(Es.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button open-chat-button",onClick:It,children:(0,us.Y)("span",{children:xe("SavedOpenChat")})})}),Dt&&(0,us.Y)("div",{className:Ft,children:(0,us.Y)("div",{className:"messaging-disabled-inner",children:(0,us.Y)("span",{children:Ut})})}),i&&(He||st&&!at)&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.Y)(Es.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:yt,children:xe(tt?"ProfileJoinChannel":"ProfileJoinGroup")})}),i&&at&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.Y)(Es.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:yt,children:xe("ChannelJoinRequest")})}),i&&Xe&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.Y)(Es.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:wt,children:xe("BotStart")})}),i&&$e&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.Y)(Es.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:St,children:xe("BotRestart")})}),i&&Qe&&(0,us.Y)("div",{className:"middle-column-footer-button-container",dir:xe.isRtl?"rtl":void 0,children:(0,us.Y)(Es.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:At,children:xe("Unblock")})}),(0,us.Y)(on,{messageListType:_e,isActive:T,canPost:Ze}),(0,us.Y)(Oa,{isOpen:U}),(0,us.Y)(La,{isOpen:Y}),(0,us.Y)(ci,{isOpen:D}),d.CM&&(0,us.Y)(Va,{isOpen:O})]})]}),(0,us.Y)(_a,{withScrollDown:et,canPost:Ze,withExtraShift:Ot})]}),(0,us.Y)(li,{isActive:Boolean(P)})]}),t&&(0,us.Y)(Ga,{isOpen:Le,chatId:t,pinnedMessagesCount:f,onClose:ft,onUnpin:bt}),(0,us.Y)("div",{teactFastList:!0,children:H?.map(((e,t)=>(0,us.Y)(qa,{teactOrderKey:t,activeEmojiInteraction:e},e.id)))})]})}))),mi={giftCodeModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"GiftCodeModal",!t);return s?(0,us.Y)(s,{...e}):void 0},boostModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"BoostModal",!t);return s?(0,us.Y)(s,{...e}):void 0},chatlistModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ChatlistModal",!t);return s?(0,us.Y)(s,{...e}):void 0},urlAuth:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"UrlAuthModal",!t);return s?(0,us.Y)(s,{...e}):void 0},oneTimeMediaModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"OneTimeMediaModal",!t);return s?(0,us.Y)(s,{...e}):void 0},inviteViaLinkModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"InviteViaLinkModal",!t);return s?(0,us.Y)(s,{...e}):void 0},requestedAttachBotInstall:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"AttachBotInstallModal",!t);return s?(0,us.Y)(s,{...e}):void 0},reportAdModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ReportAdModal",!t);return s?(0,us.Y)(s,{...e}):void 0},reportModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ReportModal",!t);return s?(0,us.Y)(s,{...e}):void 0},webApps:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"WebAppModal",!t);return s?(0,us.Y)(s,{...e}):void 0},collectibleInfoModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"CollectibleInfoModal",!t);return s?(0,us.Y)(s,{...e}):void 0},mapModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"MapModal",!t);return s?(0,us.Y)(s,{...e}):void 0},starsPayment:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"StarPaymentModal",!t);return s?(0,us.Y)(s,{...e}):void 0},starsBalanceModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"StarsBalanceModal",!t);return s?(0,us.Y)(s,{...e}):void 0},starsTransactionModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"StarsTransactionInfoModal",!t);return s?(0,us.Y)(s,{...e}):void 0},chatInviteModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ChatInviteModal",!t);return s?(0,us.Y)(s,{...e}):void 0},paidReactionModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"PaidReactionModal",!t);return s?(0,us.Y)(s,{...e}):void 0},starsSubscriptionModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"StarsSubscriptionModal",!t);return s?(0,us.Y)(s,{...e}):void 0},starsGiftModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"StarsGiftModal",!t);return s?(0,us.Y)(s,{...e}):void 0},giftModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftModal",!t);return s?(0,us.Y)(s,{...e}):void 0},isGiftRecipientPickerOpen:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftRecipientPicker",!t);return s?(0,us.Y)(s,{...e}):void 0},isWebAppsCloseConfirmationModalOpen:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"WebAppsCloseConfirmationModal",!t);return s?(0,us.Y)(s,{isOpen:t}):void 0},giftInfoModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftInfoModal",!t);return s?(0,us.Y)(s,{...e}):void 0},giftResalePriceComposerModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftResalePriceComposerModal",!t);return s?(0,us.Y)(s,{...e}):void 0},suggestedStatusModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"SuggestedStatusModal",!t);return s?(0,us.Y)(s,{...e}):void 0},emojiStatusAccessModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"EmojiStatusAccessModal",!t);return s?(0,us.Y)(s,{...e}):void 0},locationAccessModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"LocationAccessModal",!t);return s?(0,us.Y)(s,{...e}):void 0},aboutAdsModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"AboutAdsModal",!t);return s?(0,us.Y)(s,{...e}):void 0},giftUpgradeModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftUpgradeModal",!t);return s?(0,us.Y)(s,{...e}):void 0},monetizationVerificationModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"VerificationMonetizationModal",!t);return s?(0,us.Y)(s,{...e}):void 0},giftWithdrawModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftWithdrawModal",!t);return s?(0,us.Y)(s,{...e}):void 0},giftStatusInfoModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftStatusInfoModal",!t);return s?(0,us.Y)(s,{...e}):void 0},preparedMessageModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"PreparedMessageModal",!t);return s?(0,us.Y)(s,{...e}):void 0},sharePreparedMessageModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"SharePreparedMessageModal",!t);return s?(0,us.Y)(s,{...e}):void 0},giftTransferModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"GiftTransferModal",!t);return s?(0,us.Y)(s,{...e}):void 0},chatRefundModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Stars,"ChatRefundModal",!t);return s?(0,us.Y)(s,{...e}):void 0},isFrozenAccountModalOpen:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"FrozenAccountModal",t);return s?(0,us.Y)(s,{...e}):void 0},deleteAccountModal:e=>{const{modal:t}=e,s=(0,ls.A)(Xt.ar.Extra,"DeleteAccountModal",!t);return s?(0,us.Y)(s,{...e}):void 0}},gi=Object.keys(mi),fi=Object.entries(mi),Ii=(0,jt.ph)((0,w.EK)((e=>(0,h.Up)((0,C.nTw)(e),gi)))((e=>fi.map((([t,s])=>(0,us.Y)(s,{modal:e[t]},t)))))),bi=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"PaymentModal",!t);return s?(0,us.Y)(s,{...e}):void 0},vi=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ReceiptModal",!t);return s?(0,us.Y)(s,{...e}):void 0};var yi=s(79307),wi=s(79582),Si=s(12933);const Ai=(0,jt.ph)((0,w.EK)(((e,{chatId:t})=>{const s=(0,C.hds)(e,t),{userIds:a}=e.contactList||{},{newChatMembersProgress:o}=(0,C.nTw)(e),{currentUserId:n}=e,r=s&&(0,v.WX)(s),{query:d,fetchingStatus:c,globalUserIds:l,localUserIds:u}=(0,C.nTw)(e).userSearch;return{isChannel:r,members:(0,C.AWZ)(e,t)?.members,currentUserId:n,localContactIds:a,searchQuery:d,isSearching:c,isLoading:o===i.D7.Loading,globalUserIds:l,localUserIds:u}}))((({isChannel:e,members:t,onNextStep:s,currentUserId:a,localContactIds:o,isLoading:n,searchQuery:i,isSearching:r,localUserIds:d,globalUserIds:c,onClose:l,isActive:u})=>{const{setUserSearchQuery:p}=(0,w.ko)(),m=(0,Rs.A)(),[g,f]=(0,jt.J0)([]),I=(0,Pa.A)(g)===g;(0,Aa.A)({isActive:u,onBack:l});const b=(0,jt.Kr)((()=>t?t.map((e=>e.userId)):[]),[t]),S=(0,jt.hb)((e=>{p({query:e})}),[p]),A=(0,jt.Kr)((()=>{const t=(0,w.mS)().users.byId,s=(0,y.PU)({ids:(0,h.Am)([...o||[],...d||[],...c||[]]),query:i,type:"user"});return(0,wi.A)(s.filter((s=>{const o=t[s];return!b.includes(s)&&s!==a&&(!o||!(0,v.tv)(o)||!e&&o.canBeInvitedToGroup)})))}),[o,i,d,c,a,b,e]),C=(0,jt.hb)((()=>{g.length&&(p({query:""}),s(g))}),[g,p,s]);return(0,us.Y)("div",{className:"AddChatMembers",children:(0,us.FD)("div",{className:"AddChatMembers-inner",children:[(0,us.Y)(da.A,{itemIds:A,selectedIds:g,filterValue:i,filterPlaceholder:m("lng_channel_add_users"),searchInputId:"new-members-picker-search",isLoading:r,onSelectedIdsChange:f,onFilterChange:S,isSearchable:!0,withDefaultPadding:!0,noScrollRestore:I,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,us.Y)(Si.A,{isShown:Boolean(g.length),disabled:n,ariaLabel:m("lng_channel_add_users"),onClick:C,children:n?(0,us.Y)(Hn.A,{color:"white"}):(0,us.Y)(Ys.A,{name:"arrow-right"})})]})})}))),Ci=e=>{const t=(0,ls.A)(Xt.ar.Extra,"CreateTopic");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Mi=e=>{const t=(0,ls.A)(Xt.ar.Extra,"EditTopic");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},ki=()=>{const e=(0,ls.A)(Xt.ar.Extra,"GifSearch");return e?(0,us.Y)(e,{}):(0,us.Y)(Us.A,{})},Fi=e=>{const t=(0,ls.A)(Xt.ar.Extra,"Management");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Pi=()=>{const e=(0,ls.A)(Xt.ar.Extra,"PollResults");return e?(0,us.Y)(e,{}):(0,us.Y)(Us.A,{})};var Ti=s(50442),Ui=s(55429),xi=s(68323),Bi=s(23459);const Ni=(0,I.nF)((e=>e()),250,!1);let Ri=!1;function Ji(e){switch(e){case"members":return i.zW.MemberList;case"gifts":return i.zW.GiftList;case"stories":return i.zW.StoryList;case"dialogs":return i.zW.SavedDialogs;default:return i.zW.SharedMedia}}var Ei=s(96374);function Yi(e,t){const[s,o]=(0,Ei.A)(e,t,void 0,a.nnT);return[s,o,!(!s||!t||s[0]===t[0])]}function Di(e,t,s,o,n,i){const r=(0,jt.li)();(0,is.A)((()=>{r.current=void 0}),[i]),(0,is.A)((()=>{t===e&&o&&n&&(r.current=(0,v.lH)(o,n,e))}),[o,n,t,e]);const[d,c]=(0,Ei.A)(s,r.current,void 0,"media"===e?a.Um:a.gXr);return[d,c,!(!d||!r.current||d[0]===r.current[0])]}var Li=s(65240),Oi=s(44589),Gi=s(58968),Vi=s(66833),ji=s(40558),qi=s(25404),Wi=s(87049);const zi="_TMVTkD4",Ki=(0,jt.ph)((0,w.EK)(((e,{peerId:t,gift:s})=>{const a=s.fromId?(0,C.PVB)(e,s.fromId):void 0,o=(0,C.hds)(e,t),n=o&&(0,v.ub)(o,"postMessages"),i=e.currentUserId,r=i?(0,C.mBe)(e,i):void 0,d=r?.emojiStatus,c=e.collectibleEmojiStatuses?.statuses;return{fromPeer:a,hasAdminRights:n,currentUserId:i,currentUserEmojiStatus:d,collectibleEmojiStatuses:c}}))((({peerId:e,gift:t,style:s,fromPeer:a,currentUserId:o,hasAdminRights:n,collectibleEmojiStatuses:i,currentUserEmojiStatus:r,observeIntersection:d})=>{const{openGiftInfoModal:c}=(0,w.ko)(),l=(0,jt.li)(),u=(0,jt.li)(),h=(0,es.A)(),p=e===o||n,m=(0,Vi.UC)(t.gift),g=t.gift,f="starGiftUnique"===g.type?g:void 0,I=f?.resellPriceInStars?h("GiftRibbonSale"):t.isPinned&&f?h("GiftSavedNumber",{number:f.number}):m?h("ActionStarGiftLimitedRibbon",{total:(0,ys.Vw)(h,m)}):void 0,b=f?.resellPriceInStars?"green":"blue",{isContextMenuOpen:v,contextMenuAnchor:y,handleBeforeContextMenu:S,handleContextMenu:A,handleContextMenuClose:C,handleContextMenuHide:M}=(0,Wa.A)(l),k=(0,ts.A)((()=>l.current)),F=(0,ts.A)((()=>l.current.closest(".custom-scroll"))),P=(0,ts.A)((()=>document.querySelector("#portals")?.querySelector(".saved-gift-context-menu .bubble"))),T=(0,ts.A)((()=>({withPortal:!0}))),U=(0,ts.A)((()=>{c({peerId:e,gift:t})})),x=t.isNameHidden&&!a?Gi.I5:a,B=(0,Vi.yQ)(t.gift),N=(0,jt.Kr)((()=>{const{backdrop:e,pattern:s}=(0,Vi.uc)(t.gift)||{};if(!e||!s)return;const a=[e.centerColor,e.edgeColor],o=e.patternColor;return(0,us.Y)(ji.A,{className:"_I9aOdGr",backgroundColors:a,patternColor:o,patternIcon:s.sticker})}),[t.gift]);if(B)return(0,us.FD)("div",{ref:l,className:(0,Kt.A)("HN4dYXIk","scroll-item"),style:s,onClick:U,onContextMenu:A,onMouseDown:S,children:[N,!N&&(0,us.Y)(Jo.A,{className:zi,peer:x,size:"micro"}),t.isPinned&&(0,us.Y)(Ys.A,{name:"pinned-message",className:zi}),(0,us.Y)("div",{ref:u,className:"NYuBBB9j",style:"width: 90px; height: 90px",children:B&&(0,us.Y)(ho.A,{observeIntersectionForPlaying:d,observeIntersectionForLoading:d,containerRef:u,sticker:B,size:90,shouldPreloadPreview:!0})}),t.isUnsaved&&(0,us.Y)("div",{className:"xY4yqqYA",children:(0,us.Y)(Ys.A,{name:"eye-crossed-outline"})}),I&&(0,us.Y)(Wi.A,{color:b,text:I}),void 0!==y&&(0,us.Y)(Ds.A,{isOpen:v,anchor:y,className:"saved-gift-context-menu",autoClose:!0,withPortal:!0,getMenuElement:P,getTriggerElement:k,getRootElement:F,getLayout:T,onClose:C,onCloseAnimationEnd:M,children:(0,us.Y)(qi.A,{peerId:e,gift:t,canManage:p,collectibleEmojiStatuses:i,currentUserEmojiStatus:r})})]})})));var _i=s(81524),Hi=s(42827),Xi=s(83057);const $i=(0,jt.ph)((({media:e,idPrefix:t="preview-media",isProtected:s,observeIntersection:a,onClick:o,index:n})=>{const i=(0,jt.li)(),r=(0,To.Vz)(i,a),d=(0,v.CI)(e),c=(0,bo.A)((0,v.EO)(e,"preview"),!r),l=(0,Xi.A)(c),u=e.content.video,h=(0,ts.A)((()=>{o(n)}));return(0,us.FD)("div",{ref:i,id:`${t}${n}`,className:"Media scroll-item",onClick:h,children:[(0,us.Y)("img",{src:d,className:"media-miniature",alt:"",draggable:!s,decoding:"async",onContextMenu:s?fo.A:void 0}),(0,us.Y)("img",{src:c,className:(0,Kt.A)("full-media","media-miniature",l),alt:"",draggable:!s,decoding:"async",onContextMenu:s?fo.A:void 0}),u&&(0,us.Y)("span",{className:"video-duration",children:u.isGif?"GIF":(0,we.QO)(u.duration)}),s&&(0,us.Y)("span",{className:"protector"})]})}));var Qi=s(44784),Zi=s(70195),er=s(37378),tr=s(59816);const sr="NOCaj4mx",ar=(0,jt.ph)((0,w.EK)(((e,{story:t})=>{const s=(0,C.hds)(e,t.peerId),a=s?.isProtected,{maxPinnedStoriesCount:o}=e.appConfig||{},n="isOut"in t&&t.isOut,i=(0,C.gVx)(e,t.peerId),r=i?.some((e=>e.id===t.id));return{isProtected:a,isPinned:r,canPin:n&&(!o||(i?.length||0)<o)}}))((function({story:e,isProtected:t,isArchive:s,isPinned:a,canPin:o}){const{openStoryViewer:n,loadPeerSkippedStories:i,toggleStoryInProfile:r,toggleStoryPinnedToTop:d,showNotification:c}=(0,w.ko)(),l=(0,Rs.A)(),u=(0,jt.li)(),h=(0,ts.A)((()=>u.current)),p=(0,ts.A)((()=>document.body)),m=(0,ts.A)((()=>document.querySelector("#portals .story-context-menu .bubble"))),g=(0,ts.A)((()=>({withPortal:!0,isDense:!0}))),f=e&&e.peerId,I=e&&"content"in e,b=I&&e.isOut,y=e&&"isDeleted"in e,S=I?e.content.video:void 0,A=S&&(0,we.QO)(S.duration),C=I?(0,v.EN)(e):void 0,M=(0,bo.A)(C)||S?.thumbnail?.dataUri;(0,jt.vJ)((()=>{!e||I||y||i({peerId:e.peerId})}),[y,I,e]);const{isContextMenuOpen:k,contextMenuAnchor:F,handleBeforeContextMenu:P,handleContextMenu:T,handleContextMenuClose:U,handleContextMenuHide:x}=(0,Wa.A)(u,!b),B=(0,jt.hb)((()=>{n({peerId:e.peerId,storyId:e.id,isSinglePeer:!0,isPrivate:!0,isArchive:s})}),[s,e.id,e.peerId]),N=(0,ts.A)((e=>{(0,io.u)(e),P(e)})),R=(0,ts.A)((t=>{(0,fo.A)(t),r({peerId:f,storyId:e.id,isInProfile:!0}),c({message:l("Story.ToastSavedToProfileText")}),U()})),J=(0,ts.A)((t=>{(0,fo.A)(t),r({peerId:f,storyId:e.id,isInProfile:!1}),c({message:l("Story.ToastRemovedFromProfileText")}),U()})),E=(0,ts.A)((()=>{d({peerId:f,storyId:e.id}),U()}));return(0,us.FD)("div",{ref:u,className:(0,Kt.A)("kxMIqtqr","scroll-item"),onMouseDown:N,onClick:B,onContextMenu:T,children:[y&&(0,us.FD)("span",{children:[(0,us.Y)(Ys.A,{className:"cq7jTRkg",name:"story-expired"}),l("ExpiredStory")]}),a&&(0,us.Y)(Ys.A,{className:(0,Kt.A)(sr,"GTWFQyJx"),name:"pin-badge"}),I&&Boolean(e.views?.viewsCount)&&(0,us.FD)("span",{className:(0,Kt.A)(sr,"g09Rb4Ps"),children:[(0,us.Y)(Ys.A,{name:"eye"}),e.views.viewsCount]}),A&&(0,us.Y)("span",{className:(0,Kt.A)(sr,"lM_2MMyQ"),children:A}),(0,us.FD)("div",{className:"D6Yajvjx",children:[M&&(0,us.Y)("img",{src:M,alt:"",className:"cV_QL3N5",draggable:!1}),I&&(0,us.Y)(tr.A,{story:e}),t&&(0,us.Y)("span",{className:"protector"})]}),void 0!==F&&(0,us.FD)(Ds.A,{isOpen:k,anchor:F,getTriggerElement:h,getRootElement:p,getMenuElement:m,getLayout:g,className:(0,Kt.A)("UAfI9izT","story-context-menu"),autoClose:!0,onClose:U,onCloseAnimationEnd:x,withPortal:!0,children:[s&&(0,us.Y)(Ls.A,{icon:"archive",onClick:R,children:l("StoryList.SaveToProfile")}),!s&&(0,us.Y)(Ls.A,{icon:"archive",onClick:J,children:l("Story.Context.RemoveFromProfile")}),!s&&!a&&o&&(0,us.Y)(Ls.A,{icon:"pin",onClick:E,children:l("StoryList.ItemAction.Pin")}),!s&&a&&(0,us.Y)(Ls.A,{icon:"unpin",onClick:E,children:l("StoryList.ItemAction.Unpin")})]})]})})));var or=s(46222),nr=s(24680),ir=s(285);const rr=[{type:"media",key:"ProfileTabMedia"},{type:"documents",key:"ProfileTabFiles"},{type:"links",key:"ProfileTabLinks"},{type:"audio",key:"ProfileTabMusic"}];function dr(e,t,s){return(0,us.FD)("div",{className:"profile-info",children:[(0,us.Y)(Zi.A,{peerId:e,canPlayVideo:t}),(0,us.Y)(Qi.A,{chatOrUserId:e,isSavedDialog:s})]})}const cr=(0,jt.ph)((0,w.EK)(((e,{chatId:t,threadId:s,isMobile:a})=>{const o=(0,C.mBe)(e,t),i=(0,C.hds)(e,t),r=(0,C.AWZ)(e,t),d=(0,C.vGo)(e,t),c=(0,C.zeq)(e,t),{shouldWarnAboutSvg:l}=(0,We.l)(e),{currentType:u,resultsByType:h}=(0,C.BU_)(e)||{},{foundIds:p}=h&&u&&h[u]||{},m=Boolean(i?.isForum&&s&&s!==n.l3),{byId:g,statusesById:f}=e.users,{byId:I}=e.chats,b=(0,v.cG)(t,s,e.currentUserId),y=i&&(0,v.YE)(i),w=i&&(0,v.WX)(i),S=o&&(0,v.tv)(o),A=!m&&!b&&(y||w&&(0,v.SJ)(i)),M=r?.members,k=r?.adminMembersById,F=A&&i&&(i.isForbidden||r&&!r.canViewMembers),P=A&&i&&((0,v.ub)(i,"inviteUsers")||!w&&!(0,v.Sq)(i,"inviteUsers")||i.isCreator),T=A&&i&&((0,v.ub)(i,"banUsers")||i.isCreator),U=(0,C.yuw)(e),{similarChannelIds:x}=(0,C.dg4)(e,t)||{},{similarBotsIds:B}=(0,C.AOG)(e,t)||{},N=(0,C.g29)(e),R=o||i,J=d||r,E=o&&!o.isSelf&&!(0,v.tv)(o)&&!b&&Boolean(d?.commonChatsCount),Y=(0,C.Ua4)(e,t),D=d?.botInfo?.hasPreviewMedia,L=e.users.previewMediaByBotId[t],O=R&&(o?.isSelf||!R.areStoriesHidden&&J?.hasPinnedStories)&&!b,G=O?(0,C._bp)(e,R.id):void 0,V=G?.profileIds,j=G?.pinnedIds,q=G?.byId,W=G?.archiveIds,z=Boolean(J?.starGiftCount)&&!b,K=(0,C.nTw)(e).savedGifts.giftsByPeerId[t];return{theme:(0,C.SJA)(e),isChannel:w,isBot:S,messagesById:c,foundIds:p,mediaSearchType:u,hasCommonChatsTab:E,hasStoriesTab:O,hasMembersTab:A,hasPreviewMediaTab:D,areMembersHidden:F,canAddMembers:P,canDeleteMembers:T,currentUserId:e.currentUserId,isRightColumnShown:(0,C.gjV)(e,a),isRestricted:i?.isRestricted,activeDownloads:U,usersById:g,userStatusesById:f,chatsById:I,storyIds:V,hasGiftsTab:z,gifts:K?.gifts,pinnedStoryIds:j,archiveStoryIds:W,storyByIds:q,isChatProtected:i?.isProtected,nextProfileTab:(0,C.nTw)(e).nextProfileTab,forceScrollProfileTab:(0,C.nTw)(e).forceScrollProfileTab,shouldWarnAboutSvg:l,similarChannels:x,similarBots:B,botPreviewMedia:L,isCurrentUserPremium:N,isTopicInfo:m,isSavedDialog:b,isSynced:e.isSynced,limitSimilarPeers:(0,fe.B)(e,"recommendedChannels"),...A&&M&&{members:M,adminMembersById:k},...E&&o&&{commonChatIds:Y?.ids}}}))((({chatId:e,isActive:t,threadId:s,profileState:o,theme:r,isChannel:c,isBot:l,currentUserId:u,messagesById:h,foundIds:p,storyIds:m,pinnedStoryIds:g,archiveStoryIds:f,storyByIds:I,mediaSearchType:b,hasCommonChatsTab:y,hasStoriesTab:S,hasMembersTab:A,hasPreviewMediaTab:C,hasGiftsTab:M,gifts:F,botPreviewMedia:P,areMembersHidden:T,canAddMembers:U,canDeleteMembers:x,commonChatIds:B,members:N,adminMembersById:R,usersById:J,userStatusesById:E,chatsById:Y,isRightColumnShown:D,isRestricted:L,activeDownloads:O,isChatProtected:G,nextProfileTab:V,shouldWarnAboutSvg:j,similarChannels:q,similarBots:W,isCurrentUserPremium:z,limitSimilarPeers:K,isTopicInfo:_,isSavedDialog:H,forceScrollProfileTab:X,isSynced:$,onProfileStateChange:Q})=>{const{setSharedMediaSearchType:Z,loadMoreMembers:ee,loadCommonChats:te,openChat:se,searchSharedMediaMessages:ae,openMediaViewer:oe,openAudioPlayer:ne,focusMessage:ie,setNewChatMembersDialogState:re,loadPeerProfileStories:de,loadStoriesArchive:ce,openPremiumModal:le,loadChannelRecommendations:ue,loadBotRecommendations:he,loadPreviewMedias:pe,loadPeerSavedGifts:me,resetGiftProfileFilter:ge}=(0,w.ko)(),fe=(0,jt.li)(),Ie=(0,jt.li)(),be=(0,Rs.A)(),ve=(0,es.A)(),[ye,we]=(0,jt.J0)(),Se=H?String(s):e,Ae=Se===u&&!H,Ce=(0,jt.Kr)((()=>{const e=[];return Ae&&!H&&e.push({type:"dialogs",key:"ProfileTabSavedDialogs"}),S&&e.push({type:"stories",key:"ProfileTabStories"}),S&&Ae&&e.push({type:"storiesArchive",key:"ProfileTabStoriesArchive"}),M&&e.push({type:"gifts",key:"ProfileTabGifts"}),A&&e.push({type:"members",key:c?"ProfileTabSubscribers":"ProfileTabMembers"}),C&&e.push({type:"previewMedia",key:"ProfileTabBotPreview"}),e.push(...rr),_||e.push({type:"voice",key:"ProfileTabVoice"}),y&&e.push({type:"commonChats",key:"ProfileTabSharedGroups"}),c&&q?.length&&e.push({type:"similarChannels",key:"ProfileTabSimilarChannels"}),l&&W?.length&&e.push({type:"similarBots",key:"ProfileTabSimilarBots"}),e.map((e=>({type:e.type,title:ve(e.key)})))}),[Ae,H,S,M,A,C,_,y,c,l,q?.length,W?.length,ve]),Me=(0,jt.Kr)((()=>{if(!V)return 0;const e=Ce.findIndex((({type:e})=>e===V));return-1===e?0:e}),[V,Ce]),[ke,Fe,Pe]=(0,Ta.A)(!1),[Te,Ue]=(0,jt.J0)(Me);(0,jt.vJ)((()=>{if(!V)return;const e=Ce.findIndex((({type:e})=>e===V));-1!==e&&Ue(e)}),[V,Ce]);const xe=(0,jt.hb)((e=>{Fe(),Ue(e)}),[]);(0,jt.vJ)((()=>{C&&!P&&pe({botId:e})}),[e,P,C]),(0,jt.vJ)((()=>{c&&!q&&$&&ue({chatId:e})}),[e,c,q,$]),(0,jt.vJ)((()=>{l&&!W&&$&&he({userId:e})}),[e,l,W,$]);const[Be,Ne]=(0,jt.J0)(F),{startViewTransition:Re,shouldApplyVtn:Je}=(0,xi.Y)(),Ee=(0,ts.A)((e=>`${e.date}-${e.fromId}-${e.gift.id}`)),Ye=(0,jt.Kr)((()=>Be?.map(Ee)),[Be]),De=Te>Ce.length-1?Ce.length-1:Te,Le=Ce[De].type,Oe=(0,jt.hb)((()=>{te({userId:e})}),[e]),Ge=(0,jt.hb)((({offsetId:t})=>{de({peerId:e,offsetId:t})}),[e]),Ve=(0,jt.hb)((({offsetId:t})=>{ce({peerId:e,offsetId:t})}),[e]),je=(0,jt.hb)((()=>{me({peerId:e})}),[e]);(0,ro.A)((([e])=>{if(!F||!e)return void Ne(F);const t=e.map(Ee),s=F.map(Ee);t.some(((e,t)=>e!==s[t]))?Re((()=>{Ne(F)})):Ne(F)}),[F,Re]);const[qe,We,ze,Ke]=function({loadMoreMembers:e,loadCommonChats:t,searchMessages:s,loadStories:a,loadStoriesArchive:o,loadMoreGifts:n,tabType:i,mediaSearchType:r,groupChatMembers:d,commonChatIds:c,usersById:l,userStatusesById:u,chatsById:h,chatMessages:p,foundIds:m,threadId:g,storyIds:f,giftIds:I,pinnedStoryIds:b,archiveStoryIds:y,similarChannels:w,similarBots:S}){const A="members"!==i&&r?r:i,C=(0,jt.Kr)((()=>{if(d&&l&&u)return(0,v.UB)(d.map((({userId:e})=>e)),l,u)}),[d,l,u]),M=(0,jt.Kr)((()=>{if(c&&h)return(0,wi.A)(c,!0)}),[h,c]),[k,F,P]=Yi(e,C),[T,U,x]=Di("media",A,s,p,m,g),[B,N,R]=Di("documents",A,s,p,m,g),[J,E,Y]=Di("links",A,s,p,m,g),[D,L,O]=Di("audio",A,s,p,m,g),[G,V,j]=Di("voice",A,s,p,m,g),[q,W,z]=Yi(t,M),K=(0,jt.Kr)((()=>{if(!f?.length)return f;const e=new Set(b);return f.slice().sort(((t,s)=>{const a=e.has(t),o=e.has(s);return a&&!o?-1:!a&&o?1:s-t}))}),[f,b]),[_,H,X]=Yi(a,K),[$,Q,Z]=Yi(o,y);let ee,te,se=!1;switch(A){case"members":ee=k,te=F,se=P;break;case"commonChats":ee=q,te=W,se=z;break;case"media":ee=T,te=U,se=x;break;case"documents":ee=B,te=N,se=R;break;case"links":ee=J,te=E,se=Y;break;case"audio":ee=D,te=L,se=O;break;case"voice":ee=G,te=V,se=j;break;case"stories":ee=_,te=H,se=X;break;case"storiesArchive":ee=$,te=Q,se=Z;break;case"similarChannels":ee=w;break;case"similarBots":ee=S;break;case"gifts":ee=I,te=n;break;case"dialogs":se=!0}return[A,ee,te,se]}({loadMoreMembers:ee,searchMessages:ae,loadStories:Ge,loadStoriesArchive:Ve,loadMoreGifts:je,loadCommonChats:Oe,tabType:Le,mediaSearchType:b,groupChatMembers:N,commonChatIds:B,usersById:J,userStatusesById:E,chatsById:Y,chatMessages:h,foundIds:p,threadId:s,storyIds:m,giftIds:Ye,pinnedStoryIds:g,archiveStoryIds:f,similarChannels:q,similarBots:W}),_e=Ae&&"dialogs"===qe||S&&"stories"===qe||"members"===qe||!A&&"media"===qe,He=Ce.findIndex((({type:e})=>e===qe));(0,Bi.A)("members"===qe?We:void 0);const Xe=(0,ts.A)((()=>{Pe()})),{handleScroll:$e}=function(e,t,s,a,o=!1,n=!1,r){(0,ro.A)((([s])=>{if(s&&s!==t&&n||t&&o){const s=e.current,o=s.querySelector(".TabList");r(),s.scrollTop<o.offsetTop&&(a(Ji(t)),Ri=!0,(0,it.Ay)({container:s,element:o,position:"start",forceDuration:300}),setTimeout((()=>{Ri=!1}),350))}}),[t,a,e,o,n,r]),(0,ro.A)((([t])=>{if(s!==i.zW.Profile||s===t)return;const a=e.current;if(!a)return;const o=a.querySelector(".TabList");!o||o.offsetTop>a.scrollTop||(Ri=!0,(0,it.Ay)({container:a,element:a.firstElementChild,position:"start",maxDistance:2*a.offsetHeight}),setTimeout((()=>{Ri=!1}),350))}),[s,e]);const d=(0,ts.A)((()=>{const s=e.current;if(!s)return;const o=s.querySelector(".TabList");if(!o)return;let n=i.zW.Profile;Math.ceil(s.scrollTop)>=o.offsetTop&&(n=Ji(t)),a(n)}));return(0,jt.vJ)((()=>{Ri||d()}),[d,t]),{handleScroll:(0,ts.A)((()=>{Ri||Ni(d)}))}}(fe,qe,o,Q,X,ke,Xe),{applyTransitionFix:Qe,releaseTransitionFix:Ze}=function(e,t=".Transition.shared-media-transition"){return(0,jt.vJ)((()=>{function s(){const s=e.current,a=s.querySelector(t),o=s.querySelector(".TabList");if(a&&o){const e=s.offsetHeight-o.offsetHeight+1;(0,zt.RK)((()=>{a.style.minHeight=`${e}px`}))}}return s(),window.addEventListener("resize",s,!1),()=>{window.removeEventListener("resize",s,!1)}}),[e,t]),{applyTransitionFix:(0,ts.A)((()=>{(0,zt.YS)((()=>{const t=e.current;if("hidden"===t.style.overflowY)return;const s=t.offsetWidth-t.clientWidth;(0,zt.RK)((()=>{t.style.overflowY="hidden",t.style.paddingRight=`${s}px`}))}))})),releaseTransitionFix:(0,ts.A)((()=>{const t=e.current;t.style.overflowY="scroll",t.style.paddingRight="0"}))}}(fe),[et,tt]=(()=>{const[e,t]=(0,jt.J0)(0);return[e,(0,jt.hb)((()=>{t((e=>e+1))}),[])]})(),{observe:st}=(0,To.BL)({rootRef:fe,throttleMs:500}),at=(0,ts.A)((()=>{Ze(),tt()})),ot=(0,ts.A)((()=>{re({newChatMembersProgress:i.D7.InProgress})}));(0,jt.vJ)((()=>{Z({mediaType:Le})}),[Z,Le,s]);const nt=(0,ts.A)((e=>{oe({chatId:Se,threadId:n.l3,messageId:e,origin:i.TQ.SharedMedia})})),rt=(0,ts.A)((e=>{oe({standaloneMedia:P?.flatMap((e=>e?.content.photo||e?.content.video)).filter(Boolean),origin:i.TQ.PreviewMedia,mediaIndex:e})})),dt=(0,ts.A)((e=>{ne({chatId:Se,messageId:e})})),ct=(0,ts.A)((e=>{se({id:e})})),lt=(0,ts.A)((e=>{ie({chatId:e.chatId,messageId:e.id})})),ut=(0,ts.A)((()=>{we(void 0)}));(0,ro.A)((([e])=>{if(void 0===e||0===Te||e===A)return;const t=Te+(A?1:-1);Ue(Math.min(t,Ce.length-1))}),[A,Te,Ce]);const ht=(0,ts.A)((()=>{ge({peerId:e})}));let pt;(0,jt.vJ)((()=>{if(Ie.current&&d.TF)return(0,Ti.wJ)(Ie.current,{selectorToPreventScroll:".Profile",onSwipe:(e,t)=>t===Ti.ez.Left?(Ue(Math.min(De+1,Ce.length-1)),!0):t===Ti.ez.Right&&(Ue(Math.max(0,De-1)),!0)})}),[De,Ce.length]),_e?pt=D?0:1e3:We||P||(pt=a.jhd);const mt=(0,Wn.A)([e,s,qe,De],pt),gt=`.shared-media-transition > .Transition_slide-active.${qe}-list > .scroll-item`;return(0,us.FD)(or.A,{ref:fe,className:"Profile custom-scroll",itemSelector:gt,items:mt?We:void 0,cacheBuster:et,sensitiveArea:a.ZhW,preloadBackwards:mt?"members"===qe?a.nnT:a.Um:0,noScrollRestoreOnTop:!0,noFastList:!0,onLoadMore:ze,onScroll:$e,children:[!Ke&&!Ae&&dr(Se,D&&mt,H),!L&&(0,us.FD)("div",{className:"shared-media",children:[(0,us.Y)(Ts.Ay,{ref:Ie,name:be.isRtl?"slideOptimizedRtl":"slideOptimized",activeKey:He,renderCount:Ce.length,shouldRestoreHeight:!0,className:"shared-media-transition",onStart:Qe,onStop:at,children:function(){if("dialogs"===qe)return(0,us.Y)(Ws.A,{className:"saved-dialogs",folderType:"saved",isActive:!0});if(!We&&!P||!mt||!h){const e=_e&&!mt,t=Boolean("members"===qe&&T);return(0,us.FD)("div",{className:"content empty-list",children:[!e&&!t&&(0,us.Y)(Hn.A,{}),t&&(0,us.Y)(Hi.A,{text:"You have no access to group members list."})]})}const t=We&&!We?.length;if(t&&"gifts"===qe)return(0,us.FD)("div",{className:"nothing-found-gifts",children:[(0,us.Y)(Qo.A,{size:160,tgsUrl:$o.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,us.Y)("div",{className:"description",children:ve("GiftSearchEmpty")}),(0,us.Y)(wo.A,{className:"date",onClick:ht,children:ve("GiftSearchReset")})]});if(t){let e;switch(qe){case"members":e=T?"You have no access to group members list.":"No members found";break;case"commonChats":e=be("NoGroupsInCommon");break;case"documents":e=be("lng_media_file_empty");break;case"links":e=be("lng_media_link_empty");break;case"audio":e=be("lng_media_song_empty");break;case"voice":e=be("lng_media_audio_empty");break;case"stories":e=be("StoryList.SavedEmptyState.Title");break;case"storiesArchive":e=be("StoryList.ArchivedEmptyState.Title");break;default:e=be("SharedMedia.EmptyTitle")}return(0,us.Y)("div",{className:"content empty-list",children:(0,us.Y)(Hi.A,{text:e})})}return(0,us.Y)("div",{className:`content ${qe}-list`,dir:be.isRtl&&"media"===qe?"rtl":void 0,teactFastList:!0,children:"media"===qe?We.map((e=>h[e]&&(0,us.Y)(_i.A,{message:h[e],isProtected:G||h[e].isProtected,observeIntersection:st,onClick:nt},e))):"stories"===qe||"storiesArchive"===qe?We.map(((e,t)=>I?.[e]&&(0,us.Y)(ar,{teactOrderKey:t,story:I[e],isArchive:"storiesArchive"===qe},`${qe}_${e}`))):"documents"===qe?We.map((e=>h[e]&&(0,us.Y)(Oi.A,{document:(0,v.zC)(h[e]),withDate:!0,smaller:!0,className:"scroll-item",isDownloading:(0,v.$r)(O,(0,v.zC)(h[e])),observeIntersection:st,onDateClick:lt,message:h[e],shouldWarnAboutSvg:j},e))):"links"===qe?We.map((e=>h[e]&&(0,us.Y)(er.A,{message:h[e],isProtected:G||h[e].isProtected,observeIntersection:st,onMessageClick:lt},e))):"audio"===qe?We.map((e=>h[e]&&(0,us.Y)(Li.Ay,{theme:r,message:h[e],origin:i.d9.SharedMedia,date:h[e].date,className:"scroll-item",onPlay:dt,onDateClick:lt,canDownload:!G&&!h[e].isProtected,isDownloading:(0,v.$r)(O,h[e].content.audio)},e))):"voice"===qe?We.map((e=>{const t=h[e];if(!t)return;const s=h[e]&&(0,v.ed)(t);return h[e]&&(0,us.Y)(Li.Ay,{theme:r,message:h[e],senderTitle:(0,Ui.N)(be,h[e],Y,J),origin:i.d9.SharedMedia,date:h[e].date,className:"scroll-item",onPlay:dt,onDateClick:lt,canDownload:!G&&!h[e].isProtected,isDownloading:(0,v.$r)(O,s)},e)})):"members"===qe?We.map(((e,t)=>{return(0,us.Y)(na.A,{teactOrderKey:t,className:"chat-item-clickable contact-list-item scroll-item small-icon",onClick:()=>ct(e),contextActions:(s=e,s!==u&&x?[{title:be("lng_context_remove_from_group"),icon:"stop",handler:()=>{we(s)}}]:void 0),children:(0,us.Y)(cn.A,{userId:e,adminMember:R?.[e],forceShowSelf:!0,withStory:!0})},e);var s})):"commonChats"===qe?We.map(((e,t)=>(0,us.Y)(na.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item small-icon",onClick:()=>se({id:e}),children:(0,us.Y)(dn.A,{chatId:e})},e))):"previewMedia"===qe?P.map(((e,t)=>(0,us.Y)($i,{media:e,isProtected:G,observeIntersection:st,onClick:rt,index:t},e.date))):"similarChannels"===qe?(0,us.FD)("div",{children:[We.map(((e,t)=>(0,us.Y)(na.A,{teactOrderKey:t,className:(0,Kt.A)("chat-item-clickable search-result",!z&&t===q.length-1&&"blured"),onClick:()=>se({id:e}),children:(0,us.Y)(dn.A,{avatarSize:"large",chatId:e,withFullInfo:!0})},e))),!z&&(0,us.FD)(us.FK,{children:[(0,us.FD)(Es.A,{className:"show-more-channels",size:"smaller",onClick:()=>le(),children:[be("UnlockSimilar"),(0,us.Y)(Ys.A,{name:"unlock-badge"})]}),(0,us.Y)("div",{className:"more-similar",children:(0,Io.A)(be("MoreSimilarText",K),["simple_markdown"])})]})]},qe):"similarBots"===qe?(0,us.FD)("div",{children:[We.map(((e,t)=>(0,us.Y)(na.A,{teactOrderKey:t,className:(0,Kt.A)("chat-item-clickable search-result",!z&&t===W.length-1&&"blured"),onClick:()=>se({id:e}),children:(0,k.L8)(e)?(0,us.Y)(cn.A,{userId:e,avatarSize:"medium"}):(0,us.Y)(dn.A,{chatId:e,avatarSize:"medium"})},e))),!z&&(0,us.FD)(us.FK,{children:[(0,us.FD)(Es.A,{className:"show-more-bots",size:"smaller",onClick:()=>le(),children:[ve("UnlockMoreSimilarBots"),(0,us.Y)(Ys.A,{name:"unlock-badge"})]}),(0,us.Y)("div",{className:"more-similar",children:(0,Io.A)(ve("MoreSimilarBotsDescription",{count:K},{withNodes:!0,withMarkdown:!0,pluralValue:K}))})]})]},qe):"gifts"===qe?Be?.map((t=>(0,us.Y)(Ki,{peerId:e,style:Je?`view-transition-name: vt${Ee(t)}`:void 0,gift:t,observeIntersection:st},Ee(t)))):void 0})}()}),(0,us.Y)(nr.A,{activeTab:De,tabs:Ce,onSwitchTab:xe})]}),U&&(0,us.Y)(Si.A,{className:(0,Kt.A)(!t&&"hidden"),isShown:mt,onClick:ot,ariaLabel:be("lng_channel_add_users"),children:(0,us.Y)(Ys.A,{name:"add-user-filled"})}),x&&(0,us.Y)(ir.A,{isOpen:Boolean(ye),userId:ye,onClose:ut})]})})));var lr=s(60859);const ur=450+a.xB5;var hr=function(e){return e[e.Profile=0]="Profile",e[e.MemberList=1]="MemberList",e[e.GiftList=2]="GiftList",e[e.SharedMedia=3]="SharedMedia",e[e.StoryList=4]="StoryList",e[e.Search=5]="Search",e[e.Statistics=6]="Statistics",e[e.MessageStatistics=7]="MessageStatistics",e[e.StoryStatistics=8]="StoryStatistics",e[e.BoostStatistics=9]="BoostStatistics",e[e.MonetizationStatistics=10]="MonetizationStatistics",e[e.Management=11]="Management",e[e.ManageInitial=12]="ManageInitial",e[e.ManageChannelSubscribers=13]="ManageChannelSubscribers",e[e.ManageChatAdministrators=14]="ManageChatAdministrators",e[e.ManageChatPrivacyType=15]="ManageChatPrivacyType",e[e.ManageDiscussion=16]="ManageDiscussion",e[e.ManageGroupPermissions=17]="ManageGroupPermissions",e[e.ManageGroupRemovedUsers=18]="ManageGroupRemovedUsers",e[e.ManageChannelRemovedUsers=19]="ManageChannelRemovedUsers",e[e.ManageGroupUserPermissionsCreate=20]="ManageGroupUserPermissionsCreate",e[e.ManageGroupUserPermissions=21]="ManageGroupUserPermissions",e[e.ManageGroupRecentActions=22]="ManageGroupRecentActions",e[e.ManageGroupAdminRights=23]="ManageGroupAdminRights",e[e.ManageGroupNewAdminRights=24]="ManageGroupNewAdminRights",e[e.ManageGroupMembers=25]="ManageGroupMembers",e[e.ManageGroupAddAdmins=26]="ManageGroupAddAdmins",e[e.StickerSearch=27]="StickerSearch",e[e.GifSearch=28]="GifSearch",e[e.PollResults=29]="PollResults",e[e.AddingMembers=30]="AddingMembers",e[e.ManageInvites=31]="ManageInvites",e[e.ManageEditInvite=32]="ManageEditInvite",e[e.ManageReactions=33]="ManageReactions",e[e.ManageInviteInfo=34]="ManageInviteInfo",e[e.ManageJoinRequests=35]="ManageJoinRequests",e[e.CreateTopic=36]="CreateTopic",e[e.EditTopic=37]="EditTopic",e[e.SavedDialogs=38]="SavedDialogs",e[e.NewDiscussionGroup=39]="NewDiscussionGroup",e}(hr||{});const pr=(0,w.EK)(((e,{chatId:t,isProfile:s,isManagement:a,threadId:o})=>{const i=(0,C.nTw)(e),{query:r}=(0,C.BmE)(e)||{},{query:d}=(0,C.Wy7)(e)||{},c=t?(0,C.hds)(e,t):void 0,l=s&&t&&(0,k.L8)(t)?(0,C.mBe)(e,t):void 0,u=c&&(0,v.WX)(c),h=c?.isForum&&Boolean(o&&o!==n.l3),p=h?(0,C.S0q)(e,t,o):void 0,m=h&&p&&(0,v.l1)(c,p),g=l&&(0,v.tv)(l),f=t?(0,C.nZ4)(e,t):void 0,I=g&&l?.canEditBot,b=l&&(0,v.Gh)(l),y=Boolean(!a&&s&&t&&(0,C.e5V)(e,t)),w=Boolean(t&&i.management.byChatId[t]?.editingInvite),S=!h&&t?(0,C.AWZ)(e,t)?.canViewStatistics:void 0,A=t?i.management.byChatId[t]?.inviteInfo?.invite:void 0,M=i.savedGifts.filter,F=!!t&&(0,C.rtZ)(e,t),P=!!t&&(0,C.ERc)(e,t);return{canManage:y,canAddContact:b,canViewStatistics:S,isChannel:u,isBot:g,isInsideTopic:h,canEditTopic:m,userId:l?.id,isSelf:l?.isSelf,stickerSearchQuery:r,gifSearchQuery:d,isEditingInvite:w,currentInviteInfo:A,isSavedMessages:f,shouldSkipHistoryAnimations:i.shouldSkipHistoryAnimations,canEditBot:I,giftProfileFilter:M,canUseGiftFilter:F,canUseGiftAdminFilter:P}}))((({chatId:e,threadId:t,isColumnOpen:s,isProfile:o,isManagement:n,isStatistics:r,isMessageStatistics:d,isStoryStatistics:c,isMonetizationStatistics:l,isBoostStatistics:u,isStickerSearch:h,isGifSearch:p,isPollResults:m,isCreatingTopic:g,isEditingTopic:f,isAddingChatMembers:I,profileState:b,managementScreen:v,canAddContact:y,userId:S,isSelf:A,canManage:C,isChannel:M,stickerSearchQuery:k,gifSearchQuery:F,isEditingInvite:P,canViewStatistics:T,currentInviteInfo:U,shouldSkipHistoryAnimations:x,isBot:B,isInsideTopic:N,canEditTopic:R,isSavedMessages:J,onClose:E,onScreenSelect:Y,canEditBot:D,giftProfileFilter:O,canUseGiftFilter:G,canUseGiftAdminFilter:V})=>{const{setStickerSearchQuery:j,setGifSearchQuery:q,toggleManagement:W,openAddContactDialog:z,toggleStatistics:K,setEditingExportedInvite:_,deleteExportedChatInvite:H,openEditTopicPanel:X,updateGiftProfileFilter:$}=(0,w.ko)(),[Q,Z,ee]=(0,Ta.A)(),{isMobile:te}=(0,L.Ay)(),{sortType:se,shouldIncludeUnlimited:ae,shouldIncludeLimited:oe,shouldIncludeUnique:ne,shouldIncludeDisplayed:ie,shouldIncludeHidden:re}=O,de=(0,ws.g5)(),ce=(0,ts.A)((()=>{_({chatId:e,invite:U}),Y(i.je.EditInvite)})),le=(0,ts.A)((()=>{H({chatId:e,link:U.link}),Y(i.je.Invites),ee()})),ue=(0,ts.A)((e=>{j({query:e})})),he=(0,ts.A)((e=>{q({query:e})})),pe=(0,ts.A)((()=>{z({userId:S})})),me=(0,ts.A)((()=>{e&&t&&X({chatId:e,topicId:Number(t)})})),ge=(0,ts.A)((()=>{W()})),fe=(0,ts.A)((()=>{K()})),Ie=(0,ts.A)((()=>{E(!J)})),[be,ve]=(0,jt.J0)(!s);(0,jt.vJ)((()=>{setTimeout((()=>{ve(!s)}),ur)}),[s]);const ye=(0,Rs.A)(),we=(0,es.A)(),Se=o?b===i.zW.Profile?hr.Profile:b===i.zW.SharedMedia?hr.SharedMedia:b===i.zW.MemberList?hr.MemberList:b===i.zW.GiftList?hr.GiftList:b===i.zW.StoryList?hr.StoryList:b===i.zW.SavedDialogs?hr.SavedDialogs:-1:m?hr.PollResults:h?hr.StickerSearch:p?hr.GifSearch:I?hr.AddingMembers:n?v===i.je.Initial?hr.ManageInitial:v===i.je.ChatPrivacyType?hr.ManageChatPrivacyType:v===i.je.Discussion?hr.ManageDiscussion:v===i.je.ChannelSubscribers?hr.ManageChannelSubscribers:v===i.je.GroupPermissions?hr.ManageGroupPermissions:v===i.je.ChatAdministrators?hr.ManageChatAdministrators:v===i.je.GroupRemovedUsers?hr.ManageGroupRemovedUsers:v===i.je.ChannelRemovedUsers?hr.ManageChannelRemovedUsers:v===i.je.GroupUserPermissionsCreate?hr.ManageGroupUserPermissionsCreate:v===i.je.GroupUserPermissions?hr.ManageGroupUserPermissions:v===i.je.GroupRecentActions?hr.ManageGroupRecentActions:v===i.je.ChatAdminRights?hr.ManageGroupAdminRights:v===i.je.ChatNewAdminRights?hr.ManageGroupNewAdminRights:v===i.je.GroupMembers?hr.ManageGroupMembers:v===i.je.Invites?hr.ManageInvites:v===i.je.EditInvite?hr.ManageEditInvite:v===i.je.GroupAddAdmins?hr.ManageGroupAddAdmins:v===i.je.Reactions?hr.ManageReactions:v===i.je.InviteInfo?hr.ManageInviteInfo:v===i.je.JoinRequests?hr.ManageJoinRequests:v===i.je.NewDiscussionGroup?hr.NewDiscussionGroup:void 0:r?hr.Statistics:d?hr.MessageStatistics:c?hr.StoryStatistics:u?hr.BoostStatistics:g?hr.CreateTopic:f?hr.EditTopic:l?hr.MonetizationStatistics:void 0,Ae=(0,mn.A)(Se,!0)??-1,Ce=(0,jt.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,us.Y)(Es.A,{round:!0,ripple:!te,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:we("AccDescrOpenMenu2"),children:(0,us.Y)(Ys.A,{name:"more"})})),[te,we]),Me=te||!J&&(Se===hr.SharedMedia||Se===hr.GiftList||Se===hr.MemberList||Se===hr.StoryList||Se===hr.AddingMembers||Se===hr.MessageStatistics||Se===hr.StoryStatistics||n),ke=(0,Kt.A)("animated-close-icon",Me&&"state-back",(be||x)&&"no-transition"),Fe=(0,jt.li)();return(0,us.FD)("div",{className:"RightHeader",ref:Fe,children:[(0,us.Y)(Es.A,{className:"close-button",round:!0,color:"translucent",size:"smaller",onClick:Ie,ariaLabel:ye(Me?"Common.Back":"Common.Close"),children:(0,us.Y)("div",{className:ke})}),(0,us.Y)(Ts.Ay,{name:be||x?"none":"slideFade",activeKey:Ae,children:function(){if(-1!==Ae)switch(Ae){case hr.PollResults:return(0,us.Y)("h3",{className:"title",children:ye("PollResults")});case hr.AddingMembers:return(0,us.Y)("h3",{className:"title",children:ye(M?"ChannelAddSubscribers":"GroupAddMembers")});case hr.ManageInitial:return(0,us.Y)("h3",{className:"title",children:ye("Edit")});case hr.ManageChatPrivacyType:return(0,us.Y)("h3",{className:"title",children:ye(M?"ChannelTypeHeader":"GroupTypeHeader")});case hr.ManageDiscussion:return(0,us.Y)("h3",{className:"title",children:ye("Discussion")});case hr.ManageChatAdministrators:return(0,us.Y)("h3",{className:"title",children:ye("ChannelAdministrators")});case hr.ManageGroupRecentActions:return(0,us.Y)("h3",{className:"title",children:ye("Group.Info.AdminLog")});case hr.ManageGroupAdminRights:return(0,us.Y)("h3",{className:"title",children:ye("EditAdminRights")});case hr.ManageGroupNewAdminRights:return(0,us.Y)("h3",{className:"title",children:ye("SetAsAdmin")});case hr.ManageGroupPermissions:return(0,us.Y)("h3",{className:"title",children:ye("ChannelPermissions")});case hr.ManageGroupRemovedUsers:return(0,us.Y)("h3",{className:"title",children:ye("BlockedUsers")});case hr.ManageChannelRemovedUsers:return(0,us.Y)("h3",{className:"title",children:ye("ChannelBlockedUsers")});case hr.ManageGroupUserPermissionsCreate:return(0,us.Y)("h3",{className:"title",children:ye("ChannelAddException")});case hr.ManageGroupUserPermissions:return(0,us.Y)("h3",{className:"title",children:ye("UserRestrictions")});case hr.ManageInvites:return(0,us.Y)("h3",{className:"title",children:ye("lng_group_invite_title")});case hr.ManageEditInvite:return(0,us.Y)("h3",{className:"title",children:ye(P?"EditLink":"NewLink")});case hr.ManageInviteInfo:return(0,us.FD)(us.FK,{children:[(0,us.Y)("h3",{className:"title",children:ye("InviteLink")}),(0,us.FD)("section",{className:"tools",children:[U&&!U.isRevoked&&(0,us.Y)(Es.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ye("Edit"),onClick:ce,children:(0,us.Y)(Ys.A,{name:"edit"})}),U&&U.isRevoked&&(0,us.FD)(us.FK,{children:[(0,us.Y)(Es.A,{round:!0,color:"danger",size:"smaller",ariaLabel:ye("Delete"),onClick:Z,children:(0,us.Y)(Ys.A,{name:"delete"})}),(0,us.Y)(Dn.A,{isOpen:Q,onClose:ee,title:ye("DeleteLink"),text:ye("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:ye("Delete"),confirmHandler:le})]})]})]});case hr.ManageJoinRequests:return(0,us.Y)("h3",{className:"title",children:ye(M?"SubscribeRequests":"MemberRequests")});case hr.ManageGroupAddAdmins:return(0,us.Y)("h3",{className:"title",children:ye("Channel.Management.AddModerator")});case hr.StickerSearch:return(0,us.Y)(js.A,{value:k,placeholder:ye("SearchStickersHint"),autoFocusSearch:!0,onChange:ue});case hr.GifSearch:return(0,us.Y)(js.A,{value:F,placeholder:ye("SearchGifsTitle"),autoFocusSearch:!0,onChange:he});case hr.Statistics:return(0,us.Y)("h3",{className:"title",children:ye(M?"ChannelStats.Title":"GroupStats.Title")});case hr.MessageStatistics:return(0,us.Y)("h3",{className:"title",children:ye("Stats.MessageTitle")});case hr.StoryStatistics:return(0,us.Y)("h3",{className:"title",children:ye("Stats.StoryTitle")});case hr.BoostStatistics:return(0,us.Y)("h3",{className:"title",children:ye("Boosts")});case hr.MonetizationStatistics:return(0,us.Y)("h3",{className:"title",children:ye("lng_channel_earn_title")});case hr.SharedMedia:return(0,us.Y)("h3",{className:"title",children:ye("SharedMedia")});case hr.ManageChannelSubscribers:return(0,us.Y)("h3",{className:"title",children:ye("ChannelSubscribers")});case hr.MemberList:case hr.ManageGroupMembers:return(0,us.Y)("h3",{className:"title",children:ye("GroupMembers")});case hr.StoryList:return(0,us.Y)("h3",{className:"title",children:ye(A?"Settings.MyStories":"PeerInfo.PaneStories")});case hr.SavedDialogs:return(0,us.FD)("div",{className:"header",children:[(0,us.Y)("h3",{className:"title",children:ye("SavedMessagesTab")}),(0,us.Y)("div",{className:"subtitle",children:ye("Chats",de[a.pX9])})]});case hr.ManageReactions:return(0,us.Y)("h3",{className:"title",children:ye("Reactions")});case hr.CreateTopic:return(0,us.Y)("h3",{className:"title",children:ye("NewTopic")});case hr.EditTopic:return(0,us.Y)("h3",{className:"title",children:ye("EditTopic")});case hr.GiftList:return(0,us.FD)(us.FK,{children:[(0,us.Y)("h3",{className:"title",children:we("ProfileTabGifts")}),G&&e&&(0,us.Y)("section",{className:"tools",children:(0,us.FD)(wn.A,{trigger:Ce,positionX:"right",autoClose:!1,children:[(0,us.Y)(Ls.A,{icon:"byDate"===se?"cash-circle":"calendar-filter",onClick:()=>$({peerId:e,filter:{sortType:"byDate"===se?"byValue":"byDate"}}),children:we("byDate"===se?"GiftSortByValue":"GiftSortByDate")}),(0,us.Y)(lr.A,{}),(0,us.Y)(Ls.A,{icon:ae?"check":"placeholder",onClick:()=>$({peerId:e,filter:{shouldIncludeUnlimited:!ae}}),children:we("GiftFilterUnlimited")}),(0,us.Y)(Ls.A,{icon:oe?"check":"placeholder",onClick:()=>$({peerId:e,filter:{shouldIncludeLimited:!oe}}),children:we("GiftFilterLimited")}),(0,us.Y)(Ls.A,{icon:ne?"check":"placeholder",onClick:()=>$({peerId:e,filter:{shouldIncludeUnique:!ne}}),children:we("GiftFilterUnique")}),V&&(0,us.FD)(us.FK,{children:[(0,us.Y)(lr.A,{}),(0,us.Y)(Ls.A,{icon:ie?"check":"placeholder",onClick:()=>$({peerId:e,filter:{shouldIncludeDisplayed:!ie}}),children:we("GiftFilterDisplayed")}),(0,us.Y)(Ls.A,{icon:re?"check":"placeholder",onClick:()=>$({peerId:e,filter:{shouldIncludeHidden:!re}}),children:we("GiftFilterHidden")})]})]})})]});case hr.NewDiscussionGroup:return(0,us.Y)("h3",{className:"title",children:ye("NewGroup")});default:return(0,us.FD)(us.FK,{children:[(0,us.Y)("h3",{className:"title",children:ye(J?"SavedMessages":N?"AccDescrTopic":M?"Channel.TitleInfo":S?B?"lng_info_bot_title":"lng_info_user_title":"GroupInfo.Title")}),(0,us.FD)("section",{className:"tools",children:[y&&(0,us.Y)(Es.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ye("AddContact"),onClick:pe,children:(0,us.Y)(Ys.A,{name:"add-user"})}),C&&!N&&(0,us.Y)(Es.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ye("Edit"),onClick:ge,children:(0,us.Y)(Ys.A,{name:"edit"})}),D&&(0,us.Y)(Es.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ye("Edit"),onClick:ge,children:(0,us.Y)(Ys.A,{name:"edit"})}),R&&(0,us.Y)(Es.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ye("EditTopic"),onClick:me,children:(0,us.Y)(Ys.A,{name:"edit"})}),T&&(0,us.Y)(Es.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:ye("Statistics"),onClick:fe,children:(0,us.Y)(Ys.A,{name:"stats"})})]})]})}}()})]})}));var mr=s(55317),gr=s(47058),fr=s(20333),Ir=s(71950);const br={root:"gk6pIryJ",noResults:"WP4wRUbm","section-header":"LWcgK3OX",sectionHeader:"LWcgK3OX",section:"C8KF95yU",user:"oMy5KOFr",stats:"GOzrl0zF",down:"QuLtxDUV",loadMoreSpinner:"ln5zB7KK",status:"r3zLiaXx",info:"Eo1qQlxx",month:"McSPvm0N",quantity:"s1yf_GJa",floatingBadge:"oSCjRZtx",floatingBadgeButtonColor:"duVpAT_e",floatingBadgeWarning:"DsJMXNNk",floatingBadgeButton:"urrWJVYB",floatingBadgeIcon:"hcA9VPeV",floatingBadgeValue:"hHkCO4Ge",content:"SG00REIA",boostSection:"ETgjBS4d",giveawayButton:"wOCtp5Kk",giveawayIcon:"B9GF4NDB",primaryLink:"GXmXwIbx",copy:"rB0gc1GX"};var vr=s(72078),yr=s(68153),wr=s(65741),Sr=s(45318);const Ar={3:yr,6:vr,12:wr},Cr={isCustomPeer:!0,avatarIcon:"star",peerColorId:1},Mr={isCustomPeer:!0,titleKey:"BoostingToBeDistributed",avatarIcon:"user",withPremiumGradient:!0},kr=(0,jt.ph)((0,w.EK)((e=>{const t=(0,C.nTw)(e).boostStatistics,s=(0,C.hc)(e),a=t&&t.chatId,o=a?(0,C.hds)(e,a):void 0,n=o&&(0,v.WX)(o),i=e.appConfig?.giveawayBoostsPerPremium;return{boostStatistics:t,isGiveawayAvailable:s,chatId:a,giveawayBoostsPerPremium:i,isChannel:n}}))((({boostStatistics:e,isGiveawayAvailable:t,chatId:s,giveawayBoostsPerPremium:o,isChannel:n})=>{const{openChat:i,loadMoreBoosters:r,closeBoostStatistics:d,openGiveawayModal:c,showNotification:l}=(0,w.ko)(),u=(0,Rs.A)(),h=(0,jt.li)(),p=e?.boostStatus,m=p?e.boostStatus:void 0,g=!(e&&e?.boosts?.count===e?.giftedBoosts?.count)&&e?.giftedBoosts&&e?.giftedBoosts?.list?.length>0,{currentLevel:f,hasNextLevel:I,boosts:b,levelProgress:v,remainingBoosts:y}=(0,jt.Kr)((()=>m?(0,mr.z)(m):{currentLevel:0,hasNextLevel:!1,boosts:0,levelProgress:0,remainingBoosts:0,prepaidGiveaways:[]}),[m]),S=(0,jt.Kr)((()=>{if(m)return{level:f,boosts:b,premiumSubscribers:m.premiumSubscribers,remainingBoosts:y,prepaidGiveaways:m.prepaidGiveaways}}),[m,b,f,y]),A=(0,jt.Kr)((()=>g?[{type:"boostList",title:u("BoostingBoostsCount",e?.boosts?.count,"i")},{type:"giftedBoostList",title:u("BoostingGiftsCount",e?.giftedBoosts?.count,"i")}]:[]),[g,u,e?.boosts?.count,e?.giftedBoosts?.count]),C=(0,jt.Kr)((()=>e?.boosts&&e.boosts?.list.length>0?1:0),[e]),[M,k]=(0,jt.J0)(C),F=M>A.length-1?A.length-1:M,P=A[F]?.type,T=A.findIndex((({type:e})=>e===P)),U=(0,jt.Kr)((()=>{if(!e)return;const t=g?"boostList"===P?e.boosts:e.giftedBoosts:e.boosts;if(!t?.count)return;const s=t.list.reduce(((e,t)=>e+(t.multiplier||1)),0),a=t.count-s;return a>0?a:void 0}),[g,e,P]),x=(0,ts.A)((e=>(0,us.Y)("div",{className:br.quantity,children:(0,us.FD)("div",{className:(0,Kt.A)(br.floatingBadge,br.floatingBadgeButtonColor),children:[(0,us.Y)(Ys.A,{name:"boost",className:br.floatingBadgeIcon}),(0,us.Y)("div",{className:br.floatingBadgeValue,children:e})]})}))),B=(0,ts.A)((e=>{if(e.isFromGiveaway||e.isGift)return(0,us.Y)("div",{className:br.quantity,children:(0,us.FD)("div",{className:(0,Kt.A)(br.floatingBadge,!e.isFromGiveaway&&br.floatingBadgeWarning,br.floatingBadgeButtonColor,br.floatingBadgeButton),children:[(0,us.Y)(Ys.A,{name:"gift",className:br.floatingBadgeIcon}),(0,us.Y)("div",{className:br.floatingBadgeValue,children:u(e.isFromGiveaway?"BoostingGiveaway":"BoostingGift")})]})})})),N=(0,ts.A)((e=>{e?(i({id:e}),d()):l({message:u("BoostingRecipientWillBeSelected")})})),R=(0,ts.A)((e=>{let t;return Boolean(e?.stars)&&(t={...Cr,title:u("Stars",e.stars)}),e.userId||(t=Mr),(0,us.Y)(na.A,{className:"chat-item-clickable",onClick:()=>N(e.userId),children:(0,us.Y)(cn.A,{className:br.user,userId:e.userId,customPeer:t,status:u("BoostExpireOn",(0,we.U)(u,1e3*e.expires)),noEmojiStatus:!0,forceShowSelf:!0,noFake:!0,noVerified:!0,iconElement:e.multiplier?x(e.multiplier):void 0,rightElement:B(e)})})})),J=(0,ts.A)((()=>{c({chatId:s})})),E=(0,ts.A)((e=>{e.preventDefault(),r({isGifts:"giftedBoostList"===P})})),Y=(0,ts.A)((e=>{c({chatId:s,prepaidGiveaway:e})}));return(0,us.FD)("div",{className:(0,Kt.A)(br.root,"panel-content custom-scroll"),children:[!p&&(0,us.Y)(Us.A,{}),p&&S&&(0,us.FD)(us.FK,{children:[(0,us.FD)("div",{className:br.section,children:[(0,us.Y)(fr.A,{leftText:u("BoostsLevel",f),rightText:I?u("BoostsLevel",f+1):void 0,progress:v,floatingBadgeText:(0,ys.Sm)(b),floatingBadgeIcon:"boost"}),(0,us.Y)(Ir.A,{className:br.stats,statistics:S,type:"boost"})]}),S.prepaidGiveaways&&(0,us.FD)("div",{className:br.section,children:[(0,us.Y)("h4",{className:br.sectionHeader,dir:u.isRtl?"rtl":void 0,children:u("BoostingPreparedGiveaways")}),S?.prepaidGiveaways?.map((e=>{const t="stars"in e;return(0,us.Y)(na.A,{className:"chat-item-clickable",onClick:()=>Y(e),children:(0,us.FD)("div",{className:(0,Kt.A)(br.status,"status-clickable"),children:[(0,us.Y)("div",{children:t?(0,us.Y)("img",{src:Sr,className:br.giveawayIcon,alt:u("GiftStar")}):(0,us.Y)("img",{src:Ar[e.months]||Ar[3],className:br.giveawayIcon,alt:u("Giveaway")})}),(0,us.FD)("div",{className:br.info,children:[(0,us.Y)("h3",{children:t?u("Giveaway.Stars.Prepaid.Title",e.stars):u("BoostingTelegramPremiumCountPlural",e.quantity)}),(0,us.Y)("p",{className:br.month,children:t?u("Giveaway.Stars.Prepaid.Desc",e.quantity):u("PrepaidGiveawayMonths",e.months)})]}),(0,us.Y)("div",{className:br.quantity,children:(0,us.FD)("div",{className:(0,Kt.A)(br.floatingBadge,br.floatingBadgeButtonColor,br.floatingBadgeButton),children:[(0,us.Y)(Ys.A,{name:"boost",className:br.floatingBadgeIcon}),(0,us.Y)("div",{className:br.floatingBadgeValue,dir:u.isRtl?"rtl":void 0,children:t?e.boosts:e.quantity*(o??a.CQG)})]})})]})},e.id)})),(0,us.Y)("p",{className:"text-muted hint",children:u("BoostingSelectPaidGiveaway")},"links-hint")]}),(0,us.FD)("div",{className:br.section,children:[g?(0,us.FD)("div",{className:(0,Kt.A)(br.boostSection,br.content),children:[(0,us.Y)(Ts.Ay,{ref:h,name:u.isRtl?"slideOptimizedRtl":"slideOptimized",activeKey:T,renderCount:A.length,shouldRestoreHeight:!0,children:function(){let t;if("boostList"===P?t=e?.boosts?.list:"giftedBoostList"===P&&(t=e?.giftedBoosts?.list),!t||t?.length)return(0,us.Y)("div",{className:br.section,children:t?.map((e=>R(e)))})}()}),(0,us.Y)(nr.A,{activeTab:F,tabs:A,onSwitchTab:k})]}):(0,us.FD)(us.FK,{children:[(0,us.Y)("h4",{className:br.sectionHeader,dir:u.isRtl?"rtl":void 0,children:u("BoostingBoostsCount",e?.boosts?.count)}),!e?.boosts?.list?.length&&(0,us.Y)("div",{className:br.noResults,children:u(n?"NoBoostersHint":"NoBoostersGroupHint")}),e?.boosts?.list?.map((e=>R(e)))]}),Boolean(U)&&(0,us.FD)(na.A,{className:br.showMore,disabled:e?.isLoadingBoosters,onClick:E,children:[e?.isLoadingBoosters?(0,us.Y)(Hn.A,{className:br.loadMoreSpinner}):(0,us.Y)(Ys.A,{name:"down",className:br.down}),u("ShowVotes",U,"i")]},"load-more")]}),(0,us.Y)(gr.A,{className:br.section,link:m.boostUrl,withShare:!0,title:u("LinkForBoosting")}),t&&(0,us.FD)("div",{className:br.section,children:[(0,us.Y)(na.A,{icon:"gift",onClick:J,className:br.giveawayButton,children:u("BoostingGetBoostsViaGifts")},"load-more"),(0,us.Y)("p",{className:"text-muted hint",children:u(n?"BoostingGetMoreBoosts":"BoostingGetMoreBoostsGroup")},"links-hint")]})]})]})}))),Fr=e=>{const t=(0,ls.A)(Xt.ar.Extra,"MessageStatistics");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Pr=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"AboutMonetizationModal",!t);return s?(0,us.Y)(s,{...e}):void 0};var Tr=s(84685);const Ur={root:"vBPv6lUS",graph:"EbPbvB1I",hidden:"nsPIlLYL",ready:"s6qyDhkE",section:"cB2IkwY6",topText:"FLOpxZd1",availableReward:"emE6bAD8",rewardValue:"eyDAxGDU",decimalPart:"jkRV_L7b",integer:"xE9kfGi7",decimalUsdPart:"hWMnYdxX",toncoinIcon:"ubDl9CvS",textBottom:"P3qZJJzF"};let xr,Br;const Nr={topHoursGraph:"ChannelStats.Graph.ViewsByHours",revenueGraph:"lng_channel_earn_chart_revenue"},Rr=Object.keys(Nr),Jr=(0,jt.ph)((0,w.EK)((e=>{const t=(0,C.nTw)(e),{settings:{byKey:{hasPassword:s}}}=e,a=t.monetizationStatistics,o=a&&a.chatId,n=o?(0,C.hds)(e,o):void 0,i=(0,C.AWZ)(e,o)?.statisticsDcId,r=Boolean(n?.isCreator),d=t.statistics.monetization,c=e.appConfig?.isChannelRevenueWithdrawalEnabled;return{chatId:o,dcId:i,statistics:d,isCreator:r,isChannelRevenueWithdrawalEnabled:c,hasPassword:s}}))((({chatId:e,dcId:t,statistics:a,isCreator:o,isChannelRevenueWithdrawalEnabled:n,hasPassword:i})=>{const{loadChannelMonetizationStatistics:r,openMonetizationVerificationModal:d,loadPasswordInfo:c}=(0,w.ko)(),l=(0,Rs.A)(),u=(0,es.A)(),h=(0,jt.li)(),[p,m]=(0,jt.J0)(!1),g=(0,jt.li)([]),f=(0,Zt.A)(),[I,b,v]=(0,Ta.A)(!1),[y,S,A]=(0,Ta.A)(),C=a?.balances?.availableBalance,M=a?.balances?.isWithdrawalEnabled,k=o&&n&&Boolean(C)&&M;(0,jt.vJ)((()=>{e&&(r({peerId:e}),c())}),[e,r]),(0,jt.vJ)((()=>{(async()=>{await async function(){return xr||(xr=s.e(4810).then(s.bind(s,24810)),Br=await xr),xr}(),p?(h.current&&Array.from(h.current.children).forEach((e=>{e.innerHTML="",e.classList.add(Ur.hidden)})),g.current=[],a&&h.current&&(Rr.forEach(((e,t)=>{const s=a[e];"string"==typeof s||g.current.includes(e)||(s?(Br.create(h.current.children[t],{title:l(Nr[e]),...s}),g.current.push(e),h.current.children[t].classList.remove(Ur.hidden)):g.current.push(e))})),f())):m(!0)})()}),[p,a,l,e,t,f]);const F=(0,jt.Kr)((()=>{const e=l("LearnMore");return u("ChannelEarnAbout",{link:(0,us.FD)(wo.A,{isPrimary:!0,onClick:b,children:[e,(0,us.Y)(Ys.A,{name:"next"})]})},{withNodes:!0})}),[u,l]),P=(0,jt.Kr)((()=>{const e=l("LearnMore");return u("MonetizationBalanceZeroInfo",{link:(0,us.FD)(Tr.A,{url:l("MonetizationProceedsInfoLink"),text:e,children:[e,(0,us.Y)(Ys.A,{name:"next"})]})},{withNodes:!0})}),[u,l]),T=(0,ts.A)((()=>{i?d({chatId:e}):S()}));return p&&a?(0,us.FD)("div",{className:(0,Kt.A)(Ur.root,"custom-scroll",p&&Ur.ready),children:[(0,us.Y)("div",{className:(0,Kt.A)(Ur.section,Ur.topText),children:F}),(0,us.Y)(Ir.A,{statistics:a,isToncoin:!0,type:"monetization",title:l("MonetizationOverview"),subtitle:(0,us.Y)("div",{className:Ur.textBottom,children:l("MonetizationProceedsTONInfo")})}),!g.current.length&&(0,us.Y)(Us.A,{}),(0,us.Y)("div",{ref:h,className:Ur.section,children:Rr.filter(Boolean).map((e=>(0,us.Y)("div",{className:(0,Kt.A)(Ur.graph,Ur.hidden)},e)))}),(0,us.FD)("div",{className:Ur.section,children:[l("lng_channel_earn_balance_title"),function(){const[e,t]=C?C.toFixed(4).split("."):[0],[s,o]=C&&a?.usdRate?(C*a.usdRate).toFixed(2).split("."):[0];return(0,us.FD)("div",{className:Ur.availableReward,children:[(0,us.FD)("div",{className:Ur.toncoin,children:[(0,us.Y)(Ys.A,{className:Ur.toncoinIcon,name:"toncoin"}),(0,us.FD)("b",{className:Ur.rewardValue,children:[e,t?(0,us.FD)("span",{className:Ur.decimalPart,children:[".",t]}):void 0]})]})," ",(0,us.FD)("span",{className:Ur.integer,children:["≈ $",s,o?(0,us.FD)("span",{className:Ur.decimalUsdPart,children:[".",o]}):void 0]})]})}(),(0,us.Y)(Es.A,{size:"smaller",type:"button",onClick:T,disabled:!k,children:l("MonetizationWithdraw")}),(0,us.Y)("div",{className:Ur.textBottom,children:P})]}),(0,us.Y)(Pr,{isOpen:I,onClose:v}),(0,us.Y)(Dn.A,{isOnlyConfirm:!0,isOpen:y,onClose:A,confirmHandler:A,confirmLabel:u("OK"),children:(0,us.Y)("p",{children:(0,Io.A)(l("Monetization.Withdraw.Error.Text"),["br"])})})]}):(0,us.Y)(Us.A,{})}))),Er=e=>{const t=(0,ls.A)(Xt.ar.Extra,"Statistics");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Yr=e=>{const t=(0,ls.A)(Xt.ar.Extra,"StoryStatistics");return t?(0,us.Y)(t,{...e}):(0,us.Y)(Us.A,{})},Dr=()=>{const e=(0,ls.A)(Xt.ar.Extra,"StickerSearch");return e?(0,us.Y)(e,{}):(0,us.Y)(Us.A,{})},Lr=450+a.xB5,Or=Object.keys(i.Ul).length/2,Gr=Object.keys(i.je).length/2;function Vr(){const e=document.querySelector(".RightHeader .SearchInput input");e&&e.blur()}const jr=(0,jt.ph)((0,w.EK)(((e,{isMobile:t})=>{const{chatId:s,threadId:a}=(0,C.Xf0)(e)||{},o=(0,C.bE$)(e),{management:n,shouldSkipHistoryAnimations:i,nextProfileTab:r,shouldCloseRightColumn:d}=(0,C.nTw)(e),c=s?n.byChatId[s]?.nextScreen:void 0,l=s?(0,C.nZ4)(e,s):void 0,u=s?(0,v.cG)(s,a,e.currentUserId):void 0;return{contentKey:(0,C.t75)(e,t),chatId:s,threadId:a,isChatSelected:Boolean(s&&o),shouldSkipHistoryAnimations:i,nextManagementScreen:c,nextProfileTab:r,shouldCloseRightColumn:d,isSavedMessages:l,isSavedDialog:u}}))((({contentKey:e,chatId:t,threadId:s,isMobile:o,isChatSelected:n,shouldSkipHistoryAnimations:r,nextManagementScreen:d,nextProfileTab:c,shouldCloseRightColumn:l,isSavedMessages:u,isSavedDialog:h})=>{const{toggleChatInfo:p,toggleManagement:m,setStickerSearchQuery:g,setGifSearchQuery:f,closePollResults:I,addChatMembers:b,setNewChatMembersDialogState:v,setEditingExportedInvite:y,toggleStatistics:S,toggleMessageStatistics:A,toggleStoryStatistics:C,setOpenedInviteInfo:M,requestNextManagementScreen:k,resetNextProfileTab:F,closeCreateTopicPanel:P,closeEditTopicPanel:T,closeBoostStatistics:U,setShouldCloseRightColumn:x,closeMonetizationStatistics:B}=(0,w.ko)(),N=(0,jt.li)(),{width:R}=(0,xa.A)(),[J,E]=(0,jt.J0)(u&&!h?i.zW.SavedDialogs:i.zW.Profile),[Y,D]=(0,jt.J0)(i.je.Initial),[L,O]=(0,jt.J0)(),[G,V]=(0,jt.J0)(),j=J!==i.zW.Profile,q=void 0!==e,W=e===i.Ul.ChatInfo,z=e===i.Ul.Management,K=e===i.Ul.Statistics,_=e===i.Ul.MessageStatistics,H=e===i.Ul.StoryStatistics,X=e===i.Ul.BoostStatistics,$=e===i.Ul.MonetizationStatistics,Q=e===i.Ul.StickerSearch,Z=e===i.Ul.GifSearch,ee=e===i.Ul.PollResults,te=e===i.Ul.AddingMembers,se=e===i.Ul.CreateTopic,ae=e===i.Ul.EditTopic,oe=R<=a.gQx,[ne,ie]=(0,jt.J0)(!q),re=(0,mn.A)(e,!0,!n)??-1;(0,yi.A)({containerRef:N,selector:":scope .custom-scroll, :scope .panel-content"},[e,Y,t,s]);const de=(0,ts.A)(((s=!0)=>{switch(e){case i.Ul.AddingMembers:v({newChatMembersProgress:i.D7.Closed});break;case i.Ul.ChatInfo:if(j&&s&&!u){E(i.zW.Profile);break}p({force:!1},{forceSyncOnIOs:!0});break;case i.Ul.Management:switch(Y){case i.je.Initial:m();break;case i.je.ChatPrivacyType:case i.je.Discussion:case i.je.GroupPermissions:case i.je.GroupType:case i.je.ChatAdministrators:case i.je.ChannelSubscribers:case i.je.GroupMembers:case i.je.Invites:case i.je.Reactions:case i.je.JoinRequests:case i.je.ChannelRemovedUsers:D(i.je.Initial);break;case i.je.GroupUserPermissionsCreate:case i.je.GroupRemovedUsers:case i.je.GroupUserPermissions:D(i.je.GroupPermissions),O(void 0),V(void 0);break;case i.je.NewDiscussionGroup:D(i.je.Discussion);break;case i.je.ChatAdminRights:case i.je.ChatNewAdminRights:case i.je.GroupAddAdmins:case i.je.GroupRecentActions:D(i.je.ChatAdministrators);break;case i.je.EditInvite:case i.je.InviteInfo:D(i.je.Invites),M({chatId:t,invite:void 0}),y({chatId:t,invite:void 0})}break;case i.Ul.MessageStatistics:A();break;case i.Ul.StoryStatistics:C();break;case i.Ul.Statistics:S();break;case i.Ul.BoostStatistics:U();break;case i.Ul.MonetizationStatistics:B();break;case i.Ul.StickerSearch:Vr(),g({query:void 0});break;case i.Ul.GifSearch:Vr(),f({query:void 0});break;case i.Ul.PollResults:I();break;case i.Ul.CreateTopic:P();break;case i.Ul.EditTopic:T()}})),ce=(0,ts.A)(((e,t)=>{O(e),V(t)})),le=(0,ts.A)((e=>{b({chatId:t,memberIds:e})}));return(0,jt.vJ)((()=>q&&t?(0,As.A)(de):void 0),[q,de,t]),(0,jt.vJ)((()=>{setTimeout((()=>{ie(!q)}),Lr)}),[q]),(0,jt.vJ)((()=>{d&&(D(d),k(void 0))}),[d]),(0,jt.vJ)((()=>{c&&F()}),[c]),(0,jt.vJ)((()=>{l&&(de(),x({value:void 0}))}),[l]),(0,jt.vJ)((()=>{q&&oe&&de()}),[oe]),(0,co.A)((([e,a])=>{e===t&&a===s||(E(u&&!h?i.zW.SavedDialogs:i.zW.Profile),D(i.je.Initial))}),[t,s,h,u]),(0,Aa.A)({isActive:n&&(e===i.Ul.ChatInfo||e===i.Ul.Management||e===i.Ul.AddingMembers||e===i.Ul.CreateTopic||e===i.Ul.EditTopic),onBack:()=>de(!1)}),(0,us.FD)("div",{id:"RightColumn-wrapper",className:n?void 0:"is-hidden",children:[oe&&(0,us.Y)("div",{className:"overlay-backdrop",onClick:de}),(0,us.FD)("div",{id:"RightColumn",children:[(0,us.Y)(pr,{chatId:t,threadId:s,isColumnOpen:q,isProfile:W,isManagement:z,isStatistics:K,isBoostStatistics:X,isMonetizationStatistics:$,isMessageStatistics:_,isStoryStatistics:H,isStickerSearch:Q,isGifSearch:Z,isPollResults:ee,isCreatingTopic:se,isEditingTopic:ae,isAddingChatMembers:te,profileState:J,managementScreen:Y,onClose:de,onScreenSelect:D}),(0,us.Y)(Ts.Ay,{ref:N,name:ne||r?"none":"zoomFade",renderCount:Or+Gr,activeKey:z?Or+Y:re,shouldCleanup:!0,cleanupExceptionKey:re===i.Ul.MessageStatistics||re===i.Ul.StoryStatistics?i.Ul.Statistics:void 0,children:function(e){if(-1!==re)switch(re){case i.Ul.AddingMembers:return(0,us.Y)(Ai,{chatId:t,isActive:q&&e,onNextStep:le,onClose:de},`add_chat_members_${t}`);case i.Ul.ChatInfo:return(0,us.Y)(cr,{chatId:t,threadId:s,profileState:J,isMobile:o,isActive:q&&e,onProfileStateChange:E},`profile_${t}_${s}`);case i.Ul.Management:return(0,us.Y)(Fi,{chatId:t,currentScreen:Y,isPromotedByCurrentUser:G,selectedChatMemberId:L,isActive:q&&e,onScreenSelect:D,onChatMemberSelect:ce,onClose:de},`management_${t}_${Y}`);case i.Ul.Statistics:return(0,us.Y)(Er,{chatId:t});case i.Ul.BoostStatistics:return(0,us.Y)(kr,{});case i.Ul.MonetizationStatistics:return(0,us.Y)(Jr,{});case i.Ul.MessageStatistics:return(0,us.Y)(Fr,{chatId:t,isActive:q&&e});case i.Ul.StoryStatistics:return(0,us.Y)(Yr,{chatId:t,isActive:q&&e});case i.Ul.StickerSearch:return(0,us.Y)(Dr,{onClose:de,isActive:q&&e});case i.Ul.GifSearch:return(0,us.Y)(ki,{onClose:de,isActive:q&&e});case i.Ul.PollResults:return(0,us.Y)(Pi,{onClose:de,isActive:q&&e});case i.Ul.CreateTopic:return(0,us.Y)(Ci,{onClose:de,isActive:q&&e});case i.Ul.EditTopic:return(0,us.Y)(Mi,{onClose:de,isActive:q&&e})}}})]})]})}))),qr=(0,jt.ph)((({isOpen:e})=>{const t=(0,ls.A)(Xt.ar.Extra,"StoryViewer",!e);return t?(0,us.Y)(t,{}):void 0})),Wr=e=>{const{requestedAttachBotInChat:t}=e,s=(0,ls.A)(Xt.ar.Extra,"AttachBotRecipientPicker",!t);return s?(0,us.Y)(s,{...e}):void 0},zr=e=>{const{bot:t}=e,s=(0,ls.A)(Xt.ar.Extra,"BotTrustModal",!t);return s?(0,us.Y)(s,{...e}):void 0},Kr=e=>{const{folder:t}=e,s=(0,ls.A)(Xt.ar.Extra,"DeleteFolderDialog",!t);return s?(0,us.Y)(s,{...e}):void 0},_r=({isOpen:e})=>{const t=(0,ls.A)(Xt.ar.Extra,"Dialogs",!e);return t?(0,us.Y)(t,{}):void 0};var Hr=s(95362);const Xr=new Set,$r=new Set,Qr=(0,jt.ph)((0,w.EK)((e=>({activeDownloads:(0,C.nTw)(e).activeDownloads})))((({activeDownloads:e})=>{const{cancelMediaHashDownloads:t,showNotification:s}=(0,w.ko)(),a=(0,uo.A)(1e3,!0),o=(0,ts.A)((e=>{$r.add(e),a((()=>{$r.size&&(t({mediaHashes:Array.from($r)}),$r.clear())}))}));(0,jt.vJ)((()=>{Object.keys(e).length?Object.entries(e).forEach((([e,t])=>{if(Xr.has(e))return;Xr.add(e);const{size:a,filename:i,format:r}=t,c=at.Ih(e);if(c)return(0,Hr.A)(c,i),void o(e);if(a>d.kn&&!d.l5&&!d.Tz)return s({message:"Downloading files bigger than 2GB is not supported in your browser."}),void o(e);const l=()=>{(0,C.nTw)((0,w.mS)()).activeDownloads[e]||at.ch(l)};at.hd(e,r,!0,l,(0,gt.A)()).then((t=>{if(r===n.qZ.DownloadUrl){const e=new URL(t,window.document.baseURI);e.searchParams.set("filename",encodeURIComponent(i));const a=window.open(e.toString());a?.addEventListener("beforeunload",(()=>{s({message:"Download started. Please, do not close the app before it is finished."})}))}else t&&(0,Hr.A)(t,i);o(e)}))})):Xr.clear()}),[e])}))),Zr=e=>{const{requestedDraft:t}=e,s=(0,ls.A)(Xt.ar.Extra,"DraftRecipientPicker",!t);return s?(0,us.Y)(s,{...e}):void 0},ed=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"ForwardRecipientPicker",!t);return s?(0,us.Y)(s,{...e}):void 0};var td=s(73172),sd=s(22337);const ad=(0,jt.ph)((0,w.EK)(((e,{openedGame:t})=>{const{chatId:s}=t||{},a=s&&(0,C.hds)(e,s),o=s?(0,C.AWZ)(e,s):void 0;return{canPost:Boolean(a)&&(0,v.__)(a,void 0,void 0,o)}}))((({openedGame:e,gameTitle:t,canPost:s})=>{const{closeGame:a,openForwardMenu:o}=(0,w.ko)(),n=(0,Rs.A)(),{url:i,chatId:r,messageId:d}=e||{},c=Boolean(i),l=(0,td.A)(r);(0,$t.A)((()=>{l({type:"playingGame"})}),c&&s?5e3:void 0);const u=(0,jt.hb)((e=>{if(r&&d)try{const t=JSON.parse(e.data);"share_score"===t.eventType&&(o({fromChatId:r,messageIds:[d],withMyScore:!0}),a()),"share_game"===t.eventType&&(o({fromChatId:r,messageIds:[d]}),a())}catch(e){}}),[r,a,d,o]),h=(0,jt.hb)((e=>{e.currentTarget.focus()}),[]);return(0,jt.vJ)((()=>(window.addEventListener("message",u),()=>window.removeEventListener("message",u))),[u]),(0,us.Y)(sd.A,{className:"GameModal",isOpen:c,onClose:a,title:t,hasCloseButton:!0,children:c&&(0,us.Y)("iframe",{className:"game-frame",onLoad:h,src:i,title:n("AttachGame"),sandbox:"allow-scripts allow-same-origin allow-orientation-lock",allow:"fullscreen"})})}))),od=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"HistoryCalendar",!t);return s?(0,us.Y)(s,{...e}):void 0},nd=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"NewContactModal",!t);return s?(0,us.Y)(s,{...e}):void 0},id=({isOpen:e})=>{const t=(0,ls.A)(Xt.ar.Extra,"Notifications",!e);return t?(0,us.Y)(t,{}):void 0},rd=e=>{const{limit:t}=e,s=(0,ls.A)(Xt.ar.Extra,"PremiumLimitReachedModal",!t);return s?(0,us.Y)(s,{...e}):void 0},dd=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"GiveawayModal",!t);return s?(0,us.Y)(s,{...e}):void 0},cd=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Extra,"PremiumMainModal",!t);return s?(0,us.Y)(s,{...e}):void 0},ld=e=>{const{isOpen:t}=e,s=(0,ls.A)(Xt.ar.Stars,"StarsGiftingPickerModal",!t);return s?(0,us.Y)(s,{...e}):void 0},ud=e=>{const{url:t}=e,s=(0,ls.A)(Xt.ar.Extra,"SafeLinkModal",!t);return s?(0,us.Y)(s,{...e}):void 0},hd=(0,jt.ph)((({title:e,children:t})=>(0,us.Y)(Qs.A,{id:`main-sidebar-section-${e}`,children:({isExpandedByDefault:s,onChange:a})=>(0,us.Y)($s.A,{title:e,isExpandedByDefault:s,onChange:a,className:"QDKdf4Dj",children:t},`main-sidebar-section-${e}`)}))),pd={Selector:"eWTqlWl4",selector:"eWTqlWl4",selected:"iasB3KJO",ProfileSelectorContainer:"NYTuiole",profileSelectorContainer:"NYTuiole",ListItem:"CS2yo8vn",listItem:"CS2yo8vn"},md=(0,jt.ph)((0,w.EK)((e=>({currentLeftColumnContent:(0,C.nTw)(e).leftColumn.contentKey})))((({iconName:e,title:t,onClick:s,leftColumnContent:a,currentLeftColumnContent:o,isSelected:n,contextActions:i})=>{const{openLeftColumnContent:r}=(0,w.ko)(),d=n||o===a,c=(0,jt.hb)((()=>{s?s():r({contentKey:a})}),[a,s]),l=(0,Kt.A)(pd.selector,d&&pd.selected);return(0,us.Y)(na.A,{isStatic:!0,withPortalForMenu:!0,className:pd.listItem,contextActions:i,onClick:()=>{},children:(0,us.FD)("div",{className:l,onClick:c,children:[e&&(0,us.Y)(Ys.A,{name:e}),t]})})})));var gd=s(63495),fd=s(4029),Id=s(19800),bd=s(54639),vd=s(629),yd=s(4350),wd=s(93855),Sd=s(34431);const Ad=(0,jt.ph)((({currentUser:e,totalLimit:t,onSelectCurrent:s})=>{const{showNotification:a}=(0,w.ko)(),o=(0,es.A)(),n=(0,wd.A)(e),i=(0,v.Em)(),r=(0,v.SM)(),d=(0,jt.Kr)((()=>Object.values(n).find((t=>t.userId===e.id))),[n,e.id]),c=i>=r,l=(0,ts.A)((()=>{a({title:o("PremiumLimitAccountsTitle"),message:e.isPremium?o("PremiumLimitAccounts"):o("PremiumLimitAccountsNoPremium"),duration:7e3})})),u=(0,jt.Kr)((()=>{if(!Object.values(n).length)return;if(i===t)return;let e=1;for(;n[e];)e+=1;return(0,yd.Nv)(e,!0)}),[n,i,t]);return(0,us.FD)(us.FK,{children:[Object.entries(n||{}).sort((([,t])=>t.userId===e.id?-1:1)).map((([t,a],o,n)=>{const i=a.isTest===d?.isTest,r={title:[a.firstName,a.lastName].filter(Boolean).join(" "),isCustomPeer:!0,peerColorId:a.color,emojiStatusId:i?a.emojiStatusId:void 0,isPremium:a.isPremium},c=a.userId===e.id&&(u||n.length>1);return(0,us.FD)(us.FK,{children:[(0,us.FD)(Ls.A,{className:"account-menu-item",customIcon:(0,us.Y)(Jo.A,{size:"mini",className:"account-avatar",peer:r,previewUrl:a.avatarUri}),onClick:a.userId===e.id?s:void 0,href:a.userId!==e.id?(0,yd.Nv)(Number(t)):void 0,children:[a.isTest&&(0,us.Y)("span",{className:"account-menu-item-test",children:"T"}),(0,us.Y)(Sd.A,{peer:r,withEmojiStatus:!0,emojiStatusSize:x.$})]}),c&&(0,us.Y)(lr.A,{})]})})),u&&(0,us.Y)(Ls.A,{icon:"add",rel:"noopener",href:c?void 0:u,onClick:c?l:void 0,children:o("MenuAddAccount")})]})})),Cd=(0,jt.ph)((0,w.EK)((e=>{const t=(0,C.nTw)(e),{currentUserId:s,archiveSettings:a}=e,{animationLevel:o}=(0,We.l)(e),n=e.attachMenu.bots;return{currentUserId:s,currentUser:(0,C.mBe)(e,s),theme:(0,C.SJA)(e),animationLevel:o,canInstall:Boolean(t.canInstall),archiveSettings:a,attachBots:n,accountsTotalLimit:(0,fe.B)(e,"moreAccounts")}}))((({currentUserId:e,archiveSettings:t,animationLevel:s,theme:o,canInstall:n,attachBots:i,currentUser:r,accountsTotalLimit:c,onSelectArchived:l,onSelectContacts:u,onSelectSettings:h,onBotMenuOpened:p,onBotMenuClosed:m})=>{const{openChat:g,setSharedSettingOption:f,updatePerformanceSettings:I,openChatByUsername:b,openUrl:v,openChatWithInfo:y}=(0,w.ko)(),S=(0,Rs.A)(),A=(0,es.A)(),C=s!==a.dnp?s===a.zP3?"max":"mid":"min",M=!d.cp&&(window.location.hostname===a.mFn||a.W75),k=(0,ws.ic)()[a._E9]?.chatsCount||0,F=(0,jt.Kr)((()=>Object.values(i).filter((e=>e.isForSideMenu))),[i]),P=(0,ts.A)((()=>{g({id:e,shouldReplaceHistory:!0})})),T=(0,ts.A)((e=>{e.stopPropagation(),f({theme:"light"===o?"dark":"light"}),f({shouldUseSystemTheme:!1})})),U=(0,ts.A)((e=>{e.stopPropagation();let t=s+1;t>a.zP3&&(t=a.dnp);const o=t===a.dnp?Tt.PI:t===a.zP3?Tt.LH:Tt.PX;f({animationLevel:t}),I(o)})),x=(0,ts.A)((()=>{window.open(a.qGQ,"_blank","noopener")})),B=(0,ts.A)((()=>{(0,Id.Bt)("K")})),N=(0,ts.A)((()=>{b({username:S("Settings.TipsUsername")})})),R=(0,ts.A)((()=>{v({url:a.ukY})})),J=(0,ts.A)((()=>{y({id:e,shouldReplaceHistory:!0,profileTab:"stories"})}));return(0,us.FD)(us.FK,{children:[gd.vM&&r&&(0,us.FD)(us.FK,{children:[(0,us.Y)(Ad,{currentUser:r,totalLimit:c,onSelectCurrent:h}),(0,us.Y)(lr.A,{})]}),(0,us.Y)(Ls.A,{icon:"saved-messages",onClick:P,children:S("SavedMessages")}),t.isHidden&&(0,us.FD)(Ls.A,{icon:"archive",onClick:l,children:[(0,us.Y)("span",{className:"menu-item-name",children:S("ArchivedChats")}),k>0&&(0,us.Y)("div",{className:"right-badge",children:k})]}),(0,us.Y)(Ls.A,{icon:"user",onClick:u,children:S("Contacts")}),F.map((e=>(0,us.Y)(bd.A,{bot:e,theme:o,isInSideMenu:!0,canShowNew:!0,onMenuOpened:p,onMenuClosed:m}))),(0,us.Y)(Ls.A,{icon:"play-story",onClick:J,children:S("Settings.MyStories")}),(0,us.Y)(Ls.A,{icon:"settings",onClick:h,children:S("Settings")}),(0,us.FD)(Ls.A,{icon:"darkmode",onClick:T,children:[(0,us.Y)("span",{className:"menu-item-name",children:S("lng_menu_night_mode")}),(0,us.Y)(qs.A,{id:"darkmode",label:S("dark"===o?"lng_settings_disable_night_theme":"lng_settings_enable_night_theme"),checked:"dark"===o,noAnimation:!0})]}),(0,us.FD)(Ls.A,{icon:"animations",onClick:U,children:[(0,us.Y)("span",{className:"menu-item-name capitalize",children:S("Appearance.Animations").toLowerCase()}),(0,us.Y)(vd.A,{value:C})]}),(0,us.Y)(Ls.A,{icon:"help",onClick:N,children:S("TelegramFeatures")}),(0,us.Y)(Ls.A,{icon:"bug",onClick:R,children:A("MenuReportBug")}),a.Cmz&&(0,us.Y)(Ls.A,{icon:"permissions",onClick:x,children:A("MenuBetaChangelog")}),M&&(0,us.Y)(Ls.A,{icon:"K",isCharIcon:!0,href:`${a.qJR}k`,onClick:B,children:A("MenuSwitchToK")}),n&&(0,us.Y)(Ls.A,{icon:"install",onClick:(0,fd.S)(),children:A("MenuInstallApp")})]})}))),Md=(0,jt.ph)((0,w.EK)((e=>({peer:(0,C.PVB)(e,e.currentUserId||"")})))((({peer:e})=>{const[t,s,a]=(0,Ta.A)(),o=(0,Kt.A)(pd.selector),n=(0,jt.Kr)((()=>({onTrigger:t})=>(0,us.FD)("div",{className:o,onClick:t,children:[(0,us.Y)(Jo.A,{className:pd.profileAvatar,peer:e,size:"tiny",forceRoundedRect:!0}),(0,us.Y)("div",{style:"color: var(--color-text-secondary); font-size: 13px;",children:e?.usernames&&e.usernames[0]&&e.usernames[0].username})]})),[e,o]);return(0,us.Y)("div",{className:pd.profileSelectorContainer,children:(0,us.Y)(wn.A,{trigger:n,footer:"Footer",forceOpen:t,positionX:"left",transformOriginX:300,positionY:"bottom",children:(0,us.Y)(Cd,{onSelectArchived:()=>{},onSelectContacts:()=>{},onSelectSettings:()=>{},onBotMenuOpened:s,onBotMenuClosed:a})})})}))),kd={Container:"XotuvL0_",container:"XotuvL0_",IconContainer:"wXOqykD_",iconContainer:"wXOqykD_",Title:"HCcEQ3hf",title:"HCcEQ3hf",RightBox:"iditXjQy",rightBox:"iditXjQy",onActiveIndicator:"PwIonz7j",closeButton:"bJQnOd7r"},Fd=(0,jt.ph)((({webContentsTab:e,workspaces:t,isActive:s})=>{const{loadWebContentsViewUrl:a,closeWebContentsTab:o}=(0,w.ko)(),[n,i]=(0,jt.J0)(!1),r=(0,Kt.A)(kd.container,s&&kd.isActive),d=(0,Kt.A)(kd.iconContainer);return(0,us.FD)("div",{onClick:()=>{a({url:e.url})},className:r,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[(0,us.Y)("div",{className:d,children:(0,us.Y)(Ys.A,{name:"link"})}),(0,us.Y)("div",{className:kd.title,children:t.map((t=>t.links.find((t=>t.url===e.url)))).find((e=>void 0!==e))?.title??e.title}),(0,us.Y)("div",{className:kd.rightBox,children:n?(0,us.Y)(Ys.A,{name:"close",className:kd.closeButton,onClick:t=>{t.stopPropagation(),o({tabId:e.id})}}):s?(0,us.Y)("div",{className:kd.onActiveIndicator}):void 0})]})})),Pd=(0,jt.ph)((0,w.EK)((e=>{const{workspaces:t}=e,s=(0,C.nTw)(e).leftColumn.contentKey;return{workspaces:t.byOrder||[],areWorkspacesLoaded:t.areLoaded||!1,activeWorkspaceId:t.activeId,leftColumnContentKey:s}}))((({workspaces:e,areWorkspacesLoaded:t,activeWorkspaceId:s,leftColumnContentKey:a})=>{const{loadAllWorkspaces:o,addNewWorkspace:n,openLeftColumnContent:r,setActiveWorkspaceId:d,deleteWorkspace:c}=(0,w.ko)(),[l,u]=(0,jt.J0)(!1),h=(0,jt.hb)((()=>{e.length>=3||0!==e.length&&u(!0)}),[e.length]),p=(0,jt.hb)((()=>{u(!1)}),[]),m=(0,jt.hb)((e=>()=>{a!==i.Bn.Workspace&&r({contentKey:i.Bn.Workspace}),d(e)}),[a,r,d]),g=(0,jt.hb)((e=>()=>{c({workspaceId:e})}),[c]),f=(0,jt.hb)((e=>{0!==e.length&&(n({title:e,iconName:"lamp"}),u(!1))}),[n]),I=(0,jt.hb)((e=>[{title:"Delete",handler:g(e.id),icon:"delete",destructive:!0}]),[g]);(0,jt.vJ)((()=>{t?void 0===s&&e[0]&&m(e[0].id)():o()}),[s,t,m,e]);const b=(0,jt.Kr)((()=>e.map((e=>(0,us.Y)(md,{iconName:e.iconName,title:e.title,onClick:m(e.id),isSelected:a===i.Bn.Workspace&&s===e.id,contextActions:I(e)},e.id)))),[e,a,s,m,I]);return(0,us.Y)(Qs.A,{id:"main-sidebar-section-Space",children:({isExpandedByDefault:t,onChange:s})=>(0,us.FD)($s.A,{title:"Spaces",isExpandedByDefault:t,onChange:s,onAddClick:h,className:"QDKdf4Dj",children:[0===e.length&&(0,us.Y)("div",{className:"yX_zJ91K",children:"Loading..."}),b,l&&(0,us.Y)($s.A,{isRenaming:!0,leftIconName:"lamp",onRenameCancel:p,onRenameFinish:f,className:"O5F71FTy"})]})})}))),Td=(0,jt.ph)((0,w.EK)((e=>({workspaces:e.workspaces.byOrder})))((({workspaces:e})=>{const[t,s]=(0,jt.J0)([]),[a,o]=(0,jt.J0)(void 0);window.electron.on(Wt.v.ON_WEB_CONTENTS_TABS_CHANGE,(e=>{s(e.tabs),o(e.activeTabId)})),(0,jt.vJ)((()=>{window.electron.getWebContentsTabs().then((e=>{s(e)}))}),[]);const n=(0,Kt.A)("oBRH_i6v","custom-scroll");return(0,us.FD)("div",{className:n,children:[(0,us.FD)("div",{className:"tXfha3M0",children:[(0,us.Y)(Pd,{}),(0,us.FD)(hd,{title:"Chats",children:[(0,us.Y)(md,{title:"Unreads",iconName:"check",leftColumnContent:i.Bn.AllUnread}),(0,us.Y)(md,{title:"All",iconName:"message-read",leftColumnContent:i.Bn.ChatList}),(0,us.Y)(md,{title:"Groups",iconName:"group",leftColumnContent:i.Bn.Groups}),(0,us.Y)(md,{title:"Channels",iconName:"channel",leftColumnContent:i.Bn.Channels}),(0,us.Y)(md,{title:"Bots",iconName:"bots",leftColumnContent:i.Bn.Bots}),(0,us.Y)(md,{title:"Archive",iconName:"archive",leftColumnContent:i.Bn.Archived})]}),(0,us.Y)(hd,{title:"Saved",children:(0,us.Y)(md,{title:"All",iconName:"tag",leftColumnContent:i.Bn.Saved})}),t.length>0&&(0,us.Y)(hd,{title:"Active links",children:t.reverse().map((t=>(0,us.Y)(Fd,{webContentsTab:t,workspaces:e,isActive:a===t.id})))})]}),(0,us.Y)(Md,{})]})}))),Ud={root:"YUAfqWPN"},xd=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"],Bd=new Path2D("M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z"),Nd=(0,jt.ph)((0,w.EK)((e=>(0,h.Up)((0,C.nTw)(e),["confetti"])))((({confetti:e})=>{const t=(0,jt.li)(),s=(0,jt.li)([]),a=(0,jt.li)(!1),o=(0,xa.A)(),n=(0,Zt.A)(),{isMobile:i}=(0,L.Ay)(),r=i?50:100,{lastConfettiTime:d,top:c,width:l,left:u,height:h,style:p="poppers"}=e||{},m=(0,ts.A)(((t,a,o=r)=>{for(let n=0;n<o;n++){const{position:o,velocity:i}=Rd(p,t,a,n),r=10+Jd(5),d=xd[Math.floor(Math.random()*xd.length)];s.current.push({pos:o,size:r,color:d,velocity:i,flicker:r,flickerFrequency:.2*Math.random(),rotation:0,lastDrawnAt:Date.now(),frameCount:0,isStar:e?.withStars&&Math.random()>.8})}})),g=(0,ts.A)((()=>{if(!t.current||!a.current)return;const e=t.current,o=e.getContext("2d");if(!o)return;const{width:n,height:i}=e;o.clearRect(0,0,n,i);const r=[];s.current.forEach(((e,t)=>{const{pos:a,velocity:n,size:d,color:c,flicker:l,flickerFrequency:u,rotation:h,lastDrawnAt:p,frameCount:m}=e,g=(Date.now()-p)/1e3,f={x:a.x+n.x*g,y:a.y+n.y*g},I={x:n.x*.5**(g/1),y:n.y+=1e3*g},b=d*Math.abs(Math.sin(m*u)),v=5*m*u*(Math.PI/180),y=m+1,w=Date.now();if(f.y>i+e.size)return void r.push(e);const S={...e,pos:f,velocity:I,flicker:b,rotation:v,lastDrawnAt:w,frameCount:y};s.current[t]=S,o.fillStyle=c,e.isStar?(o.save(),o.translate(a.x,a.y),o.scale(d/10*1.5,d/10*1.5),o.rotate(h),o.fill(Bd),o.restore()):(o.beginPath(),o.ellipse(a.x,a.y,d,l,h,0,2*Math.PI),o.fill())})),s.current=s.current.filter((e=>!r.includes(e))),s.current.length?(0,zt.YS)(g):a.current=!1}));if((0,is.A)((([e])=>{let t;return e!==d&&(m(l||o.width,h||o.height),t=setTimeout(n,1e4),a.current||(a.current=!0,(0,zt.YS)(g))),()=>{clearTimeout(t)}}),[d,n,g]),!d||Date.now()-d>1e4)return;const f=(0,Ma.A)(Boolean(c)&&`top: ${c}px`,Boolean(u)&&`left: ${u}px`,Boolean(l)&&`width: ${l}px`,Boolean(h)&&`height: ${h}px`);return(0,us.Y)("div",{id:"Confetti",className:Ud.root,style:f,children:(0,us.Y)("canvas",{ref:t,className:Ud.canvas,width:o.width,height:o.height})})})));function Rd(e,t,s,a){if("poppers"===e){const e=a%2,o={x:t*(e?-.1:1.1),y:.66*s},n=Math.random()*t;return{position:o,velocity:{x:e?n:-1*n,y:-s-Jd(.75*s)}}}return{position:{x:Math.random()*t,y:-20},velocity:{x:Jd(t),y:-s*Math.random()*1.25}}}function Jd(e=1){return Math.random()*e-e/2}var Ed=s(15006),Yd=s(28470);const Dd=s.p+"wave_ripple.5d7d9fa793232bef56c0.jpg",Ld="wave-filter",Od=(0,jt.ph)((0,w.EK)((e=>({waveInfo:(0,C.nTw)(e).wave})))((({waveInfo:e})=>{const[t,s]=(0,jt.J0)([]),o=(0,ts.A)((e=>{t.length>=7||s((t=>[...t,e]))}));return(0,jt.vJ)((()=>{if(!e)return;const{startX:t,startY:s}=e,{width:a,height:n}=U.A.get(),i=1.73*Math.max(a-t,n-s,t,s),r=s-i/2,d=t-i/2;o({startTime:e.lastWaveTime,waveWidth:i,top:r,left:d})}),[e]),(0,jt.vJ)((()=>((0,Yd.z)((0,us.FD)("filter",{x:"0",y:"0",width:"1",height:"1","color-interpolation-filters":"sRGB",xmlns:a.jNX,children:[(0,us.Y)("feImage",{href:Dd,result:"waveImage"}),(0,us.Y)("feDisplacementMap",{in:"SourceGraphic",in2:"waveImage",scale:"20",xChannelSelector:"R",yChannelSelector:"B"})]}),Ld),()=>{(0,Yd.e)(Ld)})),[]),(0,us.Y)("div",{className:(0,Kt.A)("RMsQzedH"),teactFastList:!0,children:t.map((e=>(0,us.Y)("div",{className:"YLR2Oh2f",style:(0,Ma.A)(`--wave-width: ${e.waveWidth}px`,`--wave-pos-top: ${e.top}px`,`--wave-pos-left: ${e.left}px`),onAnimationEnd:()=>s((t=>t.filter((t=>t!==e))))},e.startTime)))})})));let Gd=!1;const Vd=(0,jt.ph)((0,w.EK)(((e,{isMobile:t})=>{const{currentUserId:s}=e,{botTrustRequest:a,requestedAttachBotInChat:o,requestedDraft:n,safeLinkModalUrl:i,openedStickerSetShortName:r,openedCustomEmojiSetIds:d,shouldSkipHistoryAnimations:c,openedGame:l,isLeftColumnShown:u,historyCalendarSelectedAt:h,notifications:p,dialogs:m,newContact:g,ratingPhoneCall:f,premiumModal:I,giveawayModal:b,deleteMessageModal:v,starsGiftingPickerModal:y,isMasterTab:w,payment:S,limitReachedModal:A,deleteFolderDialogModal:M}=(0,C.nTw)(e),{wasTimeFormatSetManually:k}=(0,We.l)(e),F=l&&(0,C.O5q)(e,l.chatId,l.messageId),P=F?.content.game?.title,{chatId:T}=(0,C.Xf0)(e)||{},U=!(0,C.xYJ)(e,"rightColumnAnimations")||!(0,C.PKK)(e),x=M?(0,C.$aQ)(e,M):void 0,B=(0,C.trm)(e);return{currentUserId:s,isLeftColumnOpen:u,isMiddleColumnOpen:Boolean(T),isRightColumnOpen:(0,C.gjV)(e,t),isMediaViewerOpen:(0,C.F4N)(e),isStoryViewerOpen:(0,C.gd2)(e),isForwardModalOpen:(0,C.p5z)(e),isReactionPickerOpen:(0,C.Ani)(e),hasNotifications:Boolean(p.length),hasDialogs:Boolean(m.length),safeLinkModalUrl:i,isHistoryCalendarOpen:Boolean(h),shouldSkipHistoryAnimations:c,openedStickerSetShortName:r,openedCustomEmojiSetIds:d,isServiceChatReady:(0,C.dqr)(e),activeGroupCallId:w?e.groupCalls.activeGroupCallId:void 0,withInterfaceAnimations:(0,C.PKK)(e),wasTimeFormatSetManually:k,isPhoneCallActive:w?Boolean(e.phoneCall):void 0,addedSetIds:e.stickers.added.setIds,addedCustomEmojiIds:e.customEmojis.added.setIds,newContactUserId:g?.userId,newContactByPhoneNumber:g?.isByPhoneNumber,openedGame:l,gameTitle:P,isRatePhoneCallModalOpen:Boolean(f),botTrustRequest:a,botTrustRequestBot:a&&(0,C.mBe)(e,a.botId),requestedAttachBotInChat:o,isCurrentUserPremium:(0,C.g29)(e),isPremiumModalOpen:I?.isOpen,isGiveawayModalOpen:b?.isOpen,isDeleteMessageModalOpen:Boolean(v),isStarsGiftingPickerModal:y?.isOpen,limitReached:A?.limit,isPaymentModalOpen:S.isPaymentModalOpen,isReceiptModalOpen:Boolean(S.receipt),deleteFolderDialog:x,isMasterTab:w,requestedDraft:n,noRightColumnAnimation:U,isSynced:e.isSynced,isAccountFrozen:B,isAppConfigLoaded:e.isAppConfigLoaded,workspaces:e.workspaces.byOrder,chatsAreLoaded:e.chats.isFullyLoaded.active,chatFoldersAreLoaded:e.chatFolders.areLoaded}}))((({isMobile:e,isLeftColumnOpen:t,isMiddleColumnOpen:s,isRightColumnOpen:o,isMediaViewerOpen:n,isStoryViewerOpen:i,isForwardModalOpen:r,hasNotifications:c,hasDialogs:l,activeGroupCallId:u,safeLinkModalUrl:h,isHistoryCalendarOpen:p,shouldSkipHistoryAnimations:m,limitReached:g,openedStickerSetShortName:f,openedCustomEmojiSetIds:I,isServiceChatReady:b,withInterfaceAnimations:v,wasTimeFormatSetManually:y,addedSetIds:S,addedCustomEmojiIds:A,isPhoneCallActive:C,newContactUserId:M,newContactByPhoneNumber:k,openedGame:F,gameTitle:P,isRatePhoneCallModalOpen:T,botTrustRequest:U,botTrustRequestBot:x,requestedAttachBotInChat:B,requestedDraft:N,isPremiumModalOpen:R,isGiveawayModalOpen:J,isDeleteMessageModalOpen:E,isStarsGiftingPickerModal:Y,isPaymentModalOpen:D,isReceiptModalOpen:O,isReactionPickerOpen:G,isCurrentUserPremium:V,deleteFolderDialog:j,isMasterTab:q,noRightColumnAnimation:W,isSynced:z,currentUserId:K,isAccountFrozen:_,isAppConfigLoaded:H,workspaces:X,chatsAreLoaded:$,chatFoldersAreLoaded:Q})=>{const{initMain:Z,loadAnimatedEmojis:ee,loadBirthdayNumbersStickers:te,loadRestrictedEmojiStickers:se,loadNotificationSettings:ae,loadNotificationExceptions:oe,updateIsOnline:ne,onTabFocusChange:ie,loadTopInlineBots:re,loadEmojiKeywords:de,loadCountryList:ce,loadAvailableReactions:le,loadStickerSets:ue,loadPremiumGifts:he,loadStarGifts:pe,loadDefaultTopicIcons:me,loadAddedStickers:ge,loadFavoriteStickers:fe,loadDefaultStatusIcons:Ie,ensureTimeFormat:be,closeStickerSetModal:ve,closeCustomEmojiSets:ye,checkVersionNotification:we,loadConfig:Se,loadAppConfig:Ae,loadAttachBots:Ce,loadContactList:Me,loadCustomEmojis:ke,loadGenericEmojiEffects:Fe,closePaymentModal:Pe,clearReceipt:Te,checkAppVersion:Ue,openThread:xe,toggleLeftColumn:Be,loadRecentEmojiStatuses:Ne,loadUserCollectibleStatuses:Re,updatePageTitle:Je,loadTopReactions:Ee,loadRecentReactions:Ye,loadDefaultTagReactions:De,loadFeaturedEmojiStickers:Le,setIsElectronUpdateAvailable:Oe,loadAuthorizations:Ge,loadPeerColors:Ve,loadSavedReactionTags:je,loadTimezones:qe,loadQuickReplies:We,loadStarStatus:ze,loadAvailableEffects:Ke,loadTopBotApps:_e,loadPaidReactionPrivacy:He,loadPasswordInfo:Xe,loadBotFreezeAppeal:$e,loadAllChats:Qe,loadAllStories:Ze,loadChatFolders:et,loadAllHiddenStories:tt,createInitialWorkspace:st}=(0,w.ko)();a.Oig&&!Gd&&(Gd=!0,console.log(">>> RENDER MAIN"));const at=(0,es.A)();(0,Qt.A)((()=>{(0,Xt.po)(Xt.ar.Calls)}),5e3);const ot=(0,jt.li)(),it=(0,jt.li)(),{isDesktop:rt}=(0,L.Ay)();(0,jt.vJ)((()=>{t||s||rt?t&&s&&e&&Be():Be()}),[rt,t,s,e,Be]),(0,$t.A)(Ue,q?3e5:void 0,!0),(0,jt.vJ)((()=>{if(!d.cp)return;const e=window.electron.on(Wt.v.UPDATE_AVAILABLE,(()=>{Oe({isAvailable:!0})})),t=window.electron.on(Wt.v.UPDATE_ERROR,(()=>{Oe({isAvailable:!1}),e?.()}));return()=>{t?.(),e?.()}}),[]),(0,jt.vJ)((()=>{q&&z&&(ne({isOnline:!0}),Se(),Ae(),Ve(),Z(),Me(),Ue(),Ge(),Xe())}),[q,z]),(0,jt.vJ)((()=>{q&&z&&H&&!_&&(Qe({listType:"saved"}),Ze(),tt(),et(),Ye(),De(),Ce(),ae(),oe(),re(),Ee(),ze(),de({language:a.cUY}),Le(),je(),_e(),He(),me(),ee(),le(),Re(),Fe(),he(),pe(),Ke(),te(),se(),We(),qe())}),[q,z,H,_]),(0,jt.vJ)((()=>{q&&V&&H&&!_&&(Ie(),Ne())}),[V,q,H,_]),(0,jt.vJ)((()=>{q&&(at.code!==a.cUY&&de({language:at.code}),ce({langCode:at.code}))}),[at,q]),(0,jt.vJ)((()=>{q&&ke({ids:Object.keys((0,w.mS)().customEmojis.byId),ignoreCache:!0})}),[q]),(0,jt.vJ)((()=>{q&&z&&H&&!_&&(S&&A||(ue(),fe()),S&&A&&ge())}),[S,A,q,z,H,_]),(0,jt.vJ)((()=>{$e()}),[H]),(0,jt.vJ)((()=>{b&&q&&we()}),[b,q]),(0,jt.vJ)((()=>{y||be()}),[y]),(0,jt.vJ)((()=>{if(!z)return;Je();const e=(0,nt.f4)();e?.tgaddr&&(0,Ht._)(decodeURIComponent(e.tgaddr))}),[z]),(0,jt.vJ)((()=>window.electron?.on(Wt.v.DEEPLINK,(e=>{(0,Ht._)(decodeURIComponent(e))}))),[]),(0,jt.vJ)((()=>{const e=(0,nt.xV)(K);e&&xe({chatId:e.chatId,threadId:e.threadId,type:e.type})}),[K]),(0,jt.Nf)((()=>{const e=ot.current;1===e.parentNode.childElementCount&&(0,qt.YM)(e,"Transition_slide-active")}),[]),(0,ns.A)({ref:ot,isOpen:t,noCloseTransition:m,prefix:"left-column-"});const dt=(0,jt.li)(!1),ct=(0,Zt.A)();(0,jt.vJ)((()=>{0===X?.length&&Q&&$&&st()}),[Q,$,X]),(0,is.A)((([e])=>{if(void 0===e||t===e||!v)return;dt.current=!0,d.Ni&&(0,zt.Uz)((()=>{document.body.classList.toggle("android-left-blackout-open",!t)}));const s=(0,jt.VK)();(0,_t.j)(document.getElementById("MiddleColumn"),(()=>{s(),dt.current=!1,ct()}))}),[t,v,ct]),(0,ns.A)({ref:ot,isOpen:o,noCloseTransition:m,prefix:"right-column-"});const lt=(0,jt.li)(!1),[ut,ht]=(0,jt.J0)(o),pt=(0,cs.zk)();(0,is.A)((([e,t])=>{if(void 0===t||o===t)return;if(!e||W)return void ht(o);lt.current=!0;const s=(0,jt.VK)();(0,_t.j)(document.getElementById("RightColumn"),(()=>{s(),lt.current=!1,ct(),ht(o)}))}),[s,o,W,ct]);const mt=(0,Kt.A)(dt.current&&"left-column-animating",lt.current&&"right-column-animating",ut&&"narrow-message-list",m&&"history-animation-disabled",pt&&"is-fullscreen"),gt=(0,ts.A)((()=>{ie({isBlurred:!0})})),ft=(0,ts.A)((()=>{ie({isBlurred:!1}),document.title.includes(a.LaL)||Je(),bt(!1)})),It=(0,ts.A)((()=>{ve()})),vt=(0,ts.A)((()=>{ye()}));return(0,rs.A)(gt,ft,Boolean(d.cp)),(0,ds.A)(gt),function(e=!1){(0,jt.vJ)((()=>{if(d.TF){if(!e)return ss?.setAttribute("content",as),d.pz&&!d._7&&document.addEventListener("gesturestart",os),()=>{ss?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no"),d.pz&&!d._7&&document.removeEventListener("gesturestart",os)};ss?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover")}}),[e])}(n||i),(0,us.FD)("div",{id:"MainWrapper",children:[(0,us.Y)(Td,{}),(0,us.FD)("div",{ref:ot,id:"Main",className:mt,children:[(0,us.Y)(ya,{ref:it}),(0,us.Y)(pi,{leftColumnRef:it,isMobile:e}),(0,us.Y)(jr,{isMobile:e}),(0,us.Y)(wa,{isOpen:n}),(0,us.Y)(qr,{isOpen:i}),(0,us.Y)(ed,{isOpen:r}),(0,us.Y)(Zr,{requestedDraft:N}),(0,us.Y)(id,{isOpen:c}),(0,us.Y)(_r,{isOpen:l}),(0,us.Y)(Pn,{noUi:!0}),(0,us.Y)(Ii,{}),(0,us.Y)(ud,{url:h}),(0,us.Y)(od,{isOpen:p}),(0,us.Y)(bs,{isOpen:Boolean(f),onClose:It,stickerSetShortName:f}),(0,us.Y)(fs,{customEmojiSetIds:I,onClose:vt}),u&&(0,us.Y)(ps,{groupCallId:u}),(0,us.Y)(hs,{isActive:Boolean(u||C)}),(0,us.Y)(nd,{isOpen:Boolean(M||k),userId:M,isByPhoneNumber:k}),(0,us.Y)(ad,{openedGame:F,gameTitle:P}),(0,us.Y)(Qr,{}),(0,us.Y)(Nd,{}),d.J6&&(0,us.Y)(Od,{}),(0,us.Y)(Ed.A,{}),(0,us.Y)(ms,{isActive:C}),(0,us.Y)(Ss,{isForAppBadge:!0}),(0,us.Y)(gs,{isOpen:T}),(0,us.Y)(zr,{bot:x,type:U?.type,shouldRequestWriteAccess:U?.shouldRequestWriteAccess}),(0,us.Y)(Wr,{requestedAttachBotInChat:B}),(0,us.Y)(Ca,{}),(0,us.Y)(cd,{isOpen:R}),(0,us.Y)(dd,{isOpen:J}),(0,us.Y)(ld,{isOpen:Y}),(0,us.Y)(rd,{limit:g}),(0,us.Y)(bi,{isOpen:D,onClose:Pe}),(0,us.Y)(vi,{isOpen:O,onClose:Te}),(0,us.Y)(Kr,{folder:j}),(0,us.Y)(Sa,{isOpen:G}),(0,us.Y)(Is,{isOpen:E})]})]})})));var jd=s(15535);var qd=s(89704);const Wd=(0,jt.ph)((0,w.EK)((e=>({passcodeSettings:e.passcode})))((({isLocked:e,passcodeSettings:t})=>{const{unlockScreen:s,signOut:a,logInvalidUnlockAttempt:o,resetInvalidUnlockAttempts:n}=(0,w.ko)(),{invalidAttemptsCount:i,timeoutUntil:r,isLoading:d}=t,c=(0,Rs.A)(),[l,u]=(0,jt.J0)(""),[h,p]=(0,jt.J0)(!1),[m,g,f]=(0,Ta.A)(!1),{shouldRender:I}=(0,Js.A)(e);(0,Qt.A)(n,r?r-Date.now():void 0);const b=(0,jt.hb)((()=>{u("")}),[]),v=(0,jt.hb)((e=>{void 0===r?(u(""),(0,kt.UQ)(e).then(s,(e=>{e instanceof kt.Mv&&a({forceInitApi:!0}),o(),u(c("lng_passcode_wrong"))}))):u(c("FloodWait"))}),[c,r]);(0,jt.vJ)((()=>{void 0!==r?u(c("FloodWait")):0===i&&u("")}),[r,c,i]);const y=(0,jt.hb)((()=>{f(),a({forceInitApi:!0})}),[f,a]);if(I)return(0,us.FD)("div",{className:"bdKGCai4",children:[(0,us.FD)("div",{className:"BIi4Pl4Z",dir:c.isRtl?"rtl":void 0,children:[(0,us.Y)(Qo.A,{tgsUrl:$o.w.Lock,previewUrl:qd,size:160,className:"JwlsF2tF"}),(0,us.Y)(jd.A,{shouldShowSubmit:!0,shouldDisablePasswordManager:!0,isLoading:d,error:l,placeholder:c("Passcode.EnterPasscodePlaceholder"),submitLabel:c("Next"),clearError:b,isPasswordVisible:h,noRipple:!0,onChangePasswordVisibility:p,onSubmit:v},"password-form"),(0,us.FD)("div",{className:"VlXFyC_a",children:[(0,us.FD)("p",{children:[(0,us.Y)(wo.A,{onClick:g,children:"Log out"})," ","if you don't remember your passcode."]}),(0,us.Y)("p",{children:(0,us.Y)(Es.A,{color:"translucent",size:"tiny",isText:!0,onClick:g,children:c("AccountSettings.Logout")})})]})]}),(0,us.Y)(Dn.A,{isOpen:m,onClose:f,text:c("lng_sure_logout"),confirmLabel:c("AccountSettings.Logout"),confirmHandler:y,confirmIsDestructive:!0})]})})));a.Oig&&console.log(">>> FINISH LOAD MAIN BUNDLE")},99663:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(52674);function o(e){return(0,a.A)({onEnter:e})}}}]);
//# sourceMappingURL=7768.c8f64d3f4be2137f2716.js.map