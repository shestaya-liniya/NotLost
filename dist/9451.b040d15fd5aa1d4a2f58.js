"use strict";(self.webpackChunktelegram_t=self.webpackChunktelegram_t||[]).push([[9451],{1526:(e,t,i)=>{i.d(t,{A:()=>g});var s=i(84051),n=i(87357),a=i(17142),o=i(14242),r=i(4961),l=i(37661),c=i(39351),d=i(59030),h=i(18276),m=i(9267),u=i(64493);const p={options:"OnCj9kef",option:"tpTHQAUF",active:"U_9MXPG5",wideOption:"dJcJl33b",optionTop:"x9G4lqMf",stackedStars:"etXLebjM",stackedStar:"swttXv9P",optionBottom:"tK7La7L2",moreOptions:"AWXBaWLW",iconDown:"zWYHZJmd"};var v=i(20021);const g=(0,s.ph)((({isActive:e,className:t,options:i,selectedStarOption:g,selectedStarCount:A,starsNeeded:b,onClick:f})=>{const C=(0,d.A)(),y=(0,c.A)(),[S,w,k]=(0,l.A)();(0,s.vJ)((()=>{e||k()}),[e]);const[N,I]=(0,s.Kr)((()=>{if(!i)return[void 0,!1];const e=i.reduce(((e,t)=>e.stars>t.stars?e:t)),t=b&&e.stars<b,s=[];let n=0,a=!1;return i.forEach(((e,o)=>{e.isExtended||n++,b&&!t&&e.stars<b||(S||!e.isExtended?s.push({option:e,starsCount:Math.min(n,6),isWide:o===i.length-1}):a=!0)})),[s,a]}),[S,i,b]);return(0,v.FD)("div",{className:(0,n.A)(p.options,t),children:[N?.map((({option:e,starsCount:t,isWide:i})=>{const s=N?.length,l=s%2==0,c=e===g;let d;if(e&&"winners"in e){const t=e.winners.find((e=>e.users===A))||e.winners.reduce(((e,t)=>t.users>e.users?t:e),e.winners[0]);d=t?.perUserStars}return(0,v.FD)("div",{className:(0,n.A)(p.option,!l&&i&&p.wideOption,c&&p.active),onClick:()=>f?.(e),children:[(0,v.FD)("div",{className:p.optionTop,children:["+",(0,o.Sm)(e.stars),(0,v.Y)("div",{className:p.stackedStars,dir:y.isRtl?"ltr":"rtl",children:Array.from({length:t}).map((()=>(0,v.Y)(m.A,{className:p.stackedStar,type:"gold",size:"big"})))})]}),(0,v.Y)("div",{className:p.optionBottom,children:(0,a.v)(y,e.amount,e.currency)}),(c||g&&"winners"in g)&&Boolean(d)&&(0,v.Y)("div",{className:p.optionBottom,children:(0,v.Y)("div",{className:p.perUserStars,children:(0,r.A)(C("BoostGift.Stars.PerUser",(0,o.Sm)(d)))})})]},e.stars)})),!S&&I&&(0,v.FD)(u.A,{className:p.moreOptions,isText:!0,noForcedUpperCase:!0,onClick:w,children:[C("Stars.Purchase.ShowMore"),(0,v.Y)(h.A,{className:p.iconDown,name:"down"})]})]})}))},3178:(e,t,i)=>{i.d(t,{A:()=>p});var s=i(84051),n=i(31481),a=i(78376),o=i(14737),r=i(43874),l=i(37661),c=i(18104),d=i(20021);const h=[0,50],m=[0,20],u=[20,0],p=(0,s.ph)((({isPasswordVisible:e,isBig:t})=>{const[i,p]=(0,l.A)(!1),[v,g]=(0,l.A)(!1),{isMobile:A}=(0,r.Ay)(),b=A?n.UyP:n.H6l;(0,o.A)(g,2e3);const f=(0,s.hb)(p,[p]);return(0,d.FD)("div",{id:"monkey",className:t?"big":"",children:[!i&&(0,d.Y)("div",{className:"monkey-preview"}),(0,d.Y)(c.A,{size:t?n.r2x:b,className:v?"hidden":"shown",tgsUrl:a.w.MonkeyClose,playSegment:h,noLoop:!0,onLoad:f}),(0,d.Y)(c.A,{size:t?n.r2x:b,className:v?"shown":"hidden",tgsUrl:a.w.MonkeyPeek,playSegment:e?m:u,noLoop:!0})]})}))},5463:(e,t,i)=>{i.d(t,{A:()=>h});var s=i(84051),n=i(87357),a=i(18276),o=i(64493),r=i(22720),l=i(22337),c=i(32581);var d=i(20021);const h=(0,s.ph)((({isOpen:e,listItemData:t,headerIconName:i,header:s,footer:h,buttonText:m,hasBackdrop:u,withSeparator:p,onClose:v,onButtonClick:g,contentClassName:A})=>(0,d.FD)(l.A,{isOpen:e,className:(0,n.A)("LAh8evux",A),contentClassName:"hrizpMDe",hasAbsoluteCloseButton:!0,absoluteCloseButtonColor:u?"translucent-white":void 0,onClose:v,children:[i&&(0,d.Y)("div",{className:"jySLtQNG",children:(0,d.Y)(a.A,{name:i})}),s,(0,d.Y)("div",{children:t?.map((([e,t,i])=>(0,d.FD)(r.A,{isStatic:!0,multiline:!0,icon:e,iconClassName:"hQbEPsTU",children:[(0,d.Y)("span",{className:"title",children:t}),(0,d.Y)("span",{className:"subtitle",children:i})]})))}),p&&(0,d.Y)(c.A,{className:"En1zD2cT"}),h,m&&(0,d.Y)(o.A,{size:"smaller",onClick:g||v,children:m})]})))},15640:(e,t,i)=>{function s(e){return"touches"in e?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:e.clientX,y:e.clientY}}i.d(t,{A:()=>s})},34642:(e,t,i)=>{i.d(t,{A:()=>c});var s=i(84051),n=i(87357),a=i(59030),o=i(64493),r=i(22337);var l=i(20021);const c=(0,s.ph)((({confirmButtonText:e,isConfirmDisabled:t,shouldAdaptToSearch:i,withFixedHeight:s,onConfirm:c,withPremiumGradient:d,...h})=>{const m=(0,a.A)(),u=Boolean(e||c);return(0,l.FD)(r.A,{...h,isSlim:!0,className:(0,n.A)(i&&"WGSZ8u75",s&&"CrEsDylb",h.className),contentClassName:(0,n.A)("FuFYE0AA",h.contentClassName),headerClassName:(0,n.A)("iEptOmIp",h.headerClassName),children:[h.children,u&&(0,l.Y)("div",{className:"HqeDTaSr",children:(0,l.Y)(o.A,{withPremiumGradient:d,onClick:c||h.onClose,color:"primary",size:"smaller",disabled:t,children:e||m("Confirm")})})]})}))},61912:(e,t,i)=>{i.r(t),i.d(t,{AboutAdsModal:()=>kl,AboutMonetizationModal:()=>Il,ArchivedChats:()=>au,AttachBotInstallModal:()=>fa,AttachBotRecipientPicker:()=>sn,AttachmentModal:()=>hp,BoostModal:()=>il,BotCommandMenu:()=>Up,BotTrustModal:()=>ba,CalendarModal:()=>Cn,ChatCommandTooltip:()=>_p,ChatFolderModal:()=>ou,ChatInviteModal:()=>bl,ChatLanguageModal:()=>mc,ChatlistModal:()=>vl,CollectibleInfoModal:()=>gc,ContactList:()=>Tm,ContextMenuContainer:()=>cu.A,CountryPickerModal:()=>Lo,CreateTopic:()=>vg,CustomEmojiSetsModal:()=>uu,CustomEmojiTooltip:()=>Jp,CustomSendMenu:()=>jp,DeleteAccountModal:()=>ll,DeleteFolderDialog:()=>Ca,DeleteMessageModal:()=>Zl,Dialogs:()=>on,DraftRecipientPicker:()=>tn,DropArea:()=>zp.A,EditTopic:()=>Ag,EmojiInteractionAnimation:()=>hc,EmojiStatusAccessModal:()=>Ml,EmojiTooltip:()=>Zp,ForwardRecipientPicker:()=>en,FrozenAccountModal:()=>UA,GifSearch:()=>dv,GiftCodeModal:()=>ol,GiveawayModal:()=>rr,HeaderMenuContainer:()=>Au,HistoryCalendar:()=>yn,InlineBotTooltip:()=>av,InviteViaLinkModal:()=>xA,LeftSearch:()=>rd,LocationAccessModal:()=>Tl,Management:()=>Xg,MapModal:()=>mn,MediaViewer:()=>Bt,MentionTooltip:()=>ap,MessageSelectToolbar:()=>ic,MessageStatistics:()=>$v,MiddleSearch:()=>Pu,MinimizedWebAppModal:()=>xn,MuteChatModal:()=>lu,NewChat:()=>xm,NewContactModal:()=>wn,Notifications:()=>ln,OneTimeMediaModal:()=>VA,PaymentModal:()=>DA,PinMessageModal:()=>Xl,PollModal:()=>mp,PollResults:()=>sg,PremiumLimitReachedModal:()=>ur,PremiumMainModal:()=>Fo,PreparedMessageModal:()=>Ul,PrivacySettingsNoticeModal:()=>cc,ReactionPicker:()=>Lu,ReactorListModal:()=>dc,ReceiptModal:()=>BA,ReportAdModal:()=>Rl,ReportModal:()=>El,SafeLinkModal:()=>dn,SeenByModal:()=>sc,SendAsMenu:()=>ov,Settings:()=>Mm,SharePreparedMessageModal:()=>Jl,SponsoredContextMenuContainer:()=>Cl.A,Statistics:()=>_v,StatusPickerMenu:()=>$r,StickerSearch:()=>cv,StickerSetModal:()=>hu,StickerTooltip:()=>Op,StoryStatistics:()=>eg,StoryViewer:()=>Us,SuggestedStatusModal:()=>Qr,SymbolMenu:()=>xp,TextFormatter:()=>Wp,UnpinAllMessagesModal:()=>ec,UrlAuthModal:()=>pn,VerificationMonetizationModal:()=>Fl,WebAppModal:()=>Aa,WebAppsCloseConfirmationModal:()=>_A});var s=i(84051),n=i(13439),a=i(89925),o=i(31481),r=i(66644),l=i(90709),c=i(29807),d=i(53827),h=i(11778),m=i(14680),u=i(9716),p=i(76023),v=i(49086);function g(e){if(!e)return;if("standalone"===e.type)return{media:e.media[e.mediaIndex],isSingle:1===e.media.length};if("avatar"===e.type){const t=e.profilePhotos?.photos[e.mediaIndex];return t?{media:t}:void 0}const{action:t,document:i,photo:s,video:n,webPage:a,paidMedia:o}=(0,l.r_)(e.message);if("chatEditPhoto"===t?.type||"suggestProfilePhoto"===t?.type)return{media:t.photo,isSingle:!0};if(i&&((0,l.Ml)(i)||(0,l.hr)(i)))return{media:i};if(a){const{photo:e,video:t,document:i}=a,s=i&&((0,l.Ml)(i)||(0,l.hr)(i)),n=t||(s?i:void 0)||e;if(n)return{media:n,isSingle:!0}}if(o){const t=o.extendedMedia[e.mediaIndex||0];if(!("mediaType"in t)){const{photo:e,video:i}=t;return{media:e||i}}}const r=n||s;return r?{media:r,isSingle:n?.isGif}:void 0}var A=i(19822),b=i(96454),f=i(83868),C=i(16460),y=i(41512),S=i(43503);function w(e,t){const i=document.createElement("div");i.classList.add("ghost");const s=new Image;if(s.draggable=!1,s.oncontextmenu=f.A,"string"==typeof e?s.src=e:e instanceof HTMLVideoElement?s.src=e.poster:s.src=e.src,i.appendChild(s),t===a.TQ.ProfileAvatar||t===a.TQ.SettingsAvatar){i.classList.add("ProfileInfo"),t===a.TQ.SettingsAvatar&&i.classList.add("self");const e=document.querySelector(t===a.TQ.ProfileAvatar?"#RightColumn .ProfileInfo .info":"#Settings .ProfileInfo .info");e&&i.appendChild(e.cloneNode(!0))}return i}function k(e,t,i){let s,n;switch(e){case a.TQ.Album:case a.TQ.ScheduledAlbum:s=`.Transition_slide-active > .MessageList #album-media-${(0,l.GZ)(t.id,i)}`,n=".full-media";break;case a.TQ.PreviewMedia:s=`#preview-media${i}`,n="img";break;case a.TQ.SharedMedia:s=`#shared-media${(0,l.GZ)(t.id,i)}`,n="img";break;case a.TQ.SearchResult:s=`#search-media${(0,l.GZ)(t.id,i)}`,n="img";break;case a.TQ.MiddleHeaderAvatar:s=".MiddleHeader .Transition_slide-active .ChatInfo .Avatar",n=".avatar-media";break;case a.TQ.SettingsAvatar:s="#Settings .ProfileInfo .Transition_slide-active .ProfilePhoto",n=".avatar-media";break;case a.TQ.ProfileAvatar:s="#RightColumn .ProfileInfo .Transition_slide-active .ProfilePhoto",n=".avatar-media";break;case a.TQ.ChannelAvatar:case a.TQ.SuggestedAvatar:s=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,i)}`,n=".Avatar img";break;case a.TQ.StarsTransaction:s=".transaction-media-preview",n=0===i?`.stars-transaction-media-${i} :is(img, video)`:void 0;break;case a.TQ.SponsoredMessage:s=".Transition_slide-active > .MessageList .sponsored-media-preview",n=`${o.KFG} .full-media,${o.KFG} .thumbnail:not(.blurred-bg)`;break;case a.TQ.ScheduledInline:case a.TQ.Inline:default:s=`.Transition_slide-active > .MessageList #${(0,l.GZ)(t.id,i)}`,n=`${o.KFG} .full-media,${o.KFG} .thumbnail:not(.blurred-bg)`}const r=document.querySelector(s),c=n?r?.querySelectorAll(n):void 0;return{container:r,mediaEl:c?.[0]}}function N(e,t){switch(t){case a.TQ.Album:case a.TQ.ScheduledAlbum:case a.TQ.Inline:case a.TQ.ScheduledInline:case a.TQ.StarsTransaction:case a.TQ.PreviewMedia:case a.TQ.ChannelAvatar:e.classList.add("rounded-corners");break;case a.TQ.SharedMedia:case a.TQ.SettingsAvatar:case a.TQ.ProfileAvatar:case a.TQ.SearchResult:e.firstChild.style.objectFit="cover";break;case a.TQ.MiddleHeaderAvatar:case a.TQ.SuggestedAvatar:e.classList.add("circle"),t===a.TQ.SuggestedAvatar&&e.classList.add("transition-circle")}}var I=i(43874),P=i(77523),Y=i(37661),F=i(30857),D=i(17712),M=i(59030),T=i(41733),B=i(22237);const R=(0,B.n5)(!1),L=R[1];function x(e){if(e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode)return e.webkitSetPresentationMode.bind(e)}function E(){if(document.pictureInPictureElement)try{document.exitPictureInPicture()}catch(e){o.Oig&&console.log("[MV] PictureInPicture Error",e)}}var V=i(73767),_=i(34780),U=i(23174),O=i(32587),K=i(87679);const J=new Map;var G=i(35297);var j=i(62587),z=i(69419);const H=p.cf,$=({media:e,isAvatar:t,origin:i,delay:n})=>{const o=t&&"photo"===e?.mediaType&&!e.isVideo,r=t&&"photo"===e?.mediaType&&e.isVideo,c="document"===e?.mediaType,d="video"===e?.mediaType&&!e.isRound||c&&(0,l.hr)(e),h="photo"===e?.mediaType||c&&(0,l.Ml)(e),m="video"===e?.mediaType&&e.isGif,u=i===a.TQ.SharedMedia,v=i===a.TQ.SearchResult,g=(0,s.Kr)((()=>t=>{if(e)return!o&&!r||t?r&&t?(0,l.Pg)(e):(0,l.VO)(e,t?"full":"preview"):(0,l.mU)(e)}),[r,o,e]),A=(0,j.A)(e&&(u||v||c)&&(0,l.VO)(e,"pictogram"),void 0,U.qZ.BlobUrl,n),b=g(),f=(0,j.A)(b,void 0,U.qZ.BlobUrl,n),{mediaData:C,loadProgress:y}=(0,z.A)(g(!0),void 0,e&&(0,l.Cz)(e,"full"),n),S=e&&"blobUrl"in e?e.blobUrl:void 0;let w=!d&&(S||C)||f||A;const k=function(e){const t=(0,s.li)();let i=!1;(0,G.A)((()=>{if(i=!0,t.current=void 0,!e)return;const s=new Image;if(s.src=e,!s.width)return;const n=(0,K.PR)(s);(0,O.A)(n.getContext("2d"),0,0,n.width,n.height,2,2),t.current=n.toDataURL()}),[e]);const n=function(e,t=!1,i){const n=(0,s.li)(e?J.get(e):void 0),a=(0,s.li)(),o=(0,F.A)();return a.current&&t&&(clearTimeout(a.current),a.current=void 0),(0,s.vJ)((()=>{if(!e||n.current||t)return;const s=new Image;s.onload=()=>{const t=(0,K.PR)(s);(0,O.A)(t.getContext("2d"),0,0,t.width,t.height,2,2);const i=t.toDataURL();n.current=i,o(),J.size>=1e3&&J.clear(),J.set(e,i)},i?a.current=window.setTimeout((()=>{s.src=e}),i):s.src=e}),[e,i,o,t]),n.current}(e||void 0,Boolean(t.current));return t.current||!i&&n||e||void 0}(!w&&e&&(0,l.VD)(e));w||i===a.TQ.SearchResult||(w=k),r&&f&&(w=f);const N=S||C||(r||d?void 0:f||A||w),I=e&&(0,l.si)(e),P=Boolean(S),Y=(0,s.Kr)((()=>t?r?p._e:p.cf:c?e.mediaSize:h?(0,l.Xn)(e):d?(0,l.NZ)(e):H),[t,c,h,d,r,e]);return{getMediaHash:g,media:e,isVideo:d,isPhoto:h,isGif:m,isDocument:c,bestImageData:w,bestData:N,dimensions:Y,isFromSharedMedia:u,isVideoAvatar:r,isLocal:P,loadProgress:y,mediaSize:I}};var q=i(18276),W=i(64493),Q=i(40664),Z=i(22337),X=i(1087),ee=i(20021);const te=(0,s.ph)((({isOpen:e,peerId:t,photo:i,onClose:a,onCloseAnimationEnd:o})=>{const{reportProfilePhoto:r}=(0,n.ko)(),[l,c]=(0,s.J0)("spam"),[d,h]=(0,s.J0)(""),m=(0,D.A)((()=>{r({chatId:t,photo:i,reason:l,description:d}),a()})),u=(0,D.A)((e=>{c(e)})),p=(0,D.A)((e=>{h(e.target.value)})),v=(0,M.A)(),g=(0,s.Kr)((()=>[{value:"spam",label:v("lng_report_reason_spam")},{value:"violence",label:v("lng_report_reason_violence")},{value:"pornography",label:v("lng_report_reason_pornography")},{value:"childAbuse",label:v("lng_report_reason_child_abuse")},{value:"copyright",label:v("ReportPeer.ReasonCopyright")},{value:"illegalDrugs",label:"Illegal Drugs"},{value:"personalDetails",label:"Personal Details"},{value:"other",label:v("lng_report_reason_other")}]),[v]);if(!t||!i)return;const A=v("ReportPeer.Report");return(0,ee.FD)(Z.A,{isOpen:e,onClose:a,onEnter:e?m:void 0,onCloseAnimationEnd:o,className:"narrow",title:A,children:[(0,ee.Y)(X.A,{className:"dialog-checkbox-group",name:"report-message",options:g,onChange:u,selected:l}),(0,ee.Y)(Q.A,{label:v("lng_report_reason_description"),value:d,onChange:p}),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:m,children:v("lng_report_button")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:a,children:v("Cancel")})]})]})}));var ie=i(26607),se=i(41036);const[ne,ae]=(0,B.n5)(1);function oe(){return(0,s._W)((()=>{ae(1)})),[ne,ae]}const re=(0,s.ph)((({isOpen:e,photo:t,profileId:i,onClose:a,onConfirm:o})=>{const{deleteProfilePhoto:r,deleteChatPhoto:l}=(0,n.ko)(),c=(0,s.hb)((()=>{o?.(),(0,u.L8)(i)?r({photo:t}):l({photo:t,chatId:i}),a()}),[o,i,a,r,t,l]),d=(0,M.A)();return(0,ee.Y)(Z.A,{isOpen:e,onClose:a,onEnter:c,className:"delete dialog-buttons-column",title:d("AreYouSure"),children:(0,ee.FD)("div",{className:"dialog-buttons mt-2",children:[(0,ee.Y)(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:c,children:d("Preview.DeletePhoto")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:a,children:d("Cancel")})]})})}));var le=i(22699),ce=i(24433),de=i(35913);const he=(0,s.ph)((0,n.EK)(((e,{item:t,canUpdateMedia:i})=>{const s=(0,c.nTw)(e),{origin:n}=s.mediaViewer,a="message"===t?.type?t.message:void 0,o="avatar"===t?.type?t.avatarOwner:void 0,r="avatar"===t?.type&&t.profilePhotos.photos[t.mediaIndex],l=(0,c.meB)(e),d=(0,c.Xf0)(e),{threadId:h}=(0,c.Xf0)(e)||{},m=(0,c.ynf)(e,a),u=(0,c.yuw)(e),p=a&&(0,c.ryq)(e,a?.chatId),{canDelete:v}=h&&a&&(0,c.WAX)(e,a,h)||{},g=r&&r.id===o?.avatarPhotoId,A=i&&Boolean(r),b=v||A,f=i&&Boolean(r)&&!g,C=d?.type;return{activeDownloads:u,isProtected:m,chat:l,isChatProtected:p,canDelete:b,canUpdate:f,messageListType:C,origin:n}}))((({item:e,mediaData:t,isVideo:i,chat:a,isChatProtected:o,isProtected:r,canReportAvatar:c,canDelete:d,canUpdate:h,messageListType:m,activeDownloads:p,origin:v,onReportAvatar:A,onCloseMediaViewer:b,onBeforeDelete:f,onForward:C})=>{const[y,S,w]=(0,Y.A)(!1),[k,N]=oe(),{isMobile:P}=(0,I.Ay)(),{downloadMedia:F,cancelMediaDownload:T,updateProfilePhoto:B,updateChatPhoto:R,openMediaViewer:L,openDeleteMessageModal:x}=(0,n.ko)(),E="message"===e?.type,{media:V}=g(e)||{},_=V&&(0,l.sd)(V),U=V&&(0,l.$r)(p,V),{loadProgress:O}=(0,z.A)(V&&(0,l.VO)(V,"download"),!U,V&&(0,l.Cz)(V,"download")),K=(0,D.A)((()=>{if(V)if(U)T({media:V});else{const t="message"===e?.type?e.message:void 0;F({media:V,originMessage:t})}})),J=(0,D.A)((()=>{const e=k();N((e<0?e:0)-1)})),G=(0,D.A)((()=>{const e=k();N((e>0?e:0)+1)})),j=(0,D.A)((()=>{if("avatar"!==e?.type)return;const{avatarOwner:t,profilePhotos:i,mediaIndex:s}=e,n=i?.photos[s];(0,u.L8)(t.id)?B({photo:n}):R({chatId:t.id,photo:n}),L({origin:v,chatId:t.id,mediaIndex:0,isAvatarView:!0},{forceOnHeavyAnimation:!0})})),H=(0,M.A)(),$=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",className:t?"active":void 0,onClick:e,ariaLabel:"More actions",children:(0,ee.Y)(q.A,{name:"more"})})),[]);function Q(){return"avatar"===e?.type?(0,ee.Y)(re,{isOpen:y,onClose:w,onConfirm:f,profileId:e.avatarOwner.id,photo:e.profilePhotos.photos[e.mediaIndex]}):void 0}const Z=(0,D.A)((()=>{"message"===e?.type&&a?x({chatId:a?.id,messageIds:[e.message.id],isSchedule:"scheduled"===m,onConfirm:f}):S()}));if(P){const s=[];if(E&&e.message.isForwardingAllowed&&!e.message.content.action&&!o&&s.push({icon:"forward",onClick:C,children:H("Forward")}),r||(i?s.push({icon:U?"close":"download",onClick:K,children:U?`${Math.round(100*O)}% Downloading...`:"Download"}):s.push({icon:"download",href:t,download:_,children:H("AccActionDownload")})),c&&s.push({icon:"flag",onClick:A,children:H("ReportPeer.Report")}),h&&s.push({icon:"copy-media",onClick:j,children:H("ProfilePhoto.SetMainPhoto")}),d&&s.push({icon:"delete",onClick:Z,children:H("Delete"),destructive:!0}),0===s.length)return;return(0,ee.FD)("div",{className:"MediaViewerActions-mobile",children:[(0,ee.Y)(le.A,{trigger:$,positionX:"right",children:s.map((({icon:e,onClick:t,href:i,download:s,children:n,destructive:a})=>(0,ee.Y)(ce.A,{icon:e,href:i,download:s,onClick:t,destructive:a,children:n},e)))}),U&&(0,ee.Y)(de.A,{progress:O,size:"s",noCross:!0}),d&&Q()]})}return(0,ee.FD)("div",{className:"MediaViewerActions",children:[E&&e.message.isForwardingAllowed&&!o&&(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("Forward"),onClick:C,children:(0,ee.Y)(q.A,{name:"forward"})}),function(){if(!r&&"standalone"!==e?.type)return"sponsoredMessage"!==e?.type&&(i?(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("AccActionDownload"),onClick:K,children:U?(0,ee.Y)(de.A,{progress:O,size:"s",onClick:K}):(0,ee.Y)(q.A,{name:"download"})}):(0,ee.Y)(W.A,{href:t,download:_,round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("AccActionDownload"),children:(0,ee.Y)(q.A,{name:"download"})}))}(),(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("MediaZoomOut"),onClick:J,children:(0,ee.Y)(q.A,{name:"zoom-out"})}),(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("MediaZoomIn"),onClick:G,children:(0,ee.Y)(q.A,{name:"zoom-in"})}),c&&(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H(i?"PeerInfo.ReportProfileVideo":"PeerInfo.ReportProfilePhoto"),onClick:A,children:(0,ee.Y)(q.A,{name:"flag"})}),h&&(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("ProfilePhoto.SetMainPhoto"),onClick:j,children:(0,ee.Y)(q.A,{name:"copy-media"})}),d&&(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("Delete"),onClick:Z,children:(0,ee.Y)(q.A,{name:"delete"})}),(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent-white",ariaLabel:H("Close"),onClick:b,children:(0,ee.Y)(q.A,{name:"close"})}),d&&Q()]})})));var me=i(87357),ue=i(50442),pe=i(43336),ve=i(37836),ge=i(14737),Ae=i(16581),be=i(19129),fe=i(26072),Ce=i(15283);function ye(e){const t=(0,s.li)(e());return(0,Ce.A)((()=>e.subscribe((()=>{t.current=e()})))),t}var Se=i(90423),we=i(39751),ke=i(83414);const[Ne,Ie]=(0,B.n5)(!1),[Pe,Ye]=(0,B.n5)(!1);function Fe(){return[(0,ke.A)((()=>Ne()&&!Pe()),[Ne,Pe]),Ie,Ye]}var De=i(63495);const[Me,Te]=(0,B.n5)(0);function Be(){return(0,s._W)((()=>{Te(0)})),[Me,Te]}var Re=i(5718),Le=i(672),xe=i(57474);const Ee=({text:e="",buttonText:t,isForVideo:i,onClick:n,handleSponsoredClick:a,isProtected:o,isForceMobileVersion:r})=>{const[l,c]=(0,s.J0)(!1),{isMobile:d}=(0,I.Ay)(),[h]=Fe(),m=(0,be.A)((()=>!!b.TF&&!h()),[h]);(0,s.vJ)((()=>{const e=document.querySelector(".MediaViewerFooter .media-text"),t=()=>{const t=e?e.clientHeight:0;c(t>2*p.$)};t();const i=(0,ve.nF)(t,500,!0);return window.addEventListener("resize",i,!1),()=>{window.removeEventListener("resize",i,!1)}}),[]);const u=(0,D.A)((()=>{a()})),v=(0,me.A)("MediaViewerFooter",i&&"is-for-video",m&&"is-hidden",o&&"is-protected",r&&"mobile");return(0,ee.FD)("div",{className:v,onClick:function(t){e&&t.stopPropagation()},children:[Boolean(e)&&(0,ee.Y)("div",{className:"media-viewer-footer-content",onClick:d?void 0:n,children:(0,ee.Y)("p",{className:"media-text custom-scroll allow-selection "+(l?"multiline":""),dir:"auto",children:e})}),Boolean(t)&&(0,ee.Y)(W.A,{className:(0,me.A)("media-viewer-footer-content","media-viewer-button"),size:"default",color:"primary",isRectangular:!0,onClick:u,children:t})]})};var Ve=i(15640),_e=i(84313),Ue=i(71533),Oe=i(50680),Ke=i(73622);const[Je,Ge]=(0,B.n5)(!1);function je(){return(0,s._W)((()=>{Ge(!1)})),[Je,Ge]}var ze=i(17663),He=i(14242),$e=i(71429),qe=i(82497),We=i(41074),Qe=i(4875);const Ze=b.Ni||b.pz,Xe=b.Ni||b.pz?.3:.25,et=Ze?40:80,tt=200,it=(0,We.Ay)();let st;class nt{frames=new Map;currentTime=0;constructor(e,t){this.canvas=t,it.forEach((({connector:t},i)=>{t.request({name:"video-preview:init",args:[e,et,i,We.bP,this.onFrame.bind(this)]})}))}onFrame(e,t){this.frames.set(e,t),e===this.currentTime&&this.render(e)}clearCache(){this.frames.forEach((e=>{e.close()})),this.frames.clear()}render(e){this.currentTime=e;const t=this.frames.get(e);return!!t&&((0,r.RK)((()=>{this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,this.canvas.width,this.canvas.height)})),!0)}destroy(){this.clearCache(),it.forEach((({connector:e})=>{e.request({name:"video-preview:destroy",args:[]})}))}}it.forEach((({worker:e})=>{e.addEventListener("message",(async t=>{const{type:i,messageId:s,params:n}=t.data;if("requestPart"!==i)return;const a=await(0,Qe.px)("downloadMedia",{mediaFormat:U.qZ.Progressive,...n});if(!a)return;const{arrayBuffer:o}=a;e.postMessage({type:"partResponse",messageId:s,result:o},[o])}))}));var at=i(63988);const ot="Od9ZSc1U";let rt;const lt=(0,s.ph)((({duration:e,bufferedRanges:t,isReady:i,posterSize:n,playbackRate:a,url:o,isActive:r,isPlaying:l,isPreviewDisabled:c,onSeek:d,onSeekStart:h})=>{const m=(0,s.li)(),[u]=Be(),[p]=je(),v=(0,at.aG)(u,250),[g,f]=(0,s.Ul)(v()),[C,y]=(0,s.Ul)(0),[S,w]=(0,s.Ul)(0),k=(0,s.li)(!1),[N,I]=(0,s.J0)(!1),[P,Y]=(0,s.J0)(!1),F=(0,s.li)(),M=(0,s.li)(),T=(0,s.li)(),B=(0,s.li)(),R=(0,s.Kr)((()=>function(e,t){const i=(e=Math.round(e*Xe))/(t=Math.round(t*Xe));return e>tt&&(e=tt,t=Math.round(e/i)),t>tt&&(t=tt,e=Math.round(t*i)),{width:e,height:t}}(n?.width||0,n?.height||0)),[n]),L=(0,D.A)((e=>{e=Math.floor(e),w(e),function(e){st&&st.render(e)}(e)}));return(0,s.vJ)((()=>{if(!c&&o&&i)return function(e,t){return st&&st.destroy(),st=new nt(e,t),()=>{st?.destroy(),st=void 0}}(o,F.current)}),[o,i,c]),(0,s.vJ)((()=>{I(!1)}),[r]),(0,s.vJ)((()=>{if(rt&&rt(),rt=void 0,!k.current&&!P){const t=v(),i=e-t;rt=(0,A.Hd)({from:t,to:e,duration:1e3*i/a,onUpdate:f})}}),[v,P,f,a,e]),(0,s.vJ)((()=>{l&&!p()||(rt&&rt(),rt=void 0)}),[l,g,p]),(0,s.vJ)((()=>{if(l){rt&&rt(),rt=void 0;const t=v(),i=e-t;rt=(0,A.Hd)({from:t,to:e,duration:1e3*i/a,onUpdate:f})}}),[l,a,e]),(0,s.Nf)((()=>{if(!T.current)return;const t=(0,pe.LI)(g()/e*100,2);T.current.style.width=`${t}%`}),[g,e]),(0,s.Nf)((()=>{M.current&&(M.current.style.left=`${C()}px`)}),[C]),(0,s.Nf)((()=>{B.current&&(B.current.innerText=(0,ze.QO)(S()))}),[S]),(0,s.vJ)((()=>{if(!m.current||!r)return;const t=m.current;let i=t.getBoundingClientRect(),s=0,n=0;const a=s=>{const n=(0,Ve.A)(s).x,a=(0,pe.qE)(e*((n-i.left)/i.width),0,e);if(c)return[a,0];i.width||(i=t.getBoundingClientRect());const o=M.current;return[a,(0,pe.qE)(n-i.left-o.clientWidth/2,-4,i.width-o.clientWidth+4)]},o=()=>{rt&&rt(),rt=void 0},l=()=>{o(),k.current=!0,I(!1),Y(!1),f(s),d(s),setTimeout((()=>{k.current=!1}),250)},u=(0,ue.wJ)(t,{onCapture:()=>{o(),I(!0),Y(!0),h()},onRelease:l,onClick:l,onDrag:e=>{o(),I(!0),[s,n]=a(e),L(s),y(n),f(s)}});if(b.TF||c)return u;const p=e=>{I(!0),[s,n]=a(e),y(n),L(s)},v=()=>{I(!1)};return t.addEventListener("mousemove",p),t.addEventListener("mouseenter",p),t.addEventListener("mouseleave",v),()=>{u(),t.removeEventListener("mousemove",p),t.removeEventListener("mouseenter",p),t.removeEventListener("mouseleave",v)}}),[e,L,r,d,h,y,f,Y,c,a]),(0,ee.FD)("div",{className:"ingarEvU",ref:m,children:[!c&&(0,ee.FD)(ie.A,{isOpen:!0,isHidden:!N,className:"TqpEWfl3",style:`width: ${R.width}px; height: ${R.height}px`,ref:M,children:[(0,ee.Y)("canvas",{className:"fKVz2lln",ref:F}),(0,ee.Y)("div",{className:"bGiNvx5D",children:(0,ee.Y)("span",{className:"mnkqvOMR",ref:B})})]}),(0,ee.Y)("div",{className:ot,children:t.map((({start:e,end:t})=>(0,ee.Y)("div",{className:"ANe2DKfp",style:`left: ${100*e}%; right: ${100-100*t}%`},`${e}-${t}`)))}),(0,ee.Y)("div",{className:ot,children:(0,ee.Y)("div",{ref:T,className:(0,me.A)("igaGLblf",P&&"beUP6SqY")})})]})})),ct=e=>{e.stopPropagation()},dt=[.5,1,1.5,2];function ht(e,t){return(0,ee.Y)("div",{className:"player-time",children:`${(0,ze.QO)(e)} / ${(0,ze.QO)(t)}`})}const mt=(0,s.ph)((({url:e,bufferedRanges:t,bufferedProgress:i,duration:n,isReady:a,fileSize:o,isForceMobileVersion:r,isPlaying:l,isFullscreenSupported:c,isFullscreen:d,isBuffered:h,isPreviewDisabled:m,volume:u,isMuted:p,playbackRate:v,posterSize:g,onChangeFullscreen:A,onVolumeClick:f,onVolumeChange:C,onPlaybackRateChange:y,isPictureInPictureSupported:S,onPictureInPictureChange:w,onPlayPause:k,onSeek:N,onSeekingChange:P})=>{const[F,T,B]=(0,Y.A)(),[R]=Be(),L=(0,be.A)((()=>Math.trunc(R())),[R]),[x,E]=(0,s.Ul)(!1),V=(0,s.li)(),{isMobile:_}=(0,I.Ay)(),[U,O]=Fe(),K=(0,be.A)(U);(0,s.vJ)((()=>{if(b.TF||r){if(K&&l&&!F&&!x())return V.current=window.setTimeout((()=>{O(!1)}),3e3),()=>{V.current&&window.clearTimeout(V.current)};V.current&&window.clearTimeout(V.current)}}),[l,K,O,F,x,r]),(0,s.Nf)((()=>(K?document.body.classList.add("video-controls-visible"):document.body.classList.remove("video-controls-visible"),()=>{document.body.classList.remove("video-controls-visible")})),[K]),(0,s.vJ)((()=>{K||B()}),[B,K]);const J=(0,M.A)(),G=(0,D.A)((e=>{E(!1),N(e),P(!1)})),j=(0,D.A)((()=>{E(!0),P(!0)})),z=(0,s.Kr)((()=>0===u||p?"muted":u<.3?"volume-1":u<.6?"volume-2":"volume-3"),[u,p]);return(0,ee.FD)("div",{className:(0,me.A)("VideoPlayerControls",r&&"mobile",K&&"active"),onClick:ct,children:[(0,ee.Y)(lt,{url:e,duration:n,isReady:a,isPlaying:l,isPreviewDisabled:m,posterSize:g,bufferedRanges:t,playbackRate:v,onSeek:G,onSeekStart:j,isActive:K}),(0,ee.FD)("div",{className:"buttons",children:[(0,ee.Y)(W.A,{ariaLabel:J("AccActionPlay"),size:"tiny",ripple:!_,color:"translucent-white",className:"play",round:!0,onClick:k,children:(0,ee.Y)(q.A,{name:l?"pause":"play"})}),(0,ee.Y)(W.A,{ariaLabel:"Volume",size:"tiny",color:"translucent-white",className:"volume",round:!0,onClick:f,children:(0,ee.Y)(q.A,{name:z})}),!b.pz&&(0,ee.Y)(qe.A,{bold:!0,className:"volume-slider",value:p?0:100*u,onChange:C}),ht(L,n),!h&&(0,ee.Y)("div",{className:"player-file-size",children:`${(0,He.v7)(J,o*i)} / ${(0,He.v7)(J,o)}`}),(0,ee.Y)("div",{className:"spacer"}),(0,ee.Y)(W.A,{ariaLabel:"Playback rate",size:"tiny",color:"translucent-white",className:"playback-rate",round:!0,onClick:T,children:`${v}x`}),S&&(0,ee.Y)(W.A,{ariaLabel:"Picture in picture",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:w,children:(0,ee.Y)(q.A,{name:"pip"})}),c&&(0,ee.Y)(W.A,{ariaLabel:"Fullscreen",size:"tiny",color:"translucent-white",className:"fullscreen",round:!0,onClick:A,children:(0,ee.Y)(q.A,{name:d?"smallscreen":"fullscreen"})})]}),(0,ee.Y)($e.A,{isOpen:F,className:(0,me.A)("playback-rate-menu",!c&&"no-fullscreen",!S&&"no-pip"),positionX:"right",positionY:"bottom",autoClose:!0,onClose:B,children:dt.map((e=>(0,ee.Y)(ce.A,{disabled:v===e,onClick:()=>y(e),children:`${e}x`})))})]})})),ut=(0,s.ph)((({url:e,isGif:t,posterData:i,posterSize:a,loadProgress:r,fileSize:l,isMediaViewerOpen:c,noPlay:d,volume:h,isMuted:m,playbackRate:u,isForceMobileVersion:p,shouldCloseOnClick:v,isProtected:g,isClickDisabled:A,isPreviewDisabled:C,isSponsoredMessage:y,timestamp:S,handleSponsoredClick:w,onClose:k})=>{const{setMediaViewerVolume:N,setMediaViewerMuted:P,setMediaViewerPlaybackRate:Y,setMediaViewerHidden:F}=(0,n.ko)(),M=(0,s.li)(),[B,R]=(0,s.J0)(!b.TF||!b.pz),[V,_,U]=(0,Se.Ay)(M,R),{isMobile:O}=(0,I.Ay)(),K=M.current?.duration||0,J=t||K<=30,G=(0,D.A)((()=>{b.Nd||F({isHidden:!0})})),j=(0,D.A)((()=>{b.Nd||F({isHidden:!1})})),[z,H,$]=function(e,t,i){const[n,a]=(0,s.J0)(!1),[r,l]=(0,s.J0)(!1);(0,s.Nf)((()=>{if(b.pz&&b._7||!e.current)return;const s=e.current,n=x(s);if((!document.pictureInPictureEnabled||e.current?.disablePictureInPicture)&&void 0===n)return;s.autoPictureInPicture=!0,a(!0);const o=()=>{t(),l(!0),L(!0)},r=()=>{L(!1),l(!1),i()};return s.addEventListener("enterpictureinpicture",o),s.addEventListener("leavepictureinpicture",r),()=>{s.removeEventListener("enterpictureinpicture",o),s.removeEventListener("leavepictureinpicture",r)}}),[e,t,i]);const c=(0,s.hb)((()=>{if(!e.current)return;const t=x(e.current);t?t("inline"):E()}),[e]),d=(0,s.hb)((()=>{if(!e.current)return;c();const t=e.current,i=(0,T.e)(t),s=x(t);s?s("picture-in-picture"):function(e){if(e.requestPictureInPicture)try{e.requestPictureInPicture()}catch(e){o.Oig&&console.log("[MV] PictureInPicture Error",e)}}(t),i&&(0,T.A)(t)}),[e,c]);return n?[n,d,r]:[!1]}(M,G,j),[,Q,Z]=Fe(),[X,te]=(0,s.Ul)(!1),ie=(0,s.li)({x:0,y:0});(0,s.vJ)((()=>{const e=e=>{ie.current=(0,Ve.A)(e)};return window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e)}}),[]);const se=(0,D.A)(((e,t)=>{const i=M.current?.getBoundingClientRect();i&&(e<=i.left||e>=i.right||t<=i.top||t>=i.bottom)&&(X()||Q(!1))})),ne=(0,D.A)((()=>{Q(!0)})),ae=(0,D.A)((e=>{se(e.clientX,e.clientY)})),oe=(0,D.A)((e=>{if(te(e),!e){const{x:e,y:t}=ie.current;se(e,t)}})),{isReady:re,isBuffered:le,bufferedRanges:ce,bufferingHandlers:he,bufferedProgress:me}=(0,Ue.A)(),ue=(0,_e.A)(M,void 0,!e),{shouldRender:ve,transitionClassNames:ge}=(0,Oe.A)(!le&&!ue,void 0,void 0,"slow"),{shouldRender:Ae,transitionClassNames:be}=(0,Oe.A)(b.pz&&!B&&!ve&&!ue,void 0,void 0,"slow"),[,fe]=Be(),[,Ce]=je();(0,s.vJ)((()=>{Z(ve)}),[Z,ve]),(0,s.vJ)((()=>{d||!c||ue?M.current.pause():e&&!b.TF&&(0,T.A)(M.current)}),[d,c,e,P,ue]),(0,s.vJ)((()=>{M.current.volume=h}),[h]),(0,s.vJ)((()=>{M.current.playbackRate=u}),[u]),(0,s.vJ)((()=>{S&&(M.current.currentTime=S,fe(S))}),[fe,S]);const ye=(0,D.A)((e=>{e.stopPropagation(),B?(M.current.pause(),R(!1)):((0,T.A)(M.current),R(!0))})),we=(0,D.A)((e=>{y&&(w?.(!0),k(e)),A||(v?k(e):ye(e))}));(0,Ke.A)(M,he);const ke=(0,D.A)((e=>{const t=e.currentTarget;t.readyState>=4&&(Ce(!1),fe(t.currentTime)),J||t.currentTime!==t.duration||(fe(0),R(!1))})),Ne=(0,D.A)((()=>{J||(fe(0),R(!1),Q(!0))})),Ie=(0,D.A)((()=>{V&&U?U():!V&&_&&_()})),Pe=(0,D.A)((e=>{M.current.currentTime=e})),Ye=(0,D.A)((e=>{N({volume:e/100})})),De=(0,D.A)((()=>{M.current.muted=!M.current.muted,P({isMuted:!m})})),Me=(0,D.A)((e=>{Y({playbackRate:e})}));(0,s.vJ)((()=>{if(!c)return;const e=e=>{if(!V)return;const t=M.current,i=(0,pe.qE)(t.currentTime+5*e,0,t.duration);Number.isFinite(i)&&(t.currentTime=i)},t=t=>{if(!$)switch(t.key){case" ":case"Enter":t.preventDefault(),ye(t);break;case"Left":case"ArrowLeft":t.preventDefault(),e(-1);break;case"Right":case"ArrowRight":t.preventDefault(),e(1)}};return document.addEventListener("keydown",t,!1),()=>{document.removeEventListener("keydown",t,!1)}}),[ye,c,V,$]);const Te=a&&`width: ${a.width}px; height: ${a.height}px`,Re=`background-image: url(${i})`,Le=!b.TF&&!p;return(0,ee.FD)("div",{className:"VideoPlayer",onMouseMove:Le?ne:void 0,onMouseLeave:Le?ae:void 0,children:[(0,ee.FD)("div",{style:Te,children:[g&&(0,ee.Y)("div",{onContextMenu:f.A,onDoubleClick:b.TF?void 0:Ie,onClick:O?void 0:ye,className:"protector"}),(0,ee.Y)("video",{ref:M,autoPlay:b.TF,controlsList:"nodownload",playsInline:!0,loop:J,muted:t||m,id:"media-viewer-video",style:Re,onWaiting:()=>Ce(!0),onPlay:()=>R(!0),onEnded:Ne,onClick:O||V?void 0:we,onDoubleClick:b.TF?void 0:Ie,...he,onPause:e=>{R(!1),he.onPause(e)},onTimeUpdate:ke,src:e})]}),Ae&&(0,ee.Y)(W.A,{round:!0,className:`play-button ${be}`,onClick:ye,children:(0,ee.Y)(q.A,{name:"play"})}),ve&&(0,ee.FD)("div",{className:["spinner-container",ge].join(" "),children:[!le&&(0,ee.Y)("div",{className:"buffering",children:"Buffering..."}),(0,ee.Y)(de.A,{size:"xl",progress:le?1:r,onClick:k})]}),!t&&!y&&!ue&&(0,ee.Y)(mt,{url:e,isPlaying:B,bufferedRanges:ce,bufferedProgress:me,isBuffered:le,isFullscreenSupported:Boolean(_),isPictureInPictureSupported:z,isFullscreen:V,isPreviewDisabled:C,fileSize:l,duration:K,isReady:re,posterSize:a,isForceMobileVersion:p,onSeek:Pe,onChangeFullscreen:Ie,onPictureInPictureChange:H,onPlayPause:ye,volume:h,playbackRate:u,isMuted:m,onVolumeClick:De,onVolumeChange:Ye,onPlaybackRateChange:Me,onSeekingChange:oe})]})})),pt=(0,s.ph)((0,n.EK)(((e,{item:t})=>{const{volume:i,isMuted:s,playbackRate:n,isHidden:a,origin:o,timestamp:r,threadId:l}=(0,c.nTw)(e).mediaViewer,d="message"===t.type?t.message:void 0,h="sponsoredMessage"===t.type?t.message:void 0,m=d||h,u=d&&(0,c.meW)(e,d,!0);return{origin:o,textMessage:m,isProtected:d&&(0,c.ynf)(e,d),volume:i,isMuted:s,isHidden:a,playbackRate:n,threadId:l,timestamp:r,maxTimestamp:u}}))((({item:e,isActive:t,textMessage:i,origin:s,withAnimation:a,isProtected:r,volume:l,playbackRate:c,isMuted:d,isHidden:h,isMoving:m,threadId:u,timestamp:A,maxTimestamp:f,onClose:C,onFooterClick:y,handleSponsoredClick:S})=>{const{updateLastPlaybackTimestamp:w}=(0,n.ko)(),k=(0,M.A)(),N="avatar"===e.type,P="sponsoredMessage"===e.type,{media:Y}=g(e)||{},{isVideo:F,isPhoto:T,bestImageData:B,bestData:R,dimensions:L,isGif:x,isLocal:E,isVideoAvatar:V,mediaSize:_,loadProgress:U}=$({media:Y,isAvatar:N,origin:s,delay:!!a&&350}),[,O]=Fe(),[K]=Be(),J=Boolean(Y),{isMobile:G}=(0,I.Ay)(),j=(0,D.A)((()=>{O(!0)})),z=(0,Le.A)((()=>{if(!t||!i||"video"!==Y?.mediaType)return;if(Y.duration<o.u4b)return;const e="id"in i?i:void 0,s=K();if(!s||!e||e.isInAlbum)return;const n=Y.duration-s>1?s:void 0;w({chatId:e.chatId,messageId:e.id,timestamp:n})}),[K,t,Y,i],1e3);if((0,Re.R)(z,[K]),!Y)return;if("avatar"===e.type)return V?(0,ee.Y)("div",{className:"MediaViewerContent",children:(0,ee.Y)(ut,{url:R,isGif:!0,posterData:B,posterSize:(0,p.sk)(L,!1,!0),loadProgress:U,fileSize:_,isMediaViewerOpen:J&&t,isProtected:r,isPreviewDisabled:!De.G9||E,noPlay:!t,onClose:C,isMuted:!0,shouldCloseOnClick:!0,volume:0,isClickDisabled:m,playbackRate:1,isSponsoredMessage:P,handleSponsoredClick:S},Y.id)},Y.id):(0,ee.Y)("div",{className:"MediaViewerContent",children:vt(R,(0,p.sk)(L,!1),!G&&!r,r)},Y.id);const H=i&&("suggestProfilePhoto"===i.content.action?.type?k("Conversation.SuggestedPhotoTitle"):(0,v.V)({message:i,maxTimestamp:f,threadId:u,forcePlayback:!0,isForMediaViewer:!0})),q=i&&"buttonText"in i?i.buttonText:void 0,W=Boolean(H),Q=(0,p.sk)(L,W,F),Z=G||function(e){return!!e&&e.width<350}(Q);return(0,ee.FD)("div",{className:(0,me.A)("MediaViewerContent",W&&"has-footer"),onMouseMove:Z&&!b.TF?j:void 0,children:[T&&vt(R,Q,!G&&!r,r),F&&(t?(0,ee.Y)(ut,{url:R,isGif:x,posterData:B,posterSize:Q,loadProgress:U,fileSize:_,isMediaViewerOpen:J&&t,noPlay:!t,isPreviewDisabled:!De.G9||E,onClose:C,isMuted:d,isHidden:h,isForceMobileVersion:Z,isProtected:r,volume:l,isClickDisabled:m,playbackRate:c,isSponsoredMessage:P,handleSponsoredClick:S,timestamp:A},Y.id):gt(B,Q,!G&&!r,r)),H&&(0,ee.Y)(Ee,{text:H,buttonText:q,onClick:y,isProtected:r,isForceMobileVersion:Z,isForVideo:F&&!x,handleSponsoredClick:S})]})})));function vt(e,t,i,s){return e?(0,ee.FD)("div",{style:"position: relative;",children:[s&&(0,ee.Y)("div",{onContextMenu:f.A,className:"protector"}),(0,ee.Y)("img",{src:e,alt:"",className:(0,me.A)(s&&"is-protected"),style:t?`width: ${t.width}px`:"",draggable:Boolean(i)})]}):(0,ee.Y)("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:"",children:(0,ee.Y)(xe.A,{color:"white"})})}function gt(e,t,i,s){const n=t&&`width: ${t.width}px; height: ${t.height}px`,a=`background-image: url(${e})`;return e?(0,ee.FD)("div",{className:"VideoPlayer",children:[s&&(0,ee.Y)("div",{onContextMenu:f.A,className:"protector"}),(0,ee.Y)("div",{style:n,children:(0,ee.Y)("video",{style:a,className:(0,me.A)(s&&"is-protected"),draggable:Boolean(i)})})]}):(0,ee.Y)("div",{className:"spinner-wrapper",style:t?`width: ${t.width}px`:"",children:(0,ee.Y)(xe.A,{color:"white"})})}const{easeOutCubic:At,easeOutQuart:bt}=A.qM,ft=b.TF?40:0,Ct=350;let yt,St;var wt=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(wt||{});const kt=(0,s.ph)((({item:e,isVideo:t,isGif:i,isOpen:n,withAnimation:a,isHidden:o,isLoadingMoreMedia:r,isSynced:l,loadMoreItemsIfNeeded:c,getNextItem:d,selectItem:h,onClose:m,onFooterClick:u,handleSponsoredClick:p})=>{const v=(0,s.li)(),g=(0,s.li)(),f=(0,s.li)(),C=(0,s.li)(),y=(0,s.li)({x:0,y:0,scale:1}),S=(0,s.li)(void 0),w=(0,s.li)(void 0),k=(0,s.li)(!1),[N,I]=(0,s.J0)(!0),[P]=oe(),Y=(0,s.li)(P()),F=(0,Se.zk)(),[T,B]=(0,s.J0)(!1),[R,L]=(0,s.Ul)({x:0,y:0,scale:1}),x=ye(R),[E,V]=(0,s.Ul)(e),_=ye(E),U=(0,be.A)((()=>1!==R().scale),[R]),O=(0,be.A)(E),{height:K,width:J,isResizing:G}=(0,we.A)(),[j,z,H]=Fe(),$=(0,M.A)();(0,fe.A)({isActive:n,onBack:m,shouldBeReplaced:!0});const q=(0,Ae.A)(h,[h],350,!0),W=(0,Ae.A)((()=>{S.current=void 0}),[],500,!0),Q=(0,Ae.A)((e=>I(e)),[],800,!0),Z=Boolean(i&&!b.pz),X=b.TF?40:J/10,te=(0,D.A)((e=>{if(!b.TF)return;const t=K-e.pageY<80;!t&&e.pageX<X||!t&&e.pageX>J-X||z(!j())}));(0,ge.A)((()=>z(!0)),Ct),(0,s.vJ)((()=>{const{scale:t,x:i,y:s}=x.current;0===i&&0===s&&1===t&&V(e)}),[e,V,x]),(0,s.vJ)((()=>{l&&O&&!r&&c(O)}),[O,c,l,r]),(0,s.Nf)((()=>{const{x:e,y:t,scale:i}=R();H(1!==i),f.current&&(f.current.style.transform=Nt(-J+e-ft)),g.current&&(g.current.style.transform=Nt(e,t,i)),C.current&&(C.current.style.transform=Nt(J+e+ft))}),[R,H,J]),(0,s.vJ)((()=>{if(!v.current||void 0===_.current||o||F)return;let e=y.current;const t={x:0,y:0},i={x:0,y:0},s={x:0,y:0};let n,r=Date.now();const l=(0,ve.sg)((()=>{r=Date.now()}),500,!1,!0),c=t=>{const i=_.current;if(void 0===i)return!1;const s=d(i,t);if(void 0!==s){const i=(J+ft)*t,n=x.current.x+i;return I(!1),V(s),q(s),Q(!0),e={x:0,y:0,scale:1},a?(yt=(0,A.Hd)({from:n,to:0,duration:Ct,timing:At,onUpdate:e=>L({y:0,x:e,scale:1})}),!0):(L(e),!0)}return!1},h=e=>{const{scale:t}=x.current;if(1!==t)return[!1,!1];if(e.target.closest("div.VideoPlayerControls"))return[!1,!1];let i=0;return K-e.pageY<80?[!1,!1]:(e.pageX<X?i=-1:e.pageX>J-X&&(i=1),[0!==i,c(i)])},u=e=>{const{scale:t}=x.current;if(1===t)switch(e.key){case"Left":case"ArrowLeft":c(-1);break;case"Right":case"ArrowRight":c(1)}},p=({x:e,y:t,scale:i},s=0)=>{const n=w.current;if(!n)return[{x:e,y:t,scale:i},!0,!0];let a=!0,o=!0;const r=(J-J*i)/2,l=(K-K*i)/2,c=Math.max(-n.left*i,r),d=J-n.right*i;a=(0,pe.Bt)(e,d,c),e=(0,pe.qE)(e,d,c);const h=Math.max(-n.top*i+s,l),m=K-n.bottom*i;return o=(0,pe.Bt)(t,m,h),[{x:e,y:t=(0,pe.qE)(t,m,h),scale:i},a,o]},f=n=>{if(k.current)return void(k.current=!1);"mouseup"===n.type&&B(!1);const a=x.current,{y:o,scale:l}=a;let c=a.x;const h=Math.abs(c),u=Math.abs(o);if(W(),Q(!0),l<1)return e={x:0,y:0,scale:1},void(yt=(0,A.Hd)({from:[c,o,l],to:[0,0,1],duration:Ct,timing:At,onUpdate:e=>L({x:e[0],y:e[1],scale:e[2]})}));if(l>1){const a=Math.min(l,4),d=a/l;let h=c*d+(i.x-d*i.x),m=o*d+(i.y-d*i.y);const u=.15;if("wheel"!==n.type&&e.scale===l){const e=Math.abs(t.x)/(Date.now()-r),i=Math.abs(t.y)/(Date.now()-r);h-=Math.abs(t.x)*e*u*s.x,m-=Math.abs(t.y)*i*u*s.y}return[e]=p({x:h,y:m,scale:a},60),void(yt=(0,A.Hd)({from:[c,o,l],to:[e.x,e.y,e.scale],duration:Ct,timing:At,onUpdate:e=>L({x:e[0],y:e[1],scale:e[2]})}))}if(e={x:c,y:o,scale:l},u>=50)return void m();if(u>0)return void(yt=(0,A.Hd)({from:o,to:0,duration:Ct,timing:At,onUpdate:e=>L({x:0,y:e,scale:l})}));const v=c<0?1:-1,g=_.current,b=g&&d(g,c<0?1:-1),f=s.x<0?-1:1;void 0!==b&&h>=50&&v===f&&(c+=(J+ft)*v,V(b),q(b)),yt=(0,A.Hd)({from:c,to:0,duration:Ct,timing:At,onUpdate:e=>L({y:0,x:e,scale:l??1})})},C=(0,ue.wJ)(v.current,{isNotPassive:!0,withNativeDrag:!0,excludedClosestSelector:".MediaViewerFooter, .ZoomControls, .VideoPlayerControls",minZoom:1,maxZoom:4,doubleTapZoom:3,withWheelDrag:!0,onCapture:e=>{if(Pt(e))return;const{x:t,y:i,scale:s}=x.current;if("mousedown"!==e.type||(B(!0),1===s)){if(r=Date.now(),0===t&&0===i&&1===s){if(!g.current)return;if(n=g.current.querySelector("img, video"),!n)return;w.current=n.getBoundingClientRect()}}else e.preventDefault()},onDrag:(i,n,{dragOffsetX:a,dragOffsetY:o},r)=>{if(k.current||Pt(i))return;if(b.pz&&"touchstart"===n.type){const{pageX:e}=n.touches[0];if(e<=ue.h6||e>=J-ue.h6)return}yt&&(yt(),yt=void 0),s.x=t.x-a,s.y=t.y-o,t.x=a,t.y=o;const c=Math.abs(a),d=Math.abs(o),{x:h,y:m,scale:u}=x.current;if(l(),1===u){if("mousemove"!==i.type){if(S.current!==wt.Vertical&&(S.current===wt.Horizontal||Math.abs(h)>ue.no||c/d>ue.fG)){S.current=wt.Horizontal,I(!1);const e=J+ft,t=(0,pe.qE)(a,-e,e);return L({x:t,y:0,scale:u}),void("wheel"===i.type&&Math.abs(t)>100&&(f(i),k.current=!0))}if(S.current===wt.Vertical||Math.abs(m)>ue.no||d/c>ue.fG){S.current=wt.Vertical;const e=K,t=(0,pe.qE)(o,-e,e);L({x:0,y:t,scale:u}),"wheel"===i.type&&Math.abs(t)>100&&(f(i),k.current=!0)}}}else{const t=e.x+a,s=e.y+o;if(["wheel","mousemove"].includes(i.type)){const[e,i,n]=p({x:t,y:s,scale:u},60);return r&&r(!i,!n),void L(e)}"touches"in i&&1===i.touches.length&&L({x:t,y:s,scale:u})}},onZoom:(t,{zoom:s,zoomFactor:n,initialCenterX:a,initialCenterY:o,dragOffsetX:r,dragOffsetY:l,currentCenterX:c,currentCenterY:d})=>{yt&&yt(),a=a||J/2,o=o||K/2,c=c||J/2,d=d||K/2;const h=s??(0,pe.qE)(e.scale*n,.5,12),m=h/e.scale,u=Math.abs(Math.min(e.x,0)),v=Math.abs(Math.min(e.y,0));i.x=c,i.y=d;const g=u+a,A=v+o,b=g-m*g,f=A-m*A,[C]=p({x:e.x+b+r,y:e.y+f+l,scale:h});L(C)},onClick(t){B(!1);const[i,s]=h(t);if(i){if(t.preventDefault(),t.stopPropagation(),b.TF)return;s||m()}else 1!==e.scale||b.TF||!Z&&It(t.target,".VideoPlayer")||m()},onDoubleClick(t,{centerX:i,centerY:s}){const[n]=h(t);if(n)return t.preventDefault(),void t.stopPropagation();if(!b.TF&&"wheel"!==t.type)return;const{x:a,y:o,scale:r}=x.current;if(1===r){if(0!==a||0!==o)return;e=p({x:i-3*i,y:s-3*s,scale:3})[0]}else e={x:0,y:0,scale:1};yt=(0,A.Hd)({from:[a,o,r],to:[e.x,e.y,e.scale],duration:Ct,timing:At,onUpdate:e=>{const t={x:e[0],y:e[1],scale:e[2]};L(t)}})},onRelease:f});return document.addEventListener("keydown",u,!1),()=>{C(),document.removeEventListener("keydown",u,!1)}}),[_,W,X,d,F,o,m,q,V,Q,L,Z,x,K,J,a]),(0,s.vJ)((()=>{const e=P(),t=void 0!==Y.current&&Y.current!==e;if(!v.current||!t||o||F)return;Y.current=e;const{scale:i}=x.current,s=e>0?-1:1;let n=100,a=0;i<=.6&&s>0||i>=12&&s<0||(1===i&&s>0&&(n=20),St&&St(),St=(0,A.Hd)({from:s,to:s*n,duration:Ct,timing:bt,onUpdate:e=>{if(!v.current)return;const t=(0,pe.LI)(e-a,2);a=e;const i=new WheelEvent("wheel",{deltaY:t,ctrlKey:!0});v.current.dispatchEvent(i)}}))}),[P,o,F,x]);const[ie,se]=(0,s.Kr)((()=>void 0===O?[void 0,void 0]:[d(O,-1),d(O,1)]),[O,d]);if(void 0===O)return;const ne=void 0!==ie,ae=void 0!==se,re=T&&U;return(0,ee.FD)("div",{className:"MediaViewerSlides",ref:v,children:[(0,ee.Y)("div",{className:"MediaViewerSlide",ref:f,children:ne&&!U&&!G&&(0,ee.Y)(pt,{withAnimation:a,isMoving:re,item:ie,onClose:m,onFooterClick:u,handleSponsoredClick:p})}),(0,ee.Y)("div",{className:(0,me.A)("MediaViewerSlide","MediaViewerSlide--active",re&&"MediaViewerSlide--moving"),onClick:te,ref:g,children:(0,ee.Y)(pt,{item:O,withAnimation:a,isActive:N,isMoving:re,onClose:m,onFooterClick:u,handleSponsoredClick:p})}),(0,ee.Y)("div",{className:"MediaViewerSlide",ref:C,children:ae&&!U&&!G&&(0,ee.Y)(pt,{withAnimation:a,isMoving:re,item:se,onClose:m,onFooterClick:u,handleSponsoredClick:p})}),ne&&!U&&!b.TF&&(0,ee.Y)("button",{type:"button",className:`navigation prev ${t&&!i&&"inline"}`,"aria-label":$("AccDescrPrevious"),dir:$.isRtl?"rtl":void 0}),ae&&!U&&!b.TF&&(0,ee.Y)("button",{type:"button",className:`navigation next ${t&&!i&&"inline"}`,"aria-label":$("Next"),dir:$.isRtl?"rtl":void 0})]})}));function Nt(e=0,t=0,i=1){return`translate3d(${e.toFixed(3)}px, ${t.toFixed(3)}px, 0px) scale(${i.toFixed(3)})`}function It(e,t){return!!e&&(!!e.matches(t)||Boolean(e.closest(t)))}function Pt(e){const t=e.target;return!!It(t,".VideoPlayerControls")&&(It(t,".play, .fullscreen, .volume, .volume-slider, .playback-rate, .playback-rate-menu, .SeekLine")||e.preventDefault(),!0)}var Yt=i(70636),Ft=i(4961),Dt=i(21849);const Mt=(0,n.EK)(((e,{item:t})=>{const i="message"===t?.type?t.message:void 0,s=i&&(0,c.Y7C)(e,i);return{owner:"avatar"===t?.type?t.avatarOwner:s}}))((({owner:e,item:t})=>{const{closeMediaViewer:i,focusMessage:a,toggleChatInfo:o}=(0,n.ko)(),{isMobile:r}=(0,I.Ay)(),c=(0,D.A)((()=>{if(i(),"message"!==t?.type)return;const e=t.message;r?setTimeout((()=>{o({force:!1},{forceSyncOnIOs:!0}),a({chatId:e.chatId,messageId:e.id})}),350):a({chatId:e.chatId,messageId:e.id})})),d=(0,M.A)(),h=(0,s.Kr)((()=>{if(!t||"standalone"===t.type)return;const e="avatar"===t.type?t.avatarOwner:void 0,i="avatar"===t.type?t.profilePhotos:void 0,s=i?.photos[t.mediaIndex],n=s?.id===i?.fallbackPhoto?.id,a=s?.id===i?.personalPhoto?.id,o="message"===t.type?t.message.date:s?.date;if(!o)return;const r=(0,ze.fS)(d,1e3*o,!0),c=i?.count&&i.count+(i?.fallbackPhoto?1:0),h=t.mediaIndex+1+(i?.personalPhoto?-1:0),m=c&&d("Of",[h,c]),p=[];if(s){const t=(0,u.L8)(e.id)?void 0:e,i=t&&(0,l.WX)(t),s=t&&(0,l.YE)(t);p.push(d(a?"lng_mediaview_profile_photo_by_you":n?"lng_mediaview_profile_public_photo":i?"lng_mediaview_channel_photo":s?"lng_mediaview_group_photo":"lng_mediaview_profile_photo"))}return!m||a||n||p.push(m),p.push(r),p.join(" â€¢ ")}),[t,d]);if(!e)return;const m=(0,Yt.F9)(d,e);return(0,ee.FD)("div",{className:"SenderInfo",onClick:c,children:[(0,ee.Y)(Dt.A,{size:"medium",peer:e},e.id),(0,ee.FD)("div",{className:"meta",children:[(0,ee.Y)("div",{className:"title",dir:"auto",children:m&&(0,Ft.A)(m)}),(0,ee.Y)("div",{className:"date",dir:"auto",children:h})]})]})})),Tt=250,Bt=(0,s.ph)((0,n.EK)((e=>{const{mediaViewer:t,shouldSkipHistoryAnimations:i}=(0,c.nTw)(e),{chatId:s,threadId:n,messageId:o,origin:r,isHidden:d,withDynamicLoading:h,standaloneMedia:m,mediaIndex:p,isAvatarView:v,isSponsoredMessage:g}=t,A=(0,c.xYJ)(e,"mediaViewerAnimations"),{currentUserId:b,isSynced:f}=e,C=Boolean(s)&&(0,c.nZ4)(e,s);if(v){const t=(0,c.PVB)(e,s);let n=!1;t&&(n=(0,u.L8)(t.id)?t.id===b:(0,l.SJ)(t));const a=(0,c.IVq)(e,s);return{profilePhotos:a,avatar:a?.photos[p],avatarOwner:t,isLoadingMoreMedia:a?.isLoading,isChatWithSelf:C,canUpdateMedia:n,withAnimation:A,origin:r,shouldSkipHistoryAnimations:i,isHidden:d,standaloneMedia:m,mediaIndex:p,isSynced:f}}let y,S,w;s&&o&&(y=r&&[a.TQ.ScheduledAlbum,a.TQ.ScheduledInline].includes(r)?(0,c.Jl6)(e,s,o):(0,c.O5q)(e,s,o)),g&&s&&r===a.TQ.SponsoredMessage&&(S=(0,c.v8U)(e,s)),s&&(w=r&&[a.TQ.ScheduledAlbum,a.TQ.ScheduledInline].includes(r)?(0,c.yFI)(e,s):(0,c.zeq)(e,s));let k=!1;const N=r===a.TQ.Inline,I=r===a.TQ.Album;let P;if(s&&n&&o)if(h&&(N||I)){const t=(0,c.CuV)(e);k=Boolean(t?.isLoading);const{foundIds:i}=t?.currentSegment||{};P=i}else if(r===a.TQ.SharedMedia){const t=(0,c.BU_)(e),{foundIds:i}=t&&t.resultsByType&&t.resultsByType.media||{};P=i}else(N||I)&&(P=(0,c.Lzh)(e,s,n,o)||(0,c.gCU)(e,s,n));return{chatId:s,threadId:n,messageId:o,isChatWithSelf:C,origin:r,message:y,chatMessages:w,sponsoredMessage:S,collectedMessageIds:P,withAnimation:A,isHidden:d,shouldSkipHistoryAnimations:i,withDynamicLoading:h,standaloneMedia:m,mediaIndex:p,isLoadingMoreMedia:k,isSynced:f}}))((({chatId:e,threadId:t,messageId:i,message:c,collectedMessageIds:f,isChatWithSelf:T,canUpdateMedia:B,origin:L,avatar:x,avatarOwner:U,profilePhotos:O,chatMessages:K,sponsoredMessage:J,standaloneMedia:G,mediaIndex:j,withAnimation:z,isHidden:H,shouldSkipHistoryAnimations:Q,withDynamicLoading:Z,isLoadingMoreMedia:X,isSynced:ne})=>{const{openMediaViewer:ae,closeMediaViewer:oe,openForwardMenu:re,focusMessage:le,toggleChatInfo:ce,searchChatMediaMessages:de,loadMoreProfilePhotos:me,clickSponsored:ue,openUrl:pe}=(0,n.ko)(),ve=Boolean(U||c||G||J),{isMobile:ge}=(0,I.Ay)(),Ae=(0,s.li)(),be=c?.senderId||U?.id||c?.chatId,fe=(0,V.A)(be),Ce=z?"slideFade":"none",ye=Boolean(z&&!Q),[Se,we,ke]=(0,Y.A)(),Ne=function({message:e,avatarOwner:t,profilePhotos:i,standaloneMedia:s,mediaIndex:n,sponsoredMessage:a}){return t&&i?{type:"avatar",avatarOwner:t,profilePhotos:i,mediaIndex:n}:s?{type:"standalone",media:s,mediaIndex:n}:e?{type:"message",message:e,mediaIndex:n}:a?{type:"sponsoredMessage",message:a,mediaIndex:n}:void 0}({message:c,avatarOwner:U,standaloneMedia:G,profilePhotos:O,mediaIndex:j,sponsoredMessage:J}),{media:Ie,isSingle:Pe}=g(Ne)||{},{isVideo:Ye,isPhoto:Fe,bestImageData:De,bestData:Me,dimensions:Te,isGif:Be,isFromSharedMedia:Re}=$({media:Ie,isAvatar:Boolean(U),origin:L,delay:ye&&Tt}),Le=(()=>{if(T)return!1;if("avatar"!==Ne?.type||!U)return!1;const e=Ne.profilePhotos;return Ie!==e.personalPhoto})(),xe=!H&&ve,Ee=(0,s.Kr)((()=>Z?f:(0,l.Wm)(K||{},f||[],Re)),[K,f,Re,Z]);!ve||fe&&fe===be&&void 0!==Ae.current||(Ae.current=Pe?0:i||j);const[Ve]=R;(0,s.vJ)((()=>{if(!ve||Ve())return;(0,m.FD)();const e=(0,_.w4)();return()=>{e(),(0,m.wb)()}}),[ve,Ve]),(0,s.vJ)((()=>{xe&&E()}),[xe]),(0,s.vJ)((()=>{ge&&(0,r.RK)((()=>{document.body.classList.toggle("is-media-viewer-open",ve)}))}),[ge,ve]);const _e=(0,s.li)();(0,P.A)(_e);const Ue=(0,F.A)();(0,s.vJ)((()=>{const e=window.matchMedia(p.wy);return e.addEventListener("change",Ue),()=>{e.removeEventListener("change",Ue)}}),[Ue]);const Oe=(0,V.A)(c),Ke=(0,V.A)(H),Je=(0,V.A)(L),Ge=(0,V.A)(Ne),je=(0,V.A)(De),ze=c?(0,v.V)({message:c,forcePlayback:!0,isForMediaViewer:!0}):void 0,He=Boolean(ze),$e=Ke&&Ge!==Ne;(0,s.vJ)((()=>{ye&&ve&&($e||!Ge)&&((0,s.VK)(Tt+o.xB5),function(e,t,i,s,n,l,c){const{mediaEl:d}=k(t,l,c);if(!d)return;const{width:h}=S.A.get(),{width:m,height:u}=(0,p.$w)(e,n),{width:v,height:g}=(0,p.ky)(m,u,s.width,s.height),f=(h-v)/2,C=function(e){const t=window.matchMedia(p.wy);let i=4.125;return e&&!b.TF&&(i+=t.matches?.875:2.125),i*p.$}(e)+(u-g)/2;let{top:y,left:I,width:P,height:Y}=d.getBoundingClientRect();if([a.TQ.SharedMedia,a.TQ.Album,a.TQ.ScheduledAlbum,a.TQ.SearchResult].includes(t)){const e=function(e,t,i,s,n,a){if(e===t){const o=Math.max(n,a)*(e/t);s-=(o-n)/2,i-=(o-a)/2,n=o,a=o}else if(e>t){const i=n;s-=((n=a*(e/t))-i)/2}else if(t>e){const s=a;i-=((a=n*(t/e))-s)/2}return{top:i,left:s,width:n,height:a}}(v,g,y,I,P,Y);y=e.top,I=e.left,P=e.width,Y=e.height}const F=I+P/2-(f+v/2),D=y+Y/2-(C+g/2),M=P/v,T=Y/g;(0,r.RK)((()=>{const e=w(i||d);(0,A.ZM)(e,{top:`${C}px`,left:`${f}px`,width:`${v}px`,height:`${g}px`,transform:`translate3d(${F}px, ${D}px, 0) scale(${M}, ${T})`}),N(e,t),document.body.appendChild(e),document.body.classList.add("ghost-animating"),(0,r.RK)((()=>{e.style.transform="",function(e){e.firstChild.style.objectFit="default",e.classList.remove("rounded-corners","circle")}(e),setTimeout((()=>{(0,r.RK)((()=>{document.body.contains(e)&&document.body.removeChild(e),document.body.classList.remove("ghost-animating")}))}),200+o.xB5)}))}))}(He,L,De,Te,Ye,c,j)),ye&&!ve&&Ge&&((0,s.VK)(Tt+o.xB5),function(e,t,i,s){const{container:n,mediaEl:l}=k(e,i,s);if(!l)return;const c=document.getElementById("MediaViewer").querySelector(".MediaViewerSlide--active img, .MediaViewerSlide--active video");if(!c)return;const{top:d,left:h,width:m,height:u}=c.getBoundingClientRect(),{top:p,left:v,width:g,height:b}=l.getBoundingClientRect();let f=p;if(!(0,y.Y)(n)){const{height:e}=S.A.get();f=p<d?-b:e}const I=h+m/2-(v+g/2),P=d+u/2-(f+b/2);let Y=m/g,F=u/b;const D=[a.TQ.Inline,a.TQ.ScheduledInline,a.TQ.Album,a.TQ.ScheduledAlbum].includes(e)&&!function(e){const t=document.querySelector(".Transition_slide-active > .MessageList"),{top:i}=(0,C.A)(e,t);return i>t.scrollTop&&i+e.offsetHeight<t.scrollTop+t.offsetHeight}(l);[a.TQ.SharedMedia,a.TQ.Album,a.TQ.ScheduledAlbum,a.TQ.SearchResult].includes(e)&&(Y>F?Y=F:F>Y&&(F=Y));const M=document.getElementsByClassName("ghost")[0],T=M||w(t||l,e);let B;if(M){const{top:e,left:t,width:i,height:s}=M.getBoundingClientRect();B={transition:"none",top:`${f}px`,left:`${v}px`,transformOrigin:"top left",transform:`translate3d(${t-v}px, ${e-f}px, 0) scale(${i/g}, ${s/b})`,width:`${g}px`,height:`${b}px`}}else B={top:`${f}px`,left:`${v}px`,width:`${g}px`,height:`${b}px`,transform:`translate3d(${I}px, ${P}px, 0) scale(${Y}, ${F})`};(0,r.RK)((()=>{(0,A.ZM)(T,B),M||document.body.appendChild(T),document.body.classList.add("ghost-animating"),(0,r.RK)((()=>{M&&(M.style.transition=""),T.style.transform="",D&&(T.style.opacity="0"),N(T,e),setTimeout((()=>{(0,r.RK)((()=>{document.body.contains(T)&&document.body.removeChild(T),document.body.classList.remove("ghost-animating")}))}),200+o.xB5)}))}))}(Je,je,Oe,Ge?.mediaIndex))}),[De,Te,He,ye,ve,Ye,c,L,je,Ge,Oe,Je,$e,j]);const qe=(0,D.A)((()=>oe())),We=(0,D.A)((s=>{s.target instanceof HTMLElement&&s.target.closest("a")||(qe(),e&&i&&(ge?setTimeout((()=>{ce({force:!1},{forceSyncOnIOs:!0}),le({chatId:e,threadId:t,messageId:i})}),Tt):le({chatId:e,threadId:t,messageId:i})))})),Qe=(0,D.A)((t=>{J&&e&&(ue({isMedia:t,isFullscreen:!0,randomId:J.randomId}),pe({url:J.url}),oe())})),Ze=(0,D.A)((()=>{re({fromChatId:e,messageIds:[i]})}));(0,s.vJ)((()=>ve?(0,h.A)((()=>{qe()})):void 0),[qe,ve]),(0,s.vJ)((()=>{Ye&&!Be&&(0,d._K)()}),[Be,Ye]);const Xe=(0,D.A)((i=>{if(i&&!X){if("avatar"===i.type){if(!(i.mediaIndex>=i.profilePhotos.photos.length-4))return;me({peerId:i.avatarOwner.id})}"message"===i.type&&Z&&de({chatId:e,threadId:t,currentMediaMessageId:i.message.id})}})),et=(0,D.A)(((e,t)=>{if(0===t||Pe)return;if("standalone"===e.type){const{media:i,mediaIndex:s}=e,n=s+t;return n>=0&&n<i.length?{type:"standalone",media:i,mediaIndex:n}:void 0}if("avatar"===e.type){const{avatarOwner:i,profilePhotos:s,mediaIndex:n}=e,a=n+t;return a>=0&&s&&a<s.photos.length?{type:"avatar",avatarOwner:i,profilePhotos:s,mediaIndex:a}:void 0}if("sponsoredMessage"===e.type){const{message:i,mediaIndex:s}=e,n=s+t;return n>=0&&i?{type:"sponsoredMessage",message:i,mediaIndex:n}:void 0}const{message:i,mediaIndex:s}=e,n=(0,l.qG)(i);if(n){const e=s+t;if(e>=0&&e<n.extendedMedia.length)return{type:"message",message:i,mediaIndex:e}}const a=Ee?.indexOf(i.id);if(void 0===a)return;const o=Ee[a+t],r=K?.[o];return r?{type:"message",message:r}:void 0})),tt=(0,D.A)((e=>{if(!e)return void qe();const t="avatar"===e.type?e.avatarOwner.id:"message"===e.type?e.message.chatId:void 0,i="message"===e.type?e.message.id:void 0,s="standalone"===e.type?e.media:void 0;ae({origin:L,chatId:t,messageId:i,standaloneMedia:s,mediaIndex:e.mediaIndex,isAvatarView:"avatar"===e.type,withDynamicLoading:Z},{forceOnHeavyAnimation:!0})})),it=(0,D.A)((()=>{if((O?.photos.length||G?.length||Ee?.length||0)<=1||!Ne)return void qe();const e=et(Ne,-1);e?tt(e):"avatar"===Ne.type&&(0,u.L8)(Ne.avatarOwner.id)||"standalone"===Ne.type||qe()})),st=(0,M.A)();return(0,ee.FD)(ie.A,{id:"MediaViewer",isOpen:ve,isHidden:H,shouldAnimateFirstRender:!0,noCloseTransition:Q,children:[(0,ee.FD)("div",{className:"media-viewer-head",dir:st.isRtl?"rtl":void 0,ref:_e,children:[ge&&(0,ee.Y)(W.A,{className:"media-viewer-close",round:!0,size:"smaller",color:"translucent-white",ariaLabel:st("Close"),onClick:qe,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)(se.Ay,{activeKey:Ae.current,name:Ce,children:(0,ee.Y)(Mt,{item:Ne},Ie?.id)}),(0,ee.Y)(he,{mediaData:Me,isVideo:Ye,item:Ne,canUpdateMedia:B,canReportAvatar:Le,onBeforeDelete:it,onReportAvatar:we,onCloseMediaViewer:qe,onForward:Ze}),(0,ee.Y)(te,{isOpen:Se,onClose:ke,photo:x,peerId:U?.id})]}),(0,ee.Y)(kt,{item:Ne,loadMoreItemsIfNeeded:Xe,isLoadingMoreMedia:X,isSynced:ne,getNextItem:et,chatId:e,isPhoto:Fe,isGif:Be,threadId:t,avatarOwnerId:U?.id,origin:L,isOpen:ve,hasFooter:He,isVideo:Ye,withAnimation:z,onClose:qe,selectItem:tt,isHidden:H,onFooterClick:We,handleSponsoredClick:Qe})]})}))),Rt="CdTfL4f7",Lt="kW0xpExG",xt="W9A8SEMl",Et="gLHHo5k8",Vt="GJVwqV9e",_t="_Yn4SWUB",Ut="hGCH03qc",Ot="ZecqXqKy",Kt="PVZ8TOWS",Jt="Wi0DXPH2",Gt="Ka1CGfzq",jt="urTtSsk9",zt="AjXOHOgE",Ht="uAlXNXJN",$t="g8ypsnnC",qt="hGTnZuar",Wt="TkphaPyQ",Qt="CvnxnCxN",Zt="nZ30pf4g",Xt="MnNC7VHS",ei="G8OgmMDJ",ti=3.5*p.$,ii=.5*p.$;function si(e,t=!1,i=!1){const s=document.createElement("div");s.classList.add(i?"TYicp2_K":"fME2l_yv");const n=new Image;if(n.draggable=!1,n.oncontextmenu=f.A,n.classList.add("HjoURJRK"),t){const t=document.createElement("canvas");t.classList.add(Xt),n.onload=()=>{const e=t.getContext("2d",{alpha:!1}),{width:i,height:s}=n;(0,r.RK)((()=>{t.width=i,t.height=s,b.QH&&(e.filter="blur(2px)"),e.drawImage(n,-4,-4,i+8,s+8),b.QH||(0,O.A)(e,0,0,i,s,2,2)}))},n.src=e,s.appendChild(t)}else n.src=e,s.appendChild(n);return s}function ni(e,t){let i;const s=`#${(0,l.kR)(t)}`;switch(e){case a.G9.StoryRibbon:i=`#LeftColumn .${Rt}`;break;case a.G9.MiddleHeaderAvatar:i=".MiddleHeader .Transition_slide-active .ChatInfo";break;case a.G9.ChatList:i="#LeftColumn .chat-list";break;case a.G9.SearchResult:i="#LeftColumn .LeftSearch--container"}const n=document.querySelector(i),o=n&&n.querySelectorAll(`${s} img`);return{container:n,mediaEl:o?.[0]}}function ai({scale:e,slideAmount:t,isActiveSlideSize:i,isMoveThroughActiveSlide:s,isBackward:n}){const a=40+(i?405:135),o=(Math.abs(t)-1)*(40+(s?405:135)),r=(0,pe.Ki)((a+o)*e);return n?-r:r}function oi(){const{width:e,height:t}=(0,we.A)();return(0,s.Kr)((()=>function(e,t){const i=function(e,t,i,s){const n=i/1200,a=s/800;return Math.min(n,a)}(0,0,e,t),s=(0,pe.Ki)(405*i),n=(0,pe.Ki)(135*i);return{activeSlide:{width:s,height:(0,pe.Ki)(720*i)},slide:{width:n,height:(0,pe.Ki)(240*i)},scale:i,toActiveScale:s/n,fromActiveScale:n/s}}(e,t)),[e,t])}function ri(e,t=!1,i=!1){const s=e&&"content"in e,n=e&&"isDeleted"in e,a=!!s&&(0,l.XR)(e),o=s&&Boolean(e.forwardInfo);let r;s&&(e.content.photo?.thumbnail&&(r=e.content.photo.thumbnail.dataUri),e.content.video?.thumbnail?.dataUri&&(r=e.content.video.thumbnail.dataUri));const c=s?(0,l.EN)(e):void 0,d=(0,j.A)(c),h=Boolean(s&&e.content.video),m=s&&e.content.video?.noSound,u=s?(0,l.EN)(e,"full"):void 0,p=(0,j.A)(u,!e,h?U.qZ.Progressive:U.qZ.BlobUrl),v=h&&s?(0,l.EN)(e,"full",!0):void 0,g=(0,j.A)(v,!e,U.qZ.Progressive),A=Boolean(p||g),b=h?d:p||d,f=!d&&!A,C=t&&s&&!e.noForwards,y=s?(0,l.EN)(e,"download"):void 0;return{isLoadedStory:s,isDeletedStory:n,hasText:a,hasForwardInfo:o,thumbnail:r,previewHash:c,previewBlobUrl:d,isVideo:h,noSound:m,fullMediaHash:u,fullMediaData:p,altMediaHash:v,altMediaData:g,hasFullData:A,bestImageData:b,hasThumb:f,canDownload:C,downloadMediaData:(0,j.A)(y,!C&&!i)}}var li=i(80140),ci=i(22720),di=i(61361);const hi="RGD70uBt",mi="HCYfPccW",ui="L8oRQyKb",pi=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e);return{isOpen:t.storyViewer?.isStealthModalOpen,stealthMode:e.stories.stealthMode,isCurrentUserPremium:(0,c.g29)(e)}}))((({isOpen:e,stealthMode:t,isCurrentUserPremium:i})=>{const{toggleStealthModal:a,activateStealthMode:o,showNotification:r,openPremiumModal:l}=(0,n.ko)(),[c,d]=(0,s.J0)(!1);(0,s.vJ)((()=>{if(!t)return;const e=(0,li.Fm)();t.cooldownUntil&&t.cooldownUntil>e&&d(!0)}),[t,e]);const h=(0,M.A)(),m=(0,D.A)((()=>{d(!1)})),u=(0,D.A)((()=>{a({isOpen:!1})})),p=(0,D.A)((()=>{i?(o(),r({title:h("StealthModeOn"),message:h("StealthModeOnHint")}),a({isOpen:!1})):l({initialSection:"stories"})}));return(0,ee.FD)(Z.A,{className:"component-theme-dark",contentClassName:"GrE47IXS",isOpen:e,isSlim:!0,onClose:u,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",className:"NlWSF1pA",ariaLabel:h("Close"),onClick:u,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:"qKi5jsGM",children:(0,ee.Y)(q.A,{name:"eye-crossed-outline"})}),(0,ee.Y)("div",{className:"BFctFGoT",children:h("StealthMode")}),(0,ee.Y)("div",{className:"fZIJH4IG",children:h(i?"StealthModeHint":"StealthModePremiumHint")}),(0,ee.FD)(ci.A,{className:(0,me.A)(hi,"smaller-icon"),multiline:!0,inactive:!0,leftElement:(0,ee.Y)(q.A,{name:"stealth-past",className:mi}),children:[(0,ee.Y)("span",{className:"title",children:h("HideRecentViews")}),(0,ee.Y)("span",{className:(0,me.A)("subtitle",ui),children:h("HideRecentViewsDescription")})]}),(0,ee.FD)(ci.A,{className:(0,me.A)(hi,"smaller-icon"),multiline:!0,inactive:!0,leftElement:(0,ee.Y)(q.A,{name:"stealth-future",className:mi,"aria-hidden":!0}),children:[(0,ee.Y)("span",{className:"title",children:h("HideNextViews")}),(0,ee.Y)("span",{className:(0,me.A)("subtitle",ui),children:h("HideNextViewsDescription")})]}),(0,ee.Y)(W.A,{className:"AM_sxoXP",size:"smaller",disabled:c,isShiny:!i,withPremiumGradient:!i,onClick:p,children:i?c?(0,ee.Y)(di.A,{langKey:"AvailableIn",endsAt:t.cooldownUntil,onEnd:m}):h("EnableStealthMode"):h("UnlockStealthMode")})]})})));var vi=i(94189);const gi=(0,s.ph)((function({isOpen:e,story:t,onClose:i}){const{deleteStory:a,openNextStory:o}=(0,n.ko)(),r=(0,M.A)(),l=(0,s.hb)((()=>{t&&(o(),a({peerId:t.peerId,storyId:t.id}),i())}),[i,t]);return(0,ee.Y)(vi.A,{isOpen:e,onClose:i,title:r("DeleteStoryTitle"),text:r("DeleteStorySubtitle"),confirmLabel:r("Delete"),confirmHandler:l,confirmIsDestructive:!0,className:"component-theme-dark"})}));var Ai=i(21309),bi=i(63152),fi=i(87894),Ci=i(79824),yi=i(54960);const Si=(0,s.ph)((function({id:e,contactListIds:t,currentUserId:i,selectedIds:n,lockedIds:a,onSelect:o}){const r=(0,M.A)(),[l,c]=(0,s.J0)(""),d=(0,s.Kr)((()=>{const e=(t||[]).filter((e=>e!==i));return(0,fi.Am)((0,Yt.PU)({ids:[...n||[],...e],query:l,type:"user"}))}),[t,i,l,n]);return(0,ee.Y)(yi.A,{itemIds:d,selectedIds:n??Ci.p,lockedSelectedIds:a,filterValue:l,filterPlaceholder:r("Search"),searchInputId:`${e}-picker-search`,isSearchable:!0,withDefaultPadding:!0,forceShowSelf:!0,onSelectedIdsChange:o,onFilterChange:c,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"},e)}));var wi=i(82117),ki=i(12933);const Ni=(0,s.ph)((function({isActive:e,contactListIds:t,usersById:i,currentUserId:a,onClose:o}){const{saveCloseFriends:r}=(0,n.ko)(),l=(0,M.A)(),[c,d]=(0,s.J0)(""),[h,m]=(0,s.J0)(!1),[u,p]=(0,s.J0)([]),v=(0,s.Kr)((()=>(t||[]).filter((e=>i[e]?.isCloseFriend))),[t,i]),g=(0,s.Kr)((()=>{const e=(t||[]).filter((e=>e!==a));return(0,fi.Am)((0,Yt.PU)({ids:[...v,...e],query:c,type:"user"}))}),[v,t,a,c]);(0,wi.A)((([t])=>{!t&&e&&(m(!1),p(v))}),[e,v]);const A=(0,s.hb)((e=>{p(e),m(!0)}),[]),b=(0,D.A)((()=>{r({userIds:u}),o()}));return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(yi.A,{itemIds:g||[],selectedIds:u,filterValue:c,filterPlaceholder:l("Search"),searchInputId:"close-friends-picker-search",isSearchable:!0,withDefaultPadding:!0,onSelectedIdsChange:A,onFilterChange:d,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,ee.Y)("div",{className:(0,me.A)("BDK_pgpt",h&&"N8ujSwlC"),children:(0,ee.Y)(ki.A,{isShown:h,onClick:b,ariaLabel:l("Save"),children:(0,ee.Y)(q.A,{name:"check"})})})]})})),Ii={modal:"hz7SomkK",header:"NV6Rt2g9",closeButton:"SN1GFS6L",headerTitle:"gi0Y6Ns6",content:"sTaVDkiD",section:"eUiuPoEC",title:"iPPiw9DI",list:"OUP1Ss0W",option:"JL33Sa3b",checked:"qVPo_cVL",input:"zsDaUk0i",icon:"AfYCVlys",action:"njMeBBwY",optionContent:"TUAAnG2w",footer:"r24Qz2bf",info:"ljeRVBOm",submit:"RwNLN_rH"},Pi=[{name:"StoryPrivacyOptionEveryone",value:"everybody",color:["#50ABFF","#007AFF"],icon:"channel-filled",actions:"blockUserIds"},{name:"StoryPrivacyOptionContacts",value:"contacts",color:["#C36EFF","#8B60FA"],icon:"user-filled",actions:"blockContactUserIds"},{name:"StoryPrivacyOptionCloseFriends",value:"closeFriends",color:["#88D93A","#30B73B"],icon:"favorite-filled",actions:"closeFriends"},{name:"StoryPrivacyOptionSelectedContacts",value:"nobody",color:["#FFB743","#F69A36"],icon:"group-filled",actions:"allowUserIds"}];var Yi=function(e){return e[e.privacy=0]="privacy",e[e.allowList=1]="allowList",e[e.closeFriends=2]="closeFriends",e[e.denyList=3]="denyList",e}(Yi||{});const Fi=(0,s.ph)((0,n.EK)((e=>{const{storyViewer:{storyId:t,peerId:i}}=(0,c.nTw)(e),s=i&&t?(0,c.Msb)(e,i,t):void 0;return{story:s&&"content"in s?s:void 0,visibility:s&&"visibility"in s?s.visibility:void 0,contactListIds:e.contactList?.userIds,usersById:e.users.byId,currentUserId:e.currentUserId}}))((function({isOpen:e,story:t,visibility:i,contactListIds:a,usersById:o,currentUserId:r,onClose:c}){const{editStoryPrivacy:d,toggleStoryInProfile:h}=(0,n.ko)(),m=(0,M.A)(),[u,p,v]=(0,Y.A)(!1),[g,A]=(0,s.J0)(i),[b,C]=(0,s.J0)(t?.isInProfile),[y,S]=(0,s.J0)(Yi.privacy),[w,k]=(0,s.J0)("everybody"),N=y!==Yi.privacy,I=(0,s.Kr)((()=>(a||[]).filter((e=>o[e]?.isCloseFriend))),[a,o]),P=(0,s.Kr)((()=>{if(y===Yi.allowList&&(!g?.allowUserIds?.length||g.allowUserIds[0]===r))return[r]}),[y,r,g?.allowUserIds]),F=(0,s.Kr)((()=>w!==g?.visibility?[]:g?.blockUserIds||[]),[w,g?.blockUserIds,g?.visibility]),T=(0,D.A)((e=>{A({...g,allowUserIds:e?.length?e?.filter((e=>e!==r)):[r]})})),B=(0,D.A)((e=>{A({...g,blockUserIds:e,visibility:w})}));(0,s.vJ)((()=>{e&&(S(Yi.privacy),p())}),[e]),(0,s.vJ)((()=>{A(i)}),[i]);const R=(0,D.A)((()=>{y!==Yi.privacy?S(Yi.privacy):v()})),L=(0,D.A)((()=>{C(!b)})),x=(0,D.A)((()=>{d({peerId:t.peerId,storyId:t.id,privacy:g}),t.isInProfile!==b&&h({peerId:t.peerId,storyId:t.id,isInProfile:b}),v()}));return(0,ee.FD)(Z.A,{isOpen:u,className:(0,me.A)(Ii.modal,"component-theme-dark"),onClose:v,noBackdrop:!0,onCloseAnimationEnd:c,children:[(0,ee.FD)("div",{className:Ii.header,children:[(0,ee.Y)(W.A,{className:(0,me.A)(Ii.closeButton,"close-button"),round:!0,color:"translucent",size:"smaller",onClick:R,ariaLabel:m(N?"Common.Back":"Common.Close"),children:(0,ee.Y)("div",{className:(0,me.A)("animated-close-icon",N&&"state-back")})}),(0,ee.Y)(se.Ay,{name:"slideFade",activeKey:y,children:function(){switch(y){case Yi.privacy:return(0,ee.Y)("h3",{className:Ii.headerTitle,children:m("StoryPrivacyAlertEditTitle")});case Yi.allowList:return(0,ee.Y)("h3",{className:Ii.headerTitle,children:m("StoryPrivacyAlertSelectContactsTitle")});case Yi.closeFriends:return(0,ee.Y)("h3",{className:Ii.headerTitle,children:m("CloseFriends")});case Yi.denyList:return(0,ee.Y)("h3",{className:Ii.headerTitle,children:m("StoryPrivacyAlertExcludedContactsTitle")})}}()})]}),(0,ee.Y)(se.Ay,{activeKey:y,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",className:Ii.content,children:function(e){switch(y){case Yi.privacy:return function(){const e=t?(0,Ai.qZ)(t.expireDate-t.date):0;return(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:Ii.section,children:[(0,ee.Y)("h3",{className:Ii.title,children:m("StoryPrivacyAlertSubtitleProfile")}),(0,ee.Y)("div",{className:Ii.list,children:Pi.map((e=>{return(0,ee.FD)("label",{className:(0,me.A)(Ii.option,e.value===g?.visibility&&Ii.checked),children:[(0,ee.Y)("input",{type:"radio",name:"story_privacy",className:Ii.input,value:e.value,checked:e.value===g?.visibility,onChange:()=>{return t=e.value,void A({...g,visibility:t});var t},teactExperimentControlled:!0}),(0,ee.Y)("span",{className:Ii.icon,style:`--color-from: ${e.color[0]}; --color-to: ${e.color[1]}`,children:(0,ee.Y)(q.A,{name:e.icon})}),(0,ee.FD)("div",{className:Ii.optionContent,children:[(0,ee.Y)("span",{className:(0,me.A)(Ii.option_name),children:m(e.name)}),e.actions&&(0,ee.FD)("div",{tabIndex:0,role:"button",className:Ii.action,"aria-label":m("Edit"),onClick:t=>{!function(e,t){switch((0,f.A)(e),t){case"closeFriends":S(Yi.closeFriends);break;case"allowUserIds":S(Yi.allowList);break;case"blockUserIds":S(Yi.denyList),k("everybody");break;case"blockContactUserIds":S(Yi.denyList),k("contacts")}}(t,e.actions)},children:[(0,ee.Y)("span",{className:Ii.actionInner,children:(t=e.actions,"closeFriends"===t?0===I.length?m("StoryPrivacyOptionCloseFriendsDetail"):1===I.length?(0,Yt.F9)(m,o[I[0]]):m("StoryPrivacyOptionPeople",I.length,"i"):"blockUserIds"===t&&"everybody"===g?.visibility||"blockContactUserIds"===t&&"contacts"===g?.visibility?g?.blockUserIds?.length?1===g.blockUserIds.length?m("StoryPrivacyOptionExcludePerson",(0,l.Yg)(o[g.blockUserIds[0]])):m("StoryPrivacyOptionExcludePeople",g.blockUserIds.length,"i"):m("StoryPrivacyOptionContactsDetail"):g?.allowUserIds&&0!==g.allowUserIds.length?1===g.allowUserIds.length?(0,l.Yg)(o[g.allowUserIds[0]]):m("StoryPrivacyOptionPeople",g.allowUserIds.length,"i"):m("StoryPrivacyOptionSelectedContactsDetail"))}),(0,ee.Y)(q.A,{name:"next"})]})]})]},e.value);var t}))})]}),(0,ee.Y)("div",{className:Ii.section,children:(0,ee.FD)(ci.A,{ripple:!0,onClick:L,children:[(0,ee.Y)("span",{children:m("StoryKeep")}),(0,ee.Y)(bi.A,{id:"group-notifications",label:m("StoryKeep"),checked:b,inactive:!0})]})}),(0,ee.FD)("div",{className:Ii.footer,children:[(0,ee.Y)("div",{className:Ii.info,children:m("StoryKeepInfo",e)}),(0,ee.Y)("div",{className:Ii.submit,children:(0,ee.Y)(W.A,{onClick:x,children:m("StoryPrivacyButtonSave")})})]})]})}();case Yi.closeFriends:return(0,ee.Y)(Ni,{isActive:e,contactListIds:a,currentUserId:r,usersById:o,onClose:R},"close-friends");case Yi.denyList:return(0,ee.Y)(Si,{id:"deny-list",contactListIds:a,currentUserId:r,selectedIds:F,onSelect:B},"deny-list");case Yi.allowList:return(0,ee.Y)(Si,{id:"allow-list",contactListIds:a,lockedIds:P,currentUserId:r,selectedIds:g?.allowUserIds,onSelect:T},"allow-list")}}})]})})));var Di=i(95807),Mi=i(36353),Ti=i(73104),Bi=i(14),Ri=i(52674),Li=i(95362),xi=i(48775);const Ei="video/mp4; codecs=hvc1.1.6.L63.00";var Vi=i(45470),_i=i(39351),Ui=i(38218),Oi=i(83057),Ki=i(39761);const Ji=new Map,Gi=new Map,ji=new Map;async function*zi(e,t=0,i=262144){const s=e.match(/fileSize=(\d+)/);let n;for(n=s?s&&Number(s[1]):Gi.get(e);;){if(n&&t>=n)return;let s=t+i-1;n&&s>n&&(s=n-1);const a=`${e}:${t}-${s}`;let o=Ji.get(a);if(!o){let i=ji.get(a);i||(i=(0,Qe.px)("downloadMedia",{mediaFormat:U.qZ.Progressive,url:e,start:t,end:s}),ji.set(a,i));const r=await i.finally((()=>{ji.delete(a)}));if(!r?.arrayBuffer)return;r.fullSize&&!n&&(n=r.fullSize,Gi.set(e,r.fullSize)),o=r.arrayBuffer,s<=5242879&&Ji.set(a,r.arrayBuffer)}yield o,t=s+1}}function Hi(e){return!(!b.Yw||!e)&&Boolean(Wi()?.isTypeSupported(e))}function $i(e,t){try{e.appendBuffer(t)}catch(e){o.Oig&&console.warn("[Stream] failed to append buffer",e)}}function qi(e){try{e.endOfStream()}catch(e){o.Oig&&console.warn("[Stream] failed to end stream",e)}}function Wi(){return"ManagedMediaSource"in window?ManagedMediaSource:"MediaSource"in window?MediaSource:void 0}var Qi=i(61157),Zi=i(58554);const Xi={},es=(0,ve.v7)(1e3),ts=function(e,t){(0,s.vJ)((()=>{if(void 0===e)return;(Array.isArray(e)?e:[e]).forEach((e=>{const i=t||(0,n.mS)().stories.byPeerId[e]?.orderedIds?.[0];i&&(async e=>{await es,e.forEach((({hash:e,format:t,isStream:i})=>{i?async function(e){const t=zi((0,Zi.RB)(e));let i=0;for await(const e of t)if(i+=e.byteLength,i>=2097152)break}(e):Zi.hd(e,t).then((e=>{e&&(t===U.qZ.Progressive&&function(e){const t=document.head,i=document.createElement("video");i.preload="auto",i.src=e,i.muted=!0,i.autoplay=!0,i.disableRemotePlayback=!0,i.style.display="none",t.appendChild(i),i.load(),setTimeout((()=>{(0,Ki.A)(i),t.removeChild(i)}),1e3)}(e),t===U.qZ.BlobUrl&&(0,K.NN)(e))}))}))})(function(e,t){const i=(0,c._bp)((0,n.mS)(),e);if(!i||!i.orderedIds?.length)return[];const s=function(e,t){const i=e.indexOf(t),s=Math.max(i-5,0),n=Math.min(i+5,e.length);return e.slice(s,n)}(i.orderedIds,t),a=[];return s.forEach((t=>{if(Xi[e]?.has(t))return;const s=i.byId[t];if(!s||!("content"in s))return;const n=Boolean(s.content.video);a.push({hash:(0,l.EN)(s,"full"),format:n?U.qZ.Progressive:U.qZ.BlobUrl,isStream:n&&Hi(Ei)}),a.push({hash:(0,l.EN)(s),format:U.qZ.BlobUrl}),s.content.altVideos&&a.push({hash:(0,l.EN)(s,"full",!0),format:U.qZ.Progressive}),Xi[e]=(Xi[e]||new Set).add(t)})),a}(e,i))}))}),[t,e])};var is=i(58674),ss=i(65843),ns=i(55158),as=i(59816),os=i(61433),rs=i(91800),ls=i(23565),cs=i(35049),ds=i(18501),hs=i(11217),ms=i(86070),us=i(39877);const ps=(0,s.ph)((0,n.EK)(((e,{forwardInfo:t})=>({sender:t.fromPeerId?(0,c.PVB)(e,t.fromPeerId):void 0,story:t.storyId&&t.fromPeerId?(0,c.Msb)(e,t.fromPeerId,t.storyId):void 0})))((({className:e,forwardInfo:t,sender:i,story:a})=>{const{openStoryViewer:o,loadPeerStoriesByIds:r,openChat:l}=(0,n.ko)(),c=(0,s.li)(),d=(0,M.A)();(0,s.vJ)((()=>{!a&&t.fromPeerId&&t.storyId&&r({peerId:t.fromPeerId,storyIds:[t.storyId]})}),[t,a]);const h=i?(0,Yt.F9)(d,i):t.fromName,m=(0,D.A)((()=>{const{fromPeerId:e,storyId:i}=t;e&&(!a||"isDeleted"in a&&a.isDeleted?l({id:e}):o({peerId:e,storyId:i,isSingleStory:!0}))})),{handleClick:p,handleMouseDown:v}=(0,hs.Q)(m);return(0,ee.FD)(ms.A,{ref:c,className:(0,me.A)("EmbeddedMessage",e,(0,cs.y)(i,!0,!0)),dir:d.isRtl?"rtl":void 0,onClick:p,onMouseDown:v,children:[i?.color?.backgroundEmojiId&&(0,ee.Y)(us.A,{emojiDocumentId:i.color.backgroundEmojiId,className:"EmbeddedMessage--background-icons"}),(0,ee.FD)("div",{className:"message-text",children:[function(){if(a&&"content"in a&&a.content.text)return(0,ee.Y)("p",{className:"embedded-text-wrapper",children:(0,ds.fd)(a.content.text)})}(),(0,ee.Y)("div",{className:"message-title",children:function(){if(!i||!h)return;const e=(0,u.L8)(i.id)?"user-filled":"channel-filled";return(0,ee.FD)(ee.FK,{children:[e&&(0,ee.Y)(q.A,{name:e,className:"embedded-chat-icon"}),h&&(0,Ft.A)(h)]})}()})]})]})})));var vs=i(74936);const gs=(0,s.ph)((function({story:e,isExpanded:t,className:i,onExpand:n,onFold:a}){const o=(0,M.A)(),l=(0,s.li)(),c=(0,s.li)(),d=(0,s.li)(),h=(0,s.li)(),m=(0,Bi.A)(e,!0),u=m?.content.text,[p,v]=(0,s.J0)(!1),g=(0,ls.A)(t||void 0,400),A=t||g;(0,s.vJ)((()=>{(0,r.RK)((()=>{c.current&&(t?(0,os.YM)(c.current,Qt):(0,os.HW)(c.current,Qt))}))}),[t]);const b=p&&!A,{shouldRender:f,transitionClassNames:C}=(0,Oe.A)(b,void 0,!0,"slow",!0);(0,s.Nf)((()=>{(0,r.YS)((()=>{const e=c.current,t=h.current;if(!e||!t)return;const{offsetWidth:i}=t;(0,r.RK)((()=>{e.style.setProperty("--expand-button-width",`${i}px`)}))}))}),[f,o]),(0,s.Nf)((()=>{(0,r.gm)((()=>{if(!c.current||!d.current)return;const e=c.current,t=d.current,i=t.offsetTop,{lineHeight:s,totalLines:n}=(0,rs.A)(t),a=n>3,o=i+3*s;return()=>{a&&((0,os.YM)(e,"e1gyTmKe"),v(!0)),e.style.setProperty("--_overflow-shift",`${o}px`)}}))}),[u]),(0,s.vJ)((()=>{t||l.current?.scrollTo({top:0})}),[t]);const y=(0,me.A)("ilyTRZtw",A&&"HIMnUViv",f&&"Vq8pl_kQ");return(0,ee.FD)("div",{className:(0,me.A)("RKedwa0I",i),children:[(0,ee.Y)("div",{ref:c,className:y,role:b?"button":void 0,onClick:b?n:a,children:(0,ee.FD)("div",{ref:l,className:(0,me.A)("D_5mWNmi","allow-selection","custom-scroll"),children:[m?.forwardInfo&&(0,ee.Y)(ps,{forwardInfo:m.forwardInfo,className:"_M8CgT7s"}),m&&(0,ee.Y)("div",{ref:d,className:"hmFA5qb1",children:(0,ee.Y)(vs.A,{messageOrStory:m,withTranslucentThumbs:!0,forcePlayback:!0})})]})}),f&&(0,ee.Y)("div",{ref:h,className:(0,me.A)("bM5rlQtM",C),onClick:n,children:o("Story.CaptionShowMore")})]})}));var As=i(26875),bs=i(44918);const fs="YVD19vOP",Cs="vJRk_UUk",ys="nIv3YAnZ",Ss=(0,s.ph)((({story:e,className:t})=>{const{openStoryViewModal:i,openForwardMenu:a,sendStoryReaction:r}=(0,n.ko)(),c=(0,M.A)(),{views:d,isOut:h,peerId:m,id:p,sentReaction:v}=e,{viewsCount:g,forwardsCount:A,reactionsCount:b}=d||{},f=!(0,u.L8)(m),C=v&&(0,l.a0)(v,o.tNZ),y=Boolean((h||f)&&e.isPublic&&!e.noForwards),S=(0,l.$_)(m,p),w=(0,s.Kr)((()=>{const{users:{byId:e}}=(0,n.mS)(),t=d&&"recentViewerIds"in d?d.recentViewerIds:void 0;if(t)return t.map((t=>e[t])).filter(Boolean)}),[d]),k=(0,D.A)((()=>{i({storyId:p})})),N=(0,D.A)((()=>{a({fromChatId:m,storyId:p})})),I=(0,D.A)((()=>{const e=v?void 0:o.tNZ;r({peerId:m,storyId:p,containerId:S,reaction:e})}));return g?(0,ee.FD)("div",{className:(0,me.A)(fs,t),children:[(0,ee.FD)("div",{className:(0,me.A)("cknL5COh",!f&&"pJAyeGkG"),onClick:f?void 0:k,children:[Boolean(w?.length)&&(0,ee.Y)(As.A,{size:"small",peers:w,className:"Vz_VtJ16"}),f?(0,ee.FD)("span",{className:ys,children:[(0,ee.Y)(q.A,{name:"channelviews",className:"WyBiNM6e"}),g]}):(0,ee.Y)("span",{className:ys,children:c("Views",g,"i")}),Boolean(b)&&!f&&(0,ee.FD)("span",{className:"sf3u_6Vh",children:[(0,ee.Y)(q.A,{name:"heart",className:"Er2XKRqi"}),b]})]}),(0,ee.Y)("div",{className:"kKoeDk3Z"}),y&&(0,ee.Y)(W.A,{color:"translucent",size:"smaller",round:!0,onClick:N,ariaLabel:c("Forward"),className:Cs,children:(0,ee.Y)(q.A,{name:"forward"})}),f&&(0,ee.FD)(ee.FK,{children:[Boolean(A)&&(0,ee.FD)("div",{className:Cs,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",nonInteractive:!0,ariaLabel:c("PublicShares"),children:(0,ee.Y)(q.A,{name:"loop"})}),(0,ee.Y)("span",{children:A})]}),(0,ee.FD)("div",{className:Cs,children:[(0,ee.FD)(W.A,{round:!0,className:"lpDXVIuf",color:"translucent",size:"smaller",onClick:I,ariaLabel:c("AccDescrLike"),children:[v&&(0,ee.Y)(bs.A,{containerId:S,reaction:v,withEffectOnly:C},(0,l.Jj)(v)),(!v||C)&&(0,ee.Y)(q.A,{name:C?"heart":"heart-outline",className:(0,me.A)(C&&"twgMDT1y")})]}),Boolean(b)&&(0,ee.Y)("span",{children:b})]})]})]}):(0,ee.Y)("div",{className:(0,me.A)(fs,t),children:c("NobodyViewed")})})),ws=(0,s.ph)((function({isActive:e,isViewed:t,isVideo:i,duration:s=6,isPaused:n,onImageComplete:a}){const o=(0,D.A)((e=>{i||"XY98E7VM"!==e.animationName||a()})),r=(0,me.A)("c1fbGgcx",t&&"xwOKghO2",e&&"ZuByYcIx",n&&"n9V6B7hP");return(0,ee.Y)("span",{className:r,"aria-hidden":!0,children:e&&(0,ee.Y)("i",{style:`--progress-duration: ${s}s`,className:"qyBCpJct",onAnimationEnd:o})})})),ks=b.Yw?4:3,Ns=(0,s.ph)((0,n.EK)(((e,{peerId:t,storyId:i,isDeleteModalOpen:s})=>{const{appConfig:n}=e,a=(0,c.mBe)(e,t),o=(0,c.hds)(e,t),r=(0,c.vGo)(e,t),l=(0,c.nTw)(e),{storyViewer:{isMuted:d,viewModal:h,isPrivacyModalOpen:m,isStealthModalOpen:u,storyList:p},forwardMessages:{storyId:v},premiumModal:g,safeLinkModalUrl:A,mapModal:b,reportModal:f,giftInfoModal:C,isPaymentMessageConfirmDialogOpen:y}=l,{isOpen:S}=g||{},w=(0,c.Msb)(e,t,i),k=w&&"content"in w,N=Boolean(y||h||v||l.reactionPicker?.storyId||f||m||S||s||A||u||b||C),I=k?w.forwardInfo:void 0,P=k?w.mediaAreas:void 0,Y=I?.fromPeerId||P?.find((e=>"channelPost"===e.type))?.channelId,F=Y?(0,c.PVB)(e,Y):void 0,D=(0,c.xYJ)(e,"mediaViewerAnimations"),M=k&&w.fromId?(0,c.PVB)(e,w.fromId):void 0,T=(0,c.WA9)(e,t),B=(0,c.trm)(e);return{peer:a||o,forwardSender:F,fromPeer:M,story:w,orderedIds:p?.storyIdsByPeerId[t],isMuted:d,isCurrentUserPremium:(0,c.g29)(e),shouldForcePause:N,storyChangelogUserId:n.storyChangelogUserId,viewersExpirePeriod:n.storyExpirePeriod+n.storyViewersExpirePeriod,isChatExist:Boolean(o),arePeerSettingsLoaded:Boolean(r?.settings),stealthMode:e.stories.stealthMode,withHeaderAnimation:D,paidMessagesStars:T,isAccountFrozen:B}}))((function({peerId:e,storyId:t,peer:i,forwardSender:a,fromPeer:c,isMuted:d,isArchivedStories:h,isPrivateStories:m,story:p,orderedIds:v,isSingleStory:g,dimensions:f,shouldForcePause:C,storyChangelogUserId:y,viewersExpirePeriod:S,isChatExist:w,arePeerSettingsLoaded:k,getIsAnimating:N,isCurrentUserPremium:P,stealthMode:F,withHeaderAnimation:T,onDelete:B,onClose:R,onReport:L,paidMessagesStars:x,isAccountFrozen:E}){const{viewStory:V,setStoryViewerMuted:_,openPreviousStory:O,openNextStory:K,loadPeerSkippedStories:J,openForwardMenu:G,copyStoryLink:j,toggleStoryInProfile:z,openChat:H,showNotification:$,openStoryPrivacyEditor:Q,loadPeerSettings:Z,fetchChat:X,loadStoryViews:te,toggleStealthModal:ie}=(0,n.ko)(),ne=(0,li.Fm)(),ae=(0,M.A)(),oe=(0,_i.A)(),{isMobile:re}=(0,I.Ay)(),[de,he,ue]=(0,Y.A)(!1),[ve,ge,Ae]=(0,Y.A)(!1),[be,fe,Ce]=(0,Y.A)(!1),[ye,Se,we]=(0,Y.A)(!0),[ke,Ne,Ie]=(0,Y.A)(!1),[Pe,Ye]=(0,s.J0)(!1),[Fe,De,Me]=(0,Y.A)(!1),[Te,Be,Re]=(0,Y.A)(!1),Le=(0,s.li)(),{isDeletedStory:xe,hasText:Ee,hasForwardInfo:Ve,thumbnail:Ue,previewBlobUrl:Ke,isVideo:Je,noSound:Ge,fullMediaData:je,altMediaHash:He,altMediaData:$e,hasFullData:qe,hasThumb:We,canDownload:Qe,downloadMediaData:Ze}=ri(p,P,Te),Xe=p&&"content"in p,et=e===y,tt=(0,u.L8)(e),it=!tt,st=it&&(0,l.WX)(i),nt=Xe&&p.isOut,at=(0,Bi.A)(nt?!p.isInProfile:void 0,!0),ot=(0,Bi.A)(nt?p.isInProfile:void 0,!0),rt=Boolean(nt&&p.date+S<(0,li.Fm)()),lt=a?(0,Yt.F9)(ae,a):Xe&&p.forwardInfo?.fromName,ct=Boolean(Xe&&p.isPublic&&!et&&i?.hasUsername),dt=Boolean(Xe&&p.isPublic&&!p.noForwards&&!et&&!ke),ht=Boolean(qe&&!C&&ye&&!de&&!ke&&!Pe&&!Fe),mt=Xe&&p.content.video?.duration?p.content.video.duration:void 0,ut=!(nt&&tt||et||st||E),pt=Xe&&!ut&&(nt||st),vt=re&&T?"slideFade":"none",{shouldRender:gt,transitionClassNames:At}=(0,Oe.A)(!qe),{transitionClassNames:bt}=(0,Oe.A)(Boolean(je)),ft=(0,Vi.A)(Ue,!We),Ct=(0,Oi.A)(Ke),{shouldRender:yt,transitionClassNames:St}=(0,Oe.A)(ut),{shouldRender:wt,transitionClassNames:kt}=(0,Oe.A)(Ee&&ke),{transitionClassNames:Nt}=(0,Oe.A)(!0),{shouldRender:It,transitionClassNames:Pt}=(0,Oe.A)(Ee||Ve),Mt=function(e,t,i){return(0,s.vJ)((()=>{if(!t||!e.current)return;const s=Wi(),n=e.current;if(!b.Yw||!i||!s?.isTypeSupported(i))return;const a=new s;function o(){if(!t||!i)return;const e=a.addSourceBuffer(i),s=zi(t);e.addEventListener("updateend",(function(){s.next().then((({value:t,done:i})=>{"open"===a.readyState&&(i?qi(a):$i(e,t))}))})),s.next().then((({value:t,done:i})=>{i||"open"!==a.readyState||((0,r.RK)((()=>{n.style.display="block",setTimeout((()=>{(0,r.RK)((()=>{(0,A.ZM)(n,{opacity:"1"})}))}),100)})),$i(e,t))}))}return a.addEventListener("sourceopen",o,{once:!0}),(0,r.RK)((()=>{(0,A.ZM)(n,{display:"none",opacity:"0"}),n.src=URL.createObjectURL(a)})),()=>{(0,r.RK)((()=>{const e=n.src;(0,Ki.A)(n),a.removeEventListener("sourceopen",o),"open"===a.readyState&&qi(a),URL.revokeObjectURL(e)}))}}),[i,t,e]),Hi(i)}(Le,je,Ei);ts(e,t),(0,s.vJ)((()=>{t&&V({peerId:e,storyId:t})}),[t,e]),(0,s.vJ)((()=>{J({peerId:e})}),[e]),(0,s.vJ)((()=>{const t=(0,u.L8)(e);!w&&t&&X({chatId:e})}),[w,e]),(0,s.vJ)((()=>{w&&!k&&Z({peerId:e})}),[k,w,e]);const Tt=(0,D.A)((()=>{Je&&Le.current?.pause(),Ce(),Ae()})),Bt=(0,D.A)((()=>{ht&&(ge(),Je||fe())})),Rt=(0,D.A)((()=>{De()})),Lt=(0,D.A)((()=>{Me()})),Et=(0,D.A)((()=>{Be(),Tt()})),Vt=(0,D.A)((()=>{Re(),Bt()})),{onMouseDown:_t,onMouseUp:Ot,onMouseLeave:jt,onTouchStart:zt,onTouchEnd:Ht}=(0,Ui.A)({onStart:Rt,onEnd:Lt}),Qt=(0,_e.A)(Le,void 0,!Je||!je||Mt),ti=je&&(!He||$e);(0,s.vJ)((()=>{ti&&!Qt&&Bt()}),[ti,Qt]),(0,Qi.A)(we,Se),(0,s.vJ)((()=>{ti&&Le.current?.load()}),[ti]),(0,s.vJ)((()=>{!Xe||xe||rt||(nt||st)&&te({peerId:e,storyId:t})}),[xe,rt,Xe,e,t,nt,st]),(0,s.vJ)((()=>{C||!ye||de||ke||Pe||Fe?Tt():Bt()}),[Bt,ye,ke,de,C,Pe,Fe]),(0,s.vJ)((()=>{if(!(de||C||ke))return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){32===e.keyCode&&(e.preventDefault(),Ye(!Pe))}}),[ke,de,Pe,C]),(0,wi.A)((([e,t,i,s,n])=>{!Pe||ke||de||C||!ye||Fe||t===ke&&e===de&&i===C&&s===ye&&n===Fe||Ye(!1)}),[de,ke,C,ye,Fe,Pe]);const ii=(0,D.A)((()=>{R(),H({id:e})})),si=(0,D.A)((()=>{R(),H({id:a.id})})),ni=(0,D.A)((()=>{R(),H({id:c.id})})),ai=(0,D.A)((()=>{O()})),oi=(0,D.A)((()=>{K()})),ci=(0,D.A)((e=>{const t=e.currentTarget;t.readyState>=ks?fe():Ce(),mt&&(0,pe.LI)(t.currentTime,2)>=(0,pe.LI)(mt,2)&&oi()}));(0,s.vJ)((()=>N()||de?void 0:(0,Ri.A)({onRight:oi,onLeft:ai})),[N,de]);const di=(0,D.A)((()=>{j({peerId:e,storyId:t})})),hi=(0,D.A)((()=>{z({peerId:e,storyId:t,isInProfile:!0})})),mi=(0,D.A)((()=>{z({peerId:e,storyId:t,isInProfile:!1})})),ui=(0,D.A)((()=>{B(p)})),pi=(0,D.A)((()=>{L()})),vi=(0,D.A)((()=>{G({fromChatId:e,storyId:t})})),gi=(0,D.A)((()=>{Q()})),Ai=(0,D.A)((()=>{const e=!Xe||p.isPublic?void 0:p.isForContacts?"contacts":p.isForCloseFriends?"closeFriends":"nobody";let t;const s=(0,Yt.F9)(ae,i);switch(e){case"nobody":t=ae("StorySelectedContactsHint",s);break;case"contacts":t=ae("StoryContactsHint",s);break;case"closeFriends":t=ae("StoryCloseFriendsHint",s);break;default:return}$({message:t})})),bi=(0,D.A)((()=>{Ge?$({message:ae("Story.TooltipVideoHasNoSound")}):(Le.current.muted=!Le.current.muted,_({isMuted:!d}))})),fi=(0,D.A)((()=>{if(F.activeUntil&&(0,li.Fm)()<F.activeUntil){const e=F.activeUntil-(0,li.Fm)();$({title:ae("StealthModeOn"),message:ae("Story.ToastStealthModeActiveText",(0,ze.QO)(e)),duration:4e3})}else ie({isOpen:!0})})),Ci=(0,D.A)((()=>{Ze&&(0,Li.A)(Ze,`story-${e}-${t}.${Je?"mp4":"jpg"}`)}));(0,s.vJ)((()=>{xe&&$({message:ae("StoryNotFound")})}),[ae,xe]);const yi=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.Y)(W.A,{round:!0,ripple:!re,size:"tiny",color:"translucent-white",onClick:e,className:(0,me.A)(Wt,t&&"active"),ariaLabel:ae("AccDescrOpenMenu2"),children:(0,ee.Y)(q.A,{name:"more"})})),[re,ae]);const Si=x?oe("ComposerPlaceholderPaidReply",{amount:(0,xi.U)(oe,x,{asFont:!0,className:"placeholder-star-icon"})},{withNodes:!0}):ae(it?"ReplyToGroupStory":"ReplyPrivately");return(0,ee.FD)("div",{className:(0,me.A)($t,"component-theme-dark"),onMouseDown:_t,onMouseUp:Ot,onMouseLeave:jt,onTouchStart:zt,onTouchEnd:Ht,children:[(0,ee.FD)("div",{className:(0,me.A)("e7HHuS1g",Nt),children:[(0,ee.Y)("div",{className:"jGDd2sza",children:(g?[t]:v??[]).map((e=>(0,ee.Y)(ws,{isActive:e===p?.id,isVideo:Je,isViewed:Boolean(p?.id&&(m||h?e>p?.id:e<p?.id)),isPaused:!be,duration:mt,onImageComplete:oi},`progress-${e}`)))}),(0,ee.FD)("div",{className:"eMYhXF_X",children:[(0,ee.Y)(se.Ay,{activeKey:Number(e),name:vt,className:"PXnfXZur",children:(0,ee.FD)("div",{className:"WpyVfrsc",children:[(0,ee.Y)(Dt.A,{peer:i,size:"tiny",onClick:ii}),(0,ee.FD)("div",{className:"jmKI_lhC",children:[(0,ee.Y)("span",{onClick:ii,className:"H1uod43o",children:(0,Ft.A)((0,Yt.F9)(ae,i)||"")}),(0,ee.FD)("div",{className:"zimpR8Hz",children:[lt&&(0,ee.FD)("span",{className:(0,me.A)(qt,"JJFtefb9",a&&"BsqMBS2I"),onClick:a?si:void 0,children:[(0,ee.Y)(q.A,{name:"loop"}),(0,ee.Y)("span",{className:ei,children:(0,Ft.A)(lt)})]}),c&&(0,ee.FD)("span",{className:(0,me.A)(qt,"nJr8QgYX"),onClick:ni,children:[(0,ee.Y)(Dt.A,{peer:c,size:"micro"}),(0,ee.Y)("span",{className:ei,children:(0,Ft.A)((0,Yt.F9)(ae,c)||"")})]}),p&&"date"in p&&(0,ee.Y)("span",{className:qt,children:(0,ze.jy)(ae,ne,p.date)}),Xe&&p.isEdited&&(0,ee.Y)("span",{className:qt,children:ae("Story.HeaderEdited")})]})]})]})}),(0,ee.FD)("div",{className:"GrsJNw3y",children:[function(){if(!tt)return;let e="channel-filled";const t={"channel-filled":["#50ABFF","#007AFF"],"user-filled":["#C36EFF","#8B60FA"],"favorite-filled":["#88D93A","#30B73B"],"group-filled":["#FFB743","#F69A36"]};if(nt){const{visibility:t}=p&&"visibility"in p&&p.visibility||{};switch(t){case"everybody":e="channel-filled";break;case"contacts":e="user-filled";break;case"closeFriends":e="favorite-filled";break;case"nobody":e="group-filled"}}else{if(!p||!("content"in p)||p.isPublic)return;e=p.isForCloseFriends?"favorite-filled":p.isForContacts?"user-filled":"group-filled"}return(0,ee.FD)("div",{className:(0,me.A)("prxptFFf",nt&&"_MVsZpgB"),onClick:nt?gi:Ai,style:`--color-from: ${t[e][0]}; --color-to: ${t[e][1]}`,children:[(0,ee.Y)(q.A,{name:e}),nt&&(0,ee.Y)(q.A,{name:"next"})]})}(),Je&&(0,ee.Y)(W.A,{className:Wt,round:!0,ripple:!re,size:"tiny",color:"translucent-white",disabled:!qe,onClick:bi,ariaLabel:ae("Volume"),children:(0,ee.Y)(q.A,{name:d||Ge?"speaker-muted-story":"speaker-story"})}),(0,ee.FD)(le.A,{className:"K0_xAdzf",trigger:yi,positionX:"right",onOpen:Et,onClose:Vt,children:[ct&&(0,ee.Y)(ce.A,{icon:"copy",onClick:di,children:ae("CopyLink")}),at&&(0,ee.Y)(ce.A,{icon:"save-story",onClick:hi,children:ae(tt?"StorySave":"SaveToPosts")}),ot&&(0,ee.Y)(ce.A,{icon:"delete",onClick:mi,children:ae(tt?"ArchiveStory":"RemoveFromPosts")}),Qe&&(0,ee.Y)(ce.A,{icon:"download",disabled:!Ze,onClick:Ci,children:ae("lng_media_download")}),!nt&&tt&&(0,ee.Y)(ce.A,{icon:"eye-crossed-outline",onClick:fi,children:ae("StealthMode")}),!nt&&(0,ee.Y)(ce.A,{icon:"flag",onClick:pi,children:ae("lng_report_story")}),nt&&(0,ee.Y)(ce.A,{icon:"delete",destructive:!0,onClick:ui,children:ae("Delete")})]}),(0,ee.Y)(W.A,{className:(0,me.A)(Wt,"WlLsjJ2Z"),round:!0,size:"tiny",color:"translucent-white",ariaLabel:ae("Close"),onClick:R,children:(0,ee.Y)(q.A,{name:"close"})})]})]})]}),(0,ee.FD)("div",{className:"YiuvOPgT",style:`width: ${f.width}px; height: ${f.height}px`,children:[(0,ee.Y)("canvas",{ref:ft,className:Xt}),Ke&&(0,ee.Y)("img",{src:Ke,draggable:!1,alt:"",className:(0,me.A)(Kt,"lQfkulvp",Ct)},`preview-${t}`),gt&&(0,ee.Y)(ns.A,{className:(0,me.A)(At,xt)}),!Je&&je&&(0,ee.Y)("img",{src:je,alt:"",className:(0,me.A)(Kt,bt),draggable:!1}),Je&&je&&(0,ee.FD)(ss.A,{ref:Le,className:(0,me.A)(Kt,bt),canPlay:ve,muted:d,width:720,height:1280,draggable:!1,playsInline:!0,disablePictureInPicture:!0,isPriority:!0,onPause:Ce,onWaiting:Ce,disableRemotePlayback:!0,onTimeUpdate:ci,children:[(0,ee.Y)("source",{src:je,type:Ei,width:"720"}),$e&&(0,ee.Y)("source",{src:$e,type:"video/mp4; codecs=avc1.64001E",width:"480"})]},`video-${t}`),!Fe&&!de&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("button",{type:"button",className:(0,me.A)(Zt,"SXpRZiax"),onClick:ai,"aria-label":ae("Previous")}),(0,ee.Y)("button",{type:"button",className:(0,me.A)(Zt,"twOBFwUE"),onClick:oi,"aria-label":ae("Next")})]}),Xe&&je&&(0,ee.Y)(as.A,{story:p,isActive:!0,isStoryPlaying:Te},`area-overlay-${t}-${e}`),!re&&(0,ee.Y)("div",{className:Ut,children:(0,ee.FD)("div",{className:Jt,children:[(0,ee.Y)(Dt.A,{peer:i,withStory:!0,storyViewerMode:"disabled"}),(0,ee.Y)("div",{className:Gt,children:(0,Ft.A)((0,Yt.F9)(ae,i)||"")})]})})]}),pt&&(0,ee.Y)(Ss,{story:p,className:Nt}),wt&&(0,ee.Y)("div",{tabIndex:0,role:"button",className:(0,me.A)("Jd1DYS6Y",kt),onClick:()=>Ie(),"aria-label":ae("Close")}),Ee&&(0,ee.Y)("div",{className:(0,me.A)("sHNAfxzf",Pt)}),It&&(0,ee.Y)(gs,{story:p,isExpanded:ke,onExpand:Ne,onFold:Ie,className:Pt},`caption-${t}-${e}`),yt&&(0,ee.Y)(is.A,{type:"story",chatId:e,threadId:U.l3,storyId:t,isReady:!nt,messageListType:"thread",isMobile:(0,I.Ny)(),editableInputCssSelector:o.iKt,editableInputId:o.YVZ,inputId:"story-input-text",className:(0,me.A)("FXineBYO",St),inputPlaceholder:Si,onForward:dt?vi:void 0,onFocus:he,onBlur:ue})]})}))),Is=(0,s.ph)((0,n.EK)(((e,{peer:t})=>{const{storyViewer:{lastViewedByPeerId:i,origin:s,storyList:n}}=(0,c.nTw)(e);return{lastViewedId:t?.id?i?.[t.id]:void 0,origin:s,storyIdsForViewer:t?.id?n?.storyIdsByPeerId[t.id]:void 0}}))((function({peer:e,peerStories:t,lastViewedId:i,storyIdsForViewer:a,origin:o}){const{openStoryViewer:r,loadPeerSkippedStories:c}=(0,n.ko)(),d=(0,M.A)(),h=(0,s.Kr)((()=>{if(!t)return;const{orderedIds:e,lastReadId:s,byId:n}=t,o=e[e.length-1]!==s,r=i&&a?.includes(i)?i??(o?s??-1:-1):-1;return n[n[r]?.id||a?.[0]||e[0]]}),[i,t,a]),m=h&&"content"in h;(0,s.vJ)((()=>{h&&!m&&c({peerId:h.peerId})}),[h,m]);const u=m?h.content.video:void 0,p=m?(0,l.EN)(h):void 0,v=(0,j.A)(p)||u?.thumbnail?.dataUri;if(e&&h&&!("isDeleted"in h))return(0,ee.FD)("div",{className:$t,onClick:()=>{r({peerId:h.peerId,storyId:h.id,origin:o})},children:[v&&(0,ee.Y)("img",{src:v,alt:"",className:Kt,draggable:!1}),m&&(0,ee.Y)(as.A,{story:h}),(0,ee.Y)("div",{className:Ut,children:(0,ee.FD)("div",{className:Jt,children:[(0,ee.Y)(Dt.A,{peer:e,withStory:!0,storyViewerMode:"disabled"}),(0,ee.Y)("div",{className:Gt,children:(0,Ft.A)((0,Yt.F9)(d,e)||"")})]})})]})})));var Ps=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e}(Ps||{});const Ys=(0,s.ph)((0,n.EK)((e=>{const{storyViewer:{peerId:t,storyId:i,isSinglePeer:s,isSingleStory:n,isPrivate:a,isArchive:o,storyList:r}}=(0,c.nTw)(e),{byPeerId:l,orderedPeerIds:{active:d}}=e.stories;return{byPeerId:l,peerIds:r?.peerIds??d,currentPeerId:t,currentStoryId:i,isSinglePeer:s,isSingleStory:n,isPrivate:a,isArchive:o}}),(e=>(0,c.gd2)(e)))((function({peerIds:e,currentPeerId:t,currentStoryId:i,isOpen:a,isSinglePeer:d,isSingleStory:h,isPrivate:m,isArchive:u,byPeerId:p,isDeleteModalOpen:v,onDelete:g,onClose:A,onReport:f}){const{stopActiveReaction:C}=(0,n.ko)(),y=(0,s.li)(),[S,w]=(0,s.J0)(t),[k,N]=(0,s.J0)(i),P=(0,V.A)(t),Y=(0,Bi.A)(u,!0),F=(0,Bi.A)(m,!0),M=(0,Bi.A)(d,!0),T=(0,Bi.A)(h,!0),B=oi(),{height:R,width:L}=(0,we.A)(),x=(0,s.li)(void 0),E=(0,s.li)(!1),{isMobile:_}=(0,I.Ay)(),U=(0,s.li)({}),[O,K]=(0,s.Ul)(!1);function J(e,t){e&&(U.current[t]?U.current[t].current=e:U.current[t]={current:e})}(0,fe.A)({isActive:a,onBack:A,shouldBeReplaced:!0});const G=(0,s.Kr)((()=>{if(S&&(M||T))return[S];const t=S?e.indexOf(S):-1;if(!S||-1===t)return[];const i=Math.max(t-4,0),s=Math.min(t+5,e.length);return e.slice(i,s)}),[T,M,S,e]),j=(0,s.Kr)((()=>G.length&&S?G.indexOf(S):-1),[S,G]),z=(0,s.Kr)((()=>G.length&&t?G.indexOf(t):-1),[t,G]);(0,s.vJ)((()=>{_&&w(t)}),[t,_]),(0,s.vJ)((()=>{S===t&&i!==k&&N(i)}),[t,i,S,k]),(0,s.vJ)((()=>{if(!_)return P&&P!==t&&K(!0),()=>{K(!1)}}),[P,t,K,_]),(0,s.vJ)((()=>()=>{i&&t&&C({containerId:(0,l.$_)(t,i)})}),[i,t]);const H=z-j,$=j>z,q=(0,D.A)((()=>e.reduce(((i,s,n)=>{if(s===S)i[s]=ai({scale:B.scale,slideAmount:H,isBackward:$,isActiveSlideSize:$});else{let a=!1;!$&&n>0&&e[n-1]===S&&(a=!0),$&&n<e.length-1&&e[n+1]===S&&(a=!0),i[s]=ai({scale:B.scale,slideAmount:H,isBackward:$,isActiveSlideSize:t===s&&!$,isMoveThroughActiveSlide:a})}return i}),{})));(0,s.vJ)((()=>{if(!y.current||!a)return;let e=0;const t=()=>S?U.current[S]?.current:void 0,i=i=>{if(E.current)return void(E.current=!1);const s=t();if(s)if(e<-50){const e=document.getElementById(o.YVZ);e&&(0,r.RK)((()=>{(0,Mi.A)(e)}))}else e>50?(A(),"wheel"===i.type&&((0,Ti.M6)(),setTimeout(Ti.v5,1500))):(0,r.RK)((()=>{s.style.setProperty("--slide-translate-y","0px")}))};return(0,ue.wJ)(y.current,{isNotPassive:!0,withNativeDrag:!0,withWheelDrag:!0,excludedClosestSelector:".Composer",onDrag:(s,n,{dragOffsetX:a,dragOffsetY:o})=>{if(E.current)return;if(b.pz&&"touchstart"===n.type){const{pageX:e}=n.touches[0];if(e<=ue.h6||e>=L-ue.h6)return}if("mousemove"===s.type)return;const l=Math.abs(a),c=Math.abs(o),d=t();if(d&&(x.current===Ps.Vertical||Math.abs(c)>ue.no||c/l>ue.fG)){x.current=Ps.Vertical;const t=R;e=(0,pe.qE)(o,-t,t),e>0&&(0,r.RK)((()=>{d.style.setProperty("--slide-translate-y",e*(_?1:-1)+"px")})),"wheel"===s.type&&Math.abs(e)>100&&(i(s),E.current=!0)}},onRelease:i})}),[a,A,L,R,_,S]),(0,s.Nf)((()=>{if(_)return;const e=q();Object.entries(U.current).forEach((([i,{current:s}])=>{if(!s)return;if(!O())return s.classList.remove(Vt,_t,Ot),s.style.setProperty("--slide-translate-x","0px"),s.style.setProperty("--slide-translate-y","0px"),s.style.setProperty("--slide-translate-scale","1"),void s.style.setProperty("--slide-content-scale",String(B.toActiveScale));let n=0;i===S&&(n=-1.75*B.fromActiveScale,s.classList.add(Ot)),i===t&&(n=1.75,s.classList.add(_t)),s.classList.add(Vt),s.style.setProperty("--slide-translate-x",`${e[i]||0}px`),s.style.setProperty("--slide-translate-y",`${n}rem`),s.style.setProperty("--slide-translate-scale",t===i?String(B.toActiveScale):i===S?String(B.fromActiveScale):"1")}))}),[t,O,S,B,_]);const W=(0,D.A)((e=>{const s=e.target;s&&s.classList.contains(Ht)&&(S!==t?(w(t),N(i)):i!==k&&N(i),K(!1))}));return _?(0,ee.Y)("div",{className:Et,ref:y,children:(0,ee.Y)("div",{className:zt,ref:e=>J(e,S),children:(0,ee.Y)(Ns,{peerId:S,storyId:k,onDelete:g,dimensions:B.activeSlide,isPrivateStories:F,isArchivedStories:Y,isDeleteModalOpen:v,isSingleStory:h,getIsAnimating:O,onClose:A,onReport:f})})}):(0,ee.FD)("div",{className:Et,ref:y,style:`--story-viewer-scale: ${B.scale}`,onTransitionEnd:W,children:[(0,ee.Y)("div",{className:xt,onClick:A}),G.length>1&&(0,ee.Y)("div",{className:"xe67dhtF",style:`height: ${B.slide.height}px`}),G.map(((e,t)=>e===S?function(e){const t=_?void 0:(0,Di.A)(`width: ${B.activeSlide.width}px`,`--slide-media-height: ${B.activeSlide.height}px`);return(0,ee.Y)("div",{ref:t=>J(t,e),className:(0,me.A)(jt,Ht),style:t,children:(0,ee.Y)(Ns,{peerId:e,storyId:k,onDelete:g,dimensions:B.activeSlide,isPrivateStories:F,isArchivedStories:Y,isDeleteModalOpen:v,isSingleStory:h,getIsAnimating:O,onClose:A,onReport:f})},e)}(S):function(e,t,i){const s=(0,Di.A)(`width: ${B.slide.width}px`,`height: ${B.slide.height}px`),a=(0,me.A)(jt,"Sef28wEh",`slide-${i}`);return(0,ee.Y)("div",{ref:t=>J(t,e),className:a,style:s,children:(0,ee.Y)(Is,{peer:(0,c.PVB)((0,n.mS)(),e),peerStories:p?.[e]})},e)}(e,0,t-j)))]})})));function Fs(e=5){const[t,i]=(0,s.J0)(!0),[n,a]=(0,s.J0)(!0);return{isAtBeginning:t,isAtEnd:n,handleScroll:(0,D.A)((t=>{const{scrollHeight:s,scrollTop:n,clientHeight:o}=t.target;i(n<e),a(s-n-o<e)}))}}var Ds=i(46222),Ms=i(283),Ts=i(36393),Bs=i(51083),Rs=i(17751),Ls=i(17794);const xs={"views-list":"gpDY8bos",viewsList:"gpDY8bos","views-list-loading":"vuRAfQ5v",viewsListLoading:"vuRAfQ5v",info:"AOSUIChK",centeredInfo:"oGLhkkS7","view-reaction":"MLaabS6n",viewReaction:"MLaabS6n",header:"d3N2bktu",content:"QmRA3HZK","top-button":"Dkv8GAxf",topButton:"Dkv8GAxf","contact-filter":"YpB_9VxE",contactFilter:"YpB_9VxE",selected:"DoUlpdZJ",sort:"axDpgq9G","sort-button":"Bm5VA66f",sortButton:"Bm5VA66f","icon-sort":"YVQiH93R",iconSort:"YVQiH93R","icon-down":"NXP9aMD0",iconDown:"NXP9aMD0",search:"QQQqBLK6","bottom-info":"_CSv6suH",bottomInfo:"_CSv6suH",scrolled:"RYQ0liYe",footer:"dUK7rP37",closeButton:"abPzLiCH","opacity-fade-in":"cX8oY3zb",opacityFadeIn:"cX8oY3zb",fadeIn:"Sx_aeh1o",blocked:"L82sciL8",check:"UqGBKwjg",menuBubble:"dRqemuTA","with-colored-status":"GQ96fta9",withColoredStatus:"GQ96fta9"},Es=1.5*p.$,Vs=(0,s.ph)((0,n.EK)(((e,{storyView:t})=>({peer:(0,c.PVB)(e,t.peerId),availableReactions:e.reactions.availableReactions})))((({storyView:e,peer:t,availableReactions:i})=>{const{openChat:a,closeStoryViewer:o,unblockUser:r,blockUser:c,deleteContact:d,updateStoryView:h,focusMessage:m,openStoryViewer:p,closeStoryViewModal:v}=(0,n.ko)(),g=(0,M.A)(),A=(0,D.A)((()=>{const{type:t}=e;if("repost"===t)return v(),void p({peerId:e.peerId,storyId:e.storyId});o(),setTimeout((()=>{"user"===t?a({id:e.peerId}):"forward"===t&&m({chatId:e.peerId,messageId:e.messageId})}),100)})),b=(0,s.Kr)((()=>{if(!(0,u.L8)(e.peerId))return;const{peerId:i,areStoriesBlocked:s,isUserBlocked:n}=e,a=t,{isContact:o}=a||{},m=(0,l.Yg)(a),p=[];return n||(s?p.push({handler:()=>{r({userId:i,isOnlyStories:!0}),h({userId:i,areStoriesBlocked:!1})},title:g("StoryShowBackTo",m),icon:"play-story"}):p.push({handler:()=>{c({userId:i,isOnlyStories:!0}),h({userId:i,areStoriesBlocked:!0})},title:g("StoryHideFrom",m),icon:"hand-stop"})),o?p.push({handler:()=>{d({userId:i})},title:g("DeleteContact"),icon:"delete-user",destructive:!0}):p.push({handler:()=>{n?(r({userId:i}),h({userId:i,isUserBlocked:!1})):(c({userId:i}),h({userId:i,isUserBlocked:!0}))},title:g(n?"Unblock":"BlockUser"),icon:n?"user":"delete-user",destructive:!n}),p}),[g,e,t]),f="user"===e.type?"message-read":"forward"===e.type?"forward":"loop",C="forward"===e.type||"repost"===e.type,y=(0,s.Kr)((()=>{const t="repost"===e.type&&e.story.forwardInfo?.isModified,i=[(0,ze.U)(g,1e3*e.date)];return t&&i.push(g("lng_edited")),i.join(" â€¢ ")}),[g,e]);return(0,ee.Y)(ci.A,{className:(0,me.A)("chat-item-clickable small-icon",xs.opacityFadeIn,(e.isUserBlocked||e.areStoriesBlocked)&&xs.blocked),onClick:A,rightElement:"user"===e.type&&e.reaction?(0,ee.Y)(Ls.A,{reaction:e.reaction,className:xs.viewReaction,size:Es,availableReactions:i,withIconHeart:!0}):void 0,contextActions:b,withPortalForMenu:!0,menuBubbleClassName:xs.menuBubble,children:(0,u.L8)(e.peerId)?(0,ee.Y)(Rs.A,{className:(0,me.A)(C&&xs.withColoredStatus),userId:e.peerId,noStatusOrTyping:!0,status:y,statusIcon:f,withStory:!0,forceShowSelf:!0}):(0,ee.Y)(Bs.A,{className:(0,me.A)(C&&xs.withColoredStatus),chatId:e.peerId,status:y,statusIcon:f,withStory:!0})},e.peerId)}))),_s=(0,s.ph)((0,n.EK)((e=>{const{appConfig:t}=e,{storyViewer:{viewModal:i}}=(0,c.nTw)(e),{storyId:s,views:n,nextOffset:a,isLoading:o}=i||{},r=s?(0,c.Msb)(e,e.currentUserId,s):void 0;return{storyId:s,views:n,viewersExpirePeriod:t.storyExpirePeriod+t.storyViewersExpirePeriod,story:r&&"content"in r?r:void 0,nextOffset:a,isLoading:o,availableReactions:e.reactions.availableReactions,isCurrentUserPremium:(0,c.g29)(e)}}))((function({story:e,viewersExpirePeriod:t,views:i,nextOffset:a,isLoading:r,isCurrentUserPremium:l}){const{loadStoryViewList:c,closeStoryViewModal:d,clearStoryViews:h}=(0,n.ko)(),[m,u,p]=(0,Y.A)(!1),[v,g,A]=(0,Y.A)(!0),[b,f]=(0,s.J0)(""),C=(0,M.A)(),y=Boolean(e),S=Boolean(e?.date)&&e.date+t<(0,li.Fm)(),{viewsCount:w=0,reactionsCount:k=0}=e?.views||{},N=e?.isPublic&&w>o.XQO,I=k>o.$4F,P=w>o.frj,F=N||I||P;(0,s.vJ)((()=>{y||(f(""),p(),g())}),[y]);const T=(0,Ae.A)((()=>{h({isLoading:!0})}),[],250,!0);(0,s.vJ)((()=>{T()}),[m,v,b,T]);const B=(0,s.Kr)((()=>i?.sort(function(e){return(t,i)=>{if(e){const e="user"===t.type&&t.reaction,s="user"===i.type&&i.reaction;if(e&&!s)return-1;if(!e&&s)return 1}return i.date-t.date}}(v))),[v,i]),R=B?.length?1:Math.min(w,8),L=Boolean(B?.length)&&B.length<w&&S,x=(0,D.A)((()=>{e?.id&&void 0!==a&&c({peerId:e.peerId,storyId:e.id,offset:a,areReactionsFirst:v||void 0,areJustContacts:m||void 0,query:b})})),{handleScroll:E,isAtBeginning:V}=Fs(),_=(0,D.A)((()=>{d()})),U=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.FD)(W.A,{fluid:!0,size:"tiny",color:"translucent",className:(0,me.A)(!t&&"active",xs.sortButton,xs.topButton),faded:t,onClick:e,ariaLabel:C("SortBy"),children:[(0,ee.Y)(q.A,{name:v?"heart-outline":"recent",className:xs.iconSort}),(0,ee.Y)(q.A,{name:"down",className:xs.iconDown})]})),[v,C]);return(0,ee.FD)(Z.A,{isOpen:y,onClose:_,className:"component-theme-dark",contentClassName:xs.viewsList,isSlim:!0,children:[F&&(0,ee.FD)("div",{className:xs.header,children:[N&&(0,ee.FD)("div",{className:xs.contactFilter,children:[(0,ee.Y)(W.A,{className:(0,me.A)(!m&&xs.selected,xs.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:p,children:C("AllViewers")}),(0,ee.Y)(W.A,{className:(0,me.A)(m&&xs.selected,xs.topButton),size:"tiny",color:"translucent-white",fluid:!0,onClick:u,children:C("Contacts")})]}),I&&(0,ee.FD)(le.A,{className:xs.sort,trigger:U,positionX:"right",children:[(0,ee.FD)(ce.A,{icon:"heart-outline",onClick:g,children:[C("SortByReactions"),v&&(0,ee.Y)(q.A,{name:"check",className:xs.check})]}),(0,ee.FD)(ce.A,{icon:"recent",onClick:A,children:[C("SortByTime"),!v&&(0,ee.Y)(q.A,{name:"check",className:xs.check})]})]}),P&&(0,ee.Y)(Ts.A,{className:xs.search,value:b,onChange:f})]}),(0,ee.FD)("div",{className:(0,me.A)(xs.content,!V&&xs.topScrolled,"custom-scroll"),onScroll:E,children:[S&&!r&&!b&&Boolean(!B?.length)&&(0,ee.Y)("div",{className:(0,me.A)(xs.info,xs.centeredInfo),children:(0,Ft.A)(C(l?"ServerErrorViewers":"ExpiredViewsStub"),["simple_markdown","emoji"])}),!r&&Boolean(b.length)&&!B?.length&&(0,ee.Y)("div",{className:xs.info,children:C("Story.ViewList.EmptyTextSearch")}),(0,ee.FD)(Ds.A,{items:B,onLoadMore:x,children:[B?.map((e=>{const t="forward"===e.type?e.messageId:"repost"===e.type?e.storyId:"user";return(0,ee.Y)(Vs,{storyView:e},`${e.peerId}-${e.date}-${t}`)})),r&&Array.from({length:R}).map(((e,t)=>(0,ee.Y)(ci.A,{className:"chat-item-clickable contact-list-item scroll-item small-icon",disabled:!0,children:(0,ee.Y)(Ms.A,{})},`placeholder-${t}`))),L&&(0,ee.Y)("div",{className:(0,me.A)(xs.info,xs.bottomInfo),children:C("Story.ViewList.NotFullyRecorded")},"not-all-available")]})]}),(0,ee.Y)("div",{className:(0,me.A)(xs.footer,"dialog-buttons"),children:(0,ee.Y)(W.A,{className:(0,me.A)("confirm-dialog-button",xs.close),isText:!0,onClick:_,children:C("Close")})})]})}))),Us=(0,s.ph)((0,n.EK)((e=>{const{shouldSkipHistoryAnimations:t,storyViewer:{storyId:i,peerId:s,isPrivacyModalOpen:n,origin:a}}=(0,c.nTw)(e),o=s&&i?(0,c.Msb)(e,s,i):void 0,r=(0,c.xYJ)(e,"mediaViewerAnimations");return{isOpen:(0,c.gd2)(e),shouldSkipHistoryAnimations:t,peerId:s,storyId:i,story:o,origin:a,withAnimation:r,isPrivacyModalOpen:n}}))((function({isOpen:e,peerId:t,storyId:i,story:a,origin:l,shouldSkipHistoryAnimations:c,withAnimation:d,isPrivacyModalOpen:u}){const{closeStoryViewer:p,closeStoryPrivacyEditor:v,reportStory:g}=(0,n.ko)(),b=(0,M.A)(),[f,C]=(0,s.J0)(void 0),[y,w,k]=(0,Y.A)(!1),{bestImageData:N,thumbnail:I}=ri(a),P=oi(),F=(0,V.A)(e),T=(0,V.A)(N),B=(0,V.A)(t),R=(0,V.A)(l),L=Boolean(d&&!c);(0,s.vJ)((()=>{e||(C(void 0),k())}),[e]),(0,s.vJ)((()=>{if(!e)return;(0,m.FD)();const t=(0,_.w4)();return()=>{(0,m.wb)(),t()}}),[e]);const x=(0,s.hb)((()=>{p()}),[p]),E=(0,D.A)((e=>{C(e),w()})),U=(0,D.A)((()=>{k(),C(void 0)})),O=(0,D.A)((()=>{i&&g({storyId:i,peerId:t})}));return(0,s.vJ)((()=>e?(0,h.A)((()=>{x()})):void 0),[x,e]),(0,s.vJ)((()=>{L&&!F&&e&&t&&I&&void 0!==l&&((0,s.VK)(250+o.xB5),function(e,t,i,s,n){const{mediaEl:a}=ni(t,e);if(!a)return;const{width:l,height:c}=S.A.get();let{width:d,height:h}=n;const m=l<=600;if(m){d=l-2*ii,h=c-ti-2*ii;const e=getComputedStyle(document.documentElement).getPropertyValue("--safe-area-bottom");e&&(h-=parseFloat(e))}const u=m?ii:(l-d)/2,p=m?ii:(c-(h+ti))/2,{top:v,left:g,width:b,height:f}=a.getBoundingClientRect(),C=g+b/2-(u+d/2),y=v+f/2-(p+h/2),w=b/d,k=f/h;(0,r.RK)((()=>{const e=si(s||i,!s);(0,A.ZM)(e,{top:`${p}px`,left:`${u}px`,width:`${d}px`,height:`${h}px`,transform:`translate3d(${C}px, ${y}px, 0) scale(${w}, ${k})`});const t=document.getElementById("StoryViewer");t.appendChild(e),document.body.classList.add("ghost-animating"),(0,r.RK)((()=>{(0,A.ZM)(e,{transform:""}),setTimeout((()=>{(0,r.RK)((()=>{t.contains(e)&&t.removeChild(e),document.body.classList.remove("ghost-animating")}))}),200+o.xB5)}))}))}(t,l,I,N,P.activeSlide)),L&&F&&!e&&B&&T&&void 0!==R&&((0,s.VK)(250+o.xB5),function(e,t,i){const{mediaEl:s}=ni(t,e),n=document.getElementById("StoryViewer").querySelector(`.${zt} .${Kt}, .${Ht} .${Kt}`);if(!n||!s)return;const{top:a,left:l,width:c,height:d}=n.getBoundingClientRect(),{top:h,left:m,width:u,height:p}=s.getBoundingClientRect(),v=m+u/2-(l+c/2),g=h+p/2-(a+d/2),b=u/c,f=p/d;(0,r.RK)((()=>{const e=si(i);(0,A.ZM)(e,{top:`${a}px`,left:`${l}px`,width:`${c}px`,height:`${d}px`});const t=si(s.src,void 0,!0),n=a+d/2-c/2;(0,A.ZM)(t,{top:`${n}px`,left:`${l}px`,width:`${c}px`,height:`${c}px`});const h=document.getElementById("StoryViewer");h.appendChild(e),document.body.appendChild(t),document.body.classList.add("ghost-animating"),(0,r.RK)((()=>{(0,A.ZM)(e,{transform:`translate3d(${v}px, ${g}px, 0) scale(${b}, ${f})`}),(0,A.ZM)(t,{transform:`translate3d(${v}px, ${g}px, 0) scale(${b})`,opacity:"1"}),setTimeout((()=>{(0,r.RK)((()=>{h.contains(e)&&h.removeChild(e),document.body.contains(t)&&document.body.removeChild(t),document.body.classList.remove("ghost-animating")}))}),200+o.xB5)}))}))}(B,R,T))}),[L,N,T,e,F,P.activeSlide,I,t,B,l,R]),(0,ee.FD)(ie.A,{id:"StoryViewer",className:"bu_hGbaa",isOpen:e,shouldAnimateFirstRender:!0,noCloseTransition:c,children:[(0,ee.Y)("div",{className:"OFh6u50Q",onClick:x}),(0,ee.Y)(W.A,{className:"Mye8Dwxa",round:!0,size:"smaller",color:"translucent-white",ariaLabel:b("Close"),onClick:x,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)(Ys,{isOpen:e,isDeleteModalOpen:y,onReport:O,onClose:x,onDelete:E}),(0,ee.Y)(gi,{isOpen:y,story:f,onClose:U}),(0,ee.Y)(_s,{}),(0,ee.Y)(pi,{}),(0,ee.Y)(Fi,{isOpen:u,onClose:v})]})})));var Os=i(79582),Ks=i(63527),Js=i(96374),Gs=i(79174),js=i(10328),zs=i(52745),Hs=i(34431),$s=i(38102),qs=i(45780);const Ws=2.75*p.$,Qs="ChatOrUserPicker-item",Zs=(0,s.ph)((({isOpen:e,currentUserId:t,chatOrUserIds:i,search:a,searchPlaceholder:r,className:d,loadMore:h,onSearchChange:m,onSelectChatOrUser:u,onClose:p,onCloseAnimationEnd:v,isLowStackPriority:g})=>{const{loadTopics:A}=(0,n.ko)(),b=(0,M.A)(),f=(0,s.li)(),C=(0,s.li)(),y=(0,s.li)(),S=(0,s.li)(),[w,k]=(0,Js.A)(h,i,Boolean(a)),[N,I]=(0,s.J0)(void 0),[P,Y]=(0,s.J0)(""),F=N?1:0,T=i.indexOf(w[0]),B=(0,D.A)((()=>{m("")}));(0,Gs.A)(y,e&&0===F,B),(0,Gs.A)(S,e&&1===F);const R=(0,D.A)((e=>{if(N)return(0,c.pSx)(e,N)})),L=(0,Ks.A)(R),[x,E]=(0,s.Kr)((()=>{const e=(0,n.mS)(),t=e.chats.byId,i=e.chats.fullInfoById,s=t[N];if(!s||!L)return[void 0,void 0];const a=P.toLowerCase(),o=L?Object.values(L).reduce(((e,t)=>(!(0,l.__)(s,t,void 0,i[N])||a&&!t.title.toLowerCase().includes(a)||(e[t.id]=t),e)),{}):L;return[Object.keys(o).map(Number),o]}),[N,P,L]),V=(0,D.A)((()=>{I(void 0),Y("")})),_=(0,D.A)((e=>{m(e.currentTarget.value)})),U=(0,D.A)((e=>{Y(e.currentTarget.value)})),O=(0,js.A)(f,e,(e=>{if(w&&w.length>0){const t=(0,n.mS)().chats.byId,i=w[-1===e?0:e],s=t[i];s?.isForum?(L||A({chatId:i}),I(i)):u(i)}}),`.${Qs}`,!0),K=(0,js.A)(C,e,(e=>{x?.length&&u(N,x[-1===e?0:e])}),`.${Qs}`,!0),J=(0,D.A)((e=>{const t=(0,n.mS)().chats.byId,i=t?.[e];i?.isForum?(L||A({chatId:e}),I(e),B()):u(e)})),G=(0,s.hb)(((e,i)=>{const s=(0,n.mS)(),a=(0,c.PVB)(s,e);if(!a)return;const r=a&&!(0,Yt.vj)(a)?a.isSelf:void 0,[d,h]=function(){if(!a)return;if(a.id===t)return[b("SavedMessagesInfo")];if((0,Yt.vj)(a))return[(0,l.sT)(b,a)];const e=(0,c.K0y)(s,a.id);return[(0,l.CD)(b,a,e),(0,me.A)((0,l.PF)(a,e,!0)&&"online")]}()||[];return(0,ee.Y)(qs.A,{className:Qs,title:(0,ee.Y)(Hs.A,{peer:a,isSavedMessages:r}),avatarElement:(0,ee.Y)(Dt.A,{peer:a,isSavedMessages:r,size:"medium"}),subtitle:d,subtitleClassName:h,ripple:!0,style:`top: ${(T+i)*o.xw7}px;`,onClick:()=>J(e)},e)}),[t,b,T]);return(0,ee.Y)(Z.A,{isOpen:e,className:(0,me.A)("ChatOrUserPicker",d),onClose:p,onCloseAnimationEnd:v,isLowStackPriority:g,children:(0,ee.Y)(se.Ay,{activeKey:F,name:"slideFade",slideClassName:"ChatOrUserPicker_slide",children:()=>1===F?(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"modal-header",dir:b.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:b("Back"),onClick:V,children:(0,ee.Y)(q.A,{name:"arrow-left"})}),(0,ee.Y)(Q.A,{ref:S,value:P,onChange:U,onKeyDown:K,placeholder:r})]}),(0,ee.FD)(Ds.A,{ref:C,className:"picker-list custom-scroll",items:x,withAbsolutePositioning:!0,maxHeight:56*(x?.length||0),onKeyDown:K,children:[!x&&(0,ee.Y)(zs.A,{}),x?.map(((e,t)=>(0,ee.Y)(qs.A,{className:Qs,onClick:()=>u(N,e),style:`top: ${56*(T+t)}px;`,avatarElement:(0,ee.Y)($s.A,{size:Ws,topic:E[e],className:"topic-icon",letterClassName:"topic-icon-letter"}),title:(0,Ft.A)(E[e].title)},`${N}_${e}`)))]})]}):(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"modal-header",dir:b.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:b("Close"),onClick:p,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)(Q.A,{ref:y,value:a,onChange:_,onKeyDown:O,placeholder:r})]}),w?.length?(0,ee.Y)(Ds.A,{ref:f,className:"picker-list custom-scroll",items:w,itemSelector:`.${Qs}`,onLoadMore:k,withAbsolutePositioning:!0,maxHeight:i.length*o.xw7,onKeyDown:O,children:w.map(G)}):w&&!w.length?(0,ee.Y)("p",{className:"no-results",children:b("lng_blocked_list_not_found")}):(0,ee.Y)(zs.A,{})]})})})})),Xs=(0,s.ph)((0,n.EK)((e=>{const{chats:{listIds:t,orderedPinnedIds:i},currentUserId:s}=e;return{activeListIds:t.active,archivedListIds:t.archived,pinnedIds:i.active,contactIds:e.contactList?.userIds,currentUserId:s}}))((({isOpen:e,currentUserId:t,activeListIds:i,archivedListIds:a,pinnedIds:r,contactIds:d,filter:h=o.K_A,className:m,searchPlaceholder:u,loadMore:p,onSelectRecipient:v,onClose:g,onCloseAnimationEnd:A,isLowStackPriority:b})=>{const[f,C]=(0,s.J0)(""),y=(0,s.Kr)((()=>{if(!e)return;let s=r||[];t&&(s=(0,fi.Am)([t,...s]));const o=(0,n.mS)(),m=[...i||[],...f&&a||[]].filter((e=>{const t=(0,c.hds)(o,e),i=(0,c.mBe)(o,e);if(i&&!(0,l.PL)(i))return!0;const s=(0,c.AWZ)(o,e);return t&&(!s||(0,l.__)(t,void 0,void 0,s))})),u=(0,Os.A)((0,Yt.PU)({ids:(0,fi.Am)([...t?[t]:[],...m,...d||[]]),query:f}),void 0,s,t);return(0,c.yMZ)(o,u,h)}),[r,t,i,f,a,d,h,e]),S=(0,Bi.A)(y,!0);return(0,ee.Y)(Zs,{isOpen:e,className:m,chatOrUserIds:S,currentUserId:t,searchPlaceholder:u,search:f,onSearchChange:C,loadMore:p,onSelectChatOrUser:v,onClose:g,onCloseAnimationEnd:A,isLowStackPriority:b})}))),en=(0,s.ph)((0,n.EK)((e=>{const{messageIds:t,storyId:i}=(0,c.nTw)(e).forwardMessages,s=t&&t.length>0;return{currentUserId:e.currentUserId,isManyMessages:(t?.length||0)>1,isStory:Boolean(i),isForwarding:s}}))((({isOpen:e,currentUserId:t,isManyMessages:i,isStory:a,isForwarding:o})=>{const{openChatOrTopicWithReplyInDraft:r,setForwardChatOrTopic:d,exitForwardMode:h,forwardToSavedMessages:m,forwardStory:p,showNotification:v}=(0,n.ko)(),g=(0,M.A)(),A=(0,V.A)(a,!0),[b,f,C]=(0,Y.A)();(0,s.vJ)((()=>{e&&f()}),[e,f]);const y=(0,s.hb)(((e,s)=>{const h=e===t;if(a){p({toChatId:e});const t=(0,n.mS)();if((0,u.L8)(e))v({message:h?g("Conversation.StoryForwardTooltip.SavedMessages.One"):g("StorySharedTo",(0,l.u0)((0,c.mBe)(t,e)))});else{const i=(0,c.hds)(t,e);if(!i)return;v({message:g("StorySharedTo",(0,l.Js)(g,i))})}}else if(h){const e=g(i?"Conversation.ForwardTooltip.SavedMessages.Many":"Conversation.ForwardTooltip.SavedMessages.One");m(),v({message:e})}else{const t=e,i=s?Number(s):void 0;o?d({chatId:t,topicId:i}):r({chatId:t,topicId:i})}}),[t,i,a,g,o]),S=(0,s.hb)((()=>{h()}),[h]);if(e||b)return(0,ee.Y)(Xs,{isOpen:e,className:A?"component-theme-dark":void 0,searchPlaceholder:g(o?"ForwardTo":"ReplyToDialog"),onSelectRecipient:y,onClose:S,onCloseAnimationEnd:C})}))),tn=(0,s.ph)((({requestedDraft:e})=>{const t=Boolean(e&&!e.chatId),{openChatWithDraft:i,resetOpenChatWithDraft:a}=(0,n.ko)(),o=(0,M.A)(),[r,l,c]=(0,Y.A)();(0,s.vJ)((()=>{t&&l()}),[t,l]);const d=(0,s.hb)(((t,s)=>{i({chatId:t,threadId:s,text:e.text,files:e.files})}),[i,e]),h=(0,s.hb)((()=>{a()}),[a]);if(t||r)return(0,ee.Y)(Xs,{isOpen:t,searchPlaceholder:o("ForwardTo"),filter:e?.filter,onSelectRecipient:d,onClose:h,onCloseAnimationEnd:c})})),sn=(0,s.ph)((({requestedAttachBotInChat:e})=>{const{cancelAttachBotInChat:t,callAttachBot:i}=(0,n.ko)(),a=(0,M.A)(),o=Boolean(e),[r,l,c]=(0,Y.A)();(0,s.vJ)((()=>{o&&l()}),[o,l]);const{bot:d,filter:h,startParam:m}=e||{},u=(0,s.hb)((e=>{i({bot:d,chatId:e,startParam:m}),t()}),[d,i,t,m]);if(o||r)return(0,ee.Y)(Xs,{isOpen:o,searchPlaceholder:a("Search"),filter:h,onSelectRecipient:u,onClose:t,onCloseAnimationEnd:c})}));var nn=i(99375);function an(e){return e.isSlowMode?"Slowmode enabled":e.hasErrorKey?"Something went wrong":"Telegram"}const on=(0,s.ph)((0,n.EK)((e=>({dialogs:(0,c.nTw)(e).dialogs,currentMessageList:(0,c.Xf0)(e)})))((({dialogs:e,currentMessageList:t})=>{const{dismissDialog:i,sendMessage:a}=(0,n.ko)(),[o,r,l]=(0,Y.A)(),c=(0,M.A)();var d,h,m;if((0,s.vJ)((()=>{e.length>0&&r()}),[e,r]),e.length)return Boolean(e.length)&&("phoneNumber"in(d=e[e.length-1])?(h=d,(0,ee.FD)(Z.A,{isOpen:o,onClose:l,className:"confirm",title:c("ShareYouPhoneNumberTitle"),onCloseAnimationEnd:i,children:[c("AreYouSureShareMyContactInfoBot"),(0,ee.FD)("div",{className:"dialog-buttons mt-2",children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:()=>{t&&(a({contact:h,messageList:t}),l())},children:c("OK")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:l,children:c("Cancel")})]})]})):(m=d,(0,ee.FD)(Z.A,{isOpen:o,onClose:l,onCloseAnimationEnd:i,className:"error",title:an(m),children:[m.hasErrorKey?(0,nn.Ay)(m):(0,Ft.A)(m.message,["simple_markdown","emoji","br"]),(0,ee.Y)("div",{className:"dialog-buttons mt-2",children:(0,ee.Y)(W.A,{isText:!0,onClick:l,children:c("OK")})})]})))})));var rn=i(17208);const ln=(0,s.ph)((0,n.EK)((e=>(0,fi.Up)((0,c.nTw)(e),["notifications"])))((({notifications:e})=>{if(e.length)return(0,ee.Y)("div",{id:"Notifications",children:e.map((e=>(0,ee.Y)(rn.A,{notification:e},e.localId)))})})));var cn=i(24585);const dn=(0,s.ph)((({url:e})=>{const{toggleSafeLinkModal:t}=(0,n.ko)(),i=(0,_i.A)(),a=(0,s.hb)((()=>{e&&(window.open((0,cn.Tc)(e),"_blank","noopener noreferrer"),t({url:void 0}))}),[t,e]),o=(0,s.hb)((()=>{t({url:void 0})}),[t]),r=(0,Bi.A)(e);return(0,ee.Y)(vi.A,{isOpen:Boolean(e),onClose:o,title:i("OpenUrlTitle"),textParts:(0,Ft.A)(i("OpenUrlText",{url:r},{withNodes:!0,withMarkdown:!0})),confirmLabel:i("OpenUrlConfirm"),confirmHandler:a})}));var hn=i(47526);const mn=(0,s.ph)((({modal:e})=>{const{closeMapModal:t}=(0,n.ko)(),{point:i,zoom:a}=e||{},o=(0,M.A)(),r=Boolean(i),l=(0,D.A)((()=>{t()})),[c,d,h,m]=(0,s.Kr)((()=>{if(!i)return[];const e=(0,hn.zS)("google",i,a),t=(0,hn.zS)("bing",i,a),s=(0,hn.zS)("osm",i,a);return[e,t,(0,hn.zS)("apple",i,a),s]}),[i,a]),u=(0,D.A)((e=>{t(),window.open(e,"_blank","noopener")})),p=(0,D.A)((()=>{u(c)})),v=(0,D.A)((()=>{u(d)})),g=(0,D.A)((()=>{u(h)})),A=(0,D.A)((()=>{u(m)}));return(0,ee.FD)(Z.A,{contentClassName:"VJDwJpsF",title:o("OpenMapWith"),isOpen:r,onClose:l,isSlim:!0,children:[(0,ee.FD)("div",{className:"aYO2C2Hx",children:[(b.pz||b.MP)&&(0,ee.Y)(W.A,{fluid:!0,size:"smaller",onClick:g,children:"Apple Maps"}),(0,ee.Y)(W.A,{fluid:!0,size:"smaller",onClick:p,children:"Google Maps"}),(0,ee.Y)(W.A,{fluid:!0,size:"smaller",onClick:v,children:"Bing Maps"}),(0,ee.Y)(W.A,{fluid:!0,size:"smaller",onClick:A,children:"OpenStreetMap"})]}),(0,ee.Y)("div",{className:"dialog-buttons mt-2",children:(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:l,children:o("Cancel")})})]})}));var un=i(19806);const pn=(0,s.ph)((0,n.EK)((e=>({currentUser:(0,c.mBe)(e,e.currentUserId)})))((({modal:e,currentUser:t})=>{const{closeUrlAuthModal:i,acceptBotUrlAuth:a,acceptLinkUrlAuth:o}=(0,n.ko)(),[r,c]=(0,s.J0)(!0),[d,h]=(0,s.J0)(!0),m=(0,Bi.A)(e,!1),{domain:u,botId:p,shouldRequestWriteAccess:v}=m?.request||{},g=p?(0,n.mS)().users.byId[p]:void 0,A=(0,M.A)(),b=(0,s.hb)((()=>{e?.url&&r?(e.button?a:o)({isWriteAllowed:d}):m?.url&&window.open((0,cn.Tc)(m.url),"_blank","noopener"),i()}),[e,r,i,a,o,d,m]),f=(0,s.hb)((()=>{i()}),[i]),C=(0,s.hb)((e=>{c(e),h(e)}),[c]);return(0,s.vJ)((()=>{u&&(c(!0),h(Boolean(v)))}),[v,u]),(0,ee.FD)(vi.A,{isOpen:Boolean(e?.url),onClose:f,title:A("OpenUrlTitle"),confirmLabel:A("OpenUrlTitle"),confirmHandler:b,children:[(0,Ft.A)(A("OpenUrlAlert2",m?.url),["links"]),u&&(0,ee.Y)(un.A,{className:"dialog-checkbox",checked:r,label:(0,ee.Y)(ee.FK,{children:(0,Ft.A)(A("Conversation.OpenBotLinkLogin",[u,(0,l.Yg)(t)]),["simple_markdown"])}),onCheck:C}),v&&(0,ee.Y)(un.A,{className:"dialog-checkbox",checked:d,label:(0,ee.Y)(ee.FK,{children:(0,Ft.A)(A("Conversation.OpenBotLinkAllowMessages",(0,l.Yg)(g)),["simple_markdown"])}),onCheck:h,disabled:!r})]})}))),vn=1e3*o.fRl,gn=["lng_weekday1","lng_weekday2","lng_weekday3","lng_weekday4","lng_weekday5","lng_weekday6","lng_weekday7"];function An(e,t,i,s,n){const a=new Date(e,t,i),o=s&&(0,ze.pU)(s),r=n&&(0,ze.pU)(n);return!!(r&&a>r)||!!(o&&a<o)}function bn(e){return String(e).padStart(2,"0")}function fn(e,t,i){return`${e}-${t+1}-${i}`}const Cn=(0,s.ph)((({selectedAt:e,minAt:t,maxAt:i,isFutureMode:n,isPastMode:a,isOpen:o,withTimePicker:r,submitButtonLabel:l,secondButtonLabel:c,onClose:d,onSubmit:h,onSecondButtonClick:m})=>{const u=(0,M.A)(),p=new Date,v=(0,s.Kr)((()=>n&&!t?new Date:new Date(Math.max(t||0,0))),[n,t]),g=(0,s.Kr)((()=>a&&!i?new Date:new Date(Math.min(i||vn,vn))),[a,i]),A=(0,s.Kr)((()=>e?new Date(e):new Date),[e]),b=(0,V.A)(o),[f,C]=(0,Y.A)(!1),[y,S]=(0,s.J0)(A),[w,k]=(0,s.J0)(new Date(y.getFullYear(),y.getMonth(),1)),[N,I]=(0,s.J0)(bn(A.getHours())),[P,F]=(0,s.J0)(bn(A.getMinutes())),D=fn(y.getFullYear(),y.getMonth(),y.getDate()),T=w.getFullYear(),B=w.getMonth(),R=n&&y.getTime()<v.getTime()||a&&y.getTime()>g.getTime();(0,s.vJ)((()=>{!b&&o&&(S(A),k(new Date(A.getFullYear(),A.getMonth(),1)),r&&(I(bn(A.getHours())),F(bn(A.getMinutes()))))}),[A,o,b,r]),(0,s.vJ)((()=>{n&&!f&&y.getTime()<v.getTime()&&(S(v),I(bn(v.getHours())),F(bn(v.getMinutes())))}),[n,f,v,y]),(0,s.vJ)((()=>{a&&!f&&y.getTime()>g.getTime()&&(S(g),I(bn(g.getHours())),F(bn(g.getMinutes())))}),[n,a,f,g,v,y]),(0,s.vJ)((()=>{if(e){const t=new Date(e);S(t),I(bn(t.getHours())),F(bn(t.getMinutes()))}}),[e]);const L=a&&T>=p.getFullYear()&&B>=p.getMonth()||g&&T>=g.getFullYear()&&B>=g.getMonth(),x=n&&T<=p.getFullYear()&&B<=p.getMonth(),{prevMonthGrid:E,currentMonthGrid:_,nextMonthGrid:U}=(0,s.Kr)((()=>function(e,t){const i=[],s=[],n=[],a=new Date;a.setDate(1),a.setMonth(t),a.setFullYear(e);const o=a.getDay()||7,r=new Date(e,t,0).getDate();for(let e=1;e<o;e++)i.push(r-o+e+1);for(;a.getMonth()===t;){const e=a.getDate();s.push(e),a.setDate(e+1)}const l=(s.length+i.length)%7;if(l>0)for(let e=1;e<=7-l;e++)n.push(e);return{prevMonthGrid:i,currentMonthGrid:s,nextMonthGrid:n}}(T,B)),[B,T]),O=(0,s.Kr)((()=>l||function(e,t){const i=(0,ze.A)(t,e.code);return i===(0,ze.A)(new Date,e.code)?e("Conversation.ScheduleMessage.SendToday",(0,ze.fU)(e,t)):e("Conversation.ScheduleMessage.SendOn",[i,(0,ze.fU)(e,t)])}(u,y)),[u,y,l]),K=(0,s.hb)((()=>{h(n&&y<v?v:a&&y>g?g:y)}),[n,a,v,g,h,y]),J=(0,s.hb)((e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return I(""),void(e.target.value="");const i=Math.max(0,Math.min(Number(t),23)),s=new Date(y.getTime());s.setHours(i),S(s);const n=bn(i);I(n),e.target.value=n}),[y]),G=(0,s.hb)((e=>{const t=e.target.value.replace(/[^\d]+/g,"");if(!t.length)return F(""),void(e.target.value="");const i=Math.max(0,Math.min(Number(t),59)),s=new Date(y.getTime());s.setMinutes(i),S(s);const n=bn(i);F(n),e.target.value=n}),[y]);return(0,ee.FD)(Z.A,{isOpen:o,onClose:d,className:"CalendarModal",onEnter:K,children:[(0,ee.Y)("div",{className:"container",children:(0,ee.FD)("div",{className:"month-selector",children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:d,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.FD)("h4",{children:[u(`lng_month${B+1}`)," ",T]}),(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",disabled:x,onClick:x?void 0:function(){k((e=>{const t=new Date(e);return t.setMonth(t.getMonth()-1),t}))},children:(0,ee.Y)(q.A,{name:"previous"})}),(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",disabled:L,onClick:L?void 0:function(){k((e=>{const t=new Date(e);return t.setMonth(t.getMonth()+1),t}))},children:(0,ee.Y)(q.A,{name:"next"})})]})}),(0,ee.Y)("div",{className:"calendar-wrapper",children:(0,ee.FD)("div",{className:"calendar-grid",children:[gn.map((e=>(0,ee.Y)("div",{className:"day-button faded weekday",children:(0,ee.Y)("span",{children:u(e)})}))),E.map((e=>(0,ee.Y)("div",{className:"day-button disabled",children:(0,ee.Y)("span",{children:e})}))),_.map((e=>(0,ee.Y)("div",{role:"button",tabIndex:0,onClick:()=>{return t=e,void S((e=>{const i=new Date(e);return i.setDate(t),i.setMonth(B),i.setFullYear(T),i}));var t},className:(0,me.A)("day-button","div-button",An(T,B,e,v,g)?"disabled":e?"clickable":"",D===fn(T,B,e)&&"selected"),children:Boolean(e)&&(0,ee.Y)("span",{children:e})}))),U.map((e=>(0,ee.Y)("div",{className:"day-button disabled",children:(0,ee.Y)("span",{children:e})})))]})}),r&&(0,ee.FD)("div",{className:"timepicker",children:[(0,ee.Y)("input",{type:"text",className:"form-control",inputMode:"decimal",value:N,onChange:J,onFocus:C}),":",(0,ee.Y)("input",{type:"text",className:"form-control",inputMode:"decimal",value:P,onChange:G,onFocus:C})]}),(0,ee.Y)("div",{className:"footer",children:(0,ee.FD)("div",{className:"footer",children:[(0,ee.Y)(W.A,{onClick:K,disabled:R,children:O}),c&&(0,ee.Y)(W.A,{onClick:m,isText:!0,children:c})]})})]})})),yn=(0,s.ph)((0,n.EK)((e=>({selectedAt:(0,c.nTw)(e).historyCalendarSelectedAt})))((({isOpen:e,selectedAt:t})=>{const{searchMessagesByDate:i,closeHistoryCalendar:a}=(0,n.ko)(),o=(0,s.hb)((e=>{i({timestamp:e.getTime()/1e3}),a()}),[a,i]),r=(0,M.A)();return(0,ee.Y)(Cn,{isOpen:e,selectedAt:t,isPastMode:!0,submitButtonLabel:r("JumpToDate"),onClose:a,onSubmit:o})})));var Sn=i(64713);const wn=(0,s.ph)((0,n.EK)(((e,{userId:t})=>({user:t?(0,c.mBe)(e,t):void 0,userStatus:t?(0,c.K0y)(e,t):void 0,phoneCodeList:e.countryList.phoneCodes})))((({isOpen:e,userId:t,isByPhoneNumber:i,user:a,userStatus:o,phoneCodeList:r})=>{const{updateContact:c,importContact:d,closeNewContactDialog:h}=(0,n.ko)(),m=(0,M.A)(),u=(0,Bi.A)(a),p=(0,Bi.A)(i),v=(0,s.li)(),[g,A,f]=(0,Y.A)(),[C,y]=(0,s.J0)(u?.firstName??""),[S,w]=(0,s.J0)(u?.lastName??""),[k,N]=(0,s.J0)(u?.phoneNumber??""),[I,P]=(0,s.J0)(!0),F=Boolean(C&&(!i||k));(0,s.vJ)((()=>{e&&(A(),y(u?.firstName??""),w(u?.lastName??""),N(u?.phoneNumber??""),P(!0))}),[e,A,u?.firstName,u?.lastName,u?.phoneNumber]),(0,s.vJ)((()=>{!b.TF&&g&&setTimeout((()=>{v.current?.focus()}),200)}),[g]);const D=(0,s.hb)((e=>{y(e.target.value)}),[]),T=(0,s.hb)((e=>{N((0,Sn.Ox)(r,e.target.value))}),[r]),B=(0,s.hb)((e=>{w(e.target.value)}),[]),R=(0,s.hb)((()=>{h(),y(""),w(""),N("")}),[h]),L=(0,s.hb)((()=>{i||!t?d({firstName:C,lastName:S,phoneNumber:k}):c({userId:t,firstName:C,lastName:S,shouldSharePhoneNumber:I})}),[C,d,i,S,k,I,c,t]);if(e||g)return(0,ee.FD)(Z.A,{className:"NewContactModal",title:m("NewContact"),isOpen:e,onClose:R,onCloseAnimationEnd:f,children:[u&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"NewContactModal__profile",dir:m.isRtl?"rtl":void 0,children:[(0,ee.Y)(Dt.A,{size:"jumbo",peer:u,text:`${C} ${S}`}),(0,ee.FD)("div",{className:"NewContactModal__profile-info",children:[(0,ee.Y)("p",{className:"NewContactModal__phone-number",children:u?.phoneNumber?(0,Sn.Ox)(r,u.phoneNumber):m("MobileHidden")}),(0,ee.Y)("span",{className:"NewContactModal__user-status",dir:"auto",children:(0,l.CD)(m,u,o)})]})]}),(0,ee.Y)(Q.A,{ref:v,value:C,label:m("FirstName"),tabIndex:0,onChange:D}),(0,ee.Y)(Q.A,{value:S,label:m("LastName"),tabIndex:0,onChange:B}),(0,ee.Y)("p",{className:"NewContactModal__help-text",children:(0,Ft.A)(m("NewContact.Phone.Hidden.Text",u?.firstName||""),["emoji","simple_markdown"])}),(0,ee.Y)(un.A,{className:"dialog-checkbox",checked:I,tabIndex:0,onCheck:P,label:m("lng_new_contact_share")}),(0,ee.Y)("p",{className:"NewContactModal__help-text NewContactModal__help-text__negative",children:(0,Ft.A)(m("AddContact.SharedContactExceptionInfo",u?.firstName))})]}),p&&(0,ee.FD)("div",{className:"NewContactModal__new-contact",dir:m.isRtl?"rtl":void 0,children:[(0,ee.Y)(Dt.A,{size:"jumbo",text:`${C} ${S}`}),(0,ee.FD)("div",{className:"NewContactModal__new-contact-fieldset",children:[(0,ee.Y)(Q.A,{ref:v,value:k,inputMode:"tel",label:m("lng_contact_phone"),tabIndex:0,onChange:T}),(0,ee.Y)(Q.A,{value:C,label:m("FirstName"),tabIndex:0,onChange:D}),(0,ee.Y)(Q.A,{value:S,label:m("LastName"),tabIndex:0,onChange:B})]})]}),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",disabled:!F,onClick:L,children:m("Done")}),(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:R,children:m("Cancel")})]})]})})));var kn=i(20179),Nn=i(30708),In=i(48894),Pn=i(71322),Yn=i(32625),Fn=i(10722);let Dn=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.TopLeft=4]="TopLeft",e[e.TopRight=5]="TopRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomRight=7]="BottomRight",e}({});const Mn={top:Dn.Top,bottom:Dn.Bottom,left:Dn.Left,right:Dn.Right,topLeft:Dn.TopLeft,topRight:Dn.TopRight,bottomLeft:Dn.BottomLeft,bottomRight:Dn.BottomRight},Tn=Object.keys(Mn);let Bn;const Rn={x:0,y:0};var Ln=i(36838);const xn=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e).webApps,{botId:i}=(0,c.ES7)(e)||{},{modalState:s,openedWebApps:n}=t||{},a="minimized"===s;return{activeTabBot:i?(0,c.mBe)(e,i):void 0,isMinimizedState:a,openedWebApps:n}}))((({activeTabBot:e,isMinimizedState:t,openedWebApps:i})=>{const{changeWebAppModalState:a,closeWebAppModal:o}=(0,n.ko)(),r=(0,M.A)(),l=(0,_i.A)(),d=(0,s.li)(),h=(0,s.Kr)((()=>i&&Object.values(i)),[i]),m=h?.length,u=(0,s.Kr)((()=>{if(!m)return[];const t=(0,n.mS)(),i=e?.id;return(0,fi.Am)([i,...h.map((e=>e.botId))]).map((e=>e&&(0,c.mBe)(t,e))).filter(Boolean).slice(0,3)}),[m,e,h]),p=(0,D.A)((()=>{o()})),v=(0,D.A)((()=>{a({state:"maximized"})}));if(t)return(0,ee.FD)("div",{ref:d,className:(0,me.A)("kUZmBlnN"),children:[(0,ee.Y)(W.A,{className:"SMRJmUuE",round:!0,color:"translucent",size:"tiny",ariaLabel:r("Close"),onClick:p,children:(0,ee.Y)(q.A,{className:"P0P4gW6a",name:"close"})}),(0,ee.Y)(As.A,{className:"GP17QhNN",size:"mini",peers:u}),function(){const e=u.length>0&&u[0]?.firstName,t=m&&e&&m>1?l("MiniAppsMoreTabs",{botName:e,count:m-1},{pluralValue:m-1}):e;return(0,ee.Y)("div",{className:"TZFjRaG4",children:t})}(),(0,ee.Y)(W.A,{className:(0,me.A)("Rax9j_TK","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:v,children:(0,ee.Y)(q.A,{className:"sdbTXCxq",name:"expand-modal"})})]})})));var En=i(59852),Vn=i(84991);const _n={container:"RFg0Ey2I","user-count-badge":"UZtJ6ZXb",userCountBadge:"UZtJ6ZXb","user-badge-icon":"pTiZFhsG",userBadgeIcon:"pTiZFhsG",name:"TzA5nqCC"},Un=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>({user:(0,c.mBe)(e,t)})))((function({user:e,isPopularApp:t}){const{requestMainWebView:i}=(0,n.ko)(),s=(0,_i.A)(),a=(0,D.A)((()=>{if(!e)return;const t=e?.id;if(!t)return;const s=(0,En.A)();i({botId:t,peerId:t,theme:s})}));if(!e)return;const o=e?.firstName,r=e?.botActiveUsers,l=r&&t?(0,He.Vw)(s,r):void 0;return(0,ee.Y)("div",{className:_n.container,onClick:a,children:(0,ee.Y)(Vn.A,{className:(0,me.A)(_n.avatarContainer,t&&"PopularAppGridItem"),textClassName:_n.name,badgeClassName:_n.userCountBadge,badgeIconClassName:_n.userBadgeIcon,peer:e,text:o,badgeText:l,badgeIcon:"user-filled"})})}))),On={root:"BJV09FsC",search:"bdi8G7GR","section-title":"ex3kxgWX",sectionTitle:"ex3kxgWX","section-content":"uIZzLhEh",sectionContent:"uIZzLhEh",showMoreLink:"h_Zs9ypA"},Kn=(0,ve.nF)((e=>e()),500,!0),Jn=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e).globalSearch,i=t.popularBotApps?.peerIds;return{isLoading:!i&&t.fetchingStatus?.botApps,foundIds:i,recentBotIds:e.topBotApps.userIds}}))((({foundIds:e,recentBotIds:t})=>{const i=(0,M.A)(),o=(0,_i.A)(),[r,l]=(0,s.J0)(!1),{searchPopularBotApps:c}=(0,n.ko)(),d=(0,D.A)((()=>{l((e=>!e))})),[h,m]=(0,s.J0)(""),u=(0,s.Kr)((()=>e?(0,Yt.PU)({ids:e,query:h,type:"user"}):[]),[e,h]),p=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&Kn((()=>{c()}))}),[]),v=(0,s.hb)((()=>{m("")}),[]);return(0,ee.FD)(Ds.A,{className:(0,me.A)(On.root,"custom-scroll"),items:u,onLoadMore:p,itemSelector:".PopularAppGridItem",noFastList:!0,preloadBackwards:30,children:[(0,ee.Y)(Ts.A,{className:On.search,value:h,onChange:m,onReset:v,placeholder:o("SearchApps")}),t&&!h&&(0,ee.FD)("div",{className:On.section,children:[(0,ee.FD)("div",{className:On.sectionTitle,children:[(0,ee.Y)("span",{children:i("SearchAppsMine")}),(0,ee.Y)("span",{className:On.showMoreLink,onClick:d,children:i(r?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")})]}),(0,ee.Y)("div",{className:On.sectionContent,children:t.map(((e,t)=>{if(r||!(t>=5))return(0,ee.Y)(Un,{chatId:e})}))})]}),(0,ee.FD)("div",{className:On.section,children:[(0,ee.Y)("div",{className:On.sectionTitle,children:o(h?"Apps":"PopularApps")}),(0,ee.Y)("div",{className:On.sectionContent,children:u&&u.map((e=>(0,ee.Y)(Un,{chatId:e,isPopularApp:!h})))})]})]})}))),Gn=3.675*p.$,jn="jEAibDyh",zn="ablUg8HU",Hn="Wrl63uWL",$n="vOFiAq3l",qn="KwI4XdkC",Wn="oq6HKJur",Qn="a0AI_he5",Zn="MvCwTbk_",Xn=250,ea=["allow-scripts","allow-same-origin","allow-popups","allow-forms","allow-modals","allow-storage-access-by-user-activation"].join(" "),ta={ok:"OK",cancel:"Cancel",close:"Close"},ia=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const i=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:s}=i||{},n=t?.modalState,a=s?e.attachMenu.bots[s]:void 0,o=s?(0,c.mBe)(e,s):void 0,r=s?(0,c.vGo)(e,s):void 0,l=r?.botInfo?.appSettings,d=e.currentUserId?(0,c.mBe)(e,e.currentUserId):void 0,h=(0,c.SJA)(e),{isPaymentModalOpen:m,status:u}=(0,c.nTw)(e).payment,{status:p,inputInvoice:v}=(0,c.nTw)(e).starsPayment,g=o?(0,c.XOs)(e,o.id):void 0,A=p||u;return{attachBot:a,bot:o,currentUser:d,theme:h,isPaymentModalOpen:m||Boolean(v),paymentStatus:A,modalState:n,botAppPermissions:g,botAppSettings:l}}))((({modal:e,webApp:t,bot:i,theme:a,isPaymentModalOpen:r,paymentStatus:c,registerSendEventCallback:d,registerReloadFrameCallback:h,isTransforming:m,modalState:u,isMultiTabSupported:p,onContextMenuButtonClick:v,botAppPermissions:g,botAppSettings:A,modalHeight:f})=>{const{closeActiveWebApp:C,sendWebViewData:y,toggleAttachBot:S,openTelegramLink:w,setWebAppPaymentSlug:k,switchBotInline:N,sharePhoneWithBot:P,updateWebApp:F,resetPaymentStatus:T,openChatWithInfo:B,showNotification:R,openEmojiStatusAccessModal:L,openLocationAccessModal:x,changeWebAppModalState:E,closeWebAppModal:V,openPreparedInlineMessageModal:_}=(0,n.ko)(),[U,O]=(0,s.J0)(),[K,J]=(0,s.J0)(),[j,z,H]=(0,Y.A)(!1),[$,Q]=(0,s.J0)(),[X,te]=(0,s.J0)(!1),[ie,ne]=(0,s.J0)(!1),[ae,oe]=(0,s.J0)(),[re,le]=(0,s.J0)(),{unlockPopupsAt:ce,handlePopupOpened:de,handlePopupClosed:he}=function(){const[e,t]=(0,s.J0)(0),i=(0,s.li)(0),n=(0,s.li)(0),a=(0,D.A)((()=>{const e=Date.now();e-n.current>2e3&&(i.current=0),i.current+=1,i.current>=3&&t(e+2e3)})),o=(0,D.A)((()=>{e<Date.now()&&(n.current=Date.now())}));return{unlockPopupsAt:e,handlePopupOpened:a,handlePopupClosed:o}}(),ue=(0,s.li)(),pe=(0,s.li)(),ve=(0,s.li)(),ge="fullScreen"===u,Ae="minimized"===u,be=(0,D.A)((()=>{setTimeout((()=>{E({state:"maximized"})}),350)})),fe=(0,s.li)();(0,s.vJ)((()=>{fe.current=document.querySelector("#portals")}),[]);const[,Ce,ye]=(0,Se.Ay)(fe,be),ke=e?.activeWebAppKey?e.openedWebApps[e.activeWebAppKey]:void 0,Ne=ke?.appName,{url:Ie,buttonText:Pe,isBackButtonVisible:Ye}=t||{},{placeholderPath:Fe}=A||{},De=Boolean(t?.isCloseModalOpen),Me=Boolean(t?.isRemoveModalOpen),Te=t&&(0,kn.rp)(t),Be=ke&&(0,kn.rp)(ke),Re=ke&&t&&Be===Te,Le=b.H$,Ee=void 0!==g?.geolocation,Ve=Boolean(g?.geolocation),_e=(0,D.A)((e=>{Te&&F({key:Te,update:e})})),Ue=(0,s.Kr)((()=>(0,En.A)()),[a]);(0,s.vJ)((()=>{le(Ue.secondary_bg_color)}),[Ue]);const Oe=Ue.bg_color,[Ke,Je]=(0,s.J0)(),Ge="light"===a?A?.backgroundColor:A?.backgroundDarkColor;(0,s.vJ)((()=>{_e({backgroundColor:Ke||Ge||Oe})}),[Oe,Ke,Ge]);const je=Ue.bg_color,[ze,He]=(0,s.J0)(),$e="light"===a?A?.headerColor:A?.headerDarkColor;(0,s.vJ)((()=>{_e({headerColor:ze||$e||je})}),[je,ze,$e]);const qe=(0,s.li)(),We=(0,M.A)(),Ze=(0,_i.A)(),Xe=e?.isModalOpen||!1,et=Boolean(Pe),{reloadFrame:tt,sendEvent:it,sendFullScreenChanged:st,sendViewport:nt,sendSafeArea:at,sendTheme:ot}=((e,t,i,a,o,r,c)=>{const{showNotification:d,setWebAppPaymentSlug:h,openInvoice:m,closeWebApp:u,openSuggestedStatusModal:p,updateWebApp:v}=(0,n.ko)(),g=(0,s.li)(!1),A=(0,s.li)(),b=(0,s.li)(!1),f=(0,s.li)(),C=(0,we.A)();(0,s.vJ)((()=>{if(!e.current||!t)return;const i=()=>{c?.()},s=e.current;return s.addEventListener("load",i),()=>{s.removeEventListener("load",i)}}),[c,e,t]);const y=(0,s.hb)((t=>{e.current?.contentWindow&&e.current.contentWindow.postMessage(JSON.stringify(t),"*")}),[e]),S=(0,s.hb)((e=>{y({eventType:"fullscreen_changed",eventData:{is_fullscreen:e}})}),[y]),w=(0,D.A)((t=>{if(!e.current)return;const i=e.current;i.src="about:blank",i.addEventListener("load",(()=>{i.src=t}),{once:!0})})),k=(0,s.hb)((e=>{if(g.current)return y({eventType:"reload_iframe"}),void(A.current=setTimeout((()=>{w(e)}),500));w(e)}),[y]),N=(0,s.hb)((t=>{if(!e.current)return;const{width:i,height:s}=e.current.getBoundingClientRect();y({eventType:"viewport_changed",eventData:{width:i,height:s,is_expanded:!0,is_state_stable:!t}})}),[y,e]),I=(0,s.hb)((()=>{e.current&&(y({eventType:"safe_area_changed",eventData:{left:0,right:0,top:0,bottom:0}}),y({eventType:"content_safe_area_changed",eventData:{left:0,right:0,top:i?Gn:0,bottom:0}}))}),[y,i,e]),P=(0,s.hb)((()=>{y({eventType:"theme_changed",eventData:{theme_params:(0,En.A)()}})}),[y]),Y=(0,s.hb)((e=>{y({eventType:"set_custom_style",eventData:e})}),[y]),F=(0,s.hb)((t=>{if(b.current)return;const i=e.current?.contentWindow;if(i===t.source)try{const e=JSON.parse(t.data),{eventType:i,eventData:s}=e;if("web_app_ready"===i&&c?.(),"web_app_close"===i&&r){const e=(0,l.rp)(r);u({key:e,skipClosingConfirmation:!0})}if("web_app_request_viewport"===i&&N(C.isResizing),"web_app_request_safe_area"===i&&I(),"web_app_request_content_safe_area"===i&&I(),"web_app_request_theme"===i&&P(),"iframe_ready"===i){const e=getComputedStyle(document.body).getPropertyValue("--color-scrollbar");Y("* {\n  scrollbar-width: thin;\n  scrollbar-color: %SCROLLBAR_COLOR% transparent;\n}\n\n*::-webkit-scrollbar {\n  width: 6px;\n  height: 6px;\n  background-color: transparent;\n}\n\n*::-webkit-scrollbar-thumb {\n  border-radius: 6px;\n  background-color: %SCROLLBAR_COLOR%;\n}\n\n*::-webkit-scrollbar-corner {\n  background-color: transparent;\n}".replace(/%SCROLLBAR_COLOR%/g,e)),g.current=Boolean(s.reload_supported)}if("iframe_will_reload"===i&&clearTimeout(A.current),"web_app_data_send"===i){if(!a)return;b.current=!0}if("web_app_read_text_from_clipboard"===i&&y({eventType:"clipboard_text_received",eventData:{req_id:s.req_id,data:null}}),"web_app_open_scan_qr_popup"===i&&d({message:"Scanning QR code is not supported in this client yet"}),"web_app_open_invoice"===i&&(h({slug:s.slug}),m({type:"slug",slug:s.slug})),"web_app_open_link"===i){const e=s.url;window.open(e,"_blank","noreferrer")}if("web_app_biometry_get_info"===i&&y({eventType:"biometry_info_received",eventData:{available:!1}}),"web_app_device_storage_clear"===i||"web_app_device_storage_get_key"===i||"web_app_device_storage_save_key"===i){const{req_id:e}=s;y({eventType:"device_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_secure_storage_clear"===i||"web_app_secure_storage_get_key"===i||"web_app_secure_storage_restore_key"===i||"web_app_secure_storage_save_key"===i){const{req_id:e}=s;y({eventType:"secure_storage_failed",eventData:{req_id:e,error:"UNSUPPORTED"}})}if("web_app_start_accelerometer"===i&&y({eventType:"accelerometer_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_gyroscope"===i&&y({eventType:"gyroscope_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_start_device_orientation"===i&&y({eventType:"device_orientation_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_add_to_home_screen"===i&&y({eventType:"home_screen_failed",eventData:{error:"UNSUPPORTED"}}),"web_app_check_home_screen"===i&&y({eventType:"home_screen_checked",eventData:{status:"unsupported"}}),"web_app_set_emoji_status"===i){const{custom_emoji_id:e,duration:t}=s;if(!e||"string"!=typeof e)return void y({eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}});if(t)try{BigInt(t)}catch(e){return void y({eventType:"emoji_status_failed",eventData:{error:"DURATION_INVALID"}})}if(!r)return void y({eventType:"emoji_status_failed",eventData:{error:"UNKNOWN_ERROR"}});p({webAppKey:(0,l.rp)(r),customEmojiId:e,duration:Number(t),botId:r.botId})}o(e)}catch(e){}}),[a,y,o,Y,r,P,N,I,c,C.isResizing,e]);return(0,s.vJ)((()=>{const{width:e,height:t,isResizing:i}=C;f.current&&f.current.width===e&&f.current.height===t&&!f.current.isResizing||(f.current={width:e,height:t,isResizing:i},N(i))}),[N,I,C]),(0,s.vJ)((()=>{r?.plannedEvents?.length&&(r.plannedEvents.forEach((e=>{y(e)})),v({key:(0,l.rp)(r),update:{plannedEvents:[]}}))}),[y,r]),(0,s.vJ)((()=>(window.addEventListener("message",F),()=>window.removeEventListener("message",F))),[F,e]),(0,s.vJ)((()=>{t&&e.current?.contentWindow?(N(),I(),b.current=!1):f.current=void 0}),[t,i,N,I,e]),{sendEvent:y,sendFullScreenChanged:S,reloadFrame:k,sendViewport:N,sendSafeArea:I,sendTheme:P}})(qe,Xe,ge,et,(function(e){const{eventType:t,eventData:s}=e;if("web_app_request_fullscreen"===t&&((0,I.cB)()?E({state:"fullScreen"}):it({eventType:"fullscreen_failed",eventData:{error:"UNSUPPORTED"}})),"web_app_exit_fullscreen"===t&&bt(),"web_app_open_tg_link"===t){const e=o.jsp+s.path_full;w({url:e,shouldIgnoreCache:s.force_request}),C()}if("web_app_setup_back_button"===t&&_e({isBackButtonVisible:s.is_visible}),"web_app_setup_settings_button"===t&&_e({isSettingsButtonVisible:s.is_visible}),"web_app_set_background_color"===t&&Je((0,En.To)(s.color)?s.color:void 0),"web_app_set_header_color"===t){const e=s.color_key;He(s.color||(e?Ue[e]:void 0))}if("web_app_set_bottom_bar_color"===t&&le(s.color),"web_app_data_send"===t&&(C(),y({bot:i,buttonText:Pe,data:s.data})),"web_app_setup_main_button"===t){const e=s.color,t=s.text_color;O({isVisible:s.is_visible&&Boolean(s.text?.trim().length),isActive:s.is_active,text:s.text,color:e,textColor:t,isProgressVisible:s.is_progress_visible})}if("web_app_setup_secondary_button"===t){const e=s.color,t=s.text_color;J({isVisible:s.is_visible&&Boolean(s.text?.trim().length),isActive:s.is_active,text:s.text,color:e,textColor:t,isProgressVisible:s.is_progress_visible,position:s.position})}if("web_app_setup_closing_behavior"===t&&_e({shouldConfirmClosing:!0}),"web_app_open_popup"===t){if($||!s.message.trim().length||!s.buttons?.length||s.buttons.length>3||X||ie||ce>Date.now())return void pt(void 0);Q(s),de()}if("web_app_switch_inline_query"===t){const e=s.chat_types?.map(l.Xj).filter(Boolean),t=!e?.length;N({botId:i.id,query:s.query,filter:e,isSamePeer:t}),C()}if("web_app_request_phone"===t){if($||ie||ce>Date.now())return void St();te(!0),de()}if("web_app_request_write_access"===t){if($||X||ce>Date.now())return void Nt();!async function(){if(!i)return;const e=await(0,Qe.px)("fetchBotCanSendMessage",{bot:i});e&&it({eventType:"write_access_requested",eventData:{status:"allowed"}}),ne(!e)}(),de()}if("web_app_invoke_custom_method"===t){const{method:e,params:t,req_id:n}=s;!async function(e,t,s){const n=await(0,Qe.px)("invokeWebViewCustomMethod",{bot:i,customMethod:t,parameters:s});it({eventType:"custom_method_invoked",eventData:{req_id:e,...n}})}(n,e,JSON.stringify(t))}if("web_app_request_file_download"===t){if(ae||ce>Date.now())return void kt();!async function(e,t){await(0,Qe.px)("checkBotDownloadFileParams",{bot:i,url:e,fileName:t})?(oe({url:e,fileName:t}),de()):it({eventType:"file_download_requested",eventData:{status:"cancelled"}})}(s.url,s.file_name)}if("web_app_send_prepared_message"===t){if(!i||!Te)return;const{id:e}=s;_({botId:i.id,messageId:e,webAppKey:Te})}if("web_app_request_emoji_status_access"===t){if(!i)return;L({bot:i,webAppKey:Te})}"web_app_check_location"===t&&it({eventType:"location_checked",eventData:{available:Le,access_requested:Ee,access_granted:Ve}}),"web_app_request_location"===t&&(async()=>{const e=await(0,b.Bu)(),{accessRequested:t,accessGranted:s,geolocation:n}=e;if(!s||!t)return it({eventType:"location_requested",eventData:{available:!1}}),R({message:We("PermissionNoLocationPosition")}),void pt(void 0);Le?Ee?it({eventType:"location_requested",eventData:{available:Boolean(g?.geolocation),latitude:n?.latitude,longitude:n?.longitude,altitude:n?.altitude,course:n?.heading,speed:n?.speed,horizontal_accuracy:n?.accuracy,vertical_accuracy:n?.altitudeAccuracy}}):x({bot:i,webAppKey:Te}):(R({message:We("PermissionNoLocationPosition")}),pt(void 0))})(),"web_app_open_location_settings"===t&&Yt()}),t,z);(0,s.vJ)((()=>{Re&&d(it)}),[it,d,Re]),(0,s.vJ)((()=>{Re&&h(tt)}),[tt,h,Re]);const rt=j&&U?.isVisible&&U.text.trim().length>0,lt=j&&K?.isVisible&&K.text.trim().length>0,ct=(0,D.A)((()=>{_e({isCloseModalOpen:!1})})),dt=(0,D.A)((()=>{_e({shouldConfirmClosing:!1,isCloseModalOpen:!1}),setTimeout((()=>{C()}),400)})),ht=(0,D.A)((()=>{_e({isRemoveModalOpen:!1})})),mt=(0,D.A)((()=>{it({eventType:"main_button_pressed"})})),ut=(0,D.A)((()=>{it({eventType:"secondary_button_pressed"})})),pt=(0,D.A)((e=>{Q(void 0),he(),it({eventType:"popup_closed",eventData:{button_id:e}})})),vt=(0,D.A)((()=>{pt()})),gt=(0,D.A)((()=>{ot()}));(0,G.A)((()=>{setTimeout((()=>{gt()}),400)}),[a]);const At=(0,D.A)((()=>{!(0,Se.j9)()&&Re&&Ce?.()})),bt=(0,D.A)((()=>{(0,Se.j9)()&&Re&&ye?.()})),ft=(0,D.A)((e=>{Re&&st(e)}));(0,s.vJ)((()=>{ge?(At(),ft(!0)):(bt(),ft(!1))}),[ge]);const Ct=(0,D.A)((e=>{it({eventType:"visibility_changed",eventData:{is_visible:e}})}));(0,s.vJ)((()=>{j&&Ct(Boolean(Re))}),[Re,j]),(0,wi.A)((([e])=>{"minimized"===u&&Ct(!1),u&&"minimized"===e&&Ct(!0)}),[u]),(0,G.A)((([e])=>{r!==e&&t?.slug&&!r&&c&&(it({eventType:"invoice_closed",eventData:{slug:t.slug,status:c}}),k({slug:void 0}),T())}),[r,c,it,t?.slug]);const yt=(0,D.A)((()=>{S({botId:i.id,isEnabled:!1}),C()})),St=(0,D.A)((()=>{te(!1),he(),it({eventType:"phone_requested",eventData:{status:"cancelled"}})})),wt=(0,D.A)((()=>{P({botId:i.id}),te(!1),he(),it({eventType:"phone_requested",eventData:{status:"sent"}})})),kt=(0,D.A)((e=>{e&&(oe(void 0),he()),it({eventType:"file_download_requested",eventData:{status:"cancelled"}})})),Nt=(0,D.A)((()=>{it({eventType:"write_access_requested",eventData:{status:"cancelled"}}),ne(!1),he()})),It=(0,D.A)((async()=>{i&&(await(0,Qe.px)("allowBotSendMessages",{bot:i})?(it({eventType:"write_access_requested",eventData:{status:"allowed"}}),ne(!1),he()):Nt())})),Pt=(0,D.A)((()=>{ae&&(oe(void 0),he(),(0,Li.A)(ae.url,ae.fileName),it({eventType:"file_download_requested",eventData:{status:"downloading"}}))}));(0,s.vJ)((()=>{Xe||(Q(void 0),te(!1),ne(!1),O(void 0),J(void 0),_e({isSettingsButtonVisible:!1,shouldConfirmClosing:!1,isBackButtonVisible:!1,isCloseModalOpen:!1,isRemoveModalOpen:!1}),H())}),[Xe]);const Yt=(0,D.A)((()=>{B({id:i.id})})),Dt=(0,Bi.A)(U?.color,!0),Mt=(0,Bi.A)(U?.textColor,!0),Tt=(0,Bi.A)(U&&Boolean(U.isActive),!0),Bt=(0,Bi.A)(U?.text,!0),Rt=(0,Bi.A)(K?.position,!0),Lt=(0,Bi.A)(K?.color,!0),xt=(0,Bi.A)(K?.textColor,!0),Et=(0,Bi.A)(K&&Boolean(K.isActive),!0),Vt=(0,Bi.A)(K?.text,!0),[_t,Ut]=(0,s.J0)(!1),[Ot,Kt]=(0,s.J0)(!0),[Jt,Gt]=(0,s.J0)(!0),[jt,zt]=(0,s.J0)(!1),[Ht,$t]=(0,s.J0)(!1),[qt,Wt]=(0,s.J0)(!1),[Qt,Zt]=(0,s.J0)(0);(0,G.A)((()=>{setTimeout((()=>{nt(),at()}),m?0:400)}),[Ht,Jt,jt,jt,K?.position,nt,m,f,at]);const Xt="top"===Rt||"bottom"===Rt,ei=Xt&&jt&&Ht?2:jt||Ht?1:0,ti=Xt||Ot||Jt?"vertical":"horizontal",ii=(0,s.li)(),si=(0,s.li)(),ni=(0,s.li)(),ai=(0,s.li)(),oi=(0,s.li)();(0,s.vJ)((()=>(ge&&Xe&&Boolean(Ne)?(Wt(!0),oi.current&&clearTimeout(oi.current),oi.current=setTimeout((()=>{Wt(!1),oi.current=void 0}),3800)):(Wt(!1),oi.current&&(clearTimeout(oi.current),oi.current=void 0)),()=>{oi.current&&clearTimeout(oi.current)})),[ge,Xe,Ne]),(0,s.vJ)((()=>{ii.current&&clearTimeout(ii.current),si.current&&clearTimeout(si.current),rt&&(si.current=setTimeout((()=>{zt(!0)}),35),Kt(!1),ii.current=setTimeout((()=>{Ut(!0)}),Xn)),rt||(zt(!1),ii.current=setTimeout((()=>{Kt(!0)}),Xn))}),[rt]),(0,s.vJ)((()=>{ni.current&&clearTimeout(ni.current),ai.current&&clearTimeout(ai.current),lt&&(ai.current=setTimeout((()=>{$t(!0)}),35),Gt(!1),ni.current=setTimeout((()=>{Ut(!0)}),Xn)),lt||($t(!1),ni.current=setTimeout((()=>{Gt(!0)}),Xn))}),[lt]),(0,s.vJ)((()=>{Ht||jt||Ut(!1)}),[Ut,Ht,jt]);const ri=m?"pointer-events: none;":"",li=(0,D.A)((()=>{Ye?it({eventType:"back_button_pressed"}):(bt(),st(!1),E({state:"maximized"}),V())})),ci=(0,D.A)((()=>{bt()})),di=(0,D.A)((e=>{v(e)})),hi=(0,me.A)("BvNtfigU",Ye&&"rC2wkMIk"),mi=qt?Ne:We(Ye?"Back":"Close"),ui=ve?.current;return(0,s.vJ)((()=>{Zt(ve?.current?.clientWidth||0)}),[mi,ui]),(0,ee.FD)("div",{ref:ue,className:(0,me.A)("LeeJZdwH",!Re&&$n,p&&"ESsGT5OD"),children:[ge&&(0,I.cB)()&&(0,ee.FD)("div",{className:"eYrhewMy",children:[(0,ee.FD)("div",{ref:pe,className:Zn,onClick:li,children:[(0,ee.Y)("div",{className:"JXsuZ01s",children:(0,ee.Y)("div",{className:hi})}),(0,ee.Y)("span",{className:"dpZR3YT7",style:`width: ${Qt}px;`,children:(0,ee.Y)(se.Ay,{activeKey:qt?0:Ye?1:2,name:"slideFade",children:(0,ee.Y)("div",{ref:ve,className:"dWDprnWa",children:mi})})})]}),(0,ee.FD)("div",{className:"Tl4_05AQ",children:[(0,ee.Y)("div",{className:(0,me.A)(Zn,"emOpAMBm"),tabIndex:0,role:"button","aria-label":Ze("WebAppCollapse"),onClick:ci,children:(0,ee.Y)(q.A,{name:"down",className:Qn})}),(0,ee.Y)("div",{className:(0,me.A)(Zn,"z4C5VD5o"),tabIndex:0,role:"button","aria-haspopup":"menu","aria-label":Ze("AriaMoreButton"),onClick:di,children:(0,ee.Y)(q.A,{name:"more",className:(0,me.A)(Qn,"T58ozRyW")})})]})]}),!Ae&&(Fe?(0,ee.Y)("svg",{className:(0,me.A)(jn,j&&Hn),viewBox:"0 0 512 512",children:(0,ee.Y)("path",{className:"Gx1BIECZ",d:Fe})}):function(){const e=(0,me.A)(jn,"Ig_t1R7i",j&&Hn);return(0,ee.FD)("div",{className:e,children:[(0,ee.Y)("div",{className:zn}),(0,ee.Y)("div",{className:zn}),(0,ee.Y)("div",{className:zn}),(0,ee.Y)("div",{className:zn})]})}()),(0,ee.Y)("iframe",{className:(0,me.A)("OmY14FFl",_t&&"liDRl1xT",!j&&Hn),style:ri,src:Ie,title:`${i?.firstName} Web App`,sandbox:ea,allow:"camera; microphone; geolocation; clipboard-write;",allowFullScreen:!0,ref:qe}),!Ae&&(0,ee.FD)("div",{style:`background-color: ${re};`,className:(0,me.A)("mR_hsBdT","left"===Rt&&"ntESqwQ_","right"===Rt&&"q6IUFEL0","top"===Rt&&"gb4iHJ9H","bottom"===Rt&&"R_bh3GF8","horizontal"===ti&&"oYaRA7u4",1===ei&&"YfQO314y",2===ei&&"gUldkEoy"),children:[(0,ee.FD)(W.A,{className:(0,me.A)("ypxiUCFQ",Ht&&!Jt&&qn,Jt&&$n),fluid:!0,style:`background-color: ${Lt}; color: ${xt}`,disabled:!Et&&!K?.isProgressVisible,nonInteractive:K?.isProgressVisible,onClick:ut,size:"smaller",children:[!K?.isProgressVisible&&Vt,K?.isProgressVisible&&(0,ee.Y)(xe.A,{className:Wn,color:"blue"})]}),(0,ee.FD)(W.A,{className:(0,me.A)("U_ggDKn1",jt&&!Ot&&qn,Ot&&$n),fluid:!0,style:`background-color: ${Dt}; color: ${Mt}`,disabled:!Tt&&!U?.isProgressVisible,nonInteractive:U?.isProgressVisible,onClick:mt,size:"smaller",children:[!U?.isProgressVisible&&Bt,U?.isProgressVisible&&(0,ee.Y)(xe.A,{className:Wn,color:"white"})]})]}),$&&(0,ee.FD)(Z.A,{isOpen:Boolean($),title:$.title||"Â ",onClose:vt,hasCloseButton:!0,className:(0,me.A)("YEOURXza",!$.title?.trim().length&&"gvljUzY9"),children:[$.message,(0,ee.Y)("div",{className:"dialog-buttons mt-2",children:$.buttons.map((e=>(0,ee.Y)(W.A,{className:"confirm-dialog-button",color:"destructive"===e.type?"danger":"primary",isText:!0,size:"smaller",onClick:()=>pt(e.id),children:e.text||We(ta[e.type])},e.id||e.type)))})]}),(0,ee.Y)(vi.A,{isOpen:X,onClose:St,title:We("ShareYouPhoneNumberTitle"),text:We("AreYouSureShareMyContactInfoBot"),confirmHandler:wt,confirmLabel:We("ContactShare")}),(0,ee.Y)(vi.A,{isOpen:ie,onClose:Nt,title:We("lng_bot_allow_write_title"),text:We("lng_bot_allow_write"),confirmHandler:It,confirmLabel:We("lng_bot_allow_write_confirm")}),(0,ee.Y)(vi.A,{isOpen:Boolean(ae),title:We("BotDownloadFileTitle"),textParts:Ze("BotDownloadFileDescription",{bot:i?.firstName,filename:ae?.fileName},{withNodes:!0,withMarkdown:!0}),confirmLabel:We("BotDownloadFileButton"),onClose:kt,confirmHandler:Pt}),(0,ee.Y)(vi.A,{isOpen:De,onClose:ct,title:We("lng_bot_close_warning_title"),text:We("lng_bot_close_warning"),confirmHandler:dt,confirmIsDestructive:!0,confirmLabel:We("lng_bot_close_warning_sure")}),(0,ee.Y)(vi.A,{isOpen:Me,onClose:ht,title:We("BotRemoveFromMenuTitle"),textParts:(0,Ft.A)(We("BotRemoveFromMenu",i?.firstName),["simple_markdown"]),confirmHandler:yt,confirmIsDestructive:!0})]})}))),sa="oHX2d8Or",na="O4NxErFX",aa="dgdyQDsZ",oa="xGefqS93",ra="f7EicoVH",la="s6pBIYMI",ca="txS0KiU0",da="XpHR_yo0",ha="DoeOewUR",ma="YRMGpqUS",ua="b13oE9uA",pa={width:300,height:40},va={width:420,height:730},ga={width:300,height:300},Aa=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const i=t?.activeWebAppKey?(0,c.wtp)(e,t.activeWebAppKey):void 0,{botId:s}=i||{},n=s?e.attachMenu.bots[s]:void 0,a=s?(0,c.mBe)(e,s):void 0,o=(0,c.meB)(e),r=(0,c.SJA)(e),{miniAppsCachedPosition:l,miniAppsCachedSize:d}=(0,Nn.l)(e);return{attachBot:n,bot:a,chat:o,theme:r,cachedPosition:l,cachedSize:d}}))((({modal:e,chat:t,bot:i,attachBot:a,theme:r,cachedSize:l,cachedPosition:c})=>{const{closeActiveWebApp:d,closeWebAppModal:h,prolongWebView:m,toggleAttachBot:u,openChat:p,changeWebAppModalState:v,openWebAppTab:g,updateWebApp:A,openMoreAppsTab:b,closeMoreAppsTab:f,updateMiniAppCachedPosition:C,updateMiniAppCachedSize:y}=(0,n.ko)(),[w,k]=(0,s.Ul)(l||va);function N(){return"fullScreen"===e?.modalState?S.A.get():"maximized"===e?.modalState?w():pa}const{openedWebApps:P,activeWebAppKey:F,openedOrderedKeys:T,sessionKeys:B,isMoreAppsTabActive:R}=e||{},L=F?P?.[F]:void 0,{isBackButtonVisible:x,headerColor:E,backgroundColor:V,isSettingsButtonVisible:_}=L||{},U=(0,s.Kr)((()=>T?.map((e=>{const t=P[e];return{bot:(0,n.mS)().users.byId[t.botId],webApp:t,isOpen:Boolean(L&&e===(0,kn.rp)(L))}}))),[T,P,L]),{isMobile:O}=(0,I.Ay)(),K=e?.isModalOpen||!1,J="maximized"===e?.modalState,G="minimized"===e?.modalState,j="fullScreen"===e?.modalState,z=!O,H=(0,s.li)(),$=(0,s.li)(),Q=(0,s.li)(),X=(0,D.A)((()=>H.current)),te=(0,D.A)((()=>H.current)),ie=(0,D.A)((()=>Q.current)),{isContextMenuOpen:se,contextMenuAnchor:ne,handleContextMenu:ae,handleContextMenuClose:oe,handleContextMenuHide:re}=(0,Fn.A)(H),[de,he]=(0,s.J0)(!1),pe=$.current,ve=H.current;(0,s.vJ)((()=>{he(Boolean(z&&pe&&ve&&!j))}),[z,pe,ve,j]),(0,s.vJ)((()=>{v({state:"maximized"})}),[z]);const{isDragging:ge,isResizing:Ae,style:be,size:fe,position:Ce}=function(e,t,i=!0,n,a=!1,r={width:0,height:0},l){const[c,d]=(0,s.J0)(l),[h,m]=(0,s.J0)(void 0),[u,p]=(0,s.Ul)({x:0,y:0}),[v,g]=(0,s.Ul)({width:0,height:0}),[A,b]=(0,s.Ul)({x:0,y:0}),f=u(),C=A(),y=e.current,S=t.current,[w,k]=(0,Y.A)(!1),[N,I]=(0,Y.A)(!1),[P,F,M]=(0,Y.A)(!1),[T,B,R]=(0,Y.A)(!1),[L,x,E]=(0,Y.A)(!1),[V,_]=(0,s.J0)(void 0);function U(){return{width:window.innerWidth,height:window.innerHeight}}const O=(0,D.A)((e=>{a||d({x:e.x,y:e.y})})),K=(0,D.A)((()=>a?Rn:c)),J=(0,D.A)((()=>{if(!h)return;const{width:e,height:t}=h,i=U();return{x:(i.width-e)/2,y:(i.height-t)/2}}));(0,s.vJ)((()=>{y&&I()}),[y]),(0,s.vJ)((()=>{if(!w&&h){const e=J();if(!e)return;O(e),k()}}),[h,w,y]);const G=(0,D.A)((e=>{if(e instanceof MouseEvent&&0!==e.button)return;if(e.target.closest(".no-drag")||!y)return;const{x:t,y:i}=(0,Ve.A)(e),{left:s,top:n}=y.getBoundingClientRect();p({x:s,y:n}),b({x:t,y:i}),F()})),j=(0,D.A)((e=>{if(e instanceof MouseEvent&&0!==e.button)return;const t=e.target;if(!y||!t)return;const i=function(e){const t=t=>e.closest(t);if(t(o.cnh))for(const e of Tn)if(t(`.${e}`))return Mn[e]}(t);if(void 0===i)return;_(i);const{x:s,y:n}=(0,Ve.A)(e),{left:a,right:r,top:l,bottom:c}=y.getBoundingClientRect();p({x:a,y:l}),g({width:r-a,height:c-l}),b({x:s,y:n}),B()})),z=(0,D.A)((()=>{M()})),H=(0,D.A)((()=>{R()}));(0,s.vJ)((()=>{i||M()}),[i]);const $=(e,t)=>{const i=U(),s=i.width,n=i.height,a=h.width,o=h.height;let r=e,l=t;return r<0&&(r=0),l<0&&(l=0),r+a>s&&(r=s-a),l+o>n&&(l=n-o),{x:r,y:l}},q=(0,D.A)((()=>{if(a)return;const e=N||l?c:J();if(!h||!e)return;const t=$(e.x,e.y);O(t)})),W=(0,D.A)((e=>{const t=e,i=U(),s=n.width,a=n.height;return t.width=Math.min(i.width,Math.max(s,t.width)),t.height=Math.min(i.height,Math.max(a,t.height)),t}));(0,s.vJ)((()=>{if(T)return;const e=W({width:n.width,height:n.height});e&&m(e)}),[n,T]);const Q=(0,D.A)((()=>{if(!h||T)return;const e=W(h);e&&m(e)}));(0,s.vJ)((()=>{T||q()}),[h,T]),(0,s.vJ)((()=>{const e=()=>{x(),Q(),q(),Bn&&(clearTimeout(Bn),Bn=void 0),Bn=window.setTimeout((()=>{Bn=void 0,E()}),250)};return window.addEventListener("resize",e),()=>{clearTimeout(Bn),Bn=void 0,window.removeEventListener("resize",e)}}),[q]);const Z=(0,D.A)((e=>{if(!P||!y)return;const{x:t,y:i}=(0,Ve.A)(e),s=t-C.x,n=i-C.y,a=f.x+s,o=f.y+n;h&&d($(a,o))})),X=(0,D.A)((e=>{if(!T||!y||void 0===V)return;const{x:t,y:i}=(0,Ve.A)(e),s=v(),n=Math.min(Math.max(0,t),U().width),a=Math.min(Math.max(0,i),U().height),o=n-C.x,l=a-C.y,c=f.x+s.width-r.width,h=f.y+s.height-r.height,u={x:f.x,y:f.y,width:s.width,height:s.height};V!==Dn.Left&&V!==Dn.TopLeft&&V!==Dn.BottomLeft||(u.width=Math.max(s.width-o,r.width),u.x=Math.min(u.x+o,c)),V!==Dn.Right&&V!==Dn.TopRight&&V!==Dn.BottomRight||(u.width=Math.max(s.width+o,r.width)),V!==Dn.Top&&V!==Dn.TopLeft&&V!==Dn.TopRight||(u.height=Math.max(s.height-l,r.height),u.y=Math.min(u.y+l,h)),V!==Dn.Bottom&&V!==Dn.BottomLeft&&V!==Dn.BottomRight||(u.height=Math.max(s.height+l,r.height)),m({width:u.width,height:u.height}),d({x:u.x,y:u.y})}));(0,s.vJ)((()=>{let e;return S&&i&&(e=(0,ue.wJ)(S,{onCapture:G,onDrag:Z,onRelease:z,onClick:z,onDoubleClick:z})),e}),[i,S]),(0,s.vJ)((()=>{const e=[];if(y&&i)for(const t of Tn){const i=y.querySelector(`.resizeHandle.${t}`);if(i){const t=(0,ue.wJ)(i,{onCapture:j,onDrag:X,onRelease:H,onClick:H,onDoubleClick:H});t&&e.push(t)}}return()=>{e.forEach((e=>e()))}}),[i,y]);const ee=P?"cursor: grabbing !important; ":"",te=K();if(!w||!h||!te)return{isDragging:!1,style:ee};const ie=(0,Di.A)(`left: ${te.x}px;`,`top: ${te.y}px;`,!a&&`max-width: ${h.width}px;`,!a&&`max-height: ${h.height}px;`,"position: fixed;",(P||T||L)&&"transition: none !important;",ee);return{position:c,size:h,isDragging:P,isResizing:T,style:ie}}(H,$,de,N(),j,function(){if("maximized"===e?.modalState)return ga}(),c),ye=Ce?.x,Se=Ce?.y;(0,s.vJ)((()=>{ge||void 0===ye||void 0===Se||C({position:{x:ye,y:Se}})}),[ge,ye,Se]),(0,s.vJ)((()=>{!ge&&fe&&J&&y({size:fe})}),[ge,J,fe]);const we=fe||N(),ke=we.width,Ne=we.height;(0,s.vJ)((()=>{Ae&&k({width:ke,height:Ne})}),[Ne,ke,Ae,k]);const Ie=(0,M.A)(),Pe=(0,_i.A)(),{queryId:Ye}=L||{},Fe=P?Object.values(P).length:0;(0,Yn.A)((()=>{P&&Object.keys(P).forEach((e=>{const i=P[e];i.queryId&&m({botId:i.botId,queryId:i.queryId,peerId:i.peerId||t.id,replyInfo:i.replyInfo})}))}),Ye?45e3:void 0,!0);const De=(0,s.li)(null),Me=(0,s.li)(null),Te=(0,D.A)((e=>{De.current=e})),Be=(0,D.A)((e=>{De.current&&De.current(e)})),Re=(0,D.A)((e=>{Me.current=e})),Le=(0,D.A)((e=>{Me.current&&Me.current(e)})),xe=(0,D.A)((()=>{Be({eventType:"settings_button_pressed"})})),Ee=(0,D.A)((()=>{Le(L.url)})),_e=(0,D.A)((()=>{h()})),Ue=(0,D.A)((()=>{f()})),Oe=(0,D.A)((()=>{Fe>1?d():h()})),Ke=(0,D.A)((()=>{if(a){const e=(0,kn.rp)(L);A({key:e,update:{isRemoveModalOpen:!0}})}else u({botId:i.id,isEnabled:!0})})),Je=(0,D.A)((()=>{x?Be({eventType:"back_button_pressed"}):_e()})),Ge=(0,D.A)((()=>{v({state:"minimized"})})),je=(0,D.A)((()=>{v({state:"fullScreen"})})),ze=(0,D.A)((()=>{b()})),He=(0,D.A)((e=>{g({webApp:e.webApp})})),qe=(0,D.A)((()=>{p({id:i.id})})),We=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.Y)(W.A,{className:(0,me.A)(z?"gkji2_RB":"kKPD09tc",t&&"active"),round:!0,ripple:!O,size:z?"tiny":"smaller",color:"translucent",onClick:e,ariaLabel:"More actions",children:(0,ee.Y)(q.A,{name:"more"})})),[O,z]);function Qe(){return(0,ee.FD)(ee.FK,{children:[t&&i&&t.id!==i.id&&(0,ee.Y)(ce.A,{icon:"bots",onClick:qe,children:Ie("BotWebViewOpenBot")}),(0,ee.Y)(ce.A,{icon:"reload",onClick:Ee,children:Ie("WebApp.ReloadPage")}),_&&(0,ee.Y)(ce.A,{icon:"settings",onClick:xe,children:Ie("Settings")}),i?.isAttachBot&&(0,ee.Y)(ce.A,{icon:a?"stop":"install",onClick:Ke,destructive:Boolean(a),children:Ie(a?"WebApp.RemoveBot":"WebApp.AddToAttachmentAdd")})]})}function Ze(){return(0,ee.Y)($e.A,{isOpen:se,anchor:ne,ref:Q,className:(0,me.A)(z?ca:"web-app-more-menu","with-menu-transitions"),getTriggerElement:X,getMenuElement:ie,getRootElement:te,autoClose:!0,onClose:oe,onCloseAnimationEnd:re,children:Qe()})}const Xe=(0,me.A)("RuJ3d9N6",x&&"IWA50OWU"),et=(0,s.Kr)((()=>{if(R)return"color-text";if(!E)return;const{r:e,g:t,b:i}=(0,Pn.E2)(E),s=(0,In.LS)([e,t,i]);return("dark"===r?255-s:s)>128?"color-text":"color-background"}),[E,r,R]);function tt(e){return(0,ee.Y)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:(0,ee.Y)("path",{className:"bOuMHiVw","fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 16V0C16 12 12 16 0 16H16Z"})})}const it=(0,s.li)();function st(e){return(0,me.A)(o.jQ1,e)}return(0,Ln.A)(it,!K||G||!it.current),(0,ee.FD)(Z.A,{dialogRef:H,className:(0,me.A)("XWfkIDLY",z&&"gBVR7Hec",G&&"dJ1Ld_PX",j&&"ciSTWz16"),dialogStyle:z?be:void 0,dialogContent:de&&!G?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{className:st("top")}),(0,ee.Y)("div",{className:st("bottom")}),(0,ee.Y)("div",{className:st("left")}),(0,ee.Y)("div",{className:st("right")}),(0,ee.Y)("div",{className:st("topLeft")}),(0,ee.Y)("div",{className:st("topRight")}),(0,ee.Y)("div",{className:st("bottomLeft")}),(0,ee.Y)("div",{className:st("bottomRight")})]}):void 0,isOpen:K,isLowStackPriority:!0,onClose:_e,header:(0,ee.Y)("div",{ref:$,children:z?J?(0,ee.FD)("div",{className:(0,me.A)("modal-header","multiTab"),style:(0,Di.A)(et&&`--color-header-text: var(--${et})`),children:[(0,ee.Y)(W.A,{className:"GE5AkJOU",round:!0,color:"translucent",size:"tiny",ariaLabel:Ie(x?"Back":"Close"),onClick:Je,children:(0,ee.Y)("div",{className:Xe})}),(0,ee.FD)("div",{className:"X18WbDa5",ref:it,children:[U?.map((e=>e.isOpen?function(){const e=(0,Di.A)(et&&`--color-header-text: var(--${et})`,E&&`--active-tab-background: ${E}`);return(0,ee.FD)("div",{className:sa,style:e,children:[tt(ra),(0,ee.FD)("div",{className:na,children:[(0,ee.FD)("div",{className:"z39ojrWc",children:[(0,ee.Y)(Dt.A,{size:"mini",peer:i}),(0,ee.Y)(We,{onTrigger:ae,isOpen:se})]}),a?.shortName??i?.firstName,(0,ee.Y)("div",{className:aa}),(0,ee.Y)(W.A,{className:oa,round:!0,color:"translucent",size:"tiny",ariaLabel:Ie("Close"),onClick:Oe,children:(0,ee.Y)(q.A,{className:ha,name:"close"})})]}),tt(la)]})}():(0,ee.Y)(Dt.A,{className:"tI6TE6HP",size:"mini",peer:e.bot,onClick:()=>He(e)}))),R&&(0,ee.FD)("div",{className:sa,children:[tt(ra),(0,ee.FD)("div",{className:na,children:[(0,ee.Y)("div",{className:"Obu3ui67",children:(0,ee.Y)(q.A,{className:ua,name:"add"})}),Pe("OpenApp"),(0,ee.Y)("div",{className:aa}),(0,ee.Y)(W.A,{className:oa,round:!0,color:"translucent",size:"tiny",ariaLabel:Ie("Close"),onClick:Ue,children:(0,ee.Y)(q.A,{className:ha,name:"close"})})]}),tt(la)]})]}),Ze(),(0,ee.FD)("div",{className:"qK4q0Sat",children:[!R&&(0,ee.Y)(W.A,{className:(0,me.A)("cEuW1_hJ","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:ze,children:(0,ee.Y)(q.A,{className:ua,name:"add"})}),!R&&(0,ee.Y)(W.A,{className:(0,me.A)(da,"otlJULGy","no-drag"),round:!0,color:"translucent",size:"tiny",onClick:je,children:(0,ee.Y)(q.A,{className:ma,name:"expand-modal"})}),(0,ee.Y)(W.A,{className:(0,me.A)(da,"no-drag"),round:!0,color:"translucent",size:"tiny",onClick:Ge,children:(0,ee.Y)(q.A,{className:ma,name:"collapse-modal"})})]})]}):(0,ee.Y)(xn,{}):(0,ee.FD)("div",{className:"modal-header",style:(0,Di.A)(E&&`background-color: ${E}`,et&&`--color-header-text: var(--${et})`),children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Ie(x?"Back":"Close"),onClick:Je,children:(0,ee.Y)("div",{className:Xe})}),(0,ee.Y)("div",{className:"modal-title",children:a?.shortName??i?.firstName}),!R&&(0,ee.Y)(le.A,{className:(0,me.A)(z?ca:"web-app-more-menu","with-menu-transitions"),trigger:We,positionX:z?"left":"right",children:Qe()})]})}),style:`background-color: ${V||"var(--color-background)"}`,noBackdrop:!0,noBackdropClose:!0,children:[j&&Ze(),P&&B?.map((t=>(0,ee.Y)(ia,{modal:e,registerSendEventCallback:Te,registerReloadFrameCallback:Re,webApp:P[t],isTransforming:ge||Ae,onContextMenuButtonClick:ae,isMultiTabSupported:z,modalHeight:Ne},t))),R&&(0,ee.Y)(Jn,{})]})}))),ba=(0,s.ph)((({bot:e,type:t,shouldRequestWriteAccess:i})=>{const{cancelBotTrustRequest:a,markBotTrusted:o}=(0,n.ko)(),[r,c]=(0,s.J0)(i||!1),d=(0,M.A)(),h=(0,s.hb)((()=>{o({botId:e.id,isWriteAllowed:r})}),[o,r,e]),m=(0,s.hb)((()=>{a()}),[]),u=d("game"===t?"AppName":"BotOpenPageTitle"),p=(0,s.Kr)((()=>{switch(t){case"game":return d("BotPermissionGameAlert",(0,l.Yg)(e));case"webApp":return d("BotOpenPageMessage",(0,l.Yg)(e));default:return d("BotWebViewStartPermission")}}),[e,t,d]);return(0,ee.FD)(vi.A,{isOpen:Boolean(e),onClose:m,title:u,confirmHandler:h,children:[(0,Ft.A)(p,["simple_markdown"]),i&&(0,ee.Y)(un.A,{className:"dialog-checkbox",checked:r,label:(0,Ft.A)(d("WebApp.AddToAttachmentAllowMessages",e?.firstName),["simple_markdown"]),onCheck:c})]})})),fa=(0,s.ph)((({modal:e})=>{const{confirmAttachBotInstall:t,cancelAttachBotInstall:i}=(0,n.ko)(),a=e?.bot,[r,l]=(0,s.J0)(!1),c=(0,M.A)(),d=(0,s.hb)((()=>{t({isWriteAllowed:Boolean(a?.shouldRequestWriteAccess)})}),[t,a]);(0,s.vJ)((()=>{a&&l(!1)}),[a]);const h=(0,s.Kr)((()=>{const e=c("lng_mini_apps_disclaimer_button").split("{link}"),t=c("lng_mini_apps_disclaimer_link");return[e[0],(0,ee.Y)("a",{href:o.Pje,target:"_blank",rel:"noopener noreferrer",children:t}),e[1]]}),[c]);return(0,ee.FD)(vi.A,{isOpen:Boolean(a),onClose:i,title:c("lng_mini_apps_disclaimer_title"),confirmHandler:d,isConfirmDisabled:!r,children:[(0,Ft.A)(c("lng_mini_apps_disclaimer_text",a?.shortName),["simple_markdown"]),(0,ee.Y)(un.A,{className:"dialog-checkbox",checked:r,label:h,onCheck:l}),(0,Ft.A)(c("WebBot.Account.Desclaimer.Desc",a?.shortName),["simple_markdown"])]})})),Ca=(0,s.ph)((({folder:e})=>{const{closeDeleteChatFolderModal:t,deleteChatFolder:i,openDeleteChatFolderModal:a}=(0,n.ko)(),o=(0,M.A)(),r=Boolean(e),l=(0,V.A)(e)||e,c=l?.hasMyInvites,d=(0,s.hb)((()=>{t(),c?a({folderId:l.id,isConfirmedForChatlist:!0}):i({id:l.id})}),[c,l]);return(0,ee.Y)(vi.A,{isOpen:r,onClose:t,text:o(c?"FilterDeleteAlertLinks":"FilterDeleteAlert"),confirmLabel:o("Delete"),confirmHandler:d,confirmIsDestructive:!0})}));var ya=i(64520),Sa=i(17142),wa=i(87412);const ka={root:"Wn7D2H1e",text:"IQ1U2TrZ",header:"F6qqXRvD",description:"ILLaH6qQ",icon:"DzGwbpu5","font-icon":"Pa9h5mh3",fontIcon:"Pa9h5mh3"},Na=["#F2862D","#EB7B4D","#E46D72","#DD6091","#CC5FBA","#B464E7","#9873FF","#768DFF","#55A5FC","#52B0C9","#4FBC93","#4CC663"].map(Pn.E2),Ia=(0,s.ph)((({icon:e,isFontIcon:t,title:i,text:s,index:n,count:a,section:o,onClick:r})=>{const l=n/a*Na.length,c=Na[Math.floor(l)],d=Na[Math.ceil(l)]??c,{r:h,g:m,b:u}=(0,Pn.dD)(c,d,.5),p=(0,D.A)((()=>{r?.(o)}));return(0,ee.FD)(ci.A,{buttonClassName:ka.root,onClick:p,inactive:!r,children:[t?(0,ee.Y)(q.A,{name:e,className:ka.fontIcon,style:`--item-color: rgb(${h},${m},${u})`}):(0,ee.Y)("img",{src:e,className:ka.icon,alt:"",style:`--item-color: rgb(${h},${m},${u})`,draggable:!1}),(0,ee.FD)("div",{className:ka.text,children:[(0,ee.Y)("div",{className:ka.title,children:(0,Ft.A)(i,["br"])}),(0,ee.Y)("div",{className:ka.description,children:s})]})]})}));var Pa=i(57446);const Ya="cqNhvdib",Fa="wDzTWXzO",Da=(0,s.ph)((({length:e,active:t,onSelectSlide:i})=>{const n=Math.max(0,Math.min(e-8,t-4)),a=n===e-8-1,o=n===e-8,r=0===n,l=1===n,c=Math.min(e,8),d=(0,s.hb)((()=>{i(t+1)}),[t,i]),h=(0,s.hb)((()=>{i(t-1)}),[t,i]),m=Math.min(8,e);return(0,ee.FD)("div",{children:[!b.TF&&(0,ee.Y)(W.A,{className:(0,me.A)(Ya,0===t&&Fa),color:"translucent",disabled:0===t,round:!0,onClick:h,children:(0,ee.Y)(q.A,{name:"previous"})}),(0,ee.Y)("div",{className:"HmY1pYD9",style:`--start-from: ${n}; --length: ${e}; --count: ${m};`,children:Array(e).fill(void 0).map(((e,s)=>{const d=s,h=s===n+c-1&&!o&&!a,m=s===n+c-2&&!a&&!o||s===n+c-1&&a,u=s===n&&!r&&!l,p=s===n+1&&!r&&!l||s===n&&l,v=s<n||s>=n+c;return(0,ee.Y)("div",{onClick:()=>i(s),className:(0,me.A)("Ac0pMX9w",d===t&&"NYDxCNdz",(m||p)&&"yDo_8Y7X",(h||u||v)&&"bhODNwmU",v&&"O9pyrgj0")})}))}),!b.TF&&(0,ee.Y)(W.A,{className:(0,me.A)(Ya,t===e-1&&Fa,"hIgQCprt"),color:"translucent",round:!0,disabled:t===e-1,onClick:d,children:(0,ee.Y)(q.A,{name:"next"})})]})})),Ma="Hy5kWx0p",Ta=(0,s.ph)((({leftValue:e,rightValue:t,className:i,floatingBadgeIcon:s,rightStyle:n})=>{const a=(0,M.A)();return(0,ee.FD)("div",{className:(0,me.A)("u84X0r2z",i),children:[s&&(0,ee.FD)("div",{className:"hPi4fICJ",children:[(0,ee.Y)(q.A,{name:s,className:"XkiOXdMP"}),(0,ee.Y)("div",{className:"iC3LJrvy",dir:a.isRtl?"rtl":void 0,children:e}),(0,ee.Y)("div",{className:"jufjjcX9",children:(0,ee.Y)("svg",{width:"26",height:"9",viewBox:"0 0 26 9",fill:"none",children:(0,ee.Y)("path",{d:"M0 0H26H24.4853C22.894 0 21.3679 0.632141 20.2426 1.75736L14.4142 7.58579C13.6332 8.36684 12.3668 8.36683 11.5858 7.58579L5.75736 1.75736C4.63214 0.632139 3.10602 0 1.51472 0H0Z",fill:"#7E85FF"})})})]}),(0,ee.FD)("div",{className:(0,me.A)(Ma,"scGr4JS9"),children:[(0,ee.Y)("div",{className:"OejVAPj6 YaiSoFKE YaiSoFKE",dir:a.isRtl?"rtl":void 0,children:a("LimitFree")}),!s&&(0,ee.Y)("div",{className:"RJosx238 YaiSoFKE",children:e})]}),(0,ee.FD)("div",{className:(0,me.A)(Ma,"nPaUalQf"),style:n,children:[(0,ee.Y)("div",{className:"COQdFBQk YaiSoFKE YaiSoFKE",dir:a.isRtl?"rtl":void 0,children:a("LimitPremium")}),(0,ee.Y)("div",{className:"BEq3jFlz YaiSoFKE YaiSoFKE",children:t})]})]})})),Ba=[91,160,255],Ra=[197,100,243],La=(0,s.ph)((({title:e,description:t,leftValue:i,rightValue:n,colorStepProgress:a})=>{const o=(0,s.Kr)((()=>Ba.map(((e,t)=>(0,pe.Cc)(e,Ra[t],a)))),[a]);return(0,ee.FD)("div",{className:"ZXp65Wgy",children:[(0,ee.Y)("div",{className:"W1xG3pjS",children:e}),(0,ee.Y)("div",{className:"b_CBXIkT",children:t}),(0,ee.Y)(Ta,{leftValue:i,rightValue:n,rightStyle:`background: rgb(${o.join(",")})`})]})}));var xa=i(67054),Ea=i(18104);const Va=({size:e,realIndex:t,canPlay:i,sticker:n,index:a,maxLength:o,onClick:r,onEnded:l})=>{const c=(0,j.A)(`sticker${n.id}`),d=(0,j.A)(`sticker${n.id}?size=f`),h=0===a,[m,u,p]=(0,Y.A)(h),v=e-.6*e,g=3*v,A=3.2*v,b=a/o*(2*Math.PI),f=h?1:.66,C=Math.cos(b)*g-2.8*v,y=Math.sin(b)*A,S=(0,D.A)((()=>{r(t)})),w=(0,D.A)((()=>{p(),l(t)}));return(0,s.vJ)((()=>{h&&u()}),[h,u]),(0,ee.FD)(ee.FK,{children:[h&&(0,ee.Y)(Ea.A,{className:"Stdz4UIW ogaoEAcn",tgsUrl:d,play:i,isLowPriority:!0,noLoop:!0,size:.8*e,style:`--x: calc(${C}px - 10%); --y: ${y}px;`}),(0,ee.Y)(Ea.A,{className:"ogaoEAcn",tgsUrl:c,play:i&&m,noLoop:!0,size:.6*e,style:`--x: ${C}px; --y: ${y}px; --opacity: ${f}`,onClick:S,onEnded:w})]})},_a=(0,s.ph)((0,n.EK)((e=>({stickers:e.stickers.premium.stickers})))((({stickers:e,isActive:t})=>{const i=(0,s.li)(),[n,a]=(0,s.J0)(0),[o,r]=(0,s.J0)(0),l=e?.slice(0,15),c=(0,D.A)((e=>{a(-e)})),d=(0,D.A)((e=>{0===(0,xa.A)(l.length,e+n)&&setTimeout((()=>{a((e=>(0,xa.A)(l.length,e+1)))}),150)}));return(0,s.vJ)((()=>{const e=i.current;e&&r(e.closest(".modal-dialog").clientWidth)}),[]),(0,ee.Y)("div",{className:"O1fqNCy0",ref:i,children:Boolean(o)&&l?.map(((e,i)=>(0,ee.Y)(Va,{size:o,sticker:e,realIndex:i,index:(i+n+l.length)%l.length,maxLength:l.length,onClick:c,onEnded:d,canPlay:t})))})})));var Ua=i(38691),Oa=i(88554);const Ka={stories_order:"PremiumStoriesPriority",stories_stealth:"PremiumStoriesStealth",stories_views:"PremiumStoriesViews",stories_timer:"lng_premium_stories_subtitle_expiration",stories_save:"PremiumStoriesSaveToGallery",stories_caption:"lng_premium_stories_subtitle_caption",stories_link:"lng_premium_stories_subtitle_links"},Ja={stories_order:"PremiumStoriesPriorityDescription",stories_stealth:"PremiumStoriesStealthDescription",stories_views:"PremiumStoriesViewsDescription",stories_timer:"PremiumStoriesExpirationDescription",stories_save:"PremiumStoriesSaveToGalleryDescription",stories_caption:"PremiumStoriesCaptionDescription",stories_link:"PremiumStoriesFormattingDescription"},Ga={stories_order:"story-priority",stories_stealth:"eye-crossed-outline",stories_views:"eye-outline",stories_timer:"timer",stories_save:"arrow-down-circle",stories_caption:"story-caption",stories_link:"link-badge"},ja=Object.keys(Ka),za=Dt.R.giant+.25*p.$,Ha=(0,s.ph)((0,n.EK)((e=>({currentUser:(0,c.mBe)(e,e.currentUserId)})))((({currentUser:e})=>{const t=(0,s.li)(),i=(0,M.A)(),n=(0,Ua.A)();(0,s.Nf)((()=>{t.current&&(0,Oa.$)({canvas:t.current,size:za*n,segmentsCount:8,color:"purple",readSegmentsCount:0,readSegmentColor:"transparent",dpr:n})}),[n]);const{handleScroll:a,isAtBeginning:o}=Fs(),r=za;return(0,ee.FD)("div",{className:"mFElmm7a",children:[(0,ee.FD)("div",{className:"Jjbochk6",children:[(0,ee.Y)(Dt.A,{forPremiumPromo:!0,peer:e,size:"giant"}),(0,ee.Y)("canvas",{className:"ChteQ9C3",ref:t,style:`max-width: ${r}px; max-height: ${r}px`})]}),(0,ee.Y)("div",{className:"d2ayix6L",children:i("UpgradedStories")}),(0,ee.FD)("div",{className:(0,me.A)("ensyCeMe",!o&&"iN1T0a2Y","custom-scroll"),onScroll:a,children:[ja.map(((e,t)=>(0,ee.Y)(Ia,{title:i(Ka[e]),text:i(Ja[e]),icon:Ga[e],isFontIcon:!0,index:t,count:ja.length,section:e},e))),(0,ee.Y)("div",{className:"DFbZJafh",children:i("lng_premium_stories_about_mobile")})]})]})}))),$a={root:"Ot0dA1yZ",wrapper:"yxSAGAc1",down:"Jcy6cDoc",frame:"Vn81yTTJ",video:"rrVJClLL"},qa=i.p+"DeviceFrame.79271ee0fa60a7b6a1aa.svg",Wa=(0,s.ph)((({videoId:e,isReverseAnimation:t,isDown:i,videoThumbnail:s,index:n,isActive:a})=>{const o=(0,j.A)(`document${e}`),r=(0,Vi.A)(s.dataUri),l=(0,Oi.A)(o);return(0,ee.Y)("div",{className:$a.root,children:(0,ee.FD)("div",{className:(0,me.A)($a.wrapper,t&&$a.reverse,i&&$a.down),id:`premium_feature_preview_video_${n}`,children:[(0,ee.Y)("img",{src:qa,alt:"",className:$a.frame,draggable:!1}),(0,ee.Y)("canvas",{ref:r,className:$a.video}),(0,ee.Y)(ss.A,{canPlay:a,className:(0,me.A)($a.video,l),src:o,disablePictureInPicture:!0,playsInline:!0,muted:!0,loop:!0})]})})})),Qa="a7IoUtQG",Za="gubS9KP1",Xa="iZLwcL8v",eo="A7YHY8qF",to={double_limits:"PremiumPreviewLimits",infinite_reactions:"PremiumPreviewReactions2",premium_stickers:"PremiumPreviewStickers",animated_emoji:"PremiumPreviewEmoji",no_ads:"PremiumPreviewNoAds",voice_to_text:"PremiumPreviewVoiceToText",profile_badge:"PremiumPreviewProfileBadge",faster_download:"PremiumPreviewDownloadSpeed",more_upload:"PremiumPreviewUploads",advanced_chat_management:"PremiumPreviewAdvancedChatManagement",animated_userpics:"PremiumPreviewAnimatedProfiles",emoji_status:"PremiumPreviewEmojiStatus",translations:"PremiumPreviewTranslations",stories:"PremiumPreviewStories",saved_tags:"PremiumPreviewTags2",last_seen:"PremiumPreviewLastSeen",message_privacy:"PremiumPreviewMessagePrivacy",effects:"Premium.MessageEffects"},io={double_limits:"PremiumPreviewLimitsDescription",infinite_reactions:"PremiumPreviewReactions2Description",premium_stickers:"PremiumPreviewStickersDescription",no_ads:"PremiumPreviewNoAdsDescription",animated_emoji:"PremiumPreviewEmojiDescription",voice_to_text:"PremiumPreviewVoiceToTextDescription",profile_badge:"PremiumPreviewProfileBadgeDescription",faster_download:"PremiumPreviewDownloadSpeedDescription",more_upload:"PremiumPreviewUploadsDescription",advanced_chat_management:"PremiumPreviewAdvancedChatManagementDescription",animated_userpics:"PremiumPreviewAnimatedProfilesDescription",emoji_status:"PremiumPreviewEmojiStatusDescription",translations:"PremiumPreviewTranslationsDescription",stories:"PremiumPreviewStoriesDescription",saved_tags:"PremiumPreviewTagsDescription2",last_seen:"PremiumPreviewLastSeenDescription",message_privacy:"PremiumPreviewMessagePrivacyDescription",effects:"Premium.MessageEffectsInfo"},so={channels:"GroupsAndChannelsLimitTitle",dialogFolderPinned:"PinChatsLimitTitle",channelsPublic:"PublicLinksLimitTitle",savedGifs:"SavedGifsLimitTitle",stickersFaved:"FavoriteStickersLimitTitle",aboutLength:"BioLimitTitle",captionLength:"CaptionsLimitTitle",dialogFilters:"FoldersLimitTitle",dialogFiltersChats:"ChatPerFolderLimitTitle",recommendedChannels:"SimilarChannelsLimitTitle",moreAccounts:"ConnectedAccountsLimitTitle"},no={channels:"GroupsAndChannelsLimitSubtitle",dialogFolderPinned:"PinChatsLimitSubtitle",channelsPublic:"PublicLinksLimitSubtitle",savedGifs:"SavedGifsLimitSubtitle",stickersFaved:"FavoriteStickersLimitSubtitle",aboutLength:"BioLimitSubtitle",captionLength:"CaptionsLimitSubtitle",dialogFilters:"FoldersLimitSubtitle",dialogFiltersChats:"ChatPerFolderLimitSubtitle",recommendedChannels:"SimilarChannelsLimitSubtitle",moreAccounts:"ConnectedAccountsLimitSubtitle"},ao=(0,s.ph)((({promo:e,initialSection:t,isPremium:i,limits:n,premiumPromoOrder:a,subscriptionOption:l,onBack:c,onClickSubscribe:d})=>{const h=(0,M.A)(),m=(0,_i.A)(),u=(0,s.li)(),[p,v]=(0,s.J0)(o.O2i.indexOf(t)),[g,A]=(0,s.J0)(0),[b,f,C]=(0,Y.A)(),[y,S]=(0,s.J0)(!0),[w,k]=(0,s.J0)(!1),N=(0,V.A)(t),I=(0,s.Kr)((()=>a?a.filter((e=>o.O2i.includes(e))):o.O2i),[a]),P=(0,s.Kr)((()=>{if(!l)return;const{amount:e,months:t,currency:s}=l,n=Math.floor(e/t);return i?m("OK"):m("SubscribeToPremium",{price:(0,Sa.v)(m,n,s)},{withNodes:!0})}),[i,m,l]),F=(0,D.A)((()=>{d(t)}));function T(e){const{scrollTop:t,clientHeight:i,scrollHeight:s}=e.currentTarget;S(t<=20),k(t>=s-i-20)}(0,s.vJ)((()=>{const e=u.current;if(!e||N===t)return;const i=I.indexOf(t);v(i),f(),(0,Pa.A)(e,e.clientWidth*i,0).then(C)}),[p,I,t,N]);const B=(0,D.A)((async e=>{const t=u.current;t&&(v(e),f(),await(0,Pa.A)(t,t.clientWidth*e,800),C())})),R=I[p],L="double_limits"!==R&&"stories"!==R;return(0,ee.FD)("div",{className:"oyUTEj8I",children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",className:(0,me.A)("njYoMrKM",L&&"SB4pczOo"),color:L?"translucent-white":"translucent",onClick:c,ariaLabel:h("Back"),children:(0,ee.Y)(q.A,{name:"arrow-left"})}),(0,ee.Y)("div",{className:"dIVBSdWi"}),(0,ee.Y)("div",{className:(0,me.A)("sJubG84j","no-scrollbar"),onScroll:function(e){const t=e.currentTarget,{clientWidth:i,scrollLeft:s}=t,n=Math.round(s),a=n%i/i,o=Math.ceil((n+1)/i);A(o);const l=t.querySelector("#premium_feature_preview_video_"+(o-1)),c=t.querySelector(`#premium_feature_preview_video_${o}`);if((0,r.RK)((()=>{t.style.setProperty("--scroll-progress",a.toString()),t.style.setProperty("--abs-scroll-progress",Math.abs(a).toString()),l&&(0,os.dH)(l,"reverse",!1),c&&(0,os.dH)(c,"reverse",!0)})),b)return;const d=Math.round(n/i);v(d)},ref:u,children:I.map(((t,i)=>{if("double_limits"===t)return(0,ee.FD)("div",{className:(0,me.A)(Za,"U7ePgVBR"),children:[(0,ee.Y)("h2",{className:(0,me.A)("mz2Hmd83",y&&"AgmNOqi7"),children:h(to.double_limits)}),(0,ee.Y)("div",{className:(0,me.A)("n_rowVPI","custom-scroll"),onScroll:T,children:o.M$8.map(((e,t)=>{const i=n?.[e][0].toString(),s=n?.[e][1].toString();return(0,ee.Y)(La,{title:h(so[e]),description:h(no[e],s),leftValue:i,rightValue:s,colorStepProgress:t/(o.M$8.length-1)})}))})]});if("premium_stickers"===t)return(0,ee.FD)("div",{className:Za,children:[(0,ee.Y)("div",{className:Qa,children:(0,ee.Y)(_a,{isActive:p===i})}),(0,ee.Y)("h1",{className:Xa,children:h(to.premium_stickers)}),(0,ee.Y)("div",{className:eo,children:(0,Ft.A)(h(io.premium_stickers),["br"])})]});if("stories"===t)return(0,ee.Y)("div",{className:(0,me.A)(Za,"J1M6fEdo"),children:(0,ee.Y)(Ha,{})});const s=e.videoSections.indexOf(t);return-1!==s?(0,ee.FD)("div",{className:Za,children:[(0,ee.Y)("div",{className:Qa,children:(0,ee.Y)(Wa,{isActive:p===i,videoId:e.videos[s].id,videoThumbnail:e.videos[s].thumbnail,isDown:o.jhT.includes(t),index:i,isReverseAnimation:i===g})}),(0,ee.Y)("h1",{className:Xa,children:h(to[e.videoSections[s]])}),(0,ee.Y)("div",{className:eo,children:(0,Ft.A)(h(io[e.videoSections[s]]),["br"])})]}):void 0}))}),(0,ee.FD)("div",{className:(0,me.A)("yN2611rA",(w||0!==p)&&"rCHMABcD"),children:[(0,ee.Y)(Da,{length:o.O2i.length,active:p,onSelectSlide:B}),Boolean(P)&&(0,ee.Y)(W.A,{className:(0,me.A)("EPfM7AgT"),isShiny:!i,withPremiumGradient:!i,onClick:i?c:F,children:P})]})]})})),oo=(0,s.ph)((({option:e,checked:t,fullMonthlyAmount:i,onChange:n,className:a,isGiveaway:o})=>{const r=(0,M.A)(),{months:l,amount:c,currency:d}=e,h="users"in e?e.users:void 0,m=Math.floor(c/l),u=h?h>1:void 0,p=(0,s.Kr)((()=>i&&i>m?Math.ceil(100-m/(i/100)):void 0),[i,m]),v=(0,s.hb)((e=>{e.target.checked&&n(l)}),[l,n]);return(0,ee.FD)("label",{className:(0,me.A)(o?"PkseWxFK":"qZA6S2kc",t&&!o&&"EJOQwnRj",a),dir:r.isRtl?"rtl":void 0,children:[(0,ee.Y)("input",{className:"WOEkhx6R",type:"radio",name:"subscription_option",value:l,checked:t,onChange:v}),(0,ee.FD)("div",{className:"BHUCScsU",children:[(0,ee.FD)("div",{className:"DfYCMUkL",children:[Boolean(p)&&(0,ee.FD)("span",{className:(0,me.A)("ublijP0j","uqDlP3Zt"),title:r("GiftDiscount"),children:[" ","âˆ’",p,"%"]}),r("Months",l)]}),(0,ee.Y)("div",{className:"poxOXJ2o",children:o||u?`${(0,Sa.A)(c,d,r.code)} x ${h}`:r("PricePerMonth",(0,Sa.A)(m,d,r.code))}),(0,ee.Y)("div",{className:"IGMrERf_",children:(0,Sa.A)(c,d,r.code)})]})]})})),ro="yKm9hKQP",lo=i.p+"PremiumAds.a758f19ece91fe91318e.svg",co=i.p+"PremiumBadge.1c630afcfd1112ad16d0.svg",ho=i.p+"PremiumChats.89d9d315638e283ca895.svg",mo=i.p+"PremiumEffects.4eab9caad8e9c276842d.svg",uo=i.p+"PremiumEmoji.26515017c8f6dc4f3f67.svg",po=i.p+"PremiumFile.884dd3865acfe594fc61.svg",vo=i.p+"PremiumLastSeen.9575a548770d23785846.svg",go=i.p+"PremiumLimits.08701cb6df3cf756c5f7.svg",Ao=i.p+"PremiumLogo.a5c0e88cd478f4d76d82.svg",bo=i.p+"PremiumMessagePrivacy.950cab3e87c60c5733a6.svg",fo=i.p+"PremiumReactions.7fee56ab6b58c82fd15e.svg",Co=i.p+"PremiumSpeed.d0a43b6780c411c2f84a.svg",yo=i.p+"PremiumStatus.c42f9c4b68f9c2c4537a.svg",So=i.p+"PremiumStickers.7b5a8531a41b43d0da12.svg",wo=i.p+"PremiumTags.3b187054cc90f8e16cb7.svg",ko=i.p+"PremiumTranslate.cb2dcbb898d96cb35469.svg",No=i.p+"PremiumVideo.288cb61931e33d913f0a.svg",Io=i.p+"PremiumVoice.b3a2893dbe481108ab94.svg",Po=8*p.$,Yo={stories:yo,double_limits:go,infinite_reactions:fo,premium_stickers:So,animated_emoji:uo,no_ads:lo,voice_to_text:Io,profile_badge:co,faster_download:Co,more_upload:po,advanced_chat_management:ho,animated_userpics:No,emoji_status:yo,translations:ko,saved_tags:wo,last_seen:vo,message_privacy:bo,effects:mo},Fo=(0,s.ph)((0,n.EK)((e=>{const{premiumModal:t}=(0,c.nTw)(e),i=t?.fromUserId?(0,c.mBe)(e,t.fromUserId):void 0,s=i?.emojiStatus?e.customEmojis.byId[i.emojiStatus.documentId]:void 0,n=s?(0,c.ycM)(e,s.stickerSetInfo):void 0;return{currentUserId:e.currentUserId,promo:t?.promo,isSuccess:t?.isSuccess,isGift:t?.isGift,monthsAmount:t?.monthsAmount,fromUser:i,fromUserStatusEmoji:s,fromUserStatusSet:n,toUser:t?.toUserId?(0,c.mBe)(e,t.toUserId):void 0,initialSection:t?.initialSection,isPremium:(0,c.g29)(e),limitChannels:(0,ya.B)(e,"channels"),limitFolders:(0,ya.B)(e,"dialogFilters"),limitPins:(0,ya.B)(e,"dialogFolderPinned"),limitLinks:(0,ya.B)(e,"channelsPublic"),limits:e.appConfig?.limits,premiumSlug:e.appConfig?.premiumInvoiceSlug,premiumBotUsername:e.appConfig?.premiumBotUsername,premiumPromoOrder:e.appConfig?.premiumPromoOrder}}))((({isOpen:e,currentUserId:t,fromUser:i,fromUserStatusEmoji:a,fromUserStatusSet:r,promo:c,initialSection:d,isPremium:h,limitChannels:m,limitLinks:u,limitFolders:p,limitPins:v,limits:g,premiumSlug:A,premiumBotUsername:b,isSuccess:f,isGift:C,toUser:y,monthsAmount:S,premiumPromoOrder:w})=>{const k=(0,s.li)(),{closePremiumModal:N,openInvoice:I,requestConfetti:P,openTelegramLink:Y,loadStickers:F,openStickerSet:T}=(0,n.ko)(),B=(0,M.A)(),R=(0,_i.A)(),[L,x]=(0,s.J0)(!0),[E,V]=(0,s.J0)(d),[_,U]=(0,s.J0)();(0,s.vJ)((()=>{e||(x(!0),V(void 0))}),[e]);const O=(0,D.A)((e=>{V(e)})),K=(0,D.A)((()=>{V(void 0)})),J=(0,D.A)((e=>{k.current&&(A?I({type:"slug",slug:A}):b&&(Y({url:`${o.jsp}${b}?start=${e||"promo"}`}),N()))})),j=(0,D.A)((()=>{_?J(String(_.months)):J()})),z=(0,D.A)((e=>{const t=c?.options.find((t=>t.months===e));U(t)})),H=(0,D.A)((()=>{const t=k.current;if(t&&e){const{top:e,left:i,width:s,height:n}=t.querySelector(".modal-content").getBoundingClientRect();P({top:e,left:i,width:s,height:n,withStars:!0})}}));(0,s.vJ)((()=>{f&&H()}),[f,H]),(0,G.A)((([e])=>{e!==h&&H()}),[h,H]);const $=(0,s.Kr)((()=>w?w.filter((e=>o.O2i.includes(e))):o.O2i),[w]);(0,s.vJ)((()=>{a&&!r&&F({stickerSetInfo:a.stickerSetInfo})}),[F,a,r]),(0,s.vJ)((()=>{const[e]=c?.options??[];U(e)}),[c]);const Q=(0,D.A)((()=>{r&&T({stickerSetInfo:r})})),X=(0,s.Kr)((()=>{const e=c?.options.find((e=>1===e.months));if(e)return Number(e.amount)}),[c]),te=(0,s.Kr)((()=>{if(!_)return;const{amount:e,months:t,currency:i}=_,s=Math.floor(e/t);return(0,Sa.v)(R,s,i)}),[_,R]);if(c&&(!a||r))return(0,ee.Y)(Z.A,{className:"sfbpMFHM",onClose:N,isOpen:e,dialogRef:k,children:(0,ee.Y)(se.Ay,{name:"slide",activeKey:E?1:0,className:"ELNkgPve",children:E?(0,ee.Y)(ao,{initialSection:E,onBack:K,promo:c,onClickSubscribe:J,isPremium:h,limits:g,premiumPromoOrder:w,subscriptionOption:_}):(0,ee.FD)("div",{className:(0,me.A)("ZpOIPrhp","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;x(t<=150)},children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",className:"XyN3eWog",color:"translucent",onClick:()=>N(),ariaLabel:B("Close"),children:(0,ee.Y)(q.A,{name:"close"})}),a&&!C?(0,ee.Y)(wa.A,{className:"mQwvY9LA",onClick:Q,documentId:a.id,isBig:!0,size:Po}):(0,ee.Y)("img",{className:"mlMezt6b",src:Ao,alt:"",draggable:!1}),(0,ee.Y)("h2",{className:(0,me.A)("y71v6ECL",r&&"xw_GbDj7"),children:function(){if(C)return(0,Ft.A)(i?.id===t?B("TelegramPremiumUserGiftedPremiumOutboundDialogTitle",[(0,l.Yg)(y),S]):B("TelegramPremiumUserGiftedPremiumDialogTitle",[(0,l.Yg)(i),S]),["simple_markdown","emoji"]);if(r&&i){const e=B("lng_premium_emoji_status_title").replace("{user}",(0,l.Yg)(i)),[t,s]=e.split("{link}"),n=r.thumbCustomEmojiId?(0,ee.Y)(wa.A,{className:"Y0jTcadE",documentId:r.thumbCustomEmojiId}):void 0,a=(0,ee.FD)("span",{className:"FLzl2ng5",onClick:Q,children:[n,(0,Ft.A)(r.title)]});return[(0,Ft.A)(t),a,(0,Ft.A)(s)]}return(0,Ft.A)(i?B("TelegramPremiumUserDialogTitle",(0,l.Yg)(i)):B(h?"TelegramPremiumSubscribedTitle":"TelegramPremium"),["simple_markdown","emoji"])}()}),(0,ee.Y)("div",{className:"cUcKXV3j",children:(0,Ft.A)(C?i?.id===t?B("TelegramPremiumUserGiftedPremiumOutboundDialogSubtitle",(0,l.Yg)(y)):B("TelegramPremiumUserGiftedPremiumDialogSubtitle"):B(r?"TelegramPremiumUserStatusDialogSubtitle":i?"TelegramPremiumUserDialogSubtitle":h?"TelegramPremiumSubscribedSubtitle":"TelegramPremiumSubtitle"),["simple_markdown","emoji"])}),!h&&!C&&(0,ee.Y)("div",{className:"xZC_Oajr",children:c?.options.map((e=>(0,ee.Y)(oo,{className:"gygsbDbE",option:e,onChange:z,fullMonthlyAmount:X,checked:_?.months===e.months},e.amount)))}),(0,ee.Y)("div",{className:(0,me.A)("Bc_F0RKb",L&&"ltXo0Xi7"),children:(0,ee.Y)("h2",{className:"xysPdANX",children:B("TelegramPremium")})}),(0,ee.FD)("div",{className:(0,me.A)("c3Ee2oSo",h&&"yWEHoJOL"),children:[$.map(((e,t)=>(0,ee.Y)(Ia,{title:B(to[e]),text:"double_limits"===e?B(io[e],[m,p,v,u,4]):B(io[e]),icon:Yo[e],index:t,count:$.length,section:e,onClick:O},e))),(0,ee.FD)("div",{className:(0,me.A)(ro,"l1WlNpmu"),dir:B.isRtl?"rtl":void 0,children:[(0,ee.Y)("p",{children:(0,Ft.A)(B("AboutPremiumDescription"),["simple_markdown"])}),(0,ee.Y)("p",{children:(0,Ft.A)(B("AboutPremiumDescription2"),["simple_markdown"])})]}),function(){if(c&&(!C||i?.id!==t))return(0,ee.Y)("div",{className:ro,dir:B.isRtl?"rtl":void 0,children:(0,ds.fd)({text:c.statusText,entities:c.statusEntities})})}()]}),!h&&_&&(0,ee.Y)("div",{className:"nCnlO9UZ",children:(0,ee.Y)(W.A,{className:"c1tMxuFH",isShiny:!0,withPremiumGradient:!0,onClick:j,children:B("SubscribeToPremium",te)})})]})})})})));var Do=i(24956),Mo=i(31722);const To="ItemPickerItem",Bo=(0,s.ph)((({className:e,isSearchable:t,searchInputId:i,items:n,filterValue:a,notFoundText:o,isLoading:l,noScrollRestore:c,filterPlaceholder:d,isViewOnly:h,itemInputType:m,itemClassName:u,withDefaultPadding:p,forceRenderAllItems:v,onFilterChange:g,onDisabledClick:A,onLoadMore:b,...f})=>{const C=(0,M.A)(),y=(0,s.li)(),S=f.allowMultiple,w=S?f.lockedSelectedValues:void 0,k=S?f.lockedUnselectedValues:void 0;(0,s.vJ)((()=>{if(!t)return;const e=window.setTimeout((()=>{(0,r.YS)((()=>{y.current?.focus()}))}),500);return()=>{window.clearTimeout(e)}}),[t]);const N=(0,s.Kr)((()=>S?f.selectedValues:f.selectedValue?[f.selectedValue]:Ci.p),[S,f.selectedValue,f.selectedValues]),I=(0,s.Kr)((()=>new Set(w)),[w]),P=(0,s.Kr)((()=>new Set(k)),[k]),Y=(0,s.Kr)((()=>{if(a)return n.map((e=>e.value));const e=[],t=[],i=[];return n.forEach((s=>{I.has(s.value)?e.push(s):P.has(s.value)?i.push(s):t.push(s)})),e.concat(t,i).map((e=>e.value))}),[a,n,I,P]),F=(0,D.A)((e=>{if(S){const t=N.slice(),i=t.indexOf(e);return i>=0?t.splice(i,1):t.push(e),void f.onSelectedValuesChange?.(t)}f.onSelectedValueChange?.(e)})),[T,B]=(0,Js.A)(b,Y,Boolean(v||a)),R=(0,D.A)((e=>{const{value:t}=e.currentTarget;g?.(t)})),L=(0,s.hb)((e=>{const t=n.find((t=>t.value===e));if(!t)return;const{label:i,subLabel:s,isLoading:a}=t,o=P.has(e),r=I.has(e),l=o||r,c=N.includes(e);return(0,ee.Y)(qs.A,{className:(0,me.A)(To,u),title:i,subtitle:s,disabled:l,inactive:h,ripple:!0,inputElement:l?(0,ee.Y)(q.A,{name:"lock-badge"}):"radio"===m?(0,ee.Y)(Do.A,{checked:c,disabled:l,isLoading:a,onlyInput:!0}):"checkbox"===m?(0,ee.Y)(un.A,{checked:c,disabled:l,isLoading:a,onlyInput:!0}):void 0,onClick:()=>F(e),onDisabledClick:A&&(()=>A(e,r))},e)}),[n,P,I,N,h,A,m,u]);return(0,ee.FD)("div",{className:(0,me.A)(Mo.A.container,e),children:[t&&(0,ee.Y)("div",{className:(0,me.A)(Mo.A.header,"custom-scroll"),dir:C.isRtl?"rtl":void 0,children:(0,ee.Y)(Q.A,{id:i,ref:y,value:a,onChange:R,placeholder:d||C("Search")})}),T?.length?(0,ee.Y)(Ds.A,{className:(0,me.A)(Mo.A.pickerList,p&&Mo.A.padded,"custom-scroll"),items:T,itemSelector:`.${To}`,onLoadMore:B,noScrollRestore:c,children:T.map((e=>L(e)))}):l||!T||T.length?(0,ee.Y)(zs.A,{}):(0,ee.Y)("p",{className:Mo.A.noResults,children:o||C("SearchEmptyViewTitle")})]})})),Ro={root:"wzzA3MFh",pickerSelector:"xhujrq9i",pickerTitle:"YuRK4e7S",picker:"YF9nLkCK",footer:"ATCZ2Q5G"},Lo=(0,s.ph)((({isOpen:e,onClose:t,onSubmit:i,countryList:a,selectionLimit:o})=>{const{showNotification:r}=(0,n.ko)(),l=(0,M.A)(),[c,d]=(0,s.J0)([]),h=(0,V.A)(c)===c,m=(0,s.Kr)((()=>a?a.filter((e=>!e.isHidden&&"FT"!==e.iso2)).map((({iso2:e,defaultName:t})=>({value:e,label:t}))):[]),[a]),u=(0,D.A)((e=>{o&&e.length>o?r({message:l("BoostingSelectUpToWarningCountries",o)}):d(e)})),p=(0,D.A)((()=>{i(c),t()}));return(0,ee.FD)(Z.A,{className:Ro.root,isOpen:e,onClose:t,onEnter:p,children:[(0,ee.Y)("div",{className:Ro.container,children:(0,ee.FD)("div",{className:Ro.pickerSelector,children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:t,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("h4",{className:Ro.pickerTitle,children:l("BoostingSelectCountry")})]})}),(0,ee.Y)("div",{className:(0,me.A)(Ro.main,"custom-scroll"),children:(0,ee.Y)(Bo,{className:Ro.picker,items:m,selectedValues:c,onSelectedValuesChange:u,noScrollRestore:h,allowMultiple:!0,itemInputType:"checkbox"})}),(0,ee.Y)("div",{className:Ro.footer,children:(0,ee.Y)(W.A,{size:"smaller",onClick:p,children:l("SelectCountries.OK")})})]})}));var xo=i(1526),Eo=i(96530),Vo=i(11124),_o=i(34642);const Uo=(0,s.ph)((({isOpen:e,giveawayChatId:t,selectionLimit:i,initialSelectedIds:a,onSelectedIdsConfirmed:o,onClose:r})=>{const{showNotification:c}=(0,n.ko)(),d=(0,M.A)(),[h,m]=(0,s.J0)(void 0),[u,p]=(0,s.J0)(""),[v,g,A]=(0,Y.A)(),[b,f]=(0,s.J0)(a);(0,s.vJ)((()=>{f(a)}),[a]);const C=(0,s.Kr)((()=>{const e=(0,n.mS)(),i=e.chats.byId,{active:s,archived:a}=e.chats.listIds,o=(s||[]).concat(a||[]);return(0,fi.Am)(o).map((e=>i[e])).filter((e=>e&&((0,l.WX)(e)||(0,l.Vs)(e))&&e.id!==t)).map((e=>e.id))}),[t]),y=(0,s.Kr)((()=>{const e=C?(0,Yt.PU)({ids:C,query:u,type:"chat"}):[];return(0,Os.A)(e,!1,b)}),[C,u,b]),S=(0,D.A)((e=>{const t=(0,n.mS)().chats.byId,s=e.filter((e=>!b.includes(e))).find((e=>{const i=t[e];return i&&!(0,l.gA)(i)}));b?.length>=i?c({message:d("BoostingSelectUpToWarningChannelsPlural",i)}):s?(m(s),g()):f(e)})),w=(0,D.A)((()=>{h&&f((0,fi.Am)([...b,h])),A()})),k=(0,D.A)((()=>{o(b),r()}));return(0,ee.FD)(_o.A,{isOpen:e,onClose:r,title:d("RequestPeer.ChooseChannelTitle"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:d("Save"),onConfirm:k,onEnter:k,children:[(0,ee.Y)(yi.A,{itemIds:y,selectedIds:b,filterValue:u,filterPlaceholder:d("Search"),onSelectedIdsChange:S,onFilterChange:p,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"}),(0,ee.Y)(vi.A,{title:d("BoostingGiveawayPrivateChannel"),text:d("BoostingGiveawayPrivateChannelWarning"),confirmLabel:d("Add"),isOpen:v,onClose:A,confirmHandler:w})]})})),Oo=(0,s.ph)((({option:e,checked:t,name:i,text:s,img:n,isLink:a,onChange:o,onClickAction:r,className:l,userNames:c,selectedMemberIds:d})=>{const h=(0,M.A)();let m=h(s);a&&d?.length&&(m=d.length>2?d.length.toString():c);const u=(0,D.A)((t=>{t.target.checked&&o(e)})),p=(0,D.A)((()=>{r?.()}));return(0,ee.FD)("label",{className:(0,me.A)("w3OGYFKn",l),dir:h.isRtl?"rtl":void 0,role:"button",tabIndex:0,children:[(0,ee.Y)("input",{className:"xy4AclZa",type:"radio",name:"giveaway_option",value:e,checked:t,onChange:u,onClick:e=>e.stopPropagation()}),(0,ee.FD)("div",{className:"TTgSI7Xh",children:[(0,ee.Y)("img",{className:"lGhZJbMF",src:n,alt:"",draggable:!1}),(0,ee.FD)("div",{className:"sEt7TF59",children:[(0,ee.Y)("h3",{className:"u4NzVBBi",children:h(i)}),a?(0,ee.FD)("div",{className:"y7XfPOoG",onClick:p,children:[(0,ee.Y)("span",{children:m}),(0,ee.Y)(q.A,{name:"next"})]}):(0,ee.Y)("span",{className:"kt2ZKZ6j",children:m})]})]})]})})),Ko=(0,s.ph)((0,n.EK)(((e,{giveawayChatId:t})=>{const i=t?(0,c.AWZ)(e,t):void 0;return i?{members:i.members,adminMembersById:i.adminMembersById}:{}}))((({isOpen:e,selectionLimit:t,members:i,adminMembersById:a,initialSelectedIds:o,onSelectedIdsConfirmed:r,onClose:c})=>{const{showNotification:d}=(0,n.ko)(),h=(0,M.A)(),[m,u]=(0,s.J0)(""),[p,v]=(0,s.J0)(o);(0,s.vJ)((()=>{v(o)}),[o]);const g=(0,s.Kr)((()=>{const e=(0,n.mS)(),{byId:t,statusesById:s}=e.users;if(!i?.length)return[];const o=a&&new Set(Object.keys(a)),r=(0,l.UB)(i.map((({userId:e})=>e)),t,s);return o?r.filter((e=>!o.has(e))):r}),[a,i]),A=(0,s.Kr)((()=>{const e=(0,n.mS)().users.byId,t=g?(0,Yt.PU)({ids:g,query:m,type:"user"}):[];return(0,Os.A)((0,fi.Am)(t).filter((t=>{const i=e[t];return!i||!(0,l.tv)(i)})))}),[g,m]),b=(0,D.A)((e=>{e.length>t?d({message:h("BoostingSelectUpToWarningUsers",t)}):v(e)})),f=(0,D.A)((()=>{r(p),c()}));return(0,ee.Y)(_o.A,{isOpen:e,onClose:c,title:h("BoostingAwardSpecificUsers"),hasCloseButton:!0,shouldAdaptToSearch:!0,withFixedHeight:!0,confirmButtonText:h("Save"),onConfirm:f,onEnter:f,children:(0,ee.Y)(yi.A,{itemIds:A,selectedIds:p,filterValue:m,filterPlaceholder:h("Search"),onSelectedIdsChange:b,onFilterChange:u,isSearchable:!0,withDefaultPadding:!0,withStatus:!0,allowMultiple:!0,itemInputType:"checkbox"})})}))),Jo="rZRDMqUL",Go="JjDLNrKG",jo="p5Hn4Q6E",zo="rniPcuiP",Ho="G9H3tm6D",$o="xKl2UeV8",qo="HLx3wTBD",Wo="Ftr7zf2v",Qo="Ce0Ob2tg",Zo="rDFQAfTt",Xo="LZ3vPzak",er="Z9QJQ6IS",tr="ldn4mh2T";var ir=i(72078),sr=i(68153),nr=i(65741),ar=i(45318);const or={3:sr,6:ir,12:nr},rr=(0,s.ph)((0,n.EK)((e=>{const{giveawayModal:t}=(0,c.nTw)(e),i=t?.chatId,s=i?(0,c.hds)(e,i):void 0,n=s&&(0,l.WX)(s);return{chatId:i,gifts:t?.gifts,selectedMemberList:t?.selectedMemberIds,selectedChannelList:t?.selectedChannelIds,giveawayBoostPerPremiumLimit:e.appConfig?.giveawayBoostsPerPremium,isStarsGiftEnabled:e.appConfig?.isStarsGiftEnabled,userSelectionLimit:e.appConfig?.giveawayAddPeersMax,countrySelectionLimit:e.appConfig?.giveawayCountriesMax,countryList:e.countryList.general,prepaidGiveaway:t?.prepaidGiveaway,isChannel:n,starsGiftOptions:t?.starOptions}}))((({chatId:e,gifts:t,isOpen:i,isChannel:a,selectedMemberList:r,selectedChannelList:c,giveawayBoostPerPremiumLimit:d=o.CQG,countryList:h,prepaidGiveaway:m,countrySelectionLimit:u=o.y67,userSelectionLimit:p=o.qbC,isStarsGiftEnabled:v,starsGiftOptions:g})=>{const A=(0,s.li)(),{closeGiveawayModal:b,openInvoice:f,openPremiumModal:C,launchPrepaidGiveaway:y,launchPrepaidStarsGiveaway:S}=(0,n.ko)(),w=(0,M.A)(),[k,N,I]=(0,Y.A)(),[P,F,T]=(0,Y.A)(),[B,R,L]=(0,Y.A)(),[x,E,V]=(0,Y.A)(),[_,U,O]=(0,Y.A)(),K=[{name:"Premium.Title",text:"BoostingWinnersRandomly",value:"premium_giveaway",img:ir,actions:"createPremiumGiveaway",isLink:!0,onClickAction:()=>{E()}}];v&&K.push({name:"TelegramStars",text:"BoostingWinnersRandomly",value:"stars_giveaway",img:ar,actions:"createStarsGiveaway",isLink:!1});const[J,G]=(0,s.J0)(Date.now()+2592e5),[j,z]=(0,s.J0)(!0),[H,$]=(0,s.J0)(5),[te,ie]=(0,s.J0)(K[0].value),[se,ne]=(0,s.J0)(),[ae,oe]=(0,s.J0)("all"),[re,le]=(0,s.J0)(),[ce,de]=(0,s.J0)([]),[he,ue]=(0,s.J0)([]),[pe,ve]=(0,s.J0)([]),[ge,Ae]=(0,s.J0)(!1),[be,fe]=(0,s.J0)(!1),[Ce,ye]=(0,s.J0)(void 0),[Se,we]=(0,s.J0)(void 0),[ke,Ne]=(0,s.J0)(void 0),Ie="premium_giveaway"===te,Pe="stars_giveaway"===te,Ye=Ie&&!ce.length?H:ce.length,Fe=Ye*d,De=se?.yearlyBoosts,Me=(0,s.Kr)((()=>[{value:"all",label:w(a?"BoostingAllSubscribers":"BoostingAllMembers"),subLabel:pe&&pe.length>0?w("Giveaway.ReceiverType.Countries",pe.length):w("BoostingFromAllCountries")},{value:"new",label:w(a?"BoostingNewSubscribers":"BoostingNewMembers"),subLabel:pe&&pe.length>0?w("Giveaway.ReceiverType.Countries",pe.length):w("BoostingFromAllCountries")}]),[a,w,pe]),Te=w("Months",re),Be="starsGiveaway"===m?.type,Re="giveaway"===m?.type,Le=(0,s.Kr)((()=>t?.find((e=>e.months===re&&e.users===Ye))),[t,re,Ye]),xe=(0,s.Kr)((()=>g?.find((e=>Be&&e.stars===ke?.stars))),[ke,g,Be]),Ee=(0,s.Kr)((()=>t?.filter((e=>e.users===Ye&&e.currency!==o.OUy))),[t,Ye]),Ve=(0,s.Kr)((()=>{const e=Ee?.reduce(((e,t)=>t.amount<e.amount?t:e),Ee[0]);return e&&Math.floor(e.amount/e.months)}),[Ee]),_e=(0,s.Kr)((()=>(0,fi.Am)(t?.filter((e=>e.currency!==o.OUy))?.map((e=>e.users))||[]).sort(((e,t)=>e-t))),[t]),Ue=(0,s.Kr)((()=>(0,fi.Am)(se?.winners?.map((e=>e.users))||[]).sort(((e,t)=>e-t))),[se]);(0,s.vJ)((()=>{i&&t?.length&&!Be&&le(t?.[0].months)}),[i,t,Be]),(0,s.vJ)((()=>{i&&g?.length&&!Re&&ne(g?.[0])}),[i,g,Re]),(0,s.vJ)((()=>{i&&Be&&($(m.quantity),Ne(m))}),[i,Be,m]),(0,s.vJ)((()=>{i&&Re&&($(m.quantity),we(m),le(m.months))}),[i,Re,m]),(0,s.vJ)((()=>{r&&de(r)}),[r]),(0,s.vJ)((()=>{c&&ue(c)}),[c]);const Oe=(0,D.A)((()=>{C()})),Ke=(0,D.A)((()=>{Ne(void 0),we(void 0),ne(void 0),le(void 0),$(5),b()})),Je=(0,D.A)((()=>{f(Ie?ce?.length?{type:"giftcode",boostChannelId:e,userIds:ce,currency:Le.currency,amount:Le.amount,option:Le}:{type:"giveaway",chatId:e,additionalChannelIds:he,isOnlyForNewSubscribers:"new"===ae,countries:pe,areWinnersVisible:ge,prizeDescription:Ce,untilDate:J/1e3,currency:Le.currency,amount:Le.amount,option:Le}:{type:"starsgiveaway",chatId:e,additionalChannelIds:he,isOnlyForNewSubscribers:"new"===ae,countries:pe,areWinnersVisible:ge,prizeDescription:Ce,untilDate:J/1e3,currency:se.currency,amount:se.amount,stars:se.stars,users:H}),Ke()})),Ge=(0,D.A)((()=>{Be?S({chatId:e,giveawayId:ke.id,paymentPurpose:{additionalChannelIds:he,countries:pe,prizeDescription:Ce,areWinnersVisible:ge,untilDate:J/1e3,stars:ke.stars,currency:xe.currency,amount:xe.amount,users:ke.quantity}}):y({chatId:e,giveawayId:Se.id,paymentPurpose:{additionalChannelIds:he,countries:pe,prizeDescription:Ce,areWinnersVisible:ge,untilDate:J/1e3,currency:Le.currency,amount:Le.amount}}),L(),Ke()})),je=(0,D.A)((e=>{$(e)})),He=(0,D.A)((e=>{$(e)})),$e=(0,D.A)((e=>{ye(e.target.value)})),qe=(0,s.Kr)((()=>{const e=(0,n.mS)().users.byId;return ce?.map((t=>(0,l.Yg)(e[t]))).join(", ")}),[ce]),We=(0,D.A)((e=>{oe(e)})),Qe=(0,D.A)((e=>{ie(e),de([]),$(5)})),Ze=(0,D.A)((e=>{G(e.getTime()),I()})),Xe=(0,D.A)((e=>{ve(e)})),et=(0,D.A)((e=>{de(e),e.length||ie("premium_giveaway")})),tt=(0,D.A)((e=>{ue(e)})),it=(0,D.A)((e=>{Ae(e.target.checked)})),st=(0,D.A)((e=>{fe(e.target.checked)})),nt=(0,D.A)((()=>{F()})),at=(0,D.A)((e=>{ne(e)}));function ot(){return(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:Jo,children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingChannelsGroupsIncludedGiveaway")}),(0,ee.Y)(ci.A,{inactive:!0,className:"chat-item-clickable contact-list-item",children:(0,ee.Y)(Bs.A,{chatId:e,status:w(a?"BoostingChannelWillReceiveBoost":"BoostingGroupWillReceiveBoost",Fe||De,"i")})}),he?.map((e=>(0,ee.Y)(ci.A,{ripple:!0,className:"chat-item-clickable contact-list-item",onClick:()=>function(e){const t=he.filter((t=>t!==e));ue(t)}(e),rightElement:(0,ee.Y)(q.A,{name:"close",className:"UZdErfVI"}),children:(0,ee.Y)(Bs.A,{chatId:e.toString()})},e))),he.length<9&&(0,ee.Y)(ci.A,{icon:"add",ripple:!0,onClick:U,className:"sOXvh85b",iconClassName:"aGbyR60s",children:w("BoostingAddChannelOrGroup")})]}),(0,ee.FD)("div",{className:Jo,children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingEligibleUsers")}),(0,ee.Y)("div",{className:Go,children:(0,ee.Y)(X.A,{name:"subscribers",options:Me,selected:ae,onChange:We,onClickAction:nt,subLabelClassName:"txXJxVFu",isLink:!0})})]}),(0,ee.Y)("div",{className:zo,children:(0,Ft.A)(w(a?"BoostGift.LimitSubscribersInfo":"lng_giveaway_users_about_group"))}),(0,ee.FD)("div",{className:Jo,children:[(0,ee.FD)("div",{className:er,children:[(0,ee.Y)("h2",{className:Xo,children:w("BoostingGiveawayAdditionalPrizes")}),(0,ee.Y)(bi.A,{label:w("BoostingGiveawayAdditionalPrizes"),checked:be,onChange:st})]}),be&&(0,ee.FD)("div",{className:"eQVP0Nx8",children:[(0,ee.Y)("h2",{className:Xo,children:H}),(0,ee.Y)(Q.A,{className:"qMYNwiUZ",value:Ce,onChange:$e,label:w("BoostingGiveawayEnterYourPrize")})]})]}),be?Pe||Be?void 0:(0,ee.Y)("div",{className:zo,children:Ce?.length?(0,Ft.A)(w("BoostingGiveawayAdditionPrizeCountNameHint",Se?[Se.quantity,Ce,Te]:[Ye,Ce,Te],void 0,re),["simple_markdown"]):(0,Ft.A)(w("BoostingGiveawayAdditionPrizeCountHint",Se?[Se.quantity,Te]:[Ye,Te],void 0,re),["simple_markdown"])}):(0,ee.Y)("div",{className:zo,children:(0,Ft.A)(w("BoostingGiveawayAdditionPrizeHint"))}),(0,ee.Y)("div",{className:Jo,children:(0,ee.FD)("div",{className:er,children:[(0,ee.Y)("h2",{className:Xo,children:w("BoostingGiveawayShowWinners")}),(0,ee.Y)(bi.A,{label:w("BoostingGiveawayAdditionalPrizes"),checked:ge,onChange:it})]})}),(0,ee.Y)("div",{className:zo,children:(0,Ft.A)(w("BoostingGiveawayShowWinnersHint"))}),(0,ee.FD)("div",{className:(0,me.A)(Jo,(Se||ke||Pe)&&Zo),children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingDateWhenGiveawayEnds")}),(0,ee.FD)(W.A,{ariaLabel:w("BoostGift.DateEnds"),className:(0,me.A)("GeKqKRgP","expire-limit"),isText:!0,onClick:N,children:[(0,ee.Y)("h3",{className:Xo,children:w("BoostGift.DateEnds")}),(0,ze.L2)(J,w.code)]})]})]})}return(0,ee.FD)(Z.A,{className:"P0kLOw15",onClose:Ke,isOpen:i,dialogRef:A,onEnter:Se||ke?R:Je,children:[(0,ee.FD)("div",{className:(0,me.A)("SqiN63Ef","custom-scroll"),onScroll:function(e){const{scrollTop:t}=e.currentTarget;z(t<=150)},children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",className:"OX6_HqAd",color:"translucent",onClick:Ke,ariaLabel:w("Close"),children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("img",{className:"Me2hCsMs",src:Ao,alt:"",draggable:!1}),(0,ee.Y)("h2",{className:"UVDnB0Wq",children:(0,Ft.A)(w("BoostingBoostsViaGifts"))}),(0,ee.Y)("div",{className:"v5yGzV6v",children:(0,Ft.A)(w(a?"BoostingGetMoreBoost":"BoostingGetMoreBoostsGroup"))}),(0,ee.Y)("div",{className:(0,me.A)("U6XNIToQ",j&&"tDZc21ZC"),children:(0,ee.Y)("h2",{className:"v6hiGpEn",children:w("BoostingBoostsViaGifts")})}),Se||ke?(0,ee.FD)("div",{className:"q1y2qUTn",children:[(0,ee.Y)("div",{children:ke?(0,ee.Y)("img",{className:tr,src:ar,alt:""}):(0,ee.Y)("img",{className:tr,src:or[Se.months]||or[3],alt:""})}),(0,ee.FD)("div",{className:"IsT38nlq",children:[(0,ee.Y)("h3",{className:Xo,children:ke?w("Giveaway.Stars.Prepaid.Title",ke?.stars):w("BoostingTelegramPremiumCountPlural",Se.quantity)}),(0,ee.Y)("p",{className:"TsGuei3B",children:ke?w("Giveaway.Stars.Prepaid.Desc",ke?.quantity):w("PrepaidGiveawayMonths",Se?.months)})]}),(0,ee.Y)("div",{className:Ho,children:(0,ee.FD)("div",{className:(0,me.A)($o,qo),children:[(0,ee.Y)(q.A,{name:"boost",className:Wo}),(0,ee.Y)("div",{className:Qo,dir:w.isRtl?"rtl":void 0,children:ke?ke?.boosts:Se.quantity*(d??o.CQG)})]})})]}):(0,ee.Y)("div",{className:(0,me.A)(Jo,"sQ5PkKEs"),children:(0,ee.Y)("div",{className:Go,children:K.map((e=>(0,ee.Y)(Oo,{name:e.name,text:e.text,option:e.value,img:e.img,onChange:Qe,checked:te===e.value,isLink:e.isLink,userNames:qe,selectedMemberIds:ce,onClickAction:e.onClickAction},e.name)))})}),Ie&&!ce?.length&&(0,ee.FD)(ee.FK,{children:[!Se&&!ke&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:Jo,children:[(0,ee.FD)("div",{className:Ho,children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingQuantityPrizes")}),(0,ee.FD)("div",{className:(0,me.A)($o,qo),children:[(0,ee.Y)(q.A,{name:"boost",className:Wo}),(0,ee.Y)("div",{className:Qo,dir:w.isRtl?"rtl":void 0,children:Fe})]})]}),(0,ee.Y)(Vo.A,{rangeCount:Ye,marks:_e,onChange:je})]}),(0,ee.Y)("div",{className:zo,children:(0,Ft.A)(w("BoostingChooseHowMany"))})]}),ot()]}),Pe&&(0,ee.FD)(ee.FK,{children:[!ke&&!Se&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:Jo,children:[(0,ee.FD)("div",{className:Ho,children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingStarsOptions")}),(0,ee.FD)("div",{className:(0,me.A)($o,qo),children:[(0,ee.Y)(q.A,{name:"boost",className:Wo}),(0,ee.Y)("div",{className:Qo,dir:w.isRtl?"rtl":void 0,children:De})]})]}),(0,ee.Y)(xo.A,{className:"cLhNkYPB",options:g,selectedStarCount:H,selectedStarOption:se,onClick:at})]}),(0,ee.Y)("div",{className:(0,me.A)(zo,"bzRAETfR"),children:(0,Ft.A)(w("BoostGift.Stars.Info"))}),(0,ee.FD)("div",{className:Jo,children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingStarsQuantityPrizes")}),(0,ee.Y)(Vo.A,{rangeCount:H,marks:Ue,onChange:He}),(0,ee.Y)("div",{className:zo,children:(0,Ft.A)(w("BoostingStarsQuantityPrizesInfo"))})]})]}),ot()]}),!Se&&!ke&&Ie&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:Jo,children:[(0,ee.Y)("h2",{className:jo,children:w("BoostingDurationOfPremium")}),(0,ee.Y)("div",{className:Go,children:Ee?.map((e=>(0,ee.Y)(oo,{isGiveaway:!0,option:e,fullMonthlyAmount:Ve,checked:e.months===re,onChange:le},e.months)))})]}),(0,ee.Y)("div",{className:(0,me.A)(zo,Zo),children:function(){const e=w("GiftPremiumListFeaturesAndTerms").match(/([^*]*)\*([^*]+)\*(.*)/);if(e&&!(e.length<4))return(0,ee.FD)("p",{className:"eNQ_nrKr",children:[e[1],(0,ee.Y)(Eo.A,{isPrimary:!0,onClick:Oe,children:e[2]}),e[3]]})}()})]}),te&&(0,ee.Y)("div",{className:"hD_AEzjd",children:(0,ee.Y)(W.A,{className:"ILuhBsJG",onClick:Se||ke?R:Je,children:w("BoostingStartGiveaway")})})]}),(0,ee.Y)(Cn,{isOpen:k,isFutureMode:!0,withTimePicker:!0,onClose:I,onSubmit:Ze,selectedAt:J,submitButtonLabel:w("Save")}),(0,ee.Y)(Lo,{isOpen:P,onClose:T,countryList:h,onSubmit:Xe,selectionLimit:u}),(0,ee.Y)(Ko,{isOpen:x,onClose:V,onSelectedIdsConfirmed:et,initialSelectedIds:ce,selectionLimit:p,giveawayChatId:e}),(0,ee.Y)(Uo,{isOpen:_,onClose:O,initialSelectedIds:he,onSelectedIdsConfirmed:tt,selectionLimit:o.cgU,giveawayChatId:e}),(0,ee.Y)(vi.A,{title:w("BoostingStartGiveawayConfirmTitle"),text:w("BoostingStartGiveawayConfirmText"),confirmLabel:w("Start"),isOpen:B,onClose:L,confirmHandler:Ge})]})}))),lr={dialogFiltersChats:"LimitReachedChatInFolders",uploadMaxFileparts:"LimitReachedFileSize",dialogFilters:"LimitReachedFolders",dialogFolderPinned:"LimitReachedPinDialogs",channelsPublic:"LimitReachedPublicLinks",channels:"LimitReachedCommunities",chatlistInvites:"LimitReachedFolderLinks",chatlistJoined:"LimitReachedSharedFolders",savedDialogsPinned:"LimitReachedPinSavedDialogs"},cr={dialogFiltersChats:"LimitReachedChatInFoldersLocked",uploadMaxFileparts:"LimitReachedFileSizeLocked",dialogFilters:"LimitReachedFoldersLocked",dialogFolderPinned:"LimitReachedPinDialogsLocked",channelsPublic:"LimitReachedPublicLinksLocked",channels:"LimitReachedCommunitiesLocked",chatlistInvites:"LimitReachedFolderLinksLocked",chatlistJoined:"LimitReachedSharedFoldersLocked",savedDialogsPinned:"LimitReachedPinSavedDialogsLocked"},dr={dialogFiltersChats:"LimitReachedChatInFoldersPremium",uploadMaxFileparts:"LimitReachedFileSizePremium",dialogFilters:"LimitReachedFoldersPremium",dialogFolderPinned:"LimitReachedPinDialogsPremium",channelsPublic:"LimitReachedPublicLinksPremium",channels:"LimitReachedCommunitiesPremium",chatlistInvites:"LimitReachedFolderLinksPremium",chatlistJoined:"LimitReachedSharedFoldersPremium",savedDialogsPinned:"LimitReachedPinSavedDialogsPremium"},hr={dialogFiltersChats:"chat-badge",uploadMaxFileparts:"file-badge",dialogFilters:"folder-badge",dialogFolderPinned:"pin-badge",channelsPublic:"link-badge",channels:"chats-badge",chatlistInvites:"link-badge",chatlistJoined:"folder-badge",savedDialogsPinned:"pin-badge"},mr={uploadMaxFileparts:(e,t)=>8e3===t?e("FileSize.GB","4"):4e3===t?e("FileSize.GB","2"):(0,He.v7)(e,t*o.dK5)},ur=(0,s.ph)((0,n.EK)(((e,{limit:t})=>{const{limits:i}=e.appConfig||{},s=(0,c.g29)(e);return{defaultValue:t?i?.[t][0]:void 0,premiumValue:t?i?.[t][1]:void 0,canBuyPremium:!(0,c.n_C)(e),isPremium:s}}))((({defaultValue:e,premiumValue:t,limit:i,isPremium:a,canBuyPremium:o})=>{const{closeLimitReachedModal:r,openPremiumModal:l}=(0,n.ko)(),c=(0,M.A)(),[d,h,m]=(0,Y.A)(),u=(0,s.hb)((()=>{l(),h()}),[l,h]);(0,s.vJ)((()=>{!i&&d&&m()}),[d,i,m]);const p=c("LimitReached"),v=i&&mr[i],g=function({lang:e,limitType:t,isPremium:i,canBuyPremium:s,defaultValue:n,premiumValue:a,valueFormatter:o}){if(!t)return;const r=o?o(e,n):n,l=o?o(e,a):a;return i?e(dr[t],l):s?e(lr[t],"channelsPublic"===t?l:[r,l]):e(cr[t],r)}({lang:c,limitType:i,isPremium:a,canBuyPremium:o,defaultValue:e,premiumValue:t,valueFormatter:v}),A=i&&hr[i],b=o&&!a;return(0,ee.FD)(Z.A,{onClose:h,onCloseAnimationEnd:r,isOpen:Boolean(i)&&!d,title:p,className:"QAs_iFxO",children:[!b&&(0,ee.FD)("div",{className:"Q5d_7bB4",children:[(0,ee.Y)("i",{className:(0,me.A)("rbnU7JVX",A,"icon")}),(0,ee.Y)("div",{className:"ArEy3hhB",children:v?.(c,a?t:e)||(a?t:e)})]}),b&&(0,ee.Y)(Ta,{className:"k0O6Rnjh",leftValue:v?.(c,e)||e?.toString(),rightValue:v?.(c,t)||t?.toString(),floatingBadgeIcon:A}),(0,ee.Y)("div",{children:(0,Ft.A)(g||"",["simple_markdown","br"])}),(0,ee.FD)("div",{className:"RVM_RSap",children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:h,color:"primary",children:c(b?"Cancel":"OK")}),b&&(0,ee.FD)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:u,color:"primary",children:[c("IncreaseLimit"),(0,ee.Y)(q.A,{name:"double-badge",className:"esB1OhAF"})]})]})]})})));var pr=i(93809),vr=i(81954),gr=i(5912);const Ar=350+o.xB5,br=.5*p.$;function fr(e,t,i,n){const a=(0,s.li)([]),[o,r]=(0,s.J0)(0),{observe:l,freeze:c,unfreeze:d}=(0,gr.BL)({rootRef:e},(e=>{const t=a.current;e.forEach((e=>{const s=Number(e.target.id.replace(`${i}-`,""));t[s]=e.isIntersecting}));const s=t.reduce(((e,t,i)=>t&&i<e?i:e),1/0);s!==1/0&&r(s)})),{observe:h,freeze:m,unfreeze:u}=(0,gr.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:p}=(0,gr.BL)({rootRef:e,throttleMs:200,margin:100}),{observe:v}=(0,gr.BL)({rootRef:t});return(0,G.A)((()=>{n?(c(),m()):setTimeout((()=>{u(),d()}),Ar)}),[c,m,n,d,u]),{activeSetIndex:o,observeIntersectionForSet:l,observeIntersectionForShowingItems:h,observeIntersectionForPlayingItems:p,observeIntersectionForCovers:v,selectStickerSet:(0,D.A)((t=>{r((s=>{const n=document.getElementById(`${i}-${t}`),a=1===Math.abs(s-t);return(0,vr.Ay)({container:e.current,element:n,position:"start",margin:br,maxDistance:a?200:80}),t}))}))}}var Cr=i(37479),yr=i(87094),Sr=i(94519),wr=i(47483);const kr=(0,s.ph)((({stickerSet:e,size:t=o.TBj,noPlay:i,forcePlayback:a,observeIntersection:r,sharedCanvasRef:d})=>{const{loadStickers:h}=(0,n.ko)(),m=(0,s.li)(),{hasThumbnail:u,hasVideoThumb:p,hasAnimatedThumb:v,hasStaticThumb:g,thumbCustomEmojiId:A}=e,{customEmoji:f}=(0,wr.A)(A),C=f?.shouldUseTextColor,y=(0,yr.A)(m,void 0,!C),S=(0,Cr.A)(y),w=(0,gr.Vz)(m,r),k=w&&!i,N=!u||p&&!b.OF&&!v&&!g,I=N&&e.stickers?.[0]&&(0,l.Mw)(e.stickers[0],"preview"),P=(0,j.A)(I,!w),Y=(u&&!I||v)&&`stickerSet${e.id}`,F=(0,j.A)(Y,!w),D=A||F||P,M=(0,Oi.A)(D),T=(0,Sr.A)(m,d);return(0,s.vJ)((()=>{w&&!e.stickers?.length&&h({stickerSetInfo:e})}),[w,h,e]),(0,ee.Y)("div",{ref:m,className:(0,me.A)("m6XpTzQX","sticker-set-cover"),style:`--_size: ${t}px`,children:D?A?(0,ee.Y)(wa.A,{documentId:A,size:t,observeIntersectionForPlaying:r,noPlay:i}):v?(0,ee.Y)(Ea.A,{className:M,tgsUrl:F,size:t,play:k,isLowPriority:!(0,c.CzR)((0,n.mS)(),e),sharedCanvas:d?.current||void 0,sharedCanvasCoords:T,forceAlways:a}):p&&!N?(0,ee.Y)(ss.A,{className:(0,me.A)("OZHqKbDL",M),src:F,canPlay:k,style:S,isPriority:a,loop:!0,disablePictureInPicture:!0}):(0,ee.Y)("img",{src:F||P,style:S,className:(0,me.A)("enA6c8gc",M),alt:"",draggable:!1}):(0,He.Qh)(e.title,2)})}));var Nr=i(54464),Ir=i(85118),Pr=i(82855);const Yr=[{title:"SetTimeoutFor.Hours",value:1,arg:3600},{title:"SetTimeoutFor.Hours",value:2,arg:7200},{title:"SetTimeoutFor.Hours",value:8,arg:28800},{title:"SetTimeoutFor.Days",value:1,arg:86400},{title:"SetTimeoutFor.Days",value:2,arg:172800}],Fr=(0,s.ph)((({sticker:e,size:t,noPlay:i,title:a,className:o,noContextMenu:r,isSavedMessages:l,isStatusPicker:c,canViewSet:d,observeIntersection:h,observeIntersectionForShowing:m,isSelected:u,isCurrentUserPremium:p,shouldIgnorePremium:v,noShowPremium:g,sharedCanvasRef:A,withTranslucentThumb:f,forcePlayback:C,onClick:y,clickArg:S,onFaveClick:w,onUnfaveClick:k,onRemoveRecentClick:N,onContextMenuOpen:I,onContextMenuClose:P,onContextMenuClick:Y,isEffectEmoji:F,withSparkles:T})=>{const{openStickerSet:B,openPremiumModal:R,setEmojiStatus:L}=(0,n.ko)(),x=(0,s.li)(),E=(0,s.li)(),V=(0,M.A)(),_=e.shouldUseTextColor,U=(0,yr.A)(x,void 0,!_),{id:O,stickerSetInfo:K}=e,J=!e.isFree&&F||e.hasEffect,G=e.isCustomEmoji||F,j=!p&&J&&!v,z=(0,gr.Vz)(x,h),H=z,$=z&&!i,Q=(0,gr.Vz)(x,m),{isContextMenuOpen:Z,contextMenuAnchor:X,handleBeforeContextMenu:te,handleContextMenu:ie,handleContextMenuClose:se,handleContextMenuHide:ne}=(0,Fn.A)(x),ae=Boolean(!r&&X),oe=(0,D.A)((()=>x.current)),re=(0,D.A)((()=>x.current.closest(".custom-scroll, .no-scrollbar"))),le=(0,D.A)((()=>c?E.current:x.current.querySelector(".sticker-context-menu .bubble"))),de=(0,D.A)((()=>({withPortal:c,shouldAvoidNegativePosition:!0})));(0,s.vJ)((()=>{Z?I?.():P?.()}),[Z,P,I]),(0,s.vJ)((()=>{z||se()}),[se,z]);const he=(0,D.A)((t=>{t.stopPropagation(),t.preventDefault(),N(e)})),ue=(0,D.A)((()=>{N(e)})),pe=(0,D.A)((()=>{k(e)})),ve=(0,D.A)((()=>{w(e)})),ge=(0,D.A)((()=>{y?.(S,!0)})),Ae=(0,D.A)((()=>{y?.(S,void 0,!0)})),be=(0,D.A)((()=>{B({stickerSetInfo:K})})),fe=(0,D.A)(((t,i=0)=>{t.preventDefault(),t.stopPropagation(),se(),Y?.(),L({emojiStatus:{type:"regular",documentId:e.id,until:(0,li.Fm)()+i}})})),Ce=!b.TF&&N,ye=(0,me.A)("StickerButton",y&&"interactive",u&&"selected",G&&"custom-emoji",F&&"effect-emoji",o),Se=(0,s.Kr)((()=>{if(!ae||r||G&&!c)return[];const e=[];return G?(Yr.forEach((t=>{e.push((0,ee.Y)(ce.A,{onClick:fe,clickArg:t.arg,children:V(t.title,t.value,"i")}))})),e):(k&&e.push((0,ee.Y)(ce.A,{icon:"favorite",onClick:pe,children:V("Stickers.RemoveFromFavorites")})),w&&e.push((0,ee.Y)(ce.A,{icon:"favorite",onClick:ve,children:V("Stickers.AddToFavorites")})),!j&&y&&(l||e.push((0,ee.Y)(ce.A,{onClick:ge,icon:"muted",children:V("SendWithoutSound")})),e.push((0,ee.Y)(ce.A,{onClick:Ae,icon:"calendar",children:V(l?"SetReminder":"ScheduleMessage")}))),d&&e.push((0,ee.Y)(ce.A,{onClick:be,icon:"stickers",children:V("ViewPackPreview")})),N&&e.push((0,ee.Y)(ce.A,{icon:"delete",onClick:ue,children:V("DeleteFromRecent")})),e)}),[ae,r,G,c,k,w,j,y,d,N,fe,V,pe,ve,l,Ae,ge,be,ue]);return(0,ee.FD)("div",{ref:x,className:ye,title:a||e?.emoji,"data-sticker-id":O,onMouseDown:e=>{(0,Nr.u)(e),te(e)},onClick:()=>{Z||(j?R(F?{initialSection:"effects"}:{initialSection:"premium_stickers"}):y?.(S))},onContextMenu:ie,children:[T&&(0,ee.Y)(Ir.A,{preset:"button"}),Q&&(0,ee.Y)(Pr.A,{containerRef:x,sticker:e,isSmall:!0,size:t,shouldLoop:!0,shouldPreloadPreview:!0,noLoad:!H,noPlay:!$,noVideoOnMobile:!0,withSharedAnimation:!0,sharedCanvasRef:A,withTranslucentThumb:f,customColor:U,forceAlways:C}),!g&&j&&(0,ee.Y)("div",{className:"sticker-locked",children:(0,ee.Y)(q.A,{name:"lock-badge"})}),!g&&J&&!j&&(0,ee.Y)("div",{className:"sticker-premium",children:(0,ee.Y)(q.A,{name:"star"})}),Ce&&(0,ee.Y)(W.A,{className:"sticker-remove-button",color:"dark",round:!0,noFastClick:!0,onClick:he,children:(0,ee.Y)(q.A,{name:"close"})}),Boolean(Se.length)&&(0,ee.Y)($e.A,{ref:E,isOpen:Z,anchor:X,getTriggerElement:oe,getRootElement:re,getMenuElement:le,getLayout:de,className:"sticker-context-menu",autoClose:!0,withPortal:c,onClose:se,onCloseAnimationEnd:ne,children:Se})]})}));var Dr=i(93545),Mr=i(78376),Tr=i(64489);const Br=(0,s.ph)((({reaction:e,availableReactions:t,isSelected:i,loadAndPlay:n,observeIntersection:a,sharedCanvasRef:r,sharedCanvasHqRef:c,forcePlayback:d,onClick:h,onContextMenu:m})=>{const u=(0,s.li)(),p="custom"===e.type,v=(0,s.Kr)((()=>t?.find((t=>(0,l.a0)(t.reaction,e)))),[t,e]),g=v?.staticIcon?.thumbnail?.dataUri,A=v?.selectAnimation?.id,b=(0,Sr.A)(u,r),f=(0,j.A)(v?.selectAnimation?(0,l.mr)(v.selectAnimation,"full"):void 0,!A),{isContextMenuOpen:C,handleBeforeContextMenu:y,handleContextMenu:S,handleContextMenuClose:w,handleContextMenuHide:k}=(0,Fn.A)(u,"paid"!==e.type,void 0,void 0,void 0,!0);(0,s.vJ)((()=>{C&&(m?.(e),w(),k())}),[w,m,k,C,e]);const N="paid"===e.type?Mr.w.StarReaction:f,I=(0,D.A)((()=>{h(e)})),P=(0,Oi.A)(f),Y=(0,me.A)("AVrrYEbM",i&&"QkdO_lz1",!p&&"sticker-reaction");return(0,ee.Y)("div",{ref:u,className:Y,onClick:I,title:v?.title,"data-sticker-id":p?e.documentId:void 0,onMouseDown:y,onContextMenu:S,children:p?(0,ee.Y)(wa.A,{ref:u,documentId:e.documentId,size:o.g0Q,noPlay:!n,observeIntersectionForPlaying:a,sharedCanvasRef:r,sharedCanvasHqRef:c,withTranslucentThumb:!0,forceAlways:d}):(0,ee.Y)(Tr.A,{tgsUrl:N,thumbDataUri:g,play:n,noLoop:!1,size:o.g0Q,isLowPriority:!0,className:P,sharedCanvas:r.current||void 0,sharedCanvasCoords:b,forceAlways:d})})}));var Rr=i(38027);const Lr=(0,s.ph)((0,n.EK)((e=>{const t=e.collectibleEmojiStatuses?.statuses;return{collectibleStatuses:t}}))((({stickerSet:e,loadAndPlay:t,index:i,idPrefix:a,isNearActive:r,favoriteStickers:d,availableReactions:h,isSavedMessages:m,isStatusPicker:u,isReactionPicker:p,isCurrentUserPremium:v,shouldHideHeader:g,withDefaultTopicIcon:A,selectedReactionIds:b,withDefaultStatusIcon:f,isChatEmojiSet:C,isChatStickerSet:y,isTranslucent:S,noContextMenus:w,forcePlayback:k,observeIntersection:N,observeIntersectionForPlayingItems:P,observeIntersectionForShowingItems:F,onReactionSelect:T,onReactionContext:B,onStickerSelect:R,onStickerUnfave:L,onStickerFave:x,onStickerRemoveRecent:E,onContextMenuOpen:V,onContextMenuClose:_,onContextMenuClick:U,collectibleStatuses:O})=>{const{clearRecentStickers:K,clearRecentCustomEmoji:J,clearRecentReactions:G,openPremiumModal:j,toggleStickerSet:z,loadStickers:H}=(0,n.ko)(),$=(0,s.li)(),Q=(0,s.li)(),Z=(0,s.li)(),X=(0,M.A)(),{width:te}=(0,we.A)(),[ie,se,ne]=(0,Y.A)(),{isMobile:ae}=(0,I.Ay)(),[oe,re]=(0,s.J0)(xr(te)),le=(0,gr.Vz)($,N??F),ce=(0,Oi.A)(le),de=r||le,he=ae?8:4,ue=ae?8:10,pe=ae?8:4,ve=e.id===o.sR2,ge=e.id===o.j1l,Ae=e.id===o.tRH,be=e.id===o.EPW,fe=e.isEmoji,Ce=!ve&&(0,c.Q31)(e),ye=(0,D.A)((()=>{p?G():fe?J():K(),ne()})),Se=(0,D.A)((()=>{Ce&&!v?j({initialSection:"animated_emoji"}):z({stickerSetId:e.id})})),ke=(0,D.A)((()=>{R?.({mediaType:"sticker",id:o.MyF,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})})),Ne=(0,D.A)((()=>{R?.({mediaType:"sticker",id:o.zNY,isLottie:!1,isVideo:!1,stickerSetInfo:{shortName:"dummy"}})})),Ie=fe?o.g0Q:o.bkT,Pe=fe?ue:he,Ye=fe?pe:he,Fe=(0,D.A)((e=>e?Math.floor((e+Pe)/(Ie+Pe)):xr(te))),De=(0,D.A)((e=>{re(Fe(e.contentRect.width))}));(0,Dr.A)($,De),(0,s.vJ)((()=>{$.current&&re(Fe($.current.clientWidth))}),[Fe]),(0,s.vJ)((()=>{de&&!e.stickers?.length&&!e.reactions?.length&&e.accessHash&&H({stickerSetInfo:{id:e.id,accessHash:e.accessHash}})}),[de,H,e]);const Me=!m&&!v&&Ce&&!C,Te=e.installedDate&&!e.isArchived,Be=!Te&&e.id!==o.sR2&&e.id!==o.EPW&&e.id!==o.hfH&&e.id!==o.Kp3&&!C&&!y,[Re,,Le]=(0,Y.A)(Be),xe=3*oe-1,Ee=A||f?e.count+1:e.count,Ve=Ie+Ye,_e=Math.ceil(Math.min(xe,Ee)/oe)*Ve-Ye,Ue=Re?_e:Math.ceil(Ee/oe)*Ve-Ye,Oe=(0,s.Kr)((()=>d?new Set(d.map((({id:e})=>e))):void 0),[d]),Ke=(0,s.Kr)((()=>O?new Set(O.map((({documentId:e})=>e))):void 0),[O]),Je=!g&&!ve&&!ge&&fe&&!be&&!C&&(!Te||!v&&!m),Ge=(0,s.Kr)((()=>X(Me?Te?"lng_emoji_premium_restore":"Unlock":"Add")),[Me,X,Te]);return(0,ee.FD)("div",{ref:$,id:`${a}-${i}`,className:(0,me.A)("symbol-set",Me&&"symbol-set-locked"),children:[!g&&(0,ee.FD)("div",{className:"symbol-set-header",children:[(0,ee.FD)("p",{className:(0,me.A)("symbol-set-title",Je&&"symbol-set-title-external"),children:[Me&&(0,ee.Y)(q.A,{name:"lock-badge",className:"symbol-set-locked-icon"}),(0,ee.Y)("span",{className:"symbol-set-name",children:e.title}),(C||y)&&(0,ee.Y)("span",{className:"symbol-set-chat",children:X(C?"GroupEmoji":"GroupStickers")}),Je&&Boolean(e.stickers)&&(0,ee.Y)("span",{className:"symbol-set-amount",children:X(fe?"EmojiCount":"Stickers",e.stickers.length,"i")})]}),ve&&(0,ee.Y)(q.A,{className:"symbol-set-remove",name:"close",onClick:se}),Je&&(0,ee.Y)(W.A,{className:"symbol-set-add-button",withPremiumGradient:Ce&&!v,onClick:Se,pill:!0,size:"tiny",fluid:!0,children:Ge})]}),(0,ee.FD)("div",{className:(0,me.A)("symbol-set-container shared-canvas-container",ce,e.id===o.hfH&&"effect-emojis"),style:`height: ${Ue}px;`,children:[(0,ee.Y)("canvas",{ref:Q,className:"shared-canvas",style:Be?`height: ${_e}px;`:void 0}),(ve||Ae||Be)&&(0,ee.Y)("canvas",{ref:Z,className:"shared-canvas"}),A&&(0,ee.Y)(W.A,{className:"StickerButton custom-emoji",color:"translucent",onClick:ke,children:(0,ee.Y)("img",{src:Rr,alt:"Reset",className:"sticker-media",draggable:!1})},"default-topic-icon"),f&&(0,ee.Y)(W.A,{className:"StickerButton custom-emoji status-default",color:"translucent",onClick:Ne,children:(0,ee.Y)(q.A,{name:"star"})},"default-status-icon"),de&&e.reactions?.map((i=>{const s=(0,l.Jj)(i),n=s?b?.includes(s):void 0;return(0,ee.Y)(Br,{reaction:i,isSelected:n,loadAndPlay:t,availableReactions:h,observeIntersection:P,onClick:T,onContextMenu:B,sharedCanvasRef:Q,sharedCanvasHqRef:Z,forcePlayback:k},`${e.id}_${s}`)})),de&&e.stickers?.slice(0,Re?xe:e.stickers.length).map(((i,s)=>{const a=(ve||Ae)&&(0,c.CzR)((0,n.mS)(),i.stickerSetInfo),r=Be&&s>=xe||a?Z:Q,l=i.isCustomEmoji?i.id:i.emoji,d=l?b?.includes(l):void 0,h=i.id===o.j1l||Ke?.has(i.id);return(0,ee.Y)(Fr,{sticker:i,size:Ie,observeIntersection:P,observeIntersectionForShowing:F,noPlay:!t,isSavedMessages:m,isStatusPicker:u,canViewSet:!0,noContextMenu:w,isCurrentUserPremium:v,shouldIgnorePremium:C,sharedCanvasRef:r,withTranslucentThumb:S,onClick:R,clickArg:i,isSelected:d,onUnfaveClick:Ae&&Oe?.has(i.id)?L:void 0,onFaveClick:Oe?.has(i.id)?void 0:x,onRemoveRecentClick:ve?E:void 0,onContextMenuOpen:V,onContextMenuClose:_,onContextMenuClick:U,forcePlayback:k,isEffectEmoji:e.id===o.hfH,noShowPremium:v&&(e.id===o.Kp3||e.id===o.hfH),withSparkles:h},i.id)})),Re&&Ee>xe&&(0,ee.FD)(W.A,{className:"StickerButton custom-emoji set-expand",round:!0,color:"translucent",onClick:Le,children:["+",Ee-xe]},"more")]}),ve&&(0,ee.Y)(vi.A,{text:X(p?"ClearRecentReactionsAlertMessage":"ClearRecentStickersAlertMessage"),isOpen:ie,onClose:ne,confirmHandler:ye,confirmIsDestructive:!0})]},e.id)})));function xr(e){return e>440?8:e<362?6:7}const Er="p7c8y0LH",Vr="zTGriBHY",_r="Qn3lBUNs",Ur="HMspKpNp",Or="YKO0Obwy",Kr="BZfaP1GD",Jr=2.5*p.$,Gr=new Set([o.sR2,o.tRH,o.EPW]),jr=new Set([o.sR2,o.tRH,o.EPW]),zr=(0,s.ph)((0,n.EK)(((e,{chatId:t,isStatusPicker:i,isReactionPicker:s})=>{const{stickers:{setsById:n},customEmojis:{byId:a,featuredIds:o,statusRecent:{emojis:r}},recentCustomEmojis:l,reactions:{availableReactions:d,recentReactions:h,topReactions:m,defaultTags:u}}=e,p=Boolean(t&&(0,c.nZ4)(e,t)),v=t?(0,c.AWZ)(e,t):void 0,g=e.collectibleEmojiStatuses?.statuses;return{customEmojisById:a,recentCustomEmojiIds:i?void 0:l,recentStatusEmojis:i?r:void 0,collectibleStatuses:i?g:void 0,stickerSetsById:n,addedCustomEmojiIds:e.customEmojis.added.setIds,canAnimate:(0,c.BWX)(e),isSavedMessages:p,isCurrentUserPremium:(0,c.g29)(e),customEmojiFeaturedIds:o,defaultTopicIconsId:e.defaultTopicIconsId,defaultStatusIconsId:e.defaultStatusIconsId,topReactions:s?m:void 0,recentReactions:s?h:void 0,chatEmojiSetId:v?.emojiSet?.id,isWithPaidReaction:s&&v?.isPaidReactionAvailable,availableReactions:s?d:void 0,defaultTagReactions:s?u:void 0}}))((({className:e,pickerListClassName:t,isHidden:i,loadAndPlay:a,addedCustomEmojiIds:r,customEmojisById:d,recentCustomEmojiIds:h,selectedReactionIds:m,recentStatusEmojis:u,collectibleStatuses:p,stickerSetsById:v,chatEmojiSetId:g,topReactions:A,recentReactions:f,availableReactions:C,idPrefix:y="custom-emoji-set",customEmojiFeaturedIds:S,canAnimate:w,isReactionPicker:k,isStatusPicker:N,isTranslucent:P,isSavedMessages:Y,isCurrentUserPremium:F,withDefaultTopicIcons:T,defaultTopicIconsId:B,defaultStatusIconsId:R,defaultTagReactions:L,isWithPaidReaction:x,onCustomEmojiSelect:E,onReactionSelect:V,onReactionContext:_,onContextMenuOpen:U,onContextMenuClose:O,onContextMenuClick:K})=>{const J=(0,s.li)(),G=(0,s.li)(),j=(0,s.li)(),z=(0,s.li)(),{isMobile:H}=(0,I.Ay)(),{handleScroll:$,isAtBeginning:Q}=Fs(),Z=(0,s.Kr)((()=>N?u:Object.values((0,fi._E)(d,h))),[d,N,h,u]),X=(0,s.Kr)((()=>{const e=p?.map((e=>e.documentId));return d&&e?.map((e=>d[e])).filter(Boolean)}),[d,p]),te=`${y}-custom-emoji`,{activeSetIndex:ie,observeIntersectionForSet:se,observeIntersectionForPlayingItems:ne,observeIntersectionForShowingItems:ae,observeIntersectionForCovers:oe,selectStickerSet:re}=fr(J,G,te,i),le=(0,ls.A)(a||void 0,o.jhd),ce=(0,M.A)(),de=(0,_i.A)(),he=Boolean(r),ue=(0,s.Kr)((()=>{const e=[];if(k&&Y&&L?.length&&e.push({id:o.G3A,accessHash:"",title:ce("PremiumPreviewTags"),reactions:L,count:L.length,isEmoji:!0}),k&&!Y){const t=A?.slice(0,16)||[];x&&t.unshift({type:"paid"}),t?.length&&e.push({id:o.G3A,accessHash:"",title:ce("Reactions"),reactions:t,count:t.length,isEmoji:!0});const i=(f||[]).filter((e=>!t.some((t=>(0,l.a0)(t,e))))).slice(0,32),s=(C||[]).filter((({isInactive:e})=>!e)).map((({reaction:e})=>e)).filter((e=>!t.some((t=>(0,l.a0)(t,e)))&&!i.some((t=>(0,l.a0)(t,e)))));if(s?.length||i?.length){const t=!i?.length,n=i.concat(s);e.push({id:t?o.EPW:o.sR2,accessHash:"",title:ce(t?"PopularReactions":"RecentStickers"),reactions:n,count:n.length,isEmoji:!0})}}else if(N){const t=v[R];if(t?.stickers?.length){const i=(0,fi.Xd)(t.stickers.slice(0,7).concat(Z||[]),"id");e.push({...t,stickers:i,count:i.length,id:o.sR2,title:ce("RecentStickers"),isEmoji:!0})}X?.length&&e.push({id:o.j1l,accessHash:"",count:X.length,stickers:X,title:de("CollectibleStatusesCategory"),isEmoji:!0})}else if(T){const t=v[B];t.stickers?.length&&e.push({...t,id:o.sR2,title:ce("RecentStickers")})}else Z?.length&&e.push({id:o.sR2,accessHash:"0",title:ce("RecentStickers"),stickers:Z,count:Z.length,isEmoji:!0});const t=[...r||[]];g&&t.unshift(g);const i=(0,fi.Am)(t.concat(S||[])),s=Object.values((0,fi._E)(v,i));return[...e,...s]}),[r,k,N,T,Z,S,v,A,C,ce,f,R,B,Y,L,g,x,X,de]),pe=(0,s.Kr)((()=>he&&0===ue.filter((e=>e.stickers?.length)).length),[ue,he]),ve=(0,pr.A)([],o.jhd),ge=he&&ve&&!pe;(0,Ln.A)(G,H||!ge),(0,s.vJ)((()=>{if(!he)return;const e=G.current;if(!e)return;const t=ie*Jr-(e.offsetWidth/2-Jr/2);(0,Pa.A)(e,t)}),[he,ie]);const Ae=(0,D.A)((e=>{E(e)})),be=(0,me.A)("StickerPicker","Qk9PEGRE",e);if(!ge)return(0,ee.Y)("div",{className:be,children:pe?(0,ee.Y)("div",{className:Kr,children:ce("NoStickers")}):(0,ee.Y)(zs.A,{})});const fe=(0,me.A)(_r,"no-scrollbar",!Q&&Ur),Ce=(0,me.A)(Er,"U0BL1VvK",b.TF?"no-scrollbar":"custom-scroll",t,Vr);return(0,ee.FD)("div",{className:be,children:[(0,ee.Y)("div",{ref:G,className:fe,children:(0,ee.FD)("div",{className:"shared-canvas-container",children:[(0,ee.Y)("canvas",{ref:j,className:"shared-canvas"}),(0,ee.Y)("canvas",{ref:z,className:"shared-canvas"}),ue.map((function(e,t){const i=e.stickers?.[0],s=(0,me.A)(Or,t===ie&&"WYeuJNQx"),a=t<o.j41,r=(0,c.CzR)((0,n.mS)(),e);if(e.id!==o.G3A){if(jr.has(e.id)||e.hasThumbnail||!i){const i=e.id===o.sR2||e.id===o.EPW,n=Gr.has(e.id);return(0,ee.Y)(W.A,{className:s,ariaLabel:e.title,round:!0,faded:n,color:"translucent",onClick:()=>re(i?0:t),children:i?(0,ee.Y)(q.A,{name:"recent"}):(0,ee.Y)(kr,{stickerSet:e,noPlay:!w||!le,forcePlayback:!0,observeIntersection:oe,sharedCanvasRef:a?r?z:j:void 0})},e.id)}return(0,ee.Y)(Fr,{sticker:i,size:o.TBj,title:e.title,className:s,noPlay:!w||!le,observeIntersection:oe,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:a?r?z:j:void 0,withTranslucentThumb:P,onClick:re,clickArg:t,forcePlayback:!0},e.id)}}))]})}),(0,ee.Y)("div",{ref:J,onScroll:$,className:Ce,children:ue.map(((e,t)=>{const i=e.id===o.G3A||e.id===o.sR2&&(T||N),s=e.id===g;return(0,ee.Y)(Lr,{stickerSet:e,loadAndPlay:Boolean(w&&le),index:t,idPrefix:te,observeIntersection:se,observeIntersectionForPlayingItems:ne,observeIntersectionForShowingItems:ae,isNearActive:ie>=t-1&&ie<=t+1,isSavedMessages:Y,isStatusPicker:N,isReactionPicker:k,shouldHideHeader:i,withDefaultTopicIcon:T&&e.id===o.sR2,withDefaultStatusIcon:N&&e.id===o.sR2,isChatEmojiSet:s,isCurrentUserPremium:F,selectedReactionIds:m,availableReactions:C,isTranslucent:P,onReactionSelect:V,onReactionContext:_,onStickerSelect:Ae,onContextMenuOpen:U,onContextMenuClose:O,onContextMenuClick:K,forcePlayback:!0},e.id)}))})]})})));var Hr=i(3325);const $r=(0,s.ph)((0,n.EK)((e=>({areFeaturedStickersLoaded:Boolean(e.customEmojis.featuredIds?.length),isTranslucent:(0,c.cwE)(e)})))((({isOpen:e,statusButtonRef:t,areFeaturedStickersLoaded:i,isTranslucent:a,onEmojiStatusSelect:o,onClose:r})=>{const{loadFeaturedEmojiStickers:l}=(0,n.ko)(),c=(0,s.li)(),[d,h,m]=(0,Y.A)();(0,s.vJ)((()=>{c.current=t.current.getBoundingClientRect().right}),[e,t]),(0,s.vJ)((()=>{e&&!i&&l()}),[i,e,l]);const u=(0,s.hb)((e=>{o(e),r()}),[r,o]);return(0,ee.Y)(Hr.A,{children:(0,ee.Y)($e.A,{isOpen:e,noCompact:!0,positionX:"right",bubbleClassName:"hRzvfaRb",onClose:r,transformOriginX:c.current,noCloseOnBackdrop:d,children:(0,ee.Y)(zr,{idPrefix:"status-emoji-set-",loadAndPlay:e,isHidden:!e,isStatusPicker:!0,isTranslucent:a,onContextMenuOpen:h,onContextMenuClose:m,onCustomEmojiSelect:u,onContextMenuClick:r})})})})));var qr=i(10187);const Wr=6*p.$,Qr=(0,s.ph)((0,n.EK)(((e,{modal:t})=>({currentUser:(0,c.mBe)(e,e.currentUserId),bot:t?.botId?(0,c.mBe)(e,t.botId):void 0})))((({modal:e,currentUser:t,bot:i})=>{const{setEmojiStatus:a,closeSuggestedStatusModal:o,sendWebAppEvent:r}=(0,n.ko)(),c=(0,_i.A)(),d=Boolean(e),h=(0,Bi.A)(e),m=(0,s.Kr)((()=>{if(t&&h)return{...t,emojiStatus:{type:"regular",documentId:h.customEmojiId}}}),[t,h]),u=(0,s.Kr)((()=>{if(!h||!i)return;const e=(0,l.Yg)(i);return h.duration?c("BotSuggestedStatusFor",{bot:e,duration:(0,ze.A$)(c,h.duration)},{withNodes:!0,withMarkdown:!0}):c("BotSuggestedStatus",{bot:e},{withNodes:!0,withMarkdown:!0})}),[i,c,h]),p=(0,D.A)((()=>{const e=h?.webAppKey;e&&r({webAppKey:e,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}}}),o()})),v=(0,D.A)((()=>{if(!h)return;const e=h.duration?(0,li.Fm)()+h.duration:void 0;a({referrerWebAppKey:h.webAppKey,emojiStatus:{type:"regular",documentId:h.customEmojiId,until:e}}),o()}));return(0,ee.FD)(Z.A,{isOpen:d,contentClassName:"C9sWDINB",hasAbsoluteCloseButton:!0,isSlim:!0,onClose:p,children:[h&&(0,ee.Y)(wa.A,{className:"gdG3oY21",documentId:h.customEmojiId,size:Wr,loopLimit:1,forceAlways:!0}),(0,ee.FD)("div",{children:[(0,ee.Y)("h3",{className:"KVpsce1g",children:c("BotSuggestedStatusTitle")}),(0,ee.Y)("p",{className:"p7S4AH8A",children:u})]}),m&&(0,ee.Y)(qr.A,{mockPeer:m,withEmojiStatus:!0}),(0,ee.Y)(W.A,{size:"smaller",onClick:v,children:c("GeneralConfirm")})]})})));var Zr=i(55317),Xr=i(20333);const el="j6xEoljc";function tl(e,t){return e.find((e=>!e.chatId))||e.filter((e=>t&&e.chatId!==t)).sort(((e,t)=>e.date-t.date))[0]}const il=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const i=t&&(0,c.hds)(e,t?.chatId),s=i&&(0,c.AWZ)(e,i.id),n=t?.myBoosts&&tl(t.myBoosts,t.chatId);return{chat:i,chatFullInfo:s,prevBoostedChat:n?.chatId?(0,c.hds)(e,n?.chatId):void 0,isCurrentUserPremium:(0,c.g29)(e)}}))((({modal:e,chat:t,chatFullInfo:i,prevBoostedChat:a,isCurrentUserPremium:o})=>{const{applyBoost:r,closeBoostModal:c,requestConfetti:d,openPremiumModal:h,loadFullChat:m}=(0,n.ko)(),[u,p,v]=(0,Y.A)(),[g,A,b]=(0,Y.A)(),[f,C,y]=(0,Y.A)(),S=t&&(0,l.WX)(t),w=Boolean(e),k=(0,M.A)(),N=(0,_i.A)();(0,s.vJ)((()=>{t&&!i&&m({chatId:t.id})}),[t,i]);const I=(0,s.Kr)((()=>{if(t)return(0,l.Js)(k,t)}),[t,k]),P=(0,s.Kr)((()=>{if(a)return(0,l.Js)(k,a)}),[a,k]),{isStatusLoaded:F,isBoosted:T,boost:B,title:R,leftText:L,rightText:x,value:E,progress:V,descriptionText:_,canBoostMore:U}=(0,s.Kr)((()=>{if(!e?.boostStatus||!t)return{isStatusLoaded:!1,title:k("Loading")};const{hasMyBoost:s}=e.boostStatus,n=e?.myBoosts&&tl(e.myBoosts,t.id),a=e?.myBoosts&&(o=e.myBoosts,r=t.id,!o.every((e=>e.chatId===r)));var o,r;const{boosts:c,currentLevel:d,hasNextLevel:h,levelProgress:m,remainingBoosts:u,isMaxLevel:p}=(0,Zr.z)(e.boostStatus,!0),v=s,g=k("BoostsLevel",d),A=h?k("BoostsLevel",d+1):void 0,b=k("ChannelBoost.MoreBoosts",u),f=k(S?"BoostChannel":"BoostGroup"),C=(i?.boostsToUnrestrict||0)-(i?.boostsApplied||0);let y;if(p)y=k("BoostsMaxLevelReached");else if(C>0&&!(0,l.SJ)(t)){const e=k("GroupBoost.BoostToUnrestrict.Times",C);y=k("GroupBoost.BoostToUnrestrict",[e,I])}else y=k("ChannelBoost.MoreBoostsNeeded.Text",[I,b]);return{isStatusLoaded:!0,title:f,leftText:g,rightText:A,value:c.toString(),progress:m,remainingBoosts:u,descriptionText:y,boost:n,isBoosted:v,canBoostMore:a&&!p}}),[t,I,e,k,i,S]),O=!e?.myBoosts?.length&&o,K=B?.chatId&&B.chatId!==e?.chatId,J=(0,D.A)((()=>{v(),r({chatId:t.id,slots:[B.slot]}),d({})})),G=(0,D.A)((()=>{h(),y(),c()})),j=(0,D.A)((()=>{if(!B)return o?void c():void C();U?B.cooldownUntil?A():K?p():J():c()})),z=(0,D.A)((()=>{c()}));return(0,ee.FD)(Z.A,{isOpen:w,title:R,className:"IK2mBqbm",contentClassName:"pUyNTysT",onClose:c,children:[F?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(Xr.A,{leftText:L,rightText:x,progress:V,floatingBadgeText:E,floatingBadgeIcon:"boost"}),T&&(0,ee.Y)("div",{className:(0,me.A)(el,"hAA6B1lc"),children:k("ChannelBoost.YouBoostedChannelText",I)}),(0,ee.Y)("div",{className:el,children:(0,Ft.A)(_,["simple_markdown","emoji"])}),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",disabled:O,onClick:j,children:U?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(q.A,{name:"boost"}),k(S?"ChannelBoost.BoostChannel":"GroupBoost.BoostGroup")]}):k("OK")}),(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:z,children:k("Cancel")})]})]}):(0,ee.Y)(zs.A,{className:"zjXCH3pT"}),K&&P&&(0,ee.FD)(Z.A,{isOpen:u,className:"GIFAjZPY",contentClassName:"Jxyz9TaL",onClose:v,children:[(0,ee.FD)("div",{className:"OKp6HS1U",children:[(0,ee.FD)("div",{className:"NU9itcIm",children:[(0,ee.Y)(Dt.A,{peer:a,size:"large"}),(0,ee.Y)(q.A,{name:"boostcircle",className:"upXvhNRY"})]}),(0,ee.Y)(q.A,{name:"next",className:"WSJdWV7L"}),(0,ee.Y)(Dt.A,{peer:t,size:"large"})]}),(0,ee.Y)("div",{children:(0,Ft.A)(k("ChannelBoost.ReplaceBoost",[P,I]),["simple_markdown","emoji"])}),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:J,children:k("Replace")}),(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:v,children:k("Cancel")})]})]}),Boolean(B?.cooldownUntil)&&(0,ee.Y)(vi.A,{isOpen:g,isOnlyConfirm:!0,confirmLabel:k("OK"),title:k("ChannelBoost.Error.BoostTooOftenTitle"),onClose:b,confirmHandler:b,children:(0,Ft.A)(k("ChannelBoost.Error.BoostTooOftenText",(0,ze.A$)(N,B.cooldownUntil-(0,li.Fm)())),["simple_markdown","emoji"])}),!o&&(0,ee.Y)(vi.A,{isOpen:f,confirmLabel:k("Common.Yes"),title:k("PremiumNeeded"),onClose:y,confirmHandler:G,children:(0,Ft.A)(k("PremiumNeededForBoosting"),["simple_markdown","emoji"])})]})})));var sl=i(47058),nl=i(70046);const al="xVLGjLub",ol=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const{message:i}=t||{},s=i&&(0,c.O5q)(e,i.chatId,i.messageId),n=s&&(0,c.Y7C)(e,s);return{currentUserId:e.currentUserId,messageSender:n}}))((({currentUserId:e,modal:t,messageSender:i})=>{const{closeGiftCodeModal:a,applyGiftCode:r,focusMessage:l}=(0,n.ko)(),c=(0,M.A)(),d=Boolean(t),h=!(t?.info.toId&&t?.info.toId!==e||t?.info.usedAt),m=(0,D.A)((()=>{t&&t.info.giveawayMessageId&&(l({chatId:t.info.fromId,messageId:t.info.giveawayMessageId}),a())})),u=(0,D.A)((()=>{h?r({slug:t.slug}):a()})),p=(0,s.Kr)((()=>{if(!t)return;const{slug:e,info:s}=t,n=s.fromId||i?.id;return{header:(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("img",{src:Ao,alt:"",className:"Mtx4SWww"}),(0,ee.Y)("p",{className:al,children:(0,Ft.A)(c("lng_gift_link_about"),["simple_markdown"])}),(0,ee.Y)(sl.A,{title:"BoostingGiftLink",link:`${o.jsp}/giftcode/${e}`})]}),tableData:[[c("BoostingFrom"),n?{chatId:n}:c("BoostingNoRecipient")],[c("BoostingTo"),s.toId?{chatId:s.toId}:c("BoostingNoRecipient")],[c("BoostingGift"),c("BoostingTelegramPremiumFor",c("Months",s.months,"i"))],[c("BoostingReason"),(0,ee.Y)("span",{className:(0,me.A)(s.giveawayMessageId&&"IzcASdzD"),onClick:m,children:s.isFromGiveaway&&!s.toId?c("BoostingIncompleteGiveaway"):c(s.isFromGiveaway?"BoostingGiveaway":"BoostingYouWereSelected")})],[c("BoostingDate"),(0,ze.L2)(1e3*s.date,c.code,!0)]],footer:(0,ee.Y)("span",{className:al,children:(0,Ft.A)(s.usedAt?c("BoostingUsedLinkDate",(0,ze.L2)(1e3*s.usedAt,c.code,!0)):c("BoostingSendLinkToAnyone"),["simple_markdown"])})}}),[c,i?.id,t]);if(p)return(0,ee.Y)(nl.A,{isOpen:d,title:c("lng_gift_link_title"),tableData:p.tableData,header:p.header,footer:p.footer,buttonText:c(h?"BoostingUseLink":"Close"),onButtonClick:u,onClose:a})})));function rl(e,t){return e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e))}const ll=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const{selfDestructAccountDays:i}=t||{};return{selfDestructAccountDays:i}}))((({modal:e,selfDestructAccountDays:t})=>{const{closeGiftCodeModal:i,closeDeleteAccountModal:a,setAccountTTL:r}=(0,n.ko)(),l=(0,_i.A)(),c=Boolean(e),[d,h]=(0,s.J0)(),m=(0,D.A)((e=>30*Number(e))),u=(0,s.Kr)((()=>{if(t)return rl(o.WF4,t/30).toString()}),[t]);(0,s.vJ)((()=>{u&&h(u)}),[u]);const p=(0,s.Kr)((()=>o.WF4.map((e=>({value:String(e),label:l("Months",{count:e},{pluralValue:1})})))),[l]),v=(0,D.A)((e=>{h(e)})),g=(0,D.A)((()=>{d&&r({days:m(d)})})),A=(0,D.A)((()=>{a()}));return(0,ee.FD)(Z.A,{isOpen:c,title:l("SelfDestructTitle"),onClose:i,className:"X6K5oA8U",children:[(0,ee.Y)("p",{children:l("SelfDestructSessionsDescription")}),(0,ee.Y)(X.A,{className:"dialog-checkbox-group",name:"quick-reaction-settings",options:p,selected:d,onChange:v,withIcon:!0}),(0,ee.FD)("div",{className:"dialog-buttons mt-2",children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:g,children:l("Save")}),(0,ee.Y)(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:A,children:l("Cancel")})]})]})})));var cl=i(34132),dl=i(24713);const hl={description:"dl10exNi","picker-wrapper":"gxWY5c6x",pickerWrapper:"gxWY5c6x","picker-header":"h8N7eyob",pickerHeader:"h8N7eyob","picker-header-info":"Rth2Qu07",pickerHeaderInfo:"Rth2Qu07","selection-toggle":"B6eAugx8",selectionToggle:"B6eAugx8",foldersWrapper:"mwcvgD2S",folders:"LKavx8ww",folder:"qglLx5Dn","button-text":"bgaRuEMs",buttonText:"bgaRuEMs","button-badge":"rTe14Z22",buttonBadge:"rTe14Z22"},ml=(0,s.ph)((({invite:e,folder:t})=>{const{closeChatlistModal:i,joinChatlistInvite:a}=(0,n.ko)(),o=(0,_i.A)(),r=(0,M.A)(),[l,c]=(0,s.J0)(e.missingPeerIds),d=Boolean(e.missingPeerIds.length),h=0===e.alreadyPeerIds.length,m=d?e.missingPeerIds.length:0,u=l.length?l.length.toString():void 0,p=h?o("FolderLinkSubtitleNew"):m?o("FolderLinkSubtitleAdd",{chats:o("FolderLinkSubtitleAddCount",{count:m},{pluralValue:m}),title:(0,ds.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})},{withNodes:!0,withMarkdown:!0}):o("FolderLinkSubtitleAlready"),v=(0,s.hb)((()=>{i(),l.length&&a({invite:e,peerIds:l})}),[e,l]),g=(0,s.hb)((()=>{const t=l.length===e.missingPeerIds.length;c(t?[]:e.missingPeerIds)}),[e.missingPeerIds,l.length]);return(0,ee.FD)("div",{className:hl.content,children:[(0,ee.Y)("div",{className:hl.description,children:(0,Ft.A)(p,["simple_markdown","emoji"])}),(0,ee.FD)("div",{className:(0,me.A)(hl.pickerWrapper,"custom-scroll"),children:[Boolean(e.missingPeerIds.length)&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:hl.pickerHeader,children:[(0,ee.Y)("div",{className:hl.pickerHeaderInfo,children:r("FolderLinkHeaderChatsJoin",l.length,"i")}),(0,ee.Y)("div",{className:hl.selectionToggle,role:"button",tabIndex:0,onClick:g,children:l.length===e.missingPeerIds.length?r("DeselectAll"):r("SelectAll")})]}),(0,ee.Y)(yi.A,{itemIds:e.missingPeerIds,onSelectedIdsChange:c,selectedIds:l,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,ee.Y)("div",{className:hl.pickerHeader,children:(0,ee.Y)("div",{className:hl.pickerHeaderInfo,children:r("FolderLinkHeaderAlready")})}),(0,ee.Y)(yi.A,{itemIds:e.alreadyPeerIds,lockedSelectedIds:e.alreadyPeerIds,selectedIds:e.alreadyPeerIds,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,ee.Y)(W.A,{size:"smaller",onClick:v,children:(0,ee.FD)("div",{className:hl.buttonText,children:[!l.length&&r("OK"),Boolean(l.length)&&(0,ee.FD)(ee.FK,{children:[r("FolderLinkButtonJoinPlural",l.length,"i"),(0,ee.Y)(dl.A,{className:hl.buttonBadge,text:u,isAlternateColor:!0})]})]})})]})})),ul=(0,s.ph)((({folder:e,suggestedPeerIds:t=Ci.p})=>{const{closeChatlistModal:i,leaveChatlist:a}=(0,n.ko)(),o=(0,M.A)(),[r,l]=(0,s.J0)([]),c=r.length?r.length.toString():void 0,d=(0,s.hb)((()=>{const e=r.length===t.length;l(e?[]:t)}),[t,r.length]),h=(0,s.hb)((()=>{i(),a({folderId:e.id,peerIds:r})}),[e.id,r]);return(0,ee.FD)("div",{className:hl.content,children:[Boolean(t?.length)&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{className:hl.description,children:(0,Ft.A)(o("FolderLinkSubtitleRemove"),["simple_markdown","emoji"])}),(0,ee.FD)("div",{className:(0,me.A)(hl.pickerWrapper,"custom-scroll"),children:[(0,ee.FD)("div",{className:hl.pickerHeader,children:[(0,ee.Y)("div",{className:hl.pickerHeaderInfo,children:o("FolderLinkHeaderChatsQuit",r.length,"i")}),(0,ee.Y)("div",{className:hl.selectionToggle,role:"button",tabIndex:0,onClick:d,children:r.length===t.length?o("DeselectAll"):o("SelectAll")})]}),(0,ee.Y)(yi.A,{itemIds:t,onSelectedIdsChange:l,selectedIds:r,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]})]}),(0,ee.Y)(W.A,{size:"smaller",onClick:h,children:(0,ee.FD)("div",{className:hl.buttonText,children:[!r.length&&o("FolderLinkButtonRemove"),Boolean(r.length)&&(0,ee.FD)(ee.FK,{children:[o("FolderLinkButtonRemoveChats"),(0,ee.Y)(dl.A,{className:hl.buttonBadge,text:c,isAlternateColor:!0})]})]})})]})})),pl=(0,s.ph)((({invite:e})=>{const{closeChatlistModal:t,joinChatlistInvite:i}=(0,n.ko)(),a=(0,_i.A)(),o=(0,M.A)(),[r,l]=(0,s.J0)(e.peerIds),c=(0,s.Kr)((()=>{const t=(0,n.mS)().chats.byId;return e.peerIds.filter((e=>!t[e].isNotJoined))}),[e.peerIds]),d=r.length-c.length,h=d?d.toString():void 0,m=(0,s.hb)((()=>{t(),i({invite:e,peerIds:r})}),[e,r]),u=(0,s.hb)((()=>{const t=r.length===e.peerIds.length;l(t?c:e.peerIds)}),[e.peerIds,c,r.length]);return(0,ee.FD)("div",{className:hl.content,children:[(0,ee.Y)("div",{className:hl.description,children:a("FolderLinkSubtitleNew")}),(0,ee.FD)("div",{className:(0,me.A)(hl.pickerWrapper,"custom-scroll"),children:[(0,ee.FD)("div",{className:hl.pickerHeader,children:[(0,ee.Y)("div",{className:hl.pickerHeaderInfo,children:o("FolderLinkHeaderChatsJoin",d,"i")}),(0,ee.Y)("div",{className:hl.selectionToggle,role:"button",tabIndex:0,onClick:u,children:r.length===e.peerIds.length?o("DeselectAll"):o("SelectAll")})]}),(0,ee.Y)(yi.A,{itemIds:e.peerIds,lockedSelectedIds:c,onSelectedIdsChange:l,selectedIds:r,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})]}),(0,ee.Y)(W.A,{onClick:m,size:"smaller",disabled:!r.length,children:(0,ee.FD)("div",{className:hl.buttonText,children:[a("FolderLinkAddFolder"),(0,ee.Y)(dl.A,{className:hl.buttonBadge,text:h,isAlternateColor:!0})]})})]})})),vl=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const{invite:i,removal:s}=t||{},n=s?.folderId||(i&&"folderId"in i?i.folderId:void 0);return{folder:n?(0,c.$aQ)(e,n):void 0}}))((({modal:e,folder:t})=>{const{closeChatlistModal:i}=(0,n.ko)(),a=(0,M.A)(),o=Boolean(e),r=(0,V.A)(e)||e,l=(0,V.A)(t)||t,c=(0,s.Kr)((()=>{if(r){if(r.invite){const e=r.invite;return"alreadyPeerIds"in e?e.missingPeerIds.length?a("FolderLinkTitleAddChats"):a("FolderLinkTitleAlready"):a("FolderLinkTitleAdd")}return r.removal?a("FolderLinkTitleRemove"):void 0}}),[a,r]),d=(0,s.Kr)((()=>l?(0,ds.fd)({text:l.title.text,entities:l.title.entities,noCustomEmojiPlayback:l.noTitleAnimations}):r?.invite&&"title"in r.invite?(0,ds.fd)({text:r.invite.title.text,entities:r.invite.title.entities,noCustomEmojiPlayback:r.invite.noTitleAnimations}):void 0),[l,r]),h=(0,s.Kr)((()=>{if(r?.invite)return"missingPeerIds"in r.invite?r.invite.missingPeerIds.length:void 0}),[r]),m=(0,s.hb)((()=>{if(r){if(r.invite){const e=r.invite;return"alreadyPeerIds"in e?(0,ee.Y)(ml,{invite:e,folder:l}):(0,ee.Y)(pl,{invite:e})}return r.removal?(0,ee.Y)(ul,{folder:l,suggestedPeerIds:r.removal.suggestedPeerIds}):void 0}}),[l,r]);return(0,ee.FD)(Z.A,{isOpen:o,title:c,onClose:i,isSlim:!0,hasCloseButton:!0,children:[d&&(u=d,(0,ee.Y)("div",{className:hl.foldersWrapper,children:(0,ee.FD)("div",{className:hl.folders,children:[(0,ee.Y)(cl.A,{className:hl.folder,title:a("FolderLinkPreviewLeft")}),(0,ee.Y)(cl.A,{className:hl.folder,isActive:!0,badgeCount:h,isBadgeActive:!0,title:u}),(0,ee.Y)(cl.A,{className:hl.folder,title:a("FolderLinkPreviewRight")})]})})),m()]});var u})));var gl=i(29886);const Al={content:"MZ0RCecx",title:"ar8XeydN",participantCount:"un00TXYY",participants:"YvkZ6c2D",participant:"DHJSBDeE",buttons:"KFtrPtNr"},bl=(0,s.ph)((({modal:e})=>{const{acceptChatInvite:t,closeChatInviteModal:i,showNotification:a}=(0,n.ko)(),o=(0,s.li)(),r=(0,M.A)(),d=(0,gl.A)(e),{hash:h,inviteInfo:m}=e||d||{},{about:u,isBroadcast:p,participantIds:v,participantsCount:g,photo:A,isRequestNeeded:b}=m||{},f=(0,D.A)((()=>{i()})),C=(0,D.A)((()=>{t({hash:h}),a({message:r(p?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")}),f()})),y=p?"ProfileJoinChannel":"JoinGroup",S=p?"MemberRequests.RequestToJoinChannel":"MemberRequests.RequestToJoinGroup",w=(0,s.Kr)((()=>{if(m)return(0,l.nr)(m)}),[m]),k=(0,s.Kr)((()=>{if(!v)return;const e=(0,n.mS)();return v.map((t=>(0,c.mBe)(e,t))).filter(Boolean)}),[v]);return(0,Ln.A)(o,!e||!k),(0,ee.FD)(Z.A,{isOpen:Boolean(e),contentClassName:Al.content,isSlim:!0,onClose:f,onEnter:C,children:[w&&(0,ee.Y)(Dt.A,{size:"jumbo",photo:A,peer:w,withVideo:!0}),w&&(0,ee.Y)(Hs.A,{className:Al.title,peer:w}),u&&(0,ee.Y)("p",{className:Al.about,children:u}),(0,ee.Y)("p",{className:Al.participantCount,children:r(p?"Subscribers":"Members",g,"i")}),k&&(0,ee.Y)("div",{ref:o,className:(0,me.A)(Al.participants,"no-scrollbar"),children:k.map((e=>(0,ee.Y)(Vn.A,{className:Al.participant,peer:e,text:(0,l.Yg)(e)})))}),(0,ee.FD)("div",{className:(0,me.A)("dialog-buttons",Al.buttons),children:[(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:C,children:r(b?S:y)}),(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:f,children:r("Cancel")})]})]})}));var fl=i(84685),Cl=i(89873),yl=i(5463);const Sl="La4sUYaq",wl="Bn5kz5br",kl=(0,s.ph)((0,n.EK)((e=>{const t=e.appConfig?.channelRestrictAdsLevelMin;return{minLevelToRestrictAds:t}}))((({modal:e,minLevelToRestrictAds:t})=>{const{closeAboutAdsModal:i}=(0,n.ko)(),a=(0,s.li)(),o=Boolean(e),r=(0,Bi.A)(e),{canReport:l,randomId:c,additionalInfo:d,sponsorInfo:h}=r||{},m=l,u=(0,Bi.A)(m),p=(0,M.A)(),v=(0,s.Kr)((()=>(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{children:p("SponsoredMessageInfoScreen.Title")}),(0,ee.Y)("p",{children:(0,Ft.A)(p("SponsoredMessageInfoDescription1"),["br"])}),(0,ee.Y)("p",{children:(0,Ft.A)(p("SponsoredMessageInfoDescription2"),["br"])}),(0,ee.Y)("p",{children:(0,Ft.A)(p("SponsoredMessageInfoDescription3"),["br"])}),(0,ee.Y)("p",{children:(0,ee.Y)(fl.A,{url:p("SponsoredMessageAlertLearnMoreUrl"),text:p("SponsoredMessageAlertLearnMoreUrl")})}),(0,ee.Y)("p",{children:(0,Ft.A)(p("SponsoredMessageInfoDescription4"),["br"])})]})),[p]),{isContextMenuOpen:g,contextMenuAnchor:A,handleContextMenu:b,handleContextMenuClose:f,handleContextMenuHide:C}=(0,Fn.A)(a,!u),y=(0,D.A)((()=>{i(),f(),C()})),S=(0,s.Kr)((()=>{if(o)return{header:(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{className:Sl,children:p("AboutRevenueSharingAds")}),(0,ee.Y)("p",{className:(0,me.A)(wl,"hbsLlXSH"),children:p("RevenueSharingAdsAlertSubtitle")}),(0,ee.Y)(W.A,{ref:a,round:!0,size:"smaller",color:"translucent",className:"JdN5pGTw",onClick:b,children:(0,ee.Y)(q.A,{name:"more"})})]}),listItemData:[["lock",p("RevenueSharingAdsInfo1Title"),(0,Ft.A)(p("RevenueSharingAdsInfo1Subtitle"),["simple_markdown"])],["revenue-split",p("RevenueSharingAdsInfo2Title"),(0,Ft.A)(p("RevenueSharingAdsInfo2Subtitle"),["simple_markdown"])],["nochannel",p("RevenueSharingAdsInfo3Title"),(0,Ft.A)(p("RevenueSharingAdsInfo3Subtitle",t),["simple_markdown"])]],footer:(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{className:Sl,children:(0,Ft.A)(p("RevenueSharingAdsInfo4Title"),["simple_markdown"])}),(0,ee.FD)("p",{className:wl,children:[(0,Ft.A)(p("RevenueSharingAdsInfo4Subtitle2",""),["simple_markdown"]),(0,ee.Y)(fl.A,{url:p("PromoteUrl"),text:p("LearnMoreArrow")})]})]})}}),[o,p,b,t]);return u?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(yl.A,{isOpen:o,listItemData:S?.listItemData,headerIconName:"channel",withSeparator:!0,header:S?.header,footer:S?.footer,buttonText:p("RevenueSharingAdsUnderstood"),onClose:y}),A&&c&&(0,ee.Y)(Cl.A,{isOpen:g,anchor:A,triggerRef:a,randomId:c,additionalInfo:d,canReport:l,sponsorInfo:h,shouldSkipAbout:!0,onItemClick:y,onClose:f,onCloseAnimationEnd:C})]}):(0,ee.FD)(Z.A,{isOpen:o,className:"LFkgLoAk",contentClassName:"TZE15Pt_",onClose:y,children:[v,(0,ee.Y)(W.A,{size:"smaller",onClick:y,children:p("RevenueSharingAdsUnderstood")})]})}))),Nl="t9iZUzOj",Il=(0,s.ph)((({isOpen:e,onClose:t})=>{const i=(0,M.A)(),n=(0,_i.A)(),a=(0,s.Kr)((()=>{const e=i("LearnMore");return n("ChannelEarnLearnCoinAbout",{link:(0,ee.FD)(fl.A,{url:i("MonetizationInfoTONLink"),text:e,children:[e,(0,ee.Y)(q.A,{name:"next"})]})},{withNodes:!0})}),[n,i]),o=(0,s.Kr)((()=>n("MonetizationInfoTONTitle",void 0,{withNodes:!0,specialReplacement:{"ðŸ’Ž":(0,ee.Y)(q.A,{className:"ATkOSqJ7",name:"toncoin"})}})),[n]),r=(0,s.Kr)((()=>{if(e)return{header:(0,ee.Y)("h3",{className:Nl,children:i("lng_channel_earn_learn_title")}),listItemData:[["channel",i("lng_channel_earn_learn_in_subtitle"),(0,Ft.A)(i("lng_channel_earn_learn_in_about"),["simple_markdown"])],["revenue-split",i("lng_channel_earn_learn_split_subtitle"),(0,Ft.A)(i("Monetization.Intro.Split.Text"),["simple_markdown"])],["cash-circle",i("lng_channel_earn_learn_out_subtitle"),(0,Ft.A)(i("lng_channel_earn_learn_out_about"),["simple_markdown"])]],footer:(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{className:Nl,children:o}),(0,ee.Y)("p",{className:"mjveZmdr",children:a})]})}}),[e,i,o,a]);if(r)return(0,ee.Y)(yl.A,{isOpen:e,listItemData:r.listItemData,headerIconName:"cash-circle",withSeparator:!0,header:r.header,footer:r.footer,buttonText:i("RevenueSharingAdsUnderstood"),onClose:t})}));var Pl=i(15535);const Yl="oofoCYlu",Fl=(0,s.ph)((0,n.EK)((e=>{const{twoFaSettings:{hint:t}}=e;return{passwordHint:t}}))((({modal:e,passwordHint:t})=>{const{closeMonetizationVerificationModal:i,clearMonetizationVerificationError:a,processMonetizationRevenueWithdrawalUrl:o}=(0,n.ko)(),r=Boolean(e),l=(0,Bi.A)(e),c=(0,_i.A)(),[d,h]=(0,s.J0)(!1),m=(0,D.A)((e=>{l&&o({peerId:l.chatId,currentPassword:e})})),u=(0,D.A)((()=>{a()})),p=(0,D.A)((()=>{i()}));return(0,ee.Y)(Z.A,{isOpen:r,hasCloseButton:!0,title:c("CheckPasswordTitle"),className:"WqeWhMAS",contentClassName:Yl,onClose:p,children:(0,ee.Y)("div",{className:(0,me.A)(Yl,"settings-content password-form custom-scroll"),children:(0,ee.Y)("div",{className:"settings-item pt-0",children:(0,ee.Y)(Pl.A,{shouldShowSubmit:!0,placeholder:c("CheckPasswordPlaceholder"),error:l?.errorKey&&c.withRegular(l.errorKey),description:c("CheckPasswordDescription"),clearError:u,isLoading:l?.isLoading,hint:t,isPasswordVisible:d,shouldResetValue:r,onChangePasswordVisibility:h,onSubmit:m})})})})}))),Dl={content:"MKdSUg2P",chatItem:"qEIwBtp0"},Ml=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.mBe)(e,e.currentUserId),i=(0,c.g29)(e);return{currentUser:t,stickerSet:e.defaultStatusIconsId?(0,c.ycM)(e,e.defaultStatusIconsId):void 0,isPremium:i,isAccountFrozen:(0,c.trm)(e)}}))((({modal:e,currentUser:t,stickerSet:i,isPremium:a,isAccountFrozen:o})=>{const{closeEmojiStatusAccessModal:r,toggleUserEmojiStatusPermission:c,sendWebAppEvent:d,openPremiumModal:h,loadDefaultStatusIcons:m}=(0,n.ko)(),u=Boolean(e),p=(0,M.A)(),v=(0,_i.A)(),g=(0,s.li)(),[A,b]=(0,s.J0)(0);(0,s.vJ)((()=>{!u||i?.stickers||o||m()}),[u,i,o]);const f=(0,s.Kr)((()=>{if(t&&i?.stickers)return{...t,emojiStatus:{type:"regular",documentId:i.stickers[A].id}}}),[t,i,A]),C=i?.stickers?.length;(0,Yn.A)((()=>{C&&b((e=>(e+1)%C))}),C?3200:void 0);const y=(0,D.A)((()=>(0,ee.Y)(qr.A,{withEmojiStatus:!0,className:Dl.chatItem,itemClassName:Dl.itemName,mockPeer:f}))),S=(0,D.A)((()=>{e?.bot?.id&&(r(),e?.webAppKey&&(a?(d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"allowed"}}}),c({botId:e.bot.id,isEnabled:!0,isBotAccessEmojiGranted:!0})):(h(),d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}))))})),w=(0,D.A)((()=>{e?.bot?.id&&(r(),e?.webAppKey&&d({webAppKey:e.webAppKey,event:{eventType:"emoji_status_access_requested",eventData:{status:"cancelled"}}}),a&&c({botId:e.bot.id,isEnabled:!1}))})),k=(0,D.A)((()=>{if(e?.bot)return v("EmojiStatusAccessText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})}));return(0,ee.FD)(Z.A,{className:(0,me.A)("confirm"),contentClassName:Dl.content,isOpen:u,onClose:w,children:[y(),(0,ee.FD)("div",{children:[k(),(0,ee.FD)("div",{className:"dialog-buttons mt-2",ref:g,children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:S,color:"primary",children:p("lng_bot_allow_write_confirm")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:w,children:v("Cancel")})]})]})]})}))),Tl=(0,s.ph)((0,n.EK)((e=>({currentUser:(0,c.mBe)(e,e.currentUserId)})))((({modal:e,currentUser:t})=>{const{closeLocationAccessModal:i,toggleUserLocationPermission:a,sendWebAppEvent:o}=(0,n.ko)(),r=Boolean(e),c=(0,M.A)(),d=(0,_i.A)(),h=(0,s.li)(),m=(0,D.A)((async()=>{const t=await(0,b.Bu)(),{geolocation:s}=t;e?.bot?.id&&(i(),e?.webAppKey&&(a({botId:e.bot.id,isAccessGranted:!0}),o({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!0,latitude:s?.latitude,longitude:s?.longitude,altitude:s?.altitude,course:s?.heading,speed:s?.speed,horizontal_accuracy:s?.accuracy,vertical_accuracy:s?.accuracy}}})))})),u=(0,D.A)((()=>{e?.bot?.id&&(i(),e?.webAppKey&&(a({botId:e.bot.id,isAccessGranted:!1}),o({webAppKey:e.webAppKey,event:{eventType:"location_requested",eventData:{available:!1}}})))})),p=(0,D.A)((()=>{if(e?.bot)return(0,ee.FD)("div",{className:"CGPoDaLo",children:[(0,ee.Y)(Dt.A,{size:"large",peer:t}),(0,ee.Y)(q.A,{name:"next",className:"pzERgD5x"}),(0,ee.Y)(Dt.A,{size:"large",peer:e.bot})]})})),v=(0,D.A)((()=>{if(e?.bot)return d("LocationPermissionText",{name:(0,l.Yg)(e?.bot)},{withNodes:!0,withMarkdown:!0})}));return(0,ee.FD)(Z.A,{className:(0,me.A)("confirm"),isOpen:r,onClose:u,children:[p(),(0,ee.FD)("div",{children:[v(),(0,ee.FD)("div",{className:"dialog-buttons mt-2",ref:h,children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:m,color:"primary",children:c("lng_bot_allow_write_confirm")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:u,children:d("Cancel")})]})]})]})}))),Bl="qJDgUtjV",Rl=(0,s.ph)((({modal:e})=>{const{reportSponsored:t,closeReportAdModal:i,openPreviousReportAdModal:a}=(0,n.ko)(),o=(0,M.A)(),l=Boolean(e),c=(0,s.li)(),d=(0,D.A)(((i,s)=>{const{chatId:n,randomId:a}=e;t({peerId:n,randomId:a,option:s})})),[h,m]=(0,s.Kr)((()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e.sections[t],t]}),[e]),u=(0,D.A)((()=>{m?a():i()})),p=(0,s.Kr)((()=>{if(!e)return;const t=o("lng_report_sponsored_reported_learn").split("{link}");return[t[0],(0,ee.Y)(fl.A,{text:o("lng_report_sponsored_reported_link"),url:o("ReportAd.Help_URL")}),t[1]]}),[o,e]),v=(0,s.Kr)((()=>{if(!e)return;const t=Boolean(h?.subtitle);return(0,ee.FD)("div",{className:"modal-header-condensed",children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:o(m?"Back":"Close"),onClick:u,children:(0,ee.Y)(q.A,{name:m?"arrow-left":"close"})}),(0,ee.FD)("div",{className:(0,me.A)("modal-title","ZAdG13Ah",t&&"lVVyV0py"),children:[(0,ee.Y)("h3",{className:"mMmY6YR4",children:o("ReportAd")}),t&&(0,ee.Y)("span",{className:"gSkAFc4u",children:h.subtitle})]})]})}),[o,e,m,h?.subtitle]);(0,s.vJ)((()=>{if(!e)return;const t=document.querySelector(`.${se.uo} > .${Bl}`);if(!t)return;const i=t.scrollHeight;(0,r.RK)((()=>{c.current.style.height=`${i+56}px`}))}),[e]);const g=(0,D.A)((()=>{const e=document.querySelector(`.${se.VY} > .${Bl}`);(0,r.YS)((()=>{const t=e.scrollHeight;(0,r.RK)((()=>{c.current.style.height=`${t+56}px`}))}))}));return(0,ee.Y)(Z.A,{isOpen:l,hasCloseButton:!0,className:"njPBcVYr",header:v,onClose:i,children:(0,ee.FD)(se.Ay,{name:"slide",className:"HjsGIG6e",ref:c,activeKey:m,onStart:g,children:[(0,ee.FD)("div",{className:Bl,children:[(0,ee.Y)("h3",{className:"jrA2dOiw",children:h?.title}),h?.options.map((e=>(0,ee.Y)(ci.A,{narrow:!0,secondaryIcon:"next",className:"aFbjDzNo",buttonClassName:"VbE0HzDs",clickArg:e.option,onClick:d,children:(0,ee.Y)("div",{className:"oWujoaSC",children:e.text})})))]}),(0,ee.Y)("p",{className:"k71Zrc_P",children:p})]})})}));var Ll=i(94079);const xl="kq9LwNTZ",El=(0,s.ph)((({modal:e})=>{const{reportMessages:t,reportStory:i,closeReportModal:a,openPreviousReportModal:o}=(0,n.ko)(),l=(0,M.A)(),c=Boolean(e),d=(0,s.li)(),[h,m]=(0,s.J0)(""),u=(0,D.A)(((s,n)=>{const{messageIds:a,subject:o,peerId:r,chatId:l}=e;if(a)switch(o){case"message":t({chatId:l,messageIds:a,option:n});break;case"story":i({storyId:a[0],peerId:r,option:n})}})),[p,v]=(0,s.Kr)((()=>{if(!e)return[void 0,0];const t=e.sections.length-1;return[e?.sections[t],t]}),[e]),g=(0,D.A)((()=>{o()})),A=(0,D.A)((()=>{a()})),b=(0,s.Kr)((()=>{if(!e)return;const t=Boolean(p?.subtitle);return(0,ee.FD)("div",{className:"modal-header-condensed",children:[v?(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Back"),onClick:g,children:(0,ee.Y)(q.A,{name:"arrow-left"})}):(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:l("Close"),onClick:A,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.FD)("div",{className:(0,me.A)("modal-title","Lj_ezEWU",t&&"OYFbu8fQ"),children:[(0,ee.Y)("h3",{className:(0,me.A)("QawchdxB",v&&"CV7kzv9H"),children:p?.options?l("story"===e?.subject?"ReportStory":"Report"):p?.title}),t&&(0,ee.Y)("span",{className:"OUFckTb7",children:p.subtitle})]})]})}),[l,e,v,p?.options,p?.subtitle,p?.title]),f=(0,D.A)((e=>{m(e.target.value)}));(0,s.vJ)((()=>{if(!e)return;const t=document.querySelector(`.${se.uo} > .${xl}`);if(!t)return;const i=t.scrollHeight;(0,r.RK)((()=>{d.current.style.height=`${i}px`}))}),[e]);const C=(0,D.A)((()=>{const e=document.querySelector(`.${se.VY} > .${xl}`);(0,r.YS)((()=>{const t=e.scrollHeight;(0,r.RK)((()=>{d.current.style.height=`${t+20}px`}))}))})),y=(0,D.A)((()=>{m(""),a()})),S=(0,D.A)((()=>{const{messageIds:s,subject:n,peerId:a,chatId:o}=e;switch(n){case"message":t({chatId:o,messageIds:s,option:p?.option,description:h});break;case"story":i({storyId:s?.[0],peerId:a,option:p?.option,description:h})}y()}));return(0,ee.Y)(Z.A,{isOpen:c,header:b,onClose:y,contentClassName:"tNysQgHL",className:(0,me.A)("E1bGWeON","story"===e?.subject&&"component-theme-dark"),children:(0,ee.Y)(se.Ay,{name:"slide",className:"n2VxPirU",ref:d,activeKey:v,onStart:C,children:(0,ee.FD)("div",{className:xl,children:[p?.options?(0,ee.Y)("h3",{className:"GSfUuTet",children:p?.title}):void 0,p?.options?.map((e=>(0,ee.Y)(ci.A,{narrow:!0,nonInteractive:!0,secondaryIcon:"next",className:"RoxwMzvA",buttonClassName:"Z6skYdvb",clickArg:e.option,onClick:u,children:(0,ee.Y)("div",{className:"FU8m6NUU",children:e.text})}))),p?.option?(0,ee.FD)("div",{className:"KpptZ3Mk",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Report,size:100,className:"kO8JC4gK",nonInteractive:!0,forceAlways:!0,noLoop:!1}),(0,ee.Y)(Ll.A,{id:"option",className:"yc3szGcx",label:p.isOptional?l("Report2CommentOptional"):l("Report2Comment"),onChange:f,value:h,maxLength:512,maxLengthIndicator:(512-h.length).toString(),noReplaceNewlines:!0}),(0,ee.Y)(W.A,{size:"smaller",onClick:S,disabled:p.isOptional?void 0:!h.length,children:l("ReportSend")})]}):void 0]})})})}));var Vl=i(65632),_l=i(17010);const Ul=(0,s.ph)((0,n.EK)(((e,{modal:t})=>{const i=(0,c.SJA)(e),{isBlurred:s,patternColor:n,background:a,backgroundColor:o}=(0,c.Gyz)(e,i)||{};return{theme:i,isBackgroundBlurred:s,patternColor:n,customBackground:a,backgroundColor:o,bot:t?(0,c.mBe)(e,t?.botId):void 0,currentUserId:e.currentUserId}}))((({modal:e,theme:t,isBackgroundBlurred:i,patternColor:a,customBackground:o,backgroundColor:r,bot:c})=>{const{closePreparedInlineMessageModal:d,sendWebAppEvent:h,openSharePreparedMessageModal:m}=(0,n.ko)(),u=(0,_i.A)(),p=Boolean(e),{webAppKey:v,message:g,botId:A}=e||{},b=(0,s.li)(),f=(0,Vl.A)(t,o),C=(0,D.A)((()=>{v&&A&&g&&(m({webAppKey:v,message:g}),d())})),y=(0,D.A)((()=>{d(),v&&h({webAppKey:v,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})})),S=(0,s.Kr)((()=>{if(e)return(0,ee.FD)("div",{className:"P1fPh6h8",children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:u("Close"),onClick:y,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("h3",{className:(0,me.A)("modal-title","E42tgAwD"),children:u("BotShareMessage")})]})}),[u,e]),w=(0,s.Kr)((()=>{if(A&&g&&v)return(0,l.i7)(A,g)}),[A,g,v]),k=(0,me.A)("_6w75ldP","lElCwweL",o&&"CZkpv8n0",r&&"VJAYrDF_",o&&i&&"m8xzfVvU");return(0,ee.FD)(Z.A,{dialogRef:b,isOpen:p,header:S,onClose:y,className:"Rzj2LMLf",contentClassName:"Ve4u2KVI",children:[(0,ee.FD)("div",{className:(0,me.A)("McJgXCtB","MessageList"),inert:!0,style:(0,Di.A)(`--pattern-color: ${a}`,r&&`--theme-background-color: ${r}`),children:[(0,ee.Y)("div",{className:k,style:f?`--custom-background: ${f}`:void 0}),w&&(0,ee.Y)(_l.A,{message:w,threadId:U.l3,messageListType:"thread",noComments:!0,noReplies:!0,appearanceOrder:0,isJustAdded:!1,isFirstInGroup:!0,isLastInGroup:!0,isLastInList:!1,isFirstInDocumentGroup:!1,isLastInDocumentGroup:!1},A)]}),(0,ee.FD)("div",{className:"pNSCKAVN",children:[(0,ee.Y)("p",{className:"xWnXsG7q",children:u("WebAppShareMessageInfo",{user:(0,l.Yg)(c)})}),(0,ee.Y)(W.A,{size:"smaller",onClick:C,children:u("BotShareMessageShare")})]})]})})));var Ol=i(20247),Kl=i(48227);const Jl=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e),{isPaymentMessageConfirmDialogOpen:i}=t;return{isPaymentMessageConfirmDialogOpen:i,starsBalance:e.stars?.balance.amount||0,isStarsBalanceModalOpen:Boolean(t.starsBalanceModal)}}))((({modal:e,isPaymentMessageConfirmDialogOpen:t,isStarsBalanceModalOpen:i,starsBalance:a})=>{const{closeSharePreparedMessageModal:o,sendInlineBotResult:r,sendWebAppEvent:l,showNotification:d,updateSharePreparedMessageModalSendArgs:h}=(0,n.ko)(),m=(0,M.A)(),u=Boolean(e),[p,v,g]=(0,Y.A)();(0,s.vJ)((()=>{u&&v()}),[u,v]);const{message:A,filter:b,webAppKey:f,pendingSendArgs:C}=e||{},{starsForSendMessage:y}=C||{},{closeConfirmDialog:S,dialogHandler:w,shouldAutoApprove:k,setAutoApprove:N,handleWithConfirmation:I}=(0,Ol.A)(y||0,i,a),P=(0,D.A)((()=>{o(),f&&l({webAppKey:f,event:{eventType:"prepared_message_failed",eventData:{error:"USER_DECLINED"}}})})),F=(0,D.A)(((e,t)=>{if(A&&f){const i=(0,n.mS)(),s=(0,c.PVB)(i,e);r({chatId:e,threadId:t||U.l3,id:A.result.id,queryId:A.result.queryId}),y||d({message:m("BotSharedToOne",(0,Yt.F9)(m,s))}),l({webAppKey:f,event:{eventType:"prepared_message_sent"}}),o(),h({args:void 0})}})),T=(0,D.A)(((e,t)=>{h({args:{peerId:e,threadId:t}})})),B=(0,D.A)((()=>{C&&I(F,C.peerId,C.threadId)})),R=(0,D.A)((()=>{S(),h({args:void 0})}));(0,s.vJ)((()=>{C&&B()}),[C]);const L=(0,n.mS)(),x=C?(0,c.PVB)(L,C.peerId):void 0,E=x?(0,Yt.F9)(m,x):void 0;if(u||p)return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(Xs,{isOpen:u,searchPlaceholder:m("Search"),filter:b,onSelectRecipient:T,onClose:P,onCloseAnimationEnd:g,isLowStackPriority:!0}),(0,ee.Y)(Kl.A,{isOpen:t,onClose:R,userName:E,messagePriceInStars:y||0,messagesCount:1,shouldAutoApprove:k,setAutoApprove:N,confirmHandler:w})]})}))),Gl=["embedLinks","sendPolls","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs","sendStickers","sendGifs"],jl=[...Gl,"sendPlain"];function zl(e){const[t,i]=(0,s.J0)({}),[n,a]=(0,s.J0)(!1),[o,r]=(0,s.J0)(!1);(0,s.vJ)((()=>{i(e||{}),a(!1),setTimeout((()=>{r(!1)}),250)}),[e]);const l=(0,s.hb)((s=>{const{name:n}=s.target,o=n;function r(e){return!e||void 0}const l=t;let c={...l,[o]:r(l[o]),..."sendStickers"===o&&{sendGifs:r(l[o])}};const d=()=>{const e=Gl.map((e=>c[e]));e.some((e=>!e))?c={...c,sendMedia:void 0}:e.every(Boolean)&&(c={...c,sendMedia:!0})};"sendMedia"!==o?d():c={...c,...Gl.reduce(((e,t)=>Object.assign(e,{[t]:c.sendMedia})),{})},"embedLinks"!==o&&!c.embedLinks&&c.sendPlain&&(c={...c,embedLinks:!0}),"sendPlain"!==o&&!c.embedLinks&&c.sendPlain&&(c={...c,sendPlain:void 0}),"sendMedia"!==o&&d();const h=jl.every((e=>c[e]));c={...c,sendMessages:!!h||void 0},i(c),a(!e||Object.keys(c).some((t=>{const i=t;return Boolean(e[i])!==Boolean(c[i])})))}),[e,t]),c=(0,s.hb)((()=>{i(e||{}),a(!1)}),[e]);return{permissions:t,isLoading:o,havePermissionChanged:n,handlePermissionChange:l,setIsLoading:r,resetPermissions:c}}const Hl=["sendPhotos","sendVideos","sendStickers","sendAudios","sendDocs","sendVoices","sendRoundvideos","embedLinks","sendPolls"],$l=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=t?(0,c.hds)(e,t):void 0,s=i&&(0,c.AWZ)(e,i.id);return{chat:i,hasLinkedChat:Boolean(s?.linkedChatId)}}))((({chat:e,isMediaDropdownOpen:t,setIsMediaDropdownOpen:i,hasLinkedChat:a,permissions:o,handlePermissionChange:r,className:c,shiftedClassName:d,dropdownClassName:h,withCheckbox:m,getControlIsDisabled:u,permissionGroup:p})=>{const{showNotification:v}=(0,n.ko)(),{isForum:g}=e||{},A=(0,M.A)(),b=(0,s.Kr)((()=>e&&(0,l.gA)(e)),[e]),C=a||b,y=(0,s.Kr)((()=>Hl.reduce(((e,t)=>(o[t]||(e+=1),e)),0)),[o]),S=(0,D.A)((e=>{(0,f.A)(e),i(!t)})),w=(0,D.A)((()=>{v({message:A("lng_rights_permission_unavailable")})}));return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendPlain",checked:!o.sendPlain,label:A("UserRestrictionsSend"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendPlain")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendMedia",checked:!o.sendMedia,label:A("UserRestrictionsSendMedia"),labelText:`${y}/${Hl.length}`,blocking:!0,permissionGroup:p,rightIcon:t?"up":"down",onChange:r,onClickLabel:S,disabled:u&&u("sendMedia")})}),(0,ee.Y)("div",{className:h,children:(0,ee.FD)("div",{className:c,children:[(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendPhotos",checked:!o.sendPhotos,label:A("UserRestrictionsSendPhotos"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendPhotos")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendVideos",checked:!o.sendVideos,label:A("UserRestrictionsSendVideos"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendVideos")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendStickers",checked:!o.sendStickers&&!o.sendGifs,label:A("UserRestrictionsSendStickers"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendStickers")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendAudios",checked:!o.sendAudios,label:A("UserRestrictionsSendMusic"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendAudios")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendDocs",checked:!o.sendDocs,label:A("UserRestrictionsSendFiles"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendDocs")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendVoices",checked:!o.sendVoices,label:A("UserRestrictionsSendVoices"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendVoices")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendRoundvideos",checked:!o.sendRoundvideos,label:A("UserRestrictionsSendRound"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendRoundvideos")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"embedLinks",checked:!o.embedLinks,label:A("UserRestrictionsEmbedLinks"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("embedLinks")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"sendPolls",checked:!o.sendPolls,label:A("UserRestrictionsSendPolls"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("sendPolls")})})]})}),(0,ee.FD)("div",{className:d,children:[(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"inviteUsers",checked:!o.inviteUsers,label:A("UserRestrictionsInviteUsers"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("inviteUsers")})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),onClick:C?w:void 0,children:(0,ee.Y)(un.A,{name:"pinMessages",checked:!o.pinMessages,label:A("UserRestrictionsPinMessages"),disabled:u?u("pinMessages"):C,blocking:!0,permissionGroup:p,onChange:r})}),(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),onClick:C?w:void 0,children:(0,ee.Y)(un.A,{name:"changeInfo",checked:!o.changeInfo,label:A("UserRestrictionsChangeInfo"),blocking:!0,permissionGroup:p,disabled:u?u("changeInfo"):C,onChange:r})}),g&&(0,ee.Y)("div",{className:(0,me.A)("ListItem",m&&"with-checkbox"),children:(0,ee.Y)(un.A,{name:"manageTopics",checked:!o.manageTopics,label:A("CreateTopicsPermission"),blocking:!0,permissionGroup:p,onChange:r,disabled:u&&u("manageTopics")})})]})]})})));var ql=i(77561);const Wl="yGhFKTl5",Ql="goI3MITH",Zl=(0,s.ph)((0,n.EK)((e=>{const{deleteMessageModal:t}=(0,c.nTw)(e),i=t?.messageIds,s=t?.chatId,{canDeleteForAll:n}=(0,c.jyG)(e,i),a=s?(0,c.hds)(e,s):void 0,o=a&&(0,c.AWZ)(e,a.id),r=o?.linkedChatId,d=Boolean(a)&&(0,l.WX)(a),h=Boolean(a)&&(0,l.Vs)(a),m=t?.isSchedule,p=t?.onConfirm,v=a&&(0,u.L8)(a.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(a))):void 0,g=Boolean(a&&!(0,l.DX)(a.id)&&(0,c.yps)(e,a.id)),A=o?.adminMembersById,b=a&&(0,l.ub)(a,"banUsers"),f=a?.isCreator,C=a?(0,c.ALW)(e,a):void 0,y=a&&(0,l.yn)(a)&&!n||C,S=a&&((0,l.Vs)(a)||d);return{chat:a,isChannel:d,isSuperGroup:h,messageIds:i,currentUserId:e.currentUserId,canDeleteForAll:!m&&n,contactName:v,willDeleteForCurrentUserOnly:y,willDeleteForAll:S,adminMembersById:A,chatBot:g,canBanUsers:b,linkedChatId:r,isSchedule:m,isCreator:f,onConfirm:p}}))((({isOpen:e,chat:t,isChannel:i,isSuperGroup:a,isSchedule:o,currentUserId:r,messageIds:l,isCreator:d,canDeleteForAll:h,contactName:m,willDeleteForCurrentUserOnly:u,willDeleteForAll:p,onConfirm:v,chatBot:g,adminMembersById:A,canBanUsers:b,linkedChatId:f})=>{const{closeDeleteMessageModal:C,deleteMessages:y,reportChannelSpam:S,deleteChatMember:w,deleteScheduledMessages:k,exitMessageSelectMode:N,updateChatMemberBannedRights:I,deleteParticipantHistory:P}=(0,n.ko)(),Y=(0,V.A)(e),F=(0,M.A)(),T=(0,_i.A)(),{permissions:B,havePermissionChanged:R,handlePermissionChange:L,resetPermissions:x}=zl(t?.defaultBannedRights),[E,_]=(0,s.J0)([]),[U,O]=(0,s.J0)([]),[K,J]=(0,s.J0)([]),[G,j]=(0,s.J0)(!1),[z,H]=(0,s.J0)(!1),[$,Q]=(0,s.J0)(!0),X=(0,s.Kr)((()=>{if(i||!l||!t)return Ci.p;const e=(0,n.mS)(),s=(0,c.SpN)(e,t.id,l);return s?(0,fi.Am)(s).filter((e=>e?.id!==t?.id&&e?.id!==f)):Ci.p}),[t,i,f,l]),te=(0,D.A)((()=>X.map((e=>({value:e.id,label:(0,Yt.F9)(T,e)||"",leftElement:(0,ee.Y)(Dt.A,{size:"small",peer:e})}))))),ie=(0,s.Kr)((()=>X.filter((e=>e.id!==f&&e.id!==r))),[X,r,f]),se=(0,s.Kr)((()=>X.filter((e=>e.id!==r&&e.id!==f))),[X,r,f]),ne=(0,s.Kr)((()=>{const e=X.some((e=>e.id===r));return!b||e?Ci.p:X.filter((e=>{const t=A?.[e.id];return d||!t}))}),[X,d,r,b,A]),ae=(0,s.Kr)((()=>Boolean(ie.length||se.length||ne.length)),[ie,se,ne])&&!h&&!o&&a,oe=(0,s.Kr)((()=>!X||o?{}:(0,fi.pA)(X,(e=>[e.id,(0,Yt.F9)(T,e)]))),[o,T,X]),re=(0,s.Kr)((()=>[{value:l&&X.length>=2?"spam":X?.[0]?.id,label:F("ReportSpamTitle"),nestedOptions:l&&X.length>=2?[...te().filter((e=>e.value!==f&&e.value!==r))]:void 0}]),[l,X,F,f,r]),le=(0,s.Kr)((()=>[{value:l&&X.length>=2?"delete_all":X?.[0]?.id,label:l&&X.length>=2?F("DeleteAllFromUsers"):F("DeleteAllFrom",Object.values(oe)[0]),nestedOptions:l&&X.length>=2?[...te().filter((e=>e.value!==f&&e.value!==r))]:void 0}]),[l,X,F,oe,f,r]),ce=(0,s.Kr)((()=>[{value:l&&X.length>=2?"ban":X?.[0]?.id,label:l&&X.length>=2?F(z?"DeleteRestrictUsers":"DeleteBanUsers"):z?F("KickFromSupergroup"):F("DeleteBan",Object.values(oe)[0]),nestedOptions:l&&X.length>=2?[...te()]:void 0}]),[z,F,l,X,oe]),de=(0,D.A)((()=>{H((e=>!e))})),he=(0,D.A)(((e,i)=>{if(!t)return Ci.p;const s=(0,n.mS)();return i.filter((i=>{const n=(0,c.LM$)(s,t.id,i);return n&&e.includes(n.id)}))})),ue=(0,D.A)((e=>{Object.entries(e).forEach((([e,i])=>{i.length&&S({participantId:e,chatId:t.id,messageIds:i})}))})),pe=(0,D.A)((e=>{y({messageIds:e,shouldDeleteForAll:!0})})),ve=(0,D.A)((e=>{t&&e.forEach((e=>{P({peerId:e,chatId:t.id})}))})),ge=(0,D.A)((e=>{e.forEach((e=>{w({chatId:t.id,userId:e})}))})),Ae=(0,D.A)((e=>{e.forEach((e=>{I({chatId:t.id,userId:e,bannedRights:B})}))})),be=(0,D.A)((()=>{if(t&&l){if(v?.(),o)k({messageIds:l});else if(ae){if(K){const e=(0,n.mS)(),i=K.filter((e=>!Number.isNaN(Number(e)))),s=l.reduce(((s,n)=>{const a=(0,c.LM$)(e,t.id,n);return a&&i.includes(a.id)&&(s[a.id]||(s[a.id]=[]),s[a.id].push(Number(n))),s}),{});ue(s)}if(E){const e=E.filter((e=>!Number.isNaN(Number(e))));ve(e)}if(U&&!R){const e=U.filter((e=>!Number.isNaN(Number(e))));ge(e);const t=he(e,l);pe(t)}if(U&&R){const e=U.filter((e=>!Number.isNaN(Number(e))));Ae(e)}K&&E&&U||y({messageIds:l,shouldDeleteForAll:$})}else y({messageIds:l,shouldDeleteForAll:$});C(),N()}})),fe=(0,D.A)((()=>{C()}));return(0,s.vJ)((()=>{!e&&Y&&(J([]),_([]),O([]),Q(!0),j(!1),H(!1),x())}),[e,Y,x]),(0,ee.Y)(Z.A,{isOpen:e,onClose:fe,onEnter:h?void 0:be,className:"SeaF_shb",children:(0,ee.FD)("div",{className:"_YNfwDqt",children:[(0,ee.FD)("div",{className:ae&&"axa67kqo",dir:F.isRtl?"rtl":void 0,children:[ae&&(0,ee.Y)(As.A,{size:"small",peers:X}),(0,ee.Y)("h3",{className:(0,me.A)(ae?"U4IFhV0a":"qd6OFHiG"),children:F("Chat.DeleteMessagesConfirmation",l?.length)})]}),ae&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("p",{className:Wl,children:F("DeleteAdditionalActions")}),(0,ee.FD)("div",{className:"b6847Kh3",children:[(0,ee.Y)(ql.A,{options:re,onChange:J,selected:K,nestedCheckbox:l&&X.length>=2}),ie?.length>0&&(0,ee.Y)(ql.A,{options:le,onChange:_,selected:E,nestedCheckbox:l&&X.length>=2}),ne?.length>0&&(0,ee.Y)(ql.A,{options:ce,onChange:O,selected:U,nestedCheckbox:l&&X.length>=2})]}),(0,ee.FD)("div",{className:(0,me.A)("iv0u9Zw6",z&&"qCQftA04"),children:[(0,ee.Y)("h3",{className:(0,me.A)(Wl,"t3KOsBfm"),children:F("UserRestrictionsCanDoUsers",X.length)}),(0,ee.Y)($l,{withCheckbox:!0,chatId:t?.id,isMediaDropdownOpen:G,setIsMediaDropdownOpen:j,handlePermissionChange:L,permissions:B,className:(0,me.A)("czTjjKim",G&&"Ifpyv7Jp")})]}),U&&b?(0,ee.FD)(ci.A,{narrow:!0,buttonClassName:Ql,onClick:de,children:[F(z?"DeleteToggleBanUsers":"DeleteToggleRestrictUsers"),(0,ee.Y)(q.A,{name:z?"up":"down",className:(0,me.A)(Ql,"ml-2")})]}):H(!1)]}),(h||g||!ae)&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("p",{children:l&&l.length>1?T("AreYouSureDeleteFewMessages"):T("AreYouSureDeleteSingleMessage")}),u&&(0,ee.Y)("p",{children:F("lng_delete_for_me_chat_hint",1,"i")}),p&&(0,ee.Y)("p",{children:F("lng_delete_for_everyone_hint",1,"i")})]}),h&&(0,ee.Y)(un.A,{className:"dialog-checkbox",label:m?(0,Ft.A)(F("DeleteMessagesOptionAlso",m)):F("Conversation.DeleteMessagesForEveryone"),checked:$,onCheck:Q}),(0,ee.FD)("div",{className:(0,me.A)("dialog-buttons",G?"JTT_DIRv":"L4YzeG91"),children:[(0,ee.Y)(W.A,{color:"danger",className:"confirm-dialog-button",isText:!0,onClick:be,children:ae?F("DeleteProceedBtn"):T("Delete")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:fe,children:F("Cancel")})]})]})})}))),Xl=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,u.L8)(t),s=(0,c.nZ4)(e,t),n=(0,c.hds)(e,t),a=Boolean(n)&&(0,l.WX)(n),o=Boolean(n)&&(0,l.yn)(n),r=Boolean(n)&&(0,l.Vs)(n);return{isPrivateChat:i,isChatWithSelf:s,isChannel:a,isGroup:o,isSuperGroup:r,canPinForAll:i&&!s||r||o,contactName:n&&(0,u.L8)(n.id)?(0,l.u0)((0,c.mBe)(e,(0,l.e7)(n))):void 0}}))((({isOpen:e,chatId:t,messageId:i,isChannel:a,isGroup:o,isSuperGroup:r,canPinForAll:l,contactName:c,onClose:d})=>{const{pinMessage:h}=(0,n.ko)(),[m,u]=(0,s.J0)(!0),p=(0,D.A)((()=>{h({chatId:t,messageId:i,isUnpin:!1,isOneSide:!m,isSilent:!m}),d()})),v=(0,M.A)();return(0,ee.FD)(Z.A,{isOpen:e,onClose:d,className:"pin",title:v("PinMessageAlertTitle"),children:[(0,ee.Y)("p",{children:v(a?"PinMessageAlertChannel":o||r?"PinMessageAlert":"PinMessageAlertChat")}),l&&(0,ee.Y)(un.A,{className:"dialog-checkbox",label:c?(0,Ft.A)(v("Conversation.PinMessagesFor",c)):v("Conversation.PinMessageAlert.PinAndNotifyMembers"),checked:m,onCheck:u}),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:p,children:v("DialogPin")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:v("Cancel")})]})]})}))),ec=(0,s.ph)((({isOpen:e,pinnedMessagesCount:t=0,onClose:i,onUnpin:s})=>{const n=(0,M.A)();return(0,ee.FD)(Z.A,{isOpen:e,onClose:i,className:"unpin-all",title:n("Chat.PanelUnpinAllMessages"),children:[(0,ee.Y)("p",{children:n("Chat.UnpinAllMessagesConfirmation",t,"i")}),(0,ee.FD)("div",{className:"dialog-buttons mt-2",children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:s,children:n("DialogUnpin")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:i,children:n("Cancel")})]})]})}));var tc=i(2178);const ic=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e),{shouldWarnAboutSvg:i}=(0,Nn.l)(e),s=(0,c.meB)(e),{type:n,chatId:a}=(0,c.Xf0)(e)||{},o="scheduled"===n,{canDelete:r}=(0,c.jyG)(e),l=Boolean(!o&&(0,c.mDG)(e)),d=(0,c.ori)(e),{messageIds:h}=t.selectedMessages||{},m=!!a&&(0,c.o45)(e,a,h),u=!(o||!a)&&(0,c.Y8y)(e,a,h),p=!(!h||!a)&&(0,c.H_s)(e,a,h),v=t.isShareMessageModalShown,g=Boolean(v||t.requestedDraft||t.requestedAttachBotInChat||t.requestedAttachBotInstall||t.reportModal||t.deleteMessageModal);return{chat:s,isSchedule:o,selectedMessagesCount:(0,c.ZZ2)(e),canDeleteMessages:r,canReportMessages:l,canDownloadMessages:d,canForwardMessages:u,selectedMessageIds:h,hasProtectedMessage:m,isAnyModalOpen:g,shouldWarnAboutSvg:i,hasSvgs:p}}))((({chat:e,canPost:t,isActive:i,messageListType:a,isSchedule:o,selectedMessagesCount:r,canDeleteMessages:l,canReportMessages:c,canDownloadMessages:d,canForwardMessages:h,hasProtectedMessage:m,isAnyModalOpen:u,selectedMessageIds:p,shouldWarnAboutSvg:v,hasSvgs:g})=>{const{exitMessageSelectMode:A,openForwardMenuForSelectedMessages:b,downloadSelectedMessages:f,copySelectedMessages:C,showNotification:y,reportMessages:S,openDeleteMessageModal:w,setSharedSettingOption:k}=(0,n.ko)(),N=(0,M.A)();(e=>{function t(e){e.preventDefault(),(0,n.ko)().copySelectedMessages()}(0,tc.v)((0,s.Kr)((()=>e?{"Mod+C":t}:void 0),[e]))})(i);const[I,P,F]=(0,Y.A)(),[T,B]=(0,s.J0)(!1),R=(0,D.A)((()=>{A()})),L=(0,D.A)((()=>{p&&e&&w({chatId:e.id,messageIds:p,isSchedule:o})}));(0,s.vJ)((()=>i&&!u?(0,Ri.A)({onBackspace:l?L:void 0,onDelete:l?L:void 0,onEsc:R}):void 0),[i,L,R,u,l]);const x=(0,D.A)((()=>{C(),y({message:N("Share.Link.Copied")}),A()})),E=(0,D.A)((()=>{f(),A()})),_=(0,D.A)((()=>{v&&g?P():E()})),U=(0,D.A)((()=>{k({shouldWarnAboutSvg:!T}),F(),E()})),O=(0,V.A)(r||void 0,!0),K=N("VoiceOver.Chat.MessagesSelected",i?r:O,"i"),J=(0,D.A)((()=>{p&&e&&(S({chatId:e.id,messageIds:p}),A())})),G=(0,me.A)("MessageSelectToolbar",t&&"with-composer",i&&"shown"),j=(e,t,i,s)=>(0,ee.Y)("div",{role:"button",tabIndex:0,className:(0,me.A)("div-button","item",s&&"destructive"),onClick:i,title:t,"aria-label":t,children:(0,ee.Y)(q.A,{name:e})});return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{className:G,children:(0,ee.FD)("div",{className:"MessageSelectToolbar-inner",children:[(0,ee.Y)(W.A,{color:"translucent",round:!0,onClick:R,ariaLabel:"Exit select mode",children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("span",{className:"MessageSelectToolbar-count",title:K,children:K}),Boolean(r)&&(0,ee.FD)("div",{className:"MessageSelectToolbar-actions",children:["scheduled"!==a&&h&&j("forward",N("Chat.ForwardActionHeader"),b),c&&j("flag",N("Conversation.ReportMessages"),J),d&&!m&&j("download",N("lng_media_download"),_),!m&&j("copy",N("lng_context_copy_selected_items"),x),l&&j("delete",N("EditAdminGroupDeleteMessages"),L,!0)]})]})}),(0,ee.FD)(vi.A,{isOpen:I,onClose:F,confirmHandler:U,children:[N("lng_launch_svg_warning"),(0,ee.Y)(un.A,{className:"dialog-checkbox",checked:T,label:N("lng_launch_exe_dont_ask"),onCheck:B})]})]})}))),sc=(0,s.ph)((0,n.EK)((e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).seenByModal||{};return t&&i?{seenByDates:(0,c.O5q)(e,t,i)?.seenByDates}:{}}))((function({isOpen:e,seenByDates:t}){const{openChat:i,closeSeenByModal:a}=(0,n.ko)(),o=(0,M.A)(),r=(0,Bi.A)(t,!0),l=(0,s.Kr)((()=>{if(!r)return;const e=Object.keys(r);return e.sort(((e,t)=>r[t]-r[e])),e}),[r]),c=(0,D.A)((e=>{a(),setTimeout((()=>{i({id:e})}),100)})),d=(0,D.A)((()=>{a()}));return(0,ee.FD)(Z.A,{isOpen:e,onClose:a,className:(0,me.A)("slqA9gR2","narrow"),title:`Seen by ${l?.length} users`,children:[(0,ee.Y)("div",{dir:o.isRtl?"rtl":void 0,children:l&&l.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>c(e),children:(0,ee.Y)(Rs.A,{userId:e,noStatusOrTyping:!0,status:(0,ze.U)(o,1e3*r[e]),statusIcon:"message-read"})},e)))}),(0,ee.Y)("div",{className:"dialog-buttons mt-2",children:(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:o("Close")})})]})})));var nc=i(32581);const ac="MQxuEIRA",oc="AEAN1Au4",rc="F7owtTHj",lc=Z.U+o.xB5,cc=(0,s.ph)((0,n.EK)((e=>{const{chatId:t,isReadDate:i}=(0,c.nTw)(e).privacySettingsNoticeModal||{};return{user:t?(0,c.mBe)(e,t):void 0,isReadDate:i}}))((({isOpen:e,isReadDate:t,user:i})=>{const s=(0,M.A)(),{updateGlobalPrivacySettings:a,openPremiumModal:o,closePrivacySettingsNoticeModal:r,showNotification:c,setPrivacyVisibility:d,loadUser:h}=(0,n.ko)(),m=(0,l.u0)(i),u=(0,D.A)((()=>{a({shouldHideReadMarks:!1}),r(),setTimeout((()=>{c({message:s("PremiumReadSet")})}),lc)})),p=(0,D.A)((()=>{d({privacyKey:"lastSeen",visibility:"everybody",onSuccess:()=>h({userId:i.id})}),r(),setTimeout((()=>{c({message:s("PremiumLastSeenSet")})}),lc)})),v=(0,D.A)((()=>{r(),setTimeout((()=>{o({initialSection:"last_seen"})}),lc)})),g=(0,D.A)((()=>{r()}));return(0,ee.Y)(Z.A,{isSlim:!0,isOpen:e,onClose:g,children:(0,ee.FD)("div",{className:"tauadiDm",dir:s.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{className:"i6iFv9YE",color:"translucent",round:!0,size:"smaller",onClick:g,ariaLabel:"Close",children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)(Tr.A,{tgsUrl:t?Mr.w.ReadTime:Mr.w.LastSeen,size:84,className:"i4wZg_0J",nonInteractive:!0,noLoop:!0}),(0,ee.Y)("h2",{className:ac,children:s(t?"PremiumReadHeader1":"PremiumLastSeenHeader1")}),(0,ee.Y)("p",{className:oc,children:(0,Ft.A)(s(t?"PremiumReadText1":"PremiumLastSeenText1Locked",m),["simple_markdown"])}),(0,ee.Y)(W.A,{size:"smaller",onClick:t?u:p,className:rc,children:s(t?"PremiumReadButton1":"PremiumLastSeenButton1")}),(0,ee.Y)(nc.A,{className:"sXXb5yOS",children:s("PremiumOr")}),(0,ee.Y)("h2",{className:ac,children:s("PremiumReadHeader2")}),(0,ee.Y)("p",{className:oc,children:(0,Ft.A)(s(t?"PremiumReadText2":"PremiumLastSeenText2",m),["simple_markdown"])}),(0,ee.Y)(W.A,{withPremiumGradient:!0,size:"smaller",onClick:v,className:rc,children:s("PremiumLastSeenButton2")})]})})}))),dc=(0,s.ph)((0,n.EK)((e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).reactorModal||{},s=t&&i?(0,c.O5q)(e,t,i):void 0;return{chatId:t,messageId:i,reactions:s?.reactions,reactors:s?.reactors,seenByDates:s?.seenByDates,availableReactions:e.reactions.availableReactions}}))((({isOpen:e,reactors:t,reactions:i,chatId:o,messageId:r,seenByDates:c,availableReactions:d})=>{const{loadReactors:h,closeReactorListModal:m,openChat:u}=(0,n.ko)(),p=(0,n.mS)().chats.byId,v=(0,n.mS)().users.byId,g=(0,M.A)(),A=(0,_i.A)(),[b,f,C]=(0,Y.A)(!1),[y,S]=(0,s.J0)(void 0),w=t&&i&&t.count>=10&&i.results.length>1,k=(0,s.li)();(0,s.vJ)((()=>{e&&!b&&(k.current=void 0),b&&!e&&(C(),S(void 0))}),[b,e,C]);const N=(0,D.A)((()=>{k.current&&u({id:k.current}),m()})),I=(0,D.A)((()=>{f()})),P=(0,D.A)((e=>{k.current=e,I()})),F=(0,D.A)((()=>{h({chatId:o,messageId:r})})),T=(0,s.Kr)((()=>{const e=[];return t?.reactions?.forEach((({reaction:t})=>{e.some((e=>(0,l.a0)(e,t)))||e.push(t)})),e}),[t]),B=(0,s.Kr)((()=>{if(y)return t?.reactions.filter((({reaction:e})=>(0,l.a0)(e,y))).map((({peerId:e})=>e));const e=Object.keys(c||{});return(0,fi.Am)(t?.reactions.map((({peerId:e})=>e)).concat(e||[])||[])}),[y,t,c]),[R,L]=(0,Js.A)(F,B,t&&void 0===t.nextOffset);return(0,s.vJ)((()=>{L?.({direction:a.TN.Backwards})}),[L]),(0,ee.FD)(Z.A,{isOpen:e&&!b,onClose:I,className:"ReactorListModal narrow",title:g("Reactions"),onCloseAnimationEnd:N,children:[w&&(0,ee.FD)("div",{className:"Reactions",dir:g.isRtl?"rtl":void 0,children:[(0,ee.FD)(W.A,{className:(0,me.A)(!y&&"chosen"),size:"tiny",ripple:!0,onClick:()=>S(void 0),children:[(0,ee.Y)(q.A,{name:"heart"}),Boolean(t?.count)&&(0,He.Vw)(A,t.count)]}),T.map((e=>{const t=i?.results.find((t=>(0,l.a0)(t.reaction,e)))?.count;return(0,ee.FD)(W.A,{className:(0,me.A)((0,l.a0)(y,e)&&"chosen"),size:"tiny",ripple:!0,onClick:()=>S(e),children:[(0,ee.Y)(Ls.A,{reaction:e,className:"reaction-filter-emoji",availableReactions:d}),Boolean(t)&&(0,He.Vw)(A,t)]},(0,l.Jj)(e))}))]}),(0,ee.Y)("div",{dir:g.isRtl?"rtl":void 0,className:"reactor-list-wrapper",children:R?.length?(0,ee.Y)(Ds.A,{className:"reactor-list custom-scroll",items:R,onLoadMore:L,children:R?.flatMap((e=>{const i=v[e]||p[e],s=t?.reactions.filter((t=>t.peerId===e)),n=[],a=c?.[e];return s?.forEach((t=>{y&&!(0,l.a0)(t.reaction,y)||n.push((0,ee.FD)(ci.A,{className:"chat-item-clickable reactors-list-item",onClick:()=>P(e),children:[(0,ee.Y)(Dt.A,{peer:i,size:"medium"}),(0,ee.FD)("div",{className:"info",children:[(0,ee.Y)(Hs.A,{peer:i,withEmojiStatus:!0}),(0,ee.FD)("span",{className:"status",dir:"auto",children:[(0,ee.Y)(q.A,{name:"heart-outline",className:"status-icon"}),(0,ze.U)(g,1e3*t.addedDate)]})]}),t.reaction&&(0,ee.Y)(Ls.A,{className:"reactors-list-emoji",reaction:t.reaction,availableReactions:d})]},`${e}-${(0,l.Jj)(t.reaction)}`))})),y||s?.length||n.push((0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>P(e),children:(0,ee.Y)(Rs.A,{userId:e,noStatusOrTyping:!0,avatarSize:"medium",status:a?(0,ze.U)(g,1e3*a):void 0,statusIcon:"message-read"})},`${e}-seen-by`)),n}))}):(0,ee.Y)(zs.A,{})}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:I,children:g("Close")})]})}))),hc=(0,s.ph)((0,n.EK)(((e,{activeEmojiInteraction:t})=>{const i=void 0!==t.animatedEffect&&(0,c.Nr8)(e,t.animatedEffect);return{effectAnimationId:i?i.id:void 0}}))((({effectAnimationId:e,activeEmojiInteraction:t})=>{const{stopActiveEmojiInteraction:i}=(0,n.ko)(),[a,o]=(0,Y.A)(!1),[r,l]=(0,Y.A)(!1),c=(0,s.li)(),d=(0,D.A)((()=>{o(),c.current&&clearTimeout(c.current),setTimeout((()=>{i({id:t.id})}),250)})),h=(0,D.A)((e=>{e.target?.closest(".AnimatedEmoji")||d()}));(0,s.vJ)((()=>(document.addEventListener("touchstart",h),document.addEventListener("touchmove",h),document.addEventListener("mousedown",h),document.addEventListener("wheel",h),()=>{document.removeEventListener("touchstart",h),document.removeEventListener("touchmove",h),document.removeEventListener("mousedown",h),document.removeEventListener("wheel",h)})),[h]),(0,s.Nf)((()=>{const e=(0,s.VK)();c.current=setTimeout((()=>{d(),e()}),3e3)}),[d]);const m=e&&`sticker${e}`,u=(0,j.A)(m,!e);if(!t.startSize)return;const p=(t.startSize||0)/309;return(0,ee.Y)("div",{className:(0,me.A)("EmojiInteractionAnimation",a&&"hiding",r&&"playing",t.isReversed&&"reversed"),style:`--scale: ${p}; --start-x: ${t.x}px; --start-y: ${t.y}px;`,children:(0,ee.Y)(Ea.A,{size:309,tgsUrl:u,play:!0,quality:b.Ni?.5:void 0,forceAlways:!0,noLoop:!0,onLoad:l},`effect_${e}`)})}))),mc=(0,s.ph)((0,n.EK)((e=>{const{chatId:t,messageId:i}=(0,c.nTw)(e).chatLanguageModal||{},s=(0,c.wmb)(e);return{chatId:t,messageId:i,activeTranslationLanguage:t?i?(0,c.Rny)(e,t,i):(0,c.qZq)(e,t):void 0,currentLanguageCode:s}}))((({isOpen:e,chatId:t,messageId:i,activeTranslationLanguage:a,currentLanguageCode:r})=>{const{requestMessageTranslation:l,closeChatLanguageModal:c,setSettingOption:d,requestChatTranslation:h}=(0,n.ko)(),[m,u]=(0,s.J0)(""),p=(0,M.A)(),v=(0,D.A)((e=>{t&&(i?l({chatId:t,id:i,toLanguageCode:e}):(d({translationLanguage:e}),h({chatId:t,toLanguageCode:e})),c())})),g=(0,D.A)((e=>{u(e.target.value)})),A=(0,s.Kr)((()=>o.N89.map((e=>({langCode:e,translatedName:new Intl.DisplayNames([r],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)})))),[r]);(0,s.vJ)((()=>{e||u("")}),[e]);const b=(0,s.Kr)((()=>m.trim()?A.filter((({langCode:e,translatedName:t,originalName:i})=>t.toLowerCase().includes(m.toLowerCase())||i.toLowerCase().includes(m.toLowerCase())||e.toLowerCase().includes(m.toLowerCase()))):A),[A,m]);return(0,ee.FD)(Z.A,{className:"aMjNU9gm",isSlim:!0,isOpen:e,hasCloseButton:!0,title:p("Language"),onClose:c,children:[(0,ee.Y)(Q.A,{value:m,onChange:g,placeholder:p("Search"),teactExperimentControlled:!0},"search"),(0,ee.Y)("div",{className:(0,me.A)("r3YNWDQr","custom-scroll"),children:b.map((({langCode:e,originalName:t,translatedName:i})=>(0,ee.FD)(ci.A,{className:(0,me.A)("T3An6Hoz","no-icon"),secondaryIcon:a===e?"check":void 0,disabled:a===e,multiline:!0,narrow:!0,onClick:()=>v(e),children:[(0,ee.Y)("span",{className:(0,me.A)("title","dQ9wwFu1"),children:(0,Ft.A)(t,["highlight"],{highlight:m})}),(0,ee.Y)("span",{className:(0,me.A)("subtitle","m_J41YYl"),children:(0,Ft.A)(i,["highlight"],{highlight:m})})]},e)))})]})})));var uc=i(85982),pc=i(24899);const vc={content:"WEJIbFQj",closeButton:"_vwPuDEM",icon:"BUiGM8qZ",title:"Q3NhXpNI",description:"frZbGQ0G"},gc=(0,s.ph)((0,n.EK)((e=>{const{countryList:t}=e;return{phoneCodeList:t.phoneCodes}}))((({modal:e,phoneCodeList:t})=>{const{closeCollectibleInfoModal:i,openChat:a,openUrl:o,showNotification:r}=(0,n.ko)(),l=(0,M.A)(),c="username"===e?.type,d=(0,D.A)((()=>{i()})),h=(0,D.A)((()=>{a({id:e.peerId}),d()})),m=(0,D.A)((()=>{o({url:e.url,shouldSkipModal:!0}),d()})),u=(0,D.A)((()=>{const i=c?(0,pc.A)(e.collectible):(0,Sn.Ox)(t,e.collectible);(0,uc.eM)(i),r({message:l(c?"UsernameCopied":"PhoneCopied")}),d()})),p=(0,s.Kr)((()=>{if(!e)return;const i=c?"FragmentUsernameTitle":"FragmentPhoneTitle",s=c?(0,pc.A)(e.collectible):(0,Sn.Ox)(t,e.collectible);return l(i,s)}),[e,c,t,l]),v=(0,s.Kr)((()=>{if(!e)return;const t=c?"FragmentUsernameMessage":"FragmentPhoneMessage",i=(0,ze.U)(l,1e3*e.purchaseDate),s=(0,Sa.A)(e.amount,e.currency,l.code),n=(0,Sa.A)(e.cryptoAmount,e.cryptoCurrency,l.code);return l(t,[i,`${n} (${s})`])}),[e,c,l]);return(0,ee.FD)(Z.A,{isOpen:Boolean(e),isSlim:!0,contentClassName:vc.content,onClose:i,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",className:vc.closeButton,ariaLabel:l("Close"),onClick:d,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:vc.icon,children:(0,ee.Y)(Tr.A,{tgsUrl:c?Mr.w.Mention:Mr.w.Fragment,size:60})}),(0,ee.Y)("h3",{className:vc.title,children:p&&(0,Ft.A)(p,["simple_markdown"])}),(0,ee.Y)(qr.A,{className:vc.chip,peerId:e?.peerId,forceShowSelf:!0,clickArg:e?.peerId,onClick:h}),(0,ee.Y)("p",{className:vc.description,children:v&&(0,Ft.A)(v,["simple_markdown"])}),(0,ee.FD)("div",{className:"dialog-buttons dialog-buttons-centered",children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",onClick:m,children:l("FragmentUsernameOpen")}),(0,ee.Y)(W.A,{isText:!0,className:"confirm-dialog-button",onClick:u,children:l(c?"FragmentUsernameCopy":"FragmentPhoneCopy")})]})]})})));var Ac=i(24680),bc=i(57309);function fc(e){return(t,i)=>{const s=(0,c.nTw)(t),{byId:n}=t.chats,{byId:a}=t.users,{fetchingStatus:o,resultsByType:r,chatId:l}=s.globalSearch,{shouldWarnAboutSvg:d}=(0,Nn.l)(t),h="audio"!==e?e:i?.isVoice?"voice":"audio",{byChatId:m}=t.messages,u=r?.[h]?.foundIds,p=s.activeDownloads;return{theme:(0,c.SJA)(t),isLoading:void 0===u||!!o&&Boolean(o.chats||o.messages),chatsById:n,usersById:a,globalMessagesByChatId:m,foundIds:u,searchChatId:l,activeDownloads:p,isChatProtected:l?(0,c.hds)(t,l)?.isProtected:void 0,shouldWarnAboutSvg:d}}}var Cc=i(55429),yc=i(65240),Sc=i(42827);const wc=(0,ve.nF)((e=>e()),500,!0),kc=(0,s.ph)((0,n.EK)(fc("audio"))((({theme:e,isVoice:t,searchQuery:i,isLoading:r,chatsById:c,usersById:d,globalMessagesByChatId:h,foundIds:m,activeDownloads:u})=>{const{searchMessagesGlobal:p,focusMessage:v,openAudioPlayer:g}=(0,n.ko)(),A=(0,M.A)(),b=t?"voice":"audio",f=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&wc((()=>{p({type:b})}))}),[b,p,i]),C=(0,s.Kr)((()=>m&&h?m.map((e=>{const[t,i]=(0,bc.a)(e);return h[t]?.byId[i]})).filter(Boolean):Ci.p),[h,m]),y=(0,s.hb)((e=>{v({chatId:e.chatId,messageId:e.id})}),[v]),S=(0,s.hb)(((e,t)=>{g({chatId:t,messageId:e})}),[g]),w=(0,pr.A)([i],o.jhd)&&!r;return(0,ee.Y)("div",{className:"LeftSearch--content",children:(0,ee.FD)(Ds.A,{className:"search-content documents-list custom-scroll",items:w?C:void 0,onLoadMore:f,noFastList:!0,children:[!w&&(0,ee.Y)(zs.A,{}),w&&(!m||0===m.length)&&(0,ee.Y)(Sc.A,{text:A("ChatList.Search.NoResults"),description:A("ChatList.Search.NoResultsDescription")}),w&&m&&m.length>0&&C.map(((t,i)=>{const s=0===i||(0,ze.$$)(t.date)!==(0,ze.$$)(C[i-1].date),n=(0,l.ed)(t);return(0,ee.FD)(ee.FK,{children:[s&&(0,ee.Y)("p",{className:"section-heading",dir:A.isRtl?"rtl":void 0,children:(0,ze.i6)(A,new Date(1e3*t.date))},t.date),(0,ee.Y)("div",{className:"ListItem small-icon",children:(0,ee.Y)(yc.Ay,{theme:e,message:t,origin:a.d9.Search,senderTitle:(0,Cc.N)(A,t,c,d),date:t.date,className:"scroll-item",onPlay:S,onDateClick:y,canDownload:!c[t.chatId]?.isProtected&&!t.isProtected,isDownloading:(0,l.$r)(u,n)},t.id)},t.id)]})}))]})})})));var Nc=i(27109),Ic=i(47067);const Pc=e=>{const t=(0,s.li)(),i=(0,s.hb)((i=>{"Enter"===i.key&&t.current===document.activeElement&&e()}),[e]);return(0,s.vJ)((()=>(window.addEventListener("keydown",i,!1),()=>window.removeEventListener("keydown",i,!1))),[i]),t};var Yc=i(97967),Fc=i(97046);const Dc=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,user:(0,c.mBe)(e,t),isPinned:(0,c.D3D)(e,t),isMuted:i&&(0,Nc.If)(i,(0,c.K52)(e),(0,c.P5N)(e,i.id)),canChangeFolder:Boolean(e.chatFolders.orderedIds?.length)}}))((({chatId:e,withUsername:t,chat:i,user:o,isPinned:r,isMuted:l,canChangeFolder:c,withOpenAppButton:d,onClick:h})=>{const{requestMainWebView:m}=(0,n.ko)(),p=(0,M.A)(),[v,g,A]=(0,Y.A)(),[b,f,C]=(0,Y.A)(),[y,S,w]=(0,Y.A)(),[k,N,I]=(0,Y.A)(),P=(0,s.hb)((()=>{S(),f()}),[S,f]),F=(0,s.hb)((()=>{N(),g()}),[N,g]),T=(0,Ic.A)({chat:i,user:o,isPinned:r,isMuted:l,canChangeFolder:c,handleMute:F,handleChatFolderChange:P},!0),B=(0,D.A)((()=>{h(e)})),R=(0,D.A)((t=>{t.stopPropagation();const i=(0,En.A)();m({botId:e,peerId:e,theme:i})})),L=Pc(B);return(0,ee.FD)(ci.A,{className:"chat-item-clickable search-result",onClick:B,contextActions:T,buttonRef:L,children:[(0,u.L8)(e)?(0,ee.Y)(Rs.A,{userId:e,withUsername:t,withStory:!0,avatarSize:"medium",storyViewerOrigin:a.G9.SearchResult}):(0,ee.Y)(Bs.A,{chatId:e,withUsername:t,avatarSize:"medium",withStory:!0,storyViewerOrigin:a.G9.SearchResult}),d&&o?.hasMainMiniApp&&(0,ee.Y)(W.A,{className:"ChatBadge miniapp",pill:!0,fluid:!0,size:"tiny",onClick:R,children:p("BotOpen")}),k&&(0,ee.Y)(Fc.A,{isOpen:v,onClose:A,onCloseAnimationEnd:I,chatId:e}),y&&(0,ee.Y)(Yc.A,{isOpen:b,onClose:C,onCloseAnimationEnd:w,chatId:e})]})}))),Mc=(0,ve.nF)((e=>e()),500,!0),Tc=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e).globalSearch,i=t.popularBotApps?.peerIds;return{isLoading:!i&&t.fetchingStatus?.botApps,foundIds:i,recentBotIds:e.topBotApps.userIds}}))((({searchQuery:e,isLoading:t,foundIds:i,recentBotIds:r})=>{const{searchPopularBotApps:l,openChatWithInfo:c}=(0,n.ko)(),d=(0,s.li)(),h=(0,M.A)(),[m,u]=(0,s.J0)(!1),p=(0,s.Kr)((()=>{if(!i)return[];const t=new Set(r),s=i.filter((e=>!t.has(e)));return(0,Yt.PU)({ids:s,query:e,type:"user"})}),[i,r,e]),v=(0,D.A)((e=>{c({id:e,shouldReplaceHistory:!0})})),g=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&Mc((()=>{l()}))}),[]),A=(0,D.A)((()=>{u((e=>!e))})),b=(0,pr.A)([e],o.jhd)&&!t;return(0,ee.Y)("div",{ref:d,className:"LeftSearch--content",children:(0,ee.FD)(Ds.A,{className:"search-content custom-scroll",items:b?p:void 0,onLoadMore:g,noFastList:!0,children:[!b&&(0,ee.Y)(zs.A,{}),b&&!p?.length&&(0,ee.Y)(Sc.A,{text:h("ChatList.Search.NoResults"),description:h("ChatList.Search.NoResultsDescription")}),b&&!e&&Boolean(r?.length)&&(0,ee.FD)("div",{className:"search-section",children:[(0,ee.FD)("h3",{className:"section-heading",children:[r.length>5&&(0,ee.Y)(Eo.A,{className:"Link",onClick:A,children:h(m?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")}),h("SearchAppsMine")]}),r.map(((e,t)=>{if(m||!(t>=5))return(0,ee.Y)(Dc,{chatId:e,onClick:v,withOpenAppButton:!0})}))]}),b&&Boolean(p?.length)&&(0,ee.FD)("div",{className:"search-section",children:[(0,ee.Y)("h3",{className:"section-heading",children:h("SearchAppsPopular")}),p.map((e=>(0,ee.Y)(Dc,{chatId:e,onClick:v,withOpenAppButton:!0})))]})]})})})));function Bc(e,t,i,s,n){if(!i)return(0,v.C)(e,t,void 0,s);const a=(0,l.y2)(t);return(0,ee.FD)("span",{className:"media-preview",children:[(0,ee.Y)("img",{src:i,alt:"",className:(0,me.A)("media-preview--image",n&&"round",a&&"media-preview-spoiler"),draggable:!1}),(0,l.zX)(t)&&(0,ee.Y)(q.A,{name:"play"}),(0,v.C)(e,t,!0,s)]})}const Rc=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t);if(!i)return{};const s=(0,l.e7)(i),n=s?(0,c.mBe)(e,s):void 0;return{chat:i,...s&&{privateChatUser:n}}}))((({message:e,searchQuery:t,chatId:i,chat:s,privateChatUser:a})=>{const{focusMessage:o}=(0,n.ko)(),{isMobile:r}=(0,I.Ay)(),c=(0,l.fP)(e)?void 0:(0,l.CI)(e),d=(0,j.A)((0,l.EO)(e,"micro")),h=Boolean((0,l.lk)(e)),m=(0,D.A)((()=>{o({chatId:i,messageId:e.id,shouldReplaceHistory:!0})})),u=(0,M.A)(),p=Pc(m);if(!s)return;const v=a||s;return(0,ee.FD)(ci.A,{className:"ChatMessage chat-item-clickable",ripple:!r,onClick:m,buttonRef:p,children:[(0,ee.Y)(Dt.A,{peer:v,isSavedMessages:a?.isSelf}),(0,ee.FD)("div",{className:"info",children:[(0,ee.FD)("div",{className:"info-row",children:[(0,ee.Y)(Hs.A,{peer:v,withEmojiStatus:!0,isSavedMessages:i===a?.id&&a?.isSelf}),(0,ee.Y)("div",{className:"message-date",children:(0,ee.Y)(Eo.A,{className:"date",children:(0,ze.be)(u,1e3*e.date)})})]}),(0,ee.Y)("div",{className:"subtitle",children:(0,ee.Y)("div",{className:"message",dir:"auto",children:Bc(u,e,d||c,t,h)})})]})]})}))),Lc=(0,s.ph)((({searchDate:e,onSelect:t})=>{const i=(0,s.Kr)((()=>function(e){if(e.match(/^\d{2,4}-\d{2}-\d{2}$/g)){const t=new Date(e);return[{date:t,text:(0,ze.A)(t)}]}const t=[],i=new Date,s=i.getFullYear(),n=i.getTime()>new Date(`${s}-${e}`).getTime()?s:s-1;for(let i=0;i<8;i++){const s=new Date(`${n-i}-${e}`);t.push({date:s,text:(0,ze.A)(s)})}return t}(e)),[e]);return(0,ee.Y)("section",{className:"DateSuggest custom-scroll custom-scroll-x",children:i.map((({date:e,text:i})=>(0,ee.FD)("div",{onClick:()=>t(e),className:"date-item",children:[(0,ee.Y)(q.A,{name:"calendar"}),(0,ee.Y)("span",{children:i})]},i)))})})),xc=2*p.$,Ec=(0,s.ph)((0,n.EK)(((e,{chatId:t,topicId:i})=>({topic:(0,c.S0q)(e,t,i)})))((({topicId:e,topic:t,onClick:i})=>{const n=(0,s.hb)((()=>{i(e)}),[e,i]),a=Pc(n);if(t)return(0,ee.FD)(ci.A,{className:"chat-item-clickable search-result",onClick:n,buttonClassName:"topic-item",buttonRef:a,children:[(0,ee.Y)($s.A,{size:xc,topic:t,className:"topic-icon",letterClassName:"topic-icon-letter"}),(0,ee.Y)("div",{dir:"auto",className:"fullName",children:(0,Ft.A)(t.title)})]})}))),Vc=(0,ve.nF)((e=>e()),500,!0),_c=(0,s.ph)((0,n.EK)((e=>{const{byId:t}=e.chats,{currentUserId:i,messages:{byChatId:s}}=e,{fetchingStatus:n,resultsByType:a,foundTopicIds:o,chatId:r}=(0,c.nTw)(e).globalSearch,{foundIds:l}=a?.text||{};return{currentUserId:i,foundIds:l,globalMessagesByChatId:s,chatsById:t,fetchingStatus:n,foundTopicIds:o,searchChatId:r}}))((({searchQuery:e,dateSearchQuery:t,foundIds:i,globalMessagesByChatId:o,chatsById:r,fetchingStatus:l,foundTopicIds:c,searchChatId:d,onSearchDateSelect:h,onReset:m})=>{const{searchMessagesGlobal:u,openThread:p}=(0,n.ko)(),g=(0,M.A)(),{isMobile:A}=(0,I.Ay)(),b=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&Vc((()=>{u({type:"text"})}))}),[e]),f=(0,s.hb)((e=>{d&&(p({chatId:d,threadId:e,shouldReplaceHistory:!0}),A||m())}),[d,A,m]),C=(0,s.Kr)((()=>i&&0!==i.length?i.map((e=>{const[t,i]=(0,bc.a)(e);return o?.[t]?.byId[i]})).filter(Boolean).sort(((e,t)=>t.date-e.date)):Ci.p),[i,o]),y=l&&!l.chats&&!l.messages&&!C.length&&!c?.length;return(0,ee.Y)("div",{className:"LeftSearch--content",children:(0,ee.FD)(Ds.A,{className:"search-content custom-scroll chat-list",items:C,onLoadMore:b,noFastList:!0,children:[t&&(0,ee.Y)("div",{className:"chat-selection no-scrollbar",children:(0,ee.Y)(Lc,{searchDate:t,onSelect:h})}),y&&(0,ee.Y)(Sc.A,{text:g("ChatList.Search.NoResults"),description:g("ChatList.Search.NoResultsDescription")}),Boolean(c?.length)&&(0,ee.FD)("div",{className:"pb-2",children:[(0,ee.Y)("h3",{className:"section-heading topic-search-heading",dir:g.isRtl?"auto":void 0,children:g("Topics")}),c.map((e=>(0,ee.Y)(Ec,{chatId:d,topicId:e,onClick:f})))]}),Boolean(C.length)&&(0,ee.FD)("div",{className:"pb-2",children:[(0,ee.Y)("h3",{className:"section-heading topic-search-heading",dir:g.isRtl?"auto":void 0,children:g("SearchMessages")}),C.map((function(t){const i=(0,v.C)(g,t),s=r[t.chatId];if(i&&s)return(0,ee.Y)(Rc,{chatId:t.chatId,message:t,searchQuery:e})}))]})]})})})));var Uc=i(49763),Oc=i(81949);const Kc=(0,s.ph)((({sponsoredPeer:e,observeIntersection:t})=>{const i=(0,s.li)(),{clickSponsored:o,viewSponsored:r,openChat:l}=(0,n.ko)(),c=(0,_i.A)(),{peerId:d,randomId:h,additionalInfo:m,sponsorInfo:p}=e;(0,gr.mv)(i,t,(e=>{1===e.intersectionRatio&&r({randomId:h})}));const v=(0,D.A)((()=>{o({randomId:h}),l({id:d})})),{isContextMenuOpen:g,contextMenuAnchor:A,handleBeforeContextMenu:b,handleContextMenu:f,handleContextMenuClose:C,handleContextMenuHide:y}=(0,Fn.A)(i),{handleClick:S,handleMouseDown:w}=(0,hs.Q)((e=>{e.stopPropagation(),f(e)})),k=Pc(v);return(0,ee.FD)(ci.A,{ref:i,className:"chat-item-clickable search-result",onClick:v,onMouseDown:b,onContextMenu:f,buttonRef:k,children:[(0,u.L8)(d)?(0,ee.Y)(Rs.A,{userId:d,withUsername:!0,withStory:!0,avatarSize:"medium",storyViewerOrigin:a.G9.SearchResult}):(0,ee.Y)(Bs.A,{chatId:d,withUsername:!0,avatarSize:"medium",withStory:!0,storyViewerOrigin:a.G9.SearchResult}),(0,ee.FD)(Oc.A,{className:"search-sponsored-badge",onMouseDown:w,onClick:S,children:[c("SponsoredPeerBadge"),(0,ee.Y)(q.A,{name:"more"})]}),A&&(0,ee.Y)(Cl.A,{isOpen:g,anchor:A,triggerRef:i,randomId:h,additionalInfo:m,canReport:!0,sponsorInfo:p,onClose:C,onCloseAnimationEnd:y})]})})),Jc=(0,ve.nF)((e=>e()),6e4,!0),Gc=(0,s.ph)((0,n.EK)((e=>{const{userIds:t}=e.topPeers,i=e.users.byId,{recentlyFoundChatIds:s}=e;return{topUserIds:t,usersById:i,recentlyFoundChatIds:s}}))((({topUserIds:e,usersById:t,recentlyFoundChatIds:i,onReset:a})=>{const{loadTopUsers:o,openChat:r,addRecentlyFoundChatId:c,clearRecentlyFoundChats:d}=(0,n.ko)(),h=(0,s.li)();(0,s.vJ)((()=>{Jc((()=>{o()}))}),[o]),(0,Ln.A)(h,!e);const m=(0,s.hb)((e=>{r({id:e,shouldReplaceHistory:!0}),a(),setTimeout((()=>{c({id:e})}),250)}),[r,c,a]),u=(0,s.hb)((()=>{d()}),[d]),p=(0,M.A)();return(0,ee.FD)("div",{className:"RecentContacts custom-scroll",children:[e&&(0,ee.Y)("div",{className:"top-peers-section",dir:p.isRtl?"rtl":void 0,children:(0,ee.Y)("div",{ref:h,className:"top-peers",children:e.map((e=>(0,ee.FD)("div",{className:"top-peer-item",onClick:()=>m(e),dir:p.isRtl?"rtl":void 0,children:[(0,ee.Y)(Dt.A,{peer:t[e]}),(0,ee.Y)("div",{className:"top-peer-name",children:(0,Ft.A)((0,l.u0)(t[e])||"Â ")})]},e)))})}),i&&(0,ee.FD)("div",{className:"search-section pt-1",children:[(0,ee.FD)("h3",{className:(0,me.A)("section-heading mt-0 recent-chats-header",!e&&"without-border"),dir:p.isRtl?"rtl":void 0,children:[p("Recent"),(0,ee.Y)(W.A,{className:"clear-recent-chats",round:!0,size:"smaller",color:"translucent",ariaLabel:p("Clear"),onClick:u,isRtl:p.isRtl,children:(0,ee.Y)(q.A,{name:"close"})})]}),i.map((e=>(0,ee.Y)(Dc,{chatId:e,withOpenAppButton:!0,onClick:m})))]})]})}))),jc=(0,ve.nF)((e=>e()),500,!1),zc=(0,s.ph)((0,n.EK)(((e,{isChannelList:t})=>{const{userIds:i}=e.contactList||{},{currentUserId:s,messages:n}=e;if(!i)return{};const{fetchingStatus:a,globalResults:r,localResults:l,resultsByType:d,sponsoredPeer:h}=(0,c.nTw)(e).globalSearch,{peerIds:m}=r||{},{peerIds:u}=l||{},{byChatId:p}=n,v=d?.[t?"channels":"text"]?.foundIds,{similarChannelIds:g}=(0,c.dg4)(e,o.rBM)||{};return{currentUserId:s,contactIds:i,accountPeerIds:u,globalPeerIds:m,foundIds:v,globalMessagesByChatId:p,fetchingStatus:a,sponsoredPeer:h,suggestedChannelIds:g}}))((({isChannelList:e,searchQuery:t,searchDate:i,dateSearchQuery:r,currentUserId:c,contactIds:d,accountPeerIds:h,globalPeerIds:m,foundIds:u,globalMessagesByChatId:p,fetchingStatus:g,suggestedChannelIds:A,sponsoredPeer:b,onReset:f,onSearchDateSelect:C})=>{const{openChat:y,addRecentlyFoundChatId:S,searchMessagesGlobal:w,setGlobalSearchChatId:k,loadChannelRecommendations:N}=(0,n.ko)(),P=(0,s.li)(),Y=(0,s.li)(),F=(0,M.A)(),T=(0,_i.A)(),{isMobile:B}=(0,I.Ay)(),[R,L]=(0,s.J0)(!1),[x,E]=(0,s.J0)(!1),[V,_]=(0,s.J0)("all"),U=(0,s.li)();(0,Ce.A)((()=>{e&&N({})}));const O=(0,s.hb)((({direction:t})=>{t===a.TN.Backwards&&jc((()=>{w({type:e?"channels":"text",context:V})}))}),[t,V]),K=(0,s.hb)((e=>{y({id:e,shouldReplaceHistory:!0}),e!==c&&S({id:e}),B||f()}),[y,c,B,S,f]),J=(0,s.hb)((e=>{k({id:e})}),[k]);function G(e){return T("users"===e?"PrivateChatsSearchContext":"groups"===e?"GroupChatsSearchContext":"channels"===e?"ChannelsSearchContext":"AllChatsSearchContext")}const{isContextMenuOpen:j,contextMenuAnchor:z,handleContextMenu:H,handleContextMenuClose:$,handleContextMenuHide:W}=(0,Fn.A)(U),Q=(0,D.A)((()=>U.current)),Z=(0,D.A)((()=>U.current.querySelector(".chatResultsContextMenu .bubble"))),X=(0,D.A)((()=>U.current.querySelector(".menuTrigger"))),te=(0,D.A)((e=>{H(e)})),ie=(0,me.A)("icon","iconPlaceholder"),ne=(0,s.Kr)((()=>{if(!e&&(!t||t.startsWith("@")&&t.length<2))return Ci.p;const i=(0,n.mS)().chats.byId,s=((0,Uc.YA)(o.DSF)??[]).filter((t=>{if(!e)return!0;const s=i[t];return s&&(0,l.WX)(s)})),a=(0,Yt.PU)({ids:s,query:t,type:"chat"});if(e)return a;const r=[...c?[c]:[],...d||[]],m=[...(0,Yt.PU)({ids:r,query:t,type:"user"}),...a];return(0,fi.Am)([...(0,Os.A)(m,void 0,c?[c]:void 0),...(0,Os.A)(h||[])])}),[t,c,d,h,e]);(0,Ln.A)(Y,!ne.length||e,!0);const ae=(0,s.Kr)((()=>{if(!t||t.length<4||!m)return Ci.p;const i=(0,n.mS)().chats.byId,s=m.filter((t=>{if(!e)return!0;const s=i[t];return s&&(0,l.WX)(s)}));return(0,Os.A)(s,!0)}),[m,e,t]),oe=(0,s.Kr)((()=>{if(!t&&!i||!u||0===u.length)return Ci.p;const s=(0,n.mS)().chats.byId;return u.map((t=>{const[i,n]=(0,bc.a)(t),a=s[i];if(a&&(!e||(0,l.WX)(a)))return p?.[i]?.byId[n]})).filter(Boolean)}),[t,i,u,e,p]);(0,s.vJ)((()=>{t&&w({type:e?"channels":"text",context:V,shouldResetResultsByType:!0,shouldCheckFetchingMessagesStatus:!0})}),[V]);const re=(0,s.hb)((()=>{L(!R)}),[R]),le=(0,s.hb)((()=>{E(!x)}),[x]),de=oe,he="all"===V&&g&&!g.chats&&!g.messages&&!ne.length&&!ae.length&&!de.length,ue=g?.messages,pe=!t&&!i&&!e,{observe:ve}=(0,gr.BL)({rootRef:P,throttleMs:200,isDisabled:!pe});if(pe)return(0,ee.Y)(Gc,{onReset:f});const ge="all"!==V||Boolean(de.length);return(0,ee.FD)(Ds.A,{ref:P,className:"LeftSearch--content custom-scroll",items:de,onLoadMore:O,noScrollRestoreOnTop:!0,noFastList:!0,children:[r&&(0,ee.Y)("div",{className:"chat-selection no-scrollbar",children:(0,ee.Y)(Lc,{searchDate:r,onSelect:C})}),he&&(0,ee.Y)(Sc.A,{text:F("ChatList.Search.NoResults"),description:F("ChatList.Search.NoResultsDescription")}),Boolean(ne.length)&&!e&&(0,ee.Y)("div",{className:"chat-selection no-scrollbar",dir:F.isRtl?"rtl":void 0,ref:Y,children:ne.map((e=>(0,ee.Y)(qr.A,{peerId:e,className:"left-search-local-suggestion",onClick:J,clickArg:e})))}),Boolean(ne.length)&&(0,ee.FD)("div",{className:"search-section",children:[(0,ee.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[ne.length>5&&(0,ee.Y)(Eo.A,{className:"Link",onClick:re,children:F(R?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")}),F(e?"SearchMyChannels":"DialogList.SearchSectionDialogs")]}),ne.map(((e,t)=>{if(R||!(t>=5))return(0,ee.Y)(Dc,{withOpenAppButton:!0,chatId:e,onClick:K})}))]}),Boolean(ae.length)&&(0,ee.FD)("div",{className:"search-section",children:[(0,ee.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[ae.length>5&&(0,ee.Y)(Eo.A,{className:"Link",onClick:le,children:F(x?"ChatList.Search.ShowLess":"ChatList.Search.ShowMore")}),F("DialogList.SearchSectionGlobal")]}),b&&(0,ee.Y)(Kc,{sponsoredPeer:b,observeIntersection:ve}),ae.map(((e,t)=>{if(x||!(t>=5))return(0,ee.Y)(Dc,{chatId:e,withUsername:!0,onClick:K})}))]}),Boolean(A?.length)&&!t&&(0,ee.FD)("div",{className:"search-section",children:[(0,ee.Y)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:F("SearchRecommendedChannels")}),A.map((e=>(0,ee.Y)(Dc,{chatId:e,withUsername:!0,onClick:K})))]}),(0,ee.FD)("div",{className:"menuOwner",ref:U,children:[(0,ee.Y)($e.A,{isOpen:j,anchor:z,getTriggerElement:X,getRootElement:Q,getMenuElement:Z,className:"chatResultsContextMenu",onClose:$,onCloseAnimationEnd:W,autoClose:!0,children:(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(ce.A,{icon:"all"===V?"check":void 0,customIcon:"all"!==V?(0,ee.Y)("i",{className:ie}):void 0,onClick:()=>_("all"),children:G("all")}),(0,ee.Y)(ce.A,{icon:"users"===V?"check":void 0,customIcon:"users"!==V?(0,ee.Y)("i",{className:ie}):void 0,onClick:()=>_("users"),children:G("users")}),(0,ee.Y)(ce.A,{icon:"groups"===V?"check":void 0,customIcon:"groups"!==V?(0,ee.Y)("i",{className:ie}):void 0,onClick:()=>_("groups"),children:G("groups")}),(0,ee.Y)(ce.A,{icon:"channels"===V?"check":void 0,customIcon:"channels"!==V?(0,ee.Y)("i",{className:ie}):void 0,onClick:()=>_("channels"),children:G("channels")})]})}),ge&&(0,ee.FD)("div",{className:"search-section",children:[(0,ee.FD)("h3",{className:"section-heading",dir:F.isRtl?"auto":void 0,children:[!e&&(0,ee.FD)(Eo.A,{className:"Link menuTrigger dropDownLink",onClick:te,children:[T("SearchContextCaption",{type:G(V)},{withNodes:!0}),(0,ee.FD)(se.Ay,{name:"fade",shouldCleanup:!0,activeKey:Number(ue),className:"iconContainer",slideClassName:"iconContainerSlide",children:[ue&&(0,ee.Y)(zs.A,{}),!ue&&(0,ee.Y)(q.A,{name:"down"})]})]}),F("SearchMessages")]}),de.map((function(e){const i=(0,n.mS)().chats.byId,s=(0,v.C)(F,e),a=i[e.chatId];if(s&&a)return(0,ee.Y)(Rc,{chatId:e.chatId,message:e,searchQuery:t})}))]})]})]})})));var Hc=i(44589);const $c="documents",qc=(0,ve.nF)((e=>e()),500,!0),Wc=(0,s.ph)((0,n.EK)(fc($c))((({searchQuery:e,isLoading:t,chatsById:i,usersById:r,globalMessagesByChatId:c,foundIds:d,activeDownloads:h,shouldWarnAboutSvg:m})=>{const{searchMessagesGlobal:u,focusMessage:p}=(0,n.ko)(),v=(0,s.li)(),g=(0,M.A)(),{observe:A}=(0,gr.BL)({rootRef:v,throttleMs:500}),b=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&qc((()=>{u({type:$c})}))}),[e]),f=(0,s.Kr)((()=>d&&c?d.map((e=>{const[t,i]=(0,bc.a)(e),s=c[t]?.byId[i];return s&&(0,l.zC)(s)?s:void 0})).filter(Boolean):Ci.p),[c,d]),C=(0,s.hb)((e=>{p({chatId:e.chatId,messageId:e.id})}),[p]),y=(0,pr.A)([e],o.jhd)&&!t;return(0,ee.Y)("div",{ref:v,className:"LeftSearch--content",children:(0,ee.FD)(Ds.A,{className:"search-content documents-list custom-scroll",items:y?f:void 0,onLoadMore:b,noFastList:!0,children:[!y&&(0,ee.Y)(zs.A,{}),y&&(!d||0===d.length)&&(0,ee.Y)(Sc.A,{text:g("ChatList.Search.NoResults"),description:g("ChatList.Search.NoResultsDescription")}),y&&d&&d.length>0&&f.map(((e,t)=>{const s=0===t||(0,ze.$$)(e.date)!==(0,ze.$$)(f[t-1].date);return(0,ee.FD)(ee.FK,{children:[s&&(0,ee.Y)("p",{className:"section-heading",dir:g.isRtl?"rtl":void 0,children:(0,ze.i6)(g,new Date(1e3*e.date))},e.date),(0,ee.Y)("div",{className:"ListItem small-icon",children:(0,ee.Y)(Hc.A,{document:(0,l.zC)(e),message:e,withDate:!0,datetime:e.date,smaller:!0,sender:(0,Cc.N)(g,e,i,r),className:"scroll-item",isDownloading:(0,l.$r)(h,e.content.document),shouldWarnAboutSvg:m,observeIntersection:A,onDateClick:C})},e.id)]})}))]})})})));var Qc=i(37378);const Zc="links",Xc=(0,ve.nF)((e=>e()),500,!0),ed=(0,s.ph)((0,n.EK)(fc(Zc))((({searchQuery:e,isLoading:t,chatsById:i,usersById:r,globalMessagesByChatId:l,foundIds:c,isChatProtected:d})=>{const{searchMessagesGlobal:h,focusMessage:m}=(0,n.ko)(),u=(0,s.li)(),p=(0,M.A)(),{observe:v}=(0,gr.BL)({rootRef:u,throttleMs:500}),g=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&Xc((()=>{h({type:Zc})}))}),[e]),A=(0,s.Kr)((()=>c&&l?c.map((e=>{const[t,i]=(0,bc.a)(e);return l[t]?.byId[i]})).filter(Boolean):Ci.p),[l,c]),b=(0,s.hb)((e=>{m({chatId:e.chatId,messageId:e.id})}),[m]),f=(0,pr.A)([e],o.jhd)&&!t;return(0,ee.Y)("div",{ref:u,className:"LeftSearch--content",children:(0,ee.FD)(Ds.A,{className:"search-content documents-list custom-scroll",items:f?A:void 0,onLoadMore:g,noFastList:!0,children:[!f&&(0,ee.Y)(zs.A,{}),f&&(!c||0===c.length)&&(0,ee.Y)(Sc.A,{text:p("ChatList.Search.NoResults"),description:p("ChatList.Search.NoResultsDescription")}),f&&c&&c.length>0&&A.map(((e,t)=>{const s=0===t||(0,ze.$$)(e.date)!==(0,ze.$$)(A[t-1].date);return(0,ee.FD)(ee.FK,{children:[s&&(0,ee.Y)("p",{className:"section-heading",dir:p.isRtl?"rtl":void 0,children:(0,ze.i6)(p,new Date(1e3*e.date))},e.date),(0,ee.Y)("div",{className:"ListItem small-icon",dir:p.isRtl?"rtl":void 0,children:(0,ee.Y)(Qc.A,{message:e,senderTitle:(0,Cc.N)(p,e,i,r),isProtected:d||e.isProtected,observeIntersection:v,onMessageClick:b},e.id)},e.id)]})}))]})})})));var td=i(81524);const id="media",sd=(0,ve.nF)((e=>e()),500,!0),nd=(0,s.ph)((0,n.EK)(fc(id))((({searchQuery:e,isLoading:t,globalMessagesByChatId:i,foundIds:r,isChatProtected:l})=>{const{searchMessagesGlobal:c,openMediaViewer:d}=(0,n.ko)(),h=(0,s.li)(),m=(0,M.A)(),{observe:u}=(0,gr.BL)({rootRef:h,throttleMs:500}),p=(0,s.hb)((({direction:e})=>{e===a.TN.Backwards&&sd((()=>{c({type:id})}))}),[c,e]),v=(0,s.Kr)((()=>r&&i?r.map((e=>{const[t,s]=(0,bc.a)(e);return i[t]?.byId[s]})).filter(Boolean):Ci.p),[i,r]),g=(0,s.hb)(((e,t)=>{d({chatId:t,messageId:e,origin:a.TQ.SearchResult})}),[d]),A=(0,pr.A)([e],o.jhd)&&!t,b=A&&r&&r.length>0&&!e,f=A&&r&&r.length>0&&e,C=(0,me.A)("search-content custom-scroll",f&&"chat-list");return(0,ee.Y)("div",{ref:h,className:"LeftSearch--content LeftSearch--media",children:(0,ee.FD)(Ds.A,{className:C,items:A?v:void 0,itemSelector:e?".ListItem":".Media",onLoadMore:p,noFastList:!0,children:[!A&&(0,ee.Y)(zs.A,{}),A&&(!r||0===r.length)&&(0,ee.Y)(Sc.A,{text:m("ChatList.Search.NoResults"),description:m("ChatList.Search.NoResultsDescription")}),b&&(0,ee.Y)("div",{className:"media-list",dir:m.isRtl?"rtl":void 0,children:v.map((e=>(0,ee.Y)(td.A,{idPrefix:"search-media",message:e,isProtected:l||e.isProtected,observeIntersection:u,onClick:g},`${e.chatId}-${e.id}`)))}),f&&v.map((e=>(0,ee.Y)(Rc,{chatId:e.chatId,message:e},e.id)))]})})}))),ad=[{type:a.$C.ChatList,key:"SearchTabChats"},{type:a.$C.ChannelList,key:"SearchTabChannels"},{type:a.$C.BotApps,key:"SearchTabApps"},{type:a.$C.Media,key:"SearchTabMedia"},{type:a.$C.Links,key:"SearchTabLinks"},{type:a.$C.Files,key:"SearchTabFiles"},{type:a.$C.Music,key:"SearchTabMusic"},{type:a.$C.Voice,key:"SearchTabVoice"}],od=[{type:a.$C.ChatList,key:"SearchTabMessages"},...ad.slice(3)],rd=(0,s.ph)((0,n.EK)((e=>{const{currentContent:t,chatId:i}=(0,c.nTw)(e).globalSearch;return{currentContent:t,chatId:i}}))((({searchQuery:e,searchDate:t,isActive:i,currentContent:o=a.$C.ChatList,chatId:r,onReset:l})=>{const{setGlobalSearchContent:c,setGlobalSearchDate:d}=(0,n.ko)(),h=(0,_i.A)(),[m,u]=(0,s.J0)(o),p=(0,s.Kr)((()=>(0,ze.Rm)(e)),[e]),v=(0,s.Kr)((()=>(r?od:ad).map((e=>({...e,title:h(e.key)})))),[r,h]),g=(0,D.A)((e=>{const t=v[e];c({content:t.type}),u(e)})),A=(0,D.A)((e=>{d({date:e.getTime()/1e3})}));(0,fe.A)({isActive:i,onBack:l});const b=(0,s.li)(),f=(0,js.A)(b,i,void 0,".ListItem-button",!0);return(0,ee.FD)("div",{className:"LeftSearch",ref:b,onKeyDown:f,children:[(0,ee.Y)(Ac.A,{activeTab:m,tabs:v,onSwitchTab:g}),(0,ee.Y)(se.Ay,{name:h.isRtl?"slideOptimizedRtl":"slideOptimized",renderCount:v.length,activeKey:o,children:(()=>{switch(o){case a.$C.ChatList:case a.$C.ChannelList:return r?(0,ee.Y)(_c,{searchQuery:e,dateSearchQuery:p,onReset:l,onSearchDateSelect:A}):(0,ee.Y)(zc,{isChannelList:o===a.$C.ChannelList,searchQuery:e,searchDate:t,dateSearchQuery:p,onReset:l,onSearchDateSelect:A});case a.$C.Media:return(0,ee.Y)(nd,{searchQuery:e});case a.$C.Links:return(0,ee.Y)(ed,{searchQuery:e});case a.$C.Files:return(0,ee.Y)(Wc,{searchQuery:e});case a.$C.Music:return(0,ee.Y)(kc,{searchQuery:e},"audio");case a.$C.Voice:return(0,ee.Y)(kc,{isVoice:!0,searchQuery:e},"voice");case a.$C.BotApps:return(0,ee.Y)(Tc,{searchQuery:e},"botApps");default:return}})()})]})})));var ld=i(42215);const cd={currentPassword:"",password:"",hint:"",email:""},dd=(e,t)=>{switch(t.type){case"setCurrentPassword":return{...e,currentPassword:t.payload};case"setPassword":return{...e,password:t.payload};case"setHint":return{...e,hint:t.payload};case"setEmail":return{...e,email:t.payload};case"reset":return cd;default:return e}};var hd=i(79307),md=i(31880),ud=i(58968),pd=i(74984);const vd=(0,s.ph)((0,n.EK)((e=>({maxChats:(0,ya.d)(e,"dialogFiltersChats")})))((({mode:e,state:t,dispatch:i,isActive:a,onReset:r,onSaveFilter:l,maxChats:c})=>{const d=(0,M.A)(),{openLimitReachedModal:h}=(0,n.ko)(),{chatFilter:m}=t,{selectedChatIds:u,selectedChatTypes:p}=(0,s.Kr)((()=>(0,md.a)(t,e,!0)),[e,t]),v="included"===e?ud.V2:ud.LS,[g,A]=(0,s.J0)(!1),b=(0,pd.Rh)(o.DSF),f=(0,pd.Rh)(o._E9),C=t.folder.isChatList;(0,s.vJ)((()=>{a||A(!1)}),[a]);const y=(0,s.Kr)((()=>{const e=[...b||[],...f||[]];return(0,fi.Am)([...(0,Yt.PU)({ids:e,query:m,type:"chat"})])}),[b,f,m]),S=(0,D.A)((e=>{i({type:"setChatFilter",payload:e}),A(!0)})),w=(0,D.A)((s=>{if("included"===e){if(s.length>=c)return void h({limit:"dialogFiltersChats"});i({type:"setIncludeFilters",payload:{...t.includeFilters,includedChatIds:s}})}else i({type:"setExcludeFilters",payload:{...t.excludeFilters,excludedChatIds:s}});A(!0)})),k=(0,D.A)((t=>{const s={};t.forEach((e=>{s[e]=!0})),i("included"===e?{type:"setIncludeFilters",payload:{includedChatIds:u,...s}}:{type:"setExcludeFilters",payload:{excludedChatIds:u,...s}}),A(!0)}));return(0,fe.A)({isActive:a,onBack:r}),y?(0,ee.FD)("div",{className:"Picker settings-folders-chat-list",children:[(0,ee.Y)(yi.A,{categories:C?void 0:v,itemIds:y,selectedIds:u,selectedCategories:p,filterValue:m,filterPlaceholder:d("Search"),categoryPlaceholderKey:"FilterChatTypes",searchInputId:"new-group-picker-search",isSearchable:!0,withDefaultPadding:!0,withPeerTypes:!0,allowMultiple:!0,itemInputType:"checkbox",onSelectedIdsChange:w,onSelectedCategoriesChange:k,onFilterChange:S}),(0,ee.Y)(ki.A,{isShown:g,onClick:l,ariaLabel:d("Save"),children:(0,ee.Y)(q.A,{name:"check"})})]}):(0,ee.Y)(zs.A,{})}))),gd="Please provide a title for this folder.",Ad="ChatList.Filter.Error.Empty",bd=(0,s.ph)((0,n.EK)(((e,{state:t})=>{const{listIds:i}=e.chats,{byId:s,invites:n}=e.chatFolders,a=Object.values(s).reduce(((e,t)=>e+(t.isChatList?1:0)),0);return{loadedActiveChatIds:i.active,loadedArchivedChatIds:i.archived,invites:t.folderId?n[t.folderId]||Ci.p:void 0,isRemoved:void 0!==t.folderId&&!s[t.folderId],maxInviteLinks:(0,ya.d)(e,"chatlistInvites"),maxChatLists:(0,ya.d)(e,"chatlistJoined"),chatListCount:a}}))((({state:e,dispatch:t,onAddIncludedChats:i,onAddExcludedChats:a,onShareFolder:r,onOpenInvite:l,isActive:d,onReset:h,isRemoved:m,onBack:p,loadedActiveChatIds:v,isOnlyInvites:g,loadedArchivedChatIds:A,invites:b,maxInviteLinks:f,maxChatLists:C,chatListCount:y,onSaveFolder:S})=>{const{loadChatlistInvites:w,openLimitReachedModal:k,showNotification:N}=(0,n.ko)(),I="create"===e.mode,P=e.folder.isChatList,[Y,F]=(0,s.J0)(!1),[D,T]=(0,s.J0)(!1);(0,s.vJ)((()=>{m&&h()}),[m,h]),(0,s.vJ)((()=>{d&&e.folderId&&e.folder.isChatList&&w({folderId:e.folderId})}),[d,e.folder.isChatList,e.folderId]);const{selectedChatIds:B,selectedChatTypes:R}=(0,s.Kr)((()=>(0,md.a)(e,"included")),[e]),{selectedChatIds:L,selectedChatTypes:x}=(0,s.Kr)((()=>(0,md.a)(e,"excluded")),[e]);(0,s.vJ)((()=>{F(!1),T(!1)}),[e.folderId]);const[E,V]=(0,s.Kr)((()=>{const e=new Set([...v||[],...A||[]]),t=(0,fi.$h)(B,e),i=(0,fi.$h)(L,e);return[Y?t:t.slice(0,5-R.length),D?i:i.slice(0,5-x.length)]}),[L,B,R,x,D,Y,v,A]),_=(0,M.A)();(0,fe.A)({isActive:d,onBack:p});const U=(0,s.hb)((e=>{const{currentTarget:i}=e;t({type:"setTitle",payload:i.value.trim()})}),[t]),O=(0,s.hb)((()=>{t({type:"setIsLoading",payload:!0}),S((()=>{setTimeout((()=>{h()}),500)}))}),[t,S,h]),K=(0,s.hb)((()=>{b?(0,c.w5O)((0,n.mS)(),e.folderId)?y>=C&&!e.folder.isChatList?k({limit:"chatlistJoined"}):b.length<f?e.isTouched?S(r):r():k({limit:"chatlistInvites"}):N({message:_("ChatList.Filter.InviteLink.IncludeExcludeError")}):I&&S(r)}),[b,e.folderId,e.isTouched,y,f,I,S,r,_,C,e.folder.isChatList]),J=(0,s.hb)(((t,i)=>{e.isTouched?S((()=>l(i))):l(i)}),[S,l,e.isTouched]);function G(e){const t="included"===e?R:x,i="included"===e?E:V,s="included"===e?Y:D,n=("included"===e?B:L).length-i.length,a="included"===e?()=>F(!0):()=>T(!0);return(0,ee.FD)(ee.FK,{children:[t.map((t=>function(e,t){const i="included"===t?ud.V2.find((({type:t})=>t===e)):ud.LS.find((({type:t})=>t===e));if(i)return(0,ee.Y)(ci.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0,children:(0,ee.Y)(Rs.A,{avatarSize:"small",customPeer:i})},i.type)}(t,e))),i.map((e=>(0,ee.Y)(ci.A,{className:"settings-folders-list-item mb-1",narrow:!0,inactive:!0,children:(0,u.L8)(e)?(0,ee.Y)(Rs.A,{avatarSize:"small",userId:e}):(0,ee.Y)(Bs.A,{avatarSize:"small",chatId:e})}))),!s&&n>0&&(0,ee.Y)(ci.A,{className:"settings-folders-list-item",narrow:!0,onClick:a,icon:"down",children:_("FilterShowMoreChats",n,"i")},"load-more")]})}return(0,ee.FD)("div",{className:"settings-fab-wrapper",children:[(0,ee.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header",children:[(0,ee.Y)(Tr.A,{size:o.fwn,tgsUrl:Mr.w.FoldersNew,play:String(e.folderId),className:"settings-content-icon"}),I&&(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:_.isRtl?"rtl":void 0,children:_("FilterIncludeInfo")}),(0,ee.Y)(Q.A,{className:"mb-0",label:_("FilterNameHint"),value:e.folder.title.text,onChange:U,error:e.error&&e.error===gd?gd:void 0})]}),!g&&(0,ee.FD)("div",{className:"settings-item",children:[e.error&&e.error===Ad&&(0,ee.Y)("p",{className:"settings-item-description color-danger mb-2",dir:_.isRtl?"rtl":void 0,children:_(e.error)}),(0,ee.Y)("h4",{className:"settings-item-header mb-3",dir:_.isRtl?"rtl":void 0,children:_("FilterInclude")}),(0,ee.Y)(ci.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:i,children:_("FilterAddChats")}),G("included")]}),!g&&!P&&(0,ee.FD)("div",{className:"settings-item pt-3",children:[(0,ee.Y)("h4",{className:"settings-item-header mb-3",dir:_.isRtl?"rtl":void 0,children:_("FilterExclude")}),(0,ee.Y)(ci.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:a,children:_("FilterAddChats")}),G("excluded")]}),(0,ee.FD)("div",{className:"settings-item pt-3",children:[(0,ee.Y)("h4",{className:"settings-item-header mb-3",dir:_.isRtl?"rtl":void 0,children:_("FolderLinkScreen.Title")}),(0,ee.Y)(ci.A,{className:"settings-folders-list-item color-primary",icon:"add",narrow:!0,onClick:K,children:_("ChatListFilter.CreateLinkNew")}),b?.map((e=>(0,ee.FD)(ci.A,{className:"settings-folders-list-item",icon:"link",narrow:!0,multiline:!0,onClick:J,clickArg:e.url,children:[(0,ee.Y)("span",{className:"title",dir:"auto",children:e.title||e.url}),(0,ee.Y)("span",{className:"subtitle",children:_("ChatListFilter.LinkLabelChatCount",e.peerIds.length,"i")})]})))]})]}),(0,ee.Y)(ki.A,{isShown:Boolean(e.isTouched),disabled:e.isLoading,onClick:O,ariaLabel:"edit"===e.mode?"Save changes":"Create folder",children:e.isLoading?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})})));var fd=i(80401);const Cd=(0,ve.nF)((e=>e()),6e4,!0),yd=(0,s.ph)((0,n.EK)((e=>{const{orderedIds:t,byId:i,recommended:s}=e.chatFolders;return{folderIds:t,foldersById:i,isPremium:(0,c.g29)(e),recommendedChatFolders:s,maxFolders:(0,ya.d)(e,"dialogFilters")}}))((({isActive:e,onCreateFolder:t,onEditFolder:i,onReset:a,folderIds:r,foldersById:c,isPremium:d,recommendedChatFolders:h,maxFolders:m})=>{const{loadRecommendedChatFolders:u,addChatFolder:p,openLimitReachedModal:v,openDeleteChatFolderModal:g,sortChatFolders:A}=(0,n.ko)(),[b,f]=(0,s.J0)({orderedFolderIds:r,dragOrderIds:r,draggedIndex:void 0}),C=(0,V.A)(r);(0,s.vJ)((()=>{C!==r&&f({orderedFolderIds:r,dragOrderIds:r,draggedIndex:void 0})}),[C,r,b.orderedFolderIds?.length]),(0,s.vJ)((()=>{Cd((()=>{u()}))}),[u]);const y=(0,s.hb)((()=>{Object.keys(c).length>=m-1?v({limit:"dialogFilters"}):t()}),[c,m,t,v]),S=(0,M.A)();(0,fe.A)({isActive:e,onBack:a});const w=(0,pd.g5)(),k=(0,s.Kr)((()=>{if(r)return r.length<=1?Ci.p:r.map((e=>{const t=c[e];return e===o.DSF?{id:e,title:{text:S("FilterAllChats"),entities:[]}}:{id:t.id,title:t.title,subtitle:(0,l.A5)(S,t,w[t.id]),isChatList:t.isChatList,noTitleAnimations:t.noTitleAnimations}}))}),[r,c,S,w]),N=(0,s.hb)((e=>{Object.keys(c).length>=m-1?v({limit:"dialogFilters"}):p({folder:e})}),[c,m,p,v]),I=(0,s.hb)(((e,t)=>{const i=Math.round(e.y/56),s=b.orderedFolderIds?.indexOf(t)||0,n=b.orderedFolderIds?.filter((e=>e!==t));n&&(0,pe.Bt)(s+i,0,r?.length||0)&&(n.splice(s+i+(d?0:1),0,t),f((e=>({...e,draggedIndex:s,dragOrderIds:n}))))}),[r?.length,d,b.orderedFolderIds]),P=(0,s.hb)((()=>{f((e=>(A({folderIds:e.dragOrderIds}),{...e,orderedFolderIds:e.dragOrderIds,draggedIndex:void 0})))}),[A]),Y=(0,s.Kr)((()=>!d||Object.keys(c).length<m-1),[c,d,m]);return(0,ee.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header",children:[(0,ee.Y)(Tr.A,{size:o.fwn,tgsUrl:Mr.w.FoldersAll,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:S("CreateNewFilterInfo")}),Y&&(0,ee.FD)(W.A,{className:"settings-button with-icon",color:"primary",size:"smaller",pill:!0,fluid:!0,onClick:y,isRtl:S.isRtl,children:[(0,ee.Y)(q.A,{name:"add"}),S("CreateNewFilter")]})]}),(0,ee.FD)("div",{className:"settings-item pt-3",children:[(0,ee.Y)("h4",{className:"settings-item-header mb-3",dir:S.isRtl?"rtl":void 0,children:S("Filters")}),(0,ee.Y)("div",{className:"settings-sortable-container",style:`height: ${56*(r?.length||0)}px`,children:k?.length?k.map(((t,s)=>{const n=s>m-1,a=b.draggedIndex===s,r=56*(b.orderedFolderIds?.indexOf(t.id)??0),l=56*(b.dragOrderIds?.indexOf(t.id)??0);return t.id===o.DSF?(0,ee.Y)(fd.A,{id:t.id,onDrag:I,onDragEnd:P,style:`top: ${a?r:l}px;`,knobStyle:(S.isRtl?"left":"right")+": 0.375rem;",isDisabled:!d||!e,children:(0,ee.FD)(ci.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,inactive:!0,multiline:!0,isStatic:!0,allowSelection:!0,children:[(0,ee.Y)("span",{className:"title",children:(0,ds.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations})}),(0,ee.Y)("span",{className:"subtitle",children:S("FoldersAllChatsDesc")})]},t.id)},t.id):(0,ee.Y)(fd.A,{id:t.id,onDrag:I,onDragEnd:P,style:`top: ${a?r:l}px;`,knobStyle:(S.isRtl?"left":"right")+": 3rem;",isDisabled:n||!e,children:(0,ee.FD)(ci.A,{className:"drag-item no-icon settings-sortable-item",narrow:!0,secondaryIcon:"more",multiline:!0,contextActions:[{handler:()=>{g({folderId:t.id})},destructive:!0,title:S("Delete"),icon:"delete"}],onClick:()=>{n?v({limit:"dialogFilters"}):i(c[t.id])},children:[(0,ee.FD)("span",{className:"title",children:[(0,ds.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}),n&&(0,ee.Y)(q.A,{name:"lock-badge",className:"settings-folders-blocked-icon"})]}),(0,ee.FD)("span",{className:"subtitle",children:[t.isChatList&&(0,ee.Y)(q.A,{name:"link",className:"mr-1"}),t.subtitle]})]})},t.id)})):k&&!k.length?(0,ee.Y)("p",{className:"settings-item-description my-4",dir:"auto",children:"You have no folders yet."}):(0,ee.Y)(zs.A,{})})]}),h&&Boolean(h.length)&&(0,ee.FD)("div",{className:"settings-item pt-3",children:[(0,ee.Y)("h4",{className:"settings-item-header mb-3",dir:S.isRtl?"rtl":void 0,children:S("FilterRecommended")}),h.map((e=>(0,ee.Y)(ci.A,{narrow:!0,onClick:()=>N(e),children:(0,ee.FD)("div",{className:"settings-folders-recommended-item",children:[(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:(0,ds.fd)({text:e.title.text,entities:e.title.entities,noCustomEmojiPlayback:e.noTitleAnimations})}),(0,ee.Y)("span",{className:"subtitle",children:e.description})]}),(0,ee.Y)(W.A,{className:"px-3",color:"primary",size:"tiny",pill:!0,fluid:!0,isRtl:S.isRtl,children:S("Add")})]})})))]})]})})));var Sd=i(4438);const wd=(0,s.ph)((0,n.EK)((e=>{const{folderId:t,url:i,isLoading:s}=(0,c.nTw)(e).shareFolderScreen||{},n=t?(0,c.$aQ)(e,t):void 0,a=t?e.chatFolders.invites[t]?.find((e=>e.url===i)):void 0;return{folderId:t,folder:n,url:i,isLoading:s,peerIds:a?.peerIds}}))((({isActive:e,onReset:t,folderId:i,folder:a,peerIds:r,url:d,isLoading:h})=>{const{createChatlistInvite:m,deleteChatlistInvite:u,editChatlistInvite:p,showNotification:v}=(0,n.ko)(),g=(0,_i.A)(),A=(0,M.A)(),[b,f]=(0,s.J0)(!1);(0,fe.A)({isActive:e,onBack:t}),(0,s.vJ)((()=>{h||f(!1)}),[h]),(0,s.vJ)((()=>{!d&&i&&e&&m({folderId:i})}),[i,e,d]);const C=(0,D.A)((()=>{d&&i&&(u({folderId:i,url:d}),t())})),y=(0,s.Kr)((()=>(a?.includedChatIds||[]).concat(a?.pinnedChatIds||[])),[a?.includedChatIds,a?.pinnedChatIds]),[S,w]=(0,s.Kr)((()=>{const e=(0,n.mS)();return(0,fi.jB)(y,(t=>(0,c.hXb)(e,t)))}),[y]),[k,N]=(0,s.J0)(r||[]),I=(0,s.li)(!0);(0,wi.A)((([e])=>{e!==d&&(I.current=!0),I.current&&(I.current=!1,d?r&&N(r):N(S))}),[d,S,r]);const P=(0,D.A)((e=>{const t=(0,n.mS)(),i=(0,c.mBe)(t,e),s=(0,c.hds)(t,e);i&&(0,l.tv)(i)?v({message:A("FolderLinkScreen.AlertTextUnavailableBot")}):i?v({message:A("FolderLinkScreen.AlertTextUnavailableUser")}):s&&(0,l.WX)(s)?v({message:A("FolderLinkScreen.AlertTextUnavailablePublicChannel")}):v({message:A("FolderLinkScreen.AlertTextUnavailablePublicGroup")})})),Y=(0,D.A)((e=>{N(e),f(!0)})),F=(0,D.A)((()=>{i&&d&&b&&p({folderId:i,peerIds:k,url:d})})),T=k.length,B=!T||h;return(0,ee.FD)("div",{className:"settings-content no-border custom-scroll SettingsFoldersChatsPicker",children:[(0,ee.FD)("div",{className:"settings-content-header",children:[(0,ee.Y)(Sd.A,{size:o.fwn,tgsUrl:Mr.w.FoldersShare,className:"settings-content-icon"}),a&&(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:g("FolderLinkTitleDescription",{folder:(0,ds.fd)({text:a.title.text,entities:a.title.entities,noCustomEmojiPlayback:a.noTitleAnimations}),chats:g("FolderLinkTitleDescriptionChats",{count:T},{pluralValue:T})},{withMarkdown:!0,withNodes:!0})})]}),(0,ee.Y)(sl.A,{className:"settings-item",link:d||A("Loading"),withShare:!0,onRevoke:C,isDisabled:!T||b}),(0,ee.Y)("div",{className:"settings-item settings-item-picker",children:(0,ee.Y)(yi.A,{itemIds:y,lockedUnselectedIds:w,onSelectedIdsChange:Y,selectedIds:k,onDisabledClick:P,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"})}),(0,ee.Y)(ki.A,{isShown:h||b,disabled:B,onClick:F,ariaLabel:"Save changes",children:h?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})}))),kd=(0,s.ph)((({currentScreen:e,shownScreen:t,state:i,dispatch:o,isActive:r,onReset:l})=>{const{openShareChatFolderModal:c,editChatFolder:d,addChatFolder:h,openSettingsScreen:m}=(0,n.ko)(),u=(0,s.hb)((()=>{e!==a.VS.FoldersCreateFolder&&e!==a.VS.FoldersEditFolder&&e!==a.VS.FoldersEditFolderFromChatList&&e!==a.VS.FoldersEditFolderInvites||setTimeout((()=>{o({type:"reset"})}),200),e!==a.VS.FoldersIncludedChats&&e!==a.VS.FoldersExcludedChats?l():"create"===i.mode?m({screen:a.VS.FoldersCreateFolder}):m({screen:a.VS.FoldersEditFolder})}),[i.mode,o,e,l]),p="create"===i.mode,v=(0,s.hb)((e=>{const{title:t}=e.folder;if(!t)return o({type:"setError",payload:gd}),!1;const{selectedChatIds:i,selectedChatTypes:s}=(0,md.a)(e,"included");return i.length||Object.keys(s).length?(p?h({folder:e.folder}):d({id:e.folderId,folderUpdate:e.folder}),o({type:"setError",payload:void 0}),o({type:"setIsTouched",payload:!1}),!0):(o({type:"setError",payload:Ad}),!1)}),[o,p]),g=(0,s.hb)((e=>{v(i)&&e?.()}),[v,i]),A=(0,s.hb)((()=>{const e=o({type:"saveFilters"});u(),v(e)}),[o,u,v]),b=(0,s.hb)((()=>{o({type:"reset"}),m({screen:a.VS.FoldersCreateFolder})}),[o]),f=(0,s.hb)((e=>{o({type:"editFolder",payload:e}),m({screen:a.VS.FoldersEditFolder})}),[o]),C=(0,s.hb)((()=>{o({type:"editIncludeFilters"}),m({screen:e===a.VS.FoldersEditFolderFromChatList?a.VS.FoldersIncludedChatsFromChatList:a.VS.FoldersIncludedChats})}),[e,o]),y=(0,s.hb)((()=>{o({type:"editExcludeFilters"}),m({screen:e===a.VS.FoldersEditFolderFromChatList?a.VS.FoldersExcludedChatsFromChatList:a.VS.FoldersExcludedChats})}),[e,o]),S=(0,s.hb)((()=>{c({folderId:i.folderId,noRequestNextScreen:!0}),o({type:"setIsChatlist",payload:!0}),m({screen:a.VS.FoldersShare})}),[o,i.folderId]),w=(0,s.hb)((e=>{c({folderId:i.folderId,url:e,noRequestNextScreen:!0}),m({screen:a.VS.FoldersShare})}),[i.folderId]);switch(e){case a.VS.Folders:return(0,ee.Y)(yd,{onCreateFolder:b,onEditFolder:f,isActive:r||[a.VS.FoldersCreateFolder,a.VS.FoldersEditFolder,a.VS.FoldersIncludedChats,a.VS.FoldersExcludedChats].includes(t),onReset:l});case a.VS.FoldersCreateFolder:case a.VS.FoldersEditFolder:case a.VS.FoldersEditFolderFromChatList:case a.VS.FoldersEditFolderInvites:return(0,ee.Y)(bd,{state:i,dispatch:o,onAddIncludedChats:C,onAddExcludedChats:y,onShareFolder:S,onOpenInvite:w,onReset:u,isActive:r||[a.VS.FoldersIncludedChats,a.VS.FoldersExcludedChats].includes(t),isOnlyInvites:e===a.VS.FoldersEditFolderInvites,onBack:l,onSaveFolder:g});case a.VS.FoldersIncludedChats:case a.VS.FoldersIncludedChatsFromChatList:return(0,ee.Y)(vd,{mode:"included",state:i,dispatch:o,onReset:u,onSaveFilter:A,isActive:r});case a.VS.FoldersExcludedChats:case a.VS.FoldersExcludedChatsFromChatList:return(0,ee.Y)(vd,{mode:"excluded",state:i,dispatch:o,onReset:u,onSaveFilter:A,isActive:r});case a.VS.FoldersShare:return(0,ee.Y)(wd,{isActive:r,onReset:u});default:return}}));var Nd=i(70934),Id=i(3178);const Pd=(0,s.ph)((({isActive:e,onReset:t,error:i,isLoading:n,shouldDisablePasswordManager:a,expectedPassword:o,placeholder:r="Current Password",hint:l,submitLabel:c,clearError:d,onSubmit:h})=>{const[m,u]=(0,s.J0)(""),[p,v]=(0,s.J0)(!1),g=(0,s.hb)((e=>{o&&e!==o?u("Passwords Should Be Equal"):h(e)}),[h,o]),A=(0,s.hb)((()=>{d&&d(),u("")}),[d]),b=(0,M.A)();return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content password-form custom-scroll",children:[(0,ee.Y)("div",{className:"settings-content-header no-border",children:(0,ee.Y)(Id.A,{isBig:!0,isPasswordVisible:p})}),(0,ee.Y)("div",{className:"settings-item settings-group",children:(0,ee.Y)(Pl.A,{error:m||i,hint:l,placeholder:r,shouldDisablePasswordManager:a,submitLabel:c||b("Next"),clearError:A,isLoading:n,isPasswordVisible:p,shouldResetValue:e,onChangePasswordVisibility:v,onSubmit:g})})]})})),Yd=(0,s.ph)((({isActive:e,onReset:t})=>{const i=(0,M.A)(),n=(0,s.hb)((()=>{t(!0)}),[t]);return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Sd.A,{size:o.BYH,tgsUrl:Mr.w.Congratulations,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Congratulations!"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Now you can lock the app with a passcode so that others can't open it."})]}),(0,ee.Y)("div",{className:"settings-item settings-group",children:(0,ee.Y)(W.A,{onClick:n,children:i("Back")})})]})}));var Fd=i(89704);const Dd=(0,s.ph)((({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,n.ko)(),s=(0,M.A)();return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Lock,previewUrl:Fd,size:160,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Local passcode is enabled."})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{icon:"edit",onClick:()=>i({screen:a.VS.PasscodeChangePasscodeCurrent}),children:s("Passcode.Change")}),(0,ee.Y)(ci.A,{icon:"password-off",onClick:()=>i({screen:a.VS.PasscodeTurnOff}),children:s("Passcode.TurnOff")})]})]})})),Md=(0,s.ph)((({isActive:e,onReset:t,onStart:i})=>{const s=(0,M.A)();return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content local-passcode custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Lock,previewUrl:Fd,size:o.BYH,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description",dir:"auto",children:"When you set up an additional passcode, a lock icon will appear on the chats page. Tap it to lock and unlock your Telegram Web A."}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:"Note: if you forget your local passcode, you'll need to log out of Telegram Web A and log in again."})]}),(0,ee.Y)("div",{className:"settings-item settings-group",children:(0,ee.Y)(W.A,{onClick:i,children:s("EnablePasscode")})})]})})),Td=(0,s.ph)((0,n.EK)((e=>({...e.passcode})))((({passcode:e,currentScreen:t,shownScreen:i,error:o,isActive:r,isLoading:l,onSetPasscode:c,onReset:d})=>{const{setPasscode:h,clearPasscode:m,setPasscodeError:u,clearPasscodeError:p,openSettingsScreen:v}=(0,n.ko)(),g=(0,M.A)(),A=(0,s.hb)((()=>{c(""),v({screen:a.VS.PasscodeNewPasscode})}),[c]),b=(0,s.hb)((e=>{c(e),v({screen:a.VS.PasscodeNewPasscodeConfirm})}),[c]),f=(0,s.hb)((()=>{h({passcode:e}),c(""),v({screen:a.VS.PasscodeCongratulations})}),[c,e]),C=(0,s.hb)((e=>{c(""),(0,Nd.UQ)(e).then((()=>{v({screen:a.VS.PasscodeChangePasscodeNew})}),(()=>{u({error:g("PasscodeController.Error.Current")})}))}),[g,c]),y=(0,s.hb)((e=>{c(e),v({screen:a.VS.PasscodeChangePasscodeConfirm})}),[c]),S=(0,s.hb)((e=>{(0,Nd.UQ)(e).then((()=>{m(),v({screen:a.VS.Privacy})}),(()=>{u({error:g("PasscodeController.Error.Current")})}))}),[g]);switch(t){case a.VS.PasscodeDisabled:return(0,ee.Y)(Md,{onStart:A,isActive:r||[a.VS.PasscodeNewPasscode,a.VS.PasscodeNewPasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeNewPasscode:return(0,ee.Y)(Pd,{shouldDisablePasswordManager:!0,placeholder:g("EnterNewPasscode"),submitLabel:g("Continue"),onSubmit:b,isActive:r||[a.VS.PasscodeNewPasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeNewPasscodeConfirm:return(0,ee.Y)(Pd,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:g("ReEnterYourPasscode"),submitLabel:g("Continue"),isLoading:l,onSubmit:f,isActive:r||[a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeCongratulations:return(0,ee.Y)(Yd,{isActive:r,onReset:d});case a.VS.PasscodeEnabled:return(0,ee.Y)(Dd,{isActive:r||[a.VS.PasscodeChangePasscodeCurrent,a.VS.PasscodeChangePasscodeNew,a.VS.PasscodeChangePasscodeConfirm,a.VS.PasscodeCongratulations,a.VS.PasscodeTurnOff].includes(i),onReset:d});case a.VS.PasscodeChangePasscodeCurrent:return(0,ee.Y)(Pd,{shouldDisablePasswordManager:!0,error:o,clearError:p,placeholder:g("PasscodeController.Current.Placeholder"),onSubmit:C,isActive:r||[a.VS.PasscodeChangePasscodeNew,a.VS.PasscodeChangePasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeChangePasscodeNew:return(0,ee.Y)(Pd,{shouldDisablePasswordManager:!0,placeholder:g("PleaseEnterNewFirstPassword"),onSubmit:y,isActive:r||[a.VS.PasscodeChangePasscodeConfirm,a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeChangePasscodeConfirm:return(0,ee.Y)(Pd,{shouldDisablePasswordManager:!0,expectedPassword:e,placeholder:g("PasscodeController.ReEnterPasscode.Placeholder"),isLoading:l,onSubmit:f,isActive:r||[a.VS.PasscodeCongratulations].includes(i),onReset:d});case a.VS.PasscodeTurnOff:return(0,ee.Y)(Pd,{shouldDisablePasswordManager:!0,error:o?g(o):void 0,clearError:p,placeholder:g("PasscodeController.Current.Placeholder"),onSubmit:S,isActive:r,onReset:d});default:return}}))),Bd=[50,100,500,1e3,2e3,5e3,1e4];function Rd(e,t){const i=e.findIndex((e=>t<=e)),s=e[i-1]||1,n=e[i]||e[e.length-1];return i+(t-s)/(n-s)}function Ld(e,t){const i=Math.floor(t),s=e[i-1]||1,n=s+((e[i]||e[e.length-1])-s)*(t-i);return n<100?Math.round(n):10*Math.round(n/10)}const xd=(0,s.ph)((({min:e=0,max:t,value:i,disabled:n,readOnly:a,bold:o,className:r,defaultValue:l,onChange:c,canChangeChargeForMessages:d})=>{const h=(0,_i.A)(),m=(0,s.Kr)((()=>{const e=[];for(let i=0;i<Bd.length;i++)if(Bd[i]<t&&e.push(Bd[i]),Bd[i]>=t){e.push(t);break}return e}),[t]),u=(0,D.A)((e=>{const t=Number(e.currentTarget.value);c(Ld(m,t))})),p=(0,me.A)(r,"RangeSlider",n&&"disabled",a&&"readOnly",o&&"bold");return(0,ee.FD)("div",{className:p,children:[(0,ee.FD)("div",{className:"slider-top-row",dir:h.isRtl?"rtl":void 0,children:[(0,ee.Y)("span",{className:"value-min",dir:"auto",children:h.number(e)}),(0,ee.FD)("span",{className:"settings-range-value",children:[!d&&(0,ee.Y)(q.A,{name:"lock-badge"}),(0,xi.K)(h,Ld(m,Rd(m,i)))]}),(0,ee.Y)("span",{className:"value-max",dir:"auto",children:h.number(t)})]}),(0,ee.FD)("div",{className:"slider-main",children:[(0,ee.Y)("div",{className:"slider-fill-track",style:`width: ${Rd(m,i)/m.length*100}%`}),(0,ee.Y)("input",{min:0,max:m.length,defaultValue:Rd(m,l),step:"any",type:"range",className:"RangeSlider__input",onChange:u})]})]})})),Ed=(0,s.ph)((0,n.EK)((e=>{const t=e.appConfig?.starsUsdWithdrawRateX1000,i=t?t/1e3:1,s=e.appConfig?.starsPaidMessageCommissionPermille;return{starsPaidMessageCommissionPermille:s?s/1e3:100,starsUsdWithdrawRate:i,starsPaidMessageAmountMax:e.appConfig?.starsPaidMessageAmountMax||o.$$v}}))((function({starsUsdWithdrawRate:e,starsPaidMessageAmountMax:t,starsPaidMessageCommissionPermille:i,canChangeChargeForMessages:s,isGroupChat:a,chargeForMessages:r,onChange:l}){const{openPremiumModal:c}=(0,n.ko)(),d=(0,_i.A)(),h=(0,D.A)((e=>{l?.(e)})),m=(0,D.A)((()=>{c({initialSection:"message_privacy"})}));return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0,children:d("SectionTitleStarsForForMessages")}),(0,ee.Y)(xd,{defaultValue:r,min:o.BSg,max:t,value:r,onChange:h,canChangeChargeForMessages:s,readOnly:!s}),!s&&(0,ee.Y)(W.A,{color:"primary",fluid:!0,size:"smaller",noForcedUpperCase:!0,className:"settings-unlock-button",onClick:m,children:(0,ee.FD)("span",{className:"settings-unlock-button-title",children:[d("UnlockButtonTitle"),(0,ee.Y)(q.A,{name:"lock-badge",className:"settings-unlock-button-icon"})]})}),s&&(0,ee.Y)("p",{className:"settings-item-description-larger",dir:d.isRtl?"rtl":void 0,children:d(a?"SetPriceGroupDescription":"SectionDescriptionStarsForForMessages",{percent:(0,He.l9)(100*i),amount:(0,Sa.A)(r*e*i,"USD",d.code)},{withNodes:!0})})]})})));var Vd=i(9267);const _d=(0,s.ph)((function({premiumSection:e}){const{openPremiumModal:t}=(0,n.ko)(),i=(0,M.A)(),s=(0,D.A)((()=>t({initialSection:e})));return(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{leftElement:(0,ee.Y)(Vd.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:s,children:i("PrivacyLastSeenPremium")}),(0,ee.Y)("p",{className:"settings-item-description-larger premium-info",dir:i.isRtl?"rtl":void 0,children:i("lng_messages_privacy_premium_about")})]})})),Ud=(0,s.ph)((function({label:e,isChecked:t}){const i=(0,M.A)(),{showNotification:s}=(0,n.ko)();return(0,ee.FD)("div",{className:(0,me.A)("sBptmiga",t&&"U_6O1ebL"),onClick:()=>s({message:i("OptionPremiumRequiredMessage")}),children:[(0,ee.Y)("span",{children:e}),(0,ee.Y)(q.A,{name:"lock-badge",className:"jWxrRbkh"})]})})),Od=(0,s.ph)((0,n.EK)((e=>{const{settings:{privacy:t}}=e,i=(0,c.Iv$)(e),s=e.settings.privacy.noPaidMessages?.allowUserIds.length||0;return{shouldNewNonContactPeersRequirePremium:(0,c.BSN)(e),shouldChargeForMessages:Boolean(i),nonContactPeersPaidStars:i||o.wZe,isCurrentUserPremium:(0,c.g29)(e),canLimitNewMessagesWithoutPremium:e.appConfig?.canLimitNewMessagesWithoutPremium,canChargeForMessages:e.appConfig?.starsPaidMessagesAvailable,noPaidReactionsForUsersCount:s,privacy:t}}))((function({isActive:e,canLimitNewMessagesWithoutPremium:t,canChargeForMessages:i,shouldNewNonContactPeersRequirePremium:o,shouldChargeForMessages:r,nonContactPeersPaidStars:l,isCurrentUserPremium:c,noPaidReactionsForUsersCount:d,onReset:h,privacy:m}){const{updateGlobalPrivacySettings:u,openSettingsScreen:p,showNotification:v}=(0,n.ko)(),g=(0,M.A)(),A=(0,_i.A)(),b=c||t,f=c&&i,[C,y]=(0,s.J0)(l),[S,w]=(0,s.J0)(!1),k=(0,s.Kr)((()=>r?"charge_for_messages":o?"contacts_and_premium":"everybody"),[r,o]);(0,wi.A)((([e])=>{S||void 0===e||"everybody"===k||k===e||("everybody"===m.chatInvite?.visibility&&v({message:A("CheckPrivacyInviteText"),action:{action:"openSettingsScreen",payload:{screen:a.VS.PrivacyGroupChats}},actionText:{key:"Review"},duration:8e3}),"everybody"===m.phoneCall?.visibility&&v({message:A("CheckPrivacyCallsText"),action:{action:"openSettingsScreen",payload:{screen:a.VS.PrivacyPhoneCall}},actionText:{key:"Review"},duration:8e3}),w(!0))}),[k,r,m,A,S]);const N=(0,s.Kr)((()=>[{value:"everybody",label:g("P2PEverybody")},{value:"contacts_and_premium",label:b?g("PrivacyMessagesContactsAndPremium"):(0,ee.Y)(Ud,{label:g("PrivacyMessagesContactsAndPremium"),isChecked:"contacts_and_premium"===k}),hidden:!b,isCanCheckedInDisabled:!0},{value:"charge_for_messages",label:f?A("PrivacyChargeForMessages"):(0,ee.Y)(Ud,{label:A("PrivacyChargeForMessages"),isChecked:"charge_for_messages"===k}),hidden:!f,isCanCheckedInDisabled:!0}]),[g,A,b,f,k]),I=(0,D.A)((e=>{u({shouldNewNonContactPeersRequirePremium:"contacts_and_premium"===e,nonContactPeersPaidStars:"charge_for_messages"===e?C:null})})),P=(0,Ae.A)((e=>{u({nonContactPeersPaidStars:e})}),[u],300,!0),Y=(0,s.hb)((e=>{y(e),P(e)}),[y,P]);(0,fe.A)({isActive:e,onBack:h});const F=(0,s.Kr)((()=>A(r?"PrivacyDescriptionChargeForMessages":"PrivacyDescriptionMessagesContactsAndPremium")),[r,A]);return(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("PrivacyMessagesTitle")}),(0,ee.Y)(X.A,{name:"privacy-messages",options:N,onChange:I,selected:k}),(0,ee.Y)("p",{className:"settings-item-description-larger",dir:g.isRtl?"rtl":void 0,children:F})]}),"charge_for_messages"===k&&(0,ee.Y)("div",{className:"settings-item fluid-container",children:(0,ee.Y)(Ed,{canChangeChargeForMessages:f,chargeForMessages:C,onChange:Y})}),f&&"charge_for_messages"===k&&function(){const e=d?g("Users",d,"i"):A("SubtitlePrivacyAddUsers");return(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:A("RemoveFeeTitle")}),(0,ee.Y)(ci.A,{narrow:!0,icon:"delete-user",onClick:()=>{p({screen:a.VS.PrivacyNoPaidMessages})},children:(0,ee.FD)("div",{className:"multiline-item full-size",children:[(0,ee.Y)("span",{className:"title",children:A("ExceptionTitlePrivacyChargeForMessages")}),(0,ee.Y)("span",{className:"subtitle",children:e})]})})]})}(),!c&&"charge_for_messages"!==k&&(0,ee.Y)(_d,{premiumSection:"message_privacy"})]})})));function Kd(e){const t=e.platform.toLowerCase(),i=e.deviceModel.toLowerCase(),s=e.systemVersion.toLowerCase();return i.includes("xbox")?"xbox":i.includes("chrome")&&!i.includes("chromebook")?"chrome":i.includes("brave")?"brave":i.includes("vivaldi")?"vivaldi":i.includes("safari")?"safari":i.includes("firefox")?"firefox":i.includes("opera")?"opera":i.includes("samsungbrowser")?"samsung":t.includes("android")?"android":i.includes("iphone")||i.includes("ipad")||t.includes("ios")||t.includes("macos")||s.includes("macos")?"apple":t.includes("ubuntu")||s.includes("ubuntu")?"ubuntu":t.includes("linux")||s.includes("linux")?"linux":t.includes("windows")||s.includes("windows")?"windows":"unknown"}const Jd={SettingsActiveSession:"M84mrPgu",settingsActiveSession:"M84mrPgu",iconDevice:"Add8P_K4",iconDevice__android:"onkXVGY4",iconDeviceAndroid:"onkXVGY4",iconDevice__apple:"xw13aT8u",iconDeviceApple:"xw13aT8u",iconDevice__brave:"HESrGUdv",iconDeviceBrave:"HESrGUdv",iconDevice__chrome:"Vpej7wm7",iconDeviceChrome:"Vpej7wm7",iconDevice__edge:"ueWE77x9",iconDeviceEdge:"ueWE77x9",iconDevice__firefox:"_lMTmvya",iconDeviceFirefox:"_lMTmvya",iconDevice__linux:"cDVfvyG_",iconDeviceLinux:"cDVfvyG_",iconDevice__opera:"nWqlTxZt",iconDeviceOpera:"nWqlTxZt",iconDevice__safari:"ldFLp1Gf",iconDeviceSafari:"ldFLp1Gf",iconDevice__samsung:"VHNORBGL",iconDeviceSamsung:"VHNORBGL",iconDevice__ubuntu:"QBVivtdu",iconDeviceUbuntu:"QBVivtdu",iconDevice__unknown:"GbjIgrwU",iconDeviceUnknown:"GbjIgrwU",iconDevice__vivaldi:"yieVnjoI",iconDeviceVivaldi:"yieVnjoI",iconDevice__windows:"_0dnTFOE",iconDeviceWindows:"_0dnTFOE",iconDevice__xbox:"fbCjjDpU",iconDeviceXbox:"fbCjjDpU",title:"c6edjhlh",note:"lRqTZAYn",date:"oLnN6crs",box:"wVEXuPlZ",actionHeader:"olQS2T1n",actionName:"KuX1APpO",headerButton:"VT8pZfMu"};function Gd(e){return[e.region,e.country].filter(Boolean).join(", ")}const jd=(0,s.ph)((0,n.EK)(((e,{hash:t})=>({session:t?e.activeSessions.byHash[t]:void 0})))((({isOpen:e,session:t,onClose:i})=>{const{changeSessionSettings:a,terminateAuthorization:o}=(0,n.ko)(),r=(0,M.A)(),l=(0,Bi.A)(t,!0),c=(0,s.hb)((()=>{a({hash:t.hash,areSecretChatsEnabled:!t.areSecretChatsEnabled})}),[a,t]),d=(0,s.hb)((()=>{a({hash:t.hash,areCallsEnabled:!t.areCallsEnabled})}),[a,t]),h=(0,s.hb)((()=>{o({hash:t.hash}),i()}),[i,t,o]);if(l)return(0,ee.FD)(Z.A,{header:(0,ee.FD)("div",{className:"modal-header-condensed",dir:r.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:r("Close"),onClick:i,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:"modal-title",children:r("SessionPreview.Title")}),(0,ee.Y)(W.A,{color:"danger",onClick:h,className:(0,me.A)("modal-action-button",Jd.headerButton),children:r("SessionPreview.TerminateSession")})]}),isOpen:e,hasCloseButton:!0,onClose:i,className:Jd.SettingsActiveSession,children:[(0,ee.Y)("div",{className:(0,me.A)(Jd.iconDevice,l&&Jd[`iconDevice__${Kd(l)}`])}),(0,ee.Y)("h3",{className:Jd.title,dir:"auto",children:l?.deviceModel}),(0,ee.Y)("div",{className:Jd.date,"aria-label":r("PrivacySettings.LastSeen"),children:(0,ze.L2)(1e3*l.dateActive,r.code)}),(0,ee.FD)("dl",{className:Jd.box,children:[(0,ee.Y)("dt",{children:r("SessionPreview.App")}),(0,ee.FD)("dd",{children:[l?.appName," ",l?.appVersion,","," ",l?.platform," ",l?.systemVersion]}),(0,ee.Y)("dt",{children:r("SessionPreview.Ip")}),(0,ee.Y)("dd",{children:l?.ip}),(0,ee.Y)("dt",{children:r("SessionPreview.Location")}),(0,ee.Y)("dd",{children:l&&Gd(l)})]}),(0,ee.Y)("p",{className:Jd.note,children:r("SessionPreview.IpDesc")}),(0,ee.Y)("h4",{className:Jd.actionHeader,children:r("AuthSessions.View.AcceptTitle")}),(0,ee.FD)(ci.A,{onClick:c,children:[(0,ee.Y)("span",{className:Jd.actionName,children:r("SessionPreview.Accept.Secret")}),(0,ee.Y)(bi.A,{id:"accept_secrets",label:"On",checked:l.areSecretChatsEnabled})]}),(0,ee.FD)(ci.A,{onClick:d,children:[(0,ee.Y)("span",{className:Jd.actionName,children:r("SessionPreview.Accept.Calls")}),(0,ee.Y)(bi.A,{id:"accept_calls",label:"On",checked:l.areCallsEnabled})]})]})})));function zd(e){return[e.region,e.country].filter(Boolean).join(", ")}const Hd=(0,s.ph)((0,n.EK)((e=>e.activeSessions))((({isActive:e,onReset:t,byHash:i,orderedHashes:a,ttlDays:o})=>{const{terminateAuthorization:r,terminateAllAuthorizations:l,changeSessionTtl:c}=(0,n.ko)(),d=(0,M.A)(),[h,m,u]=(0,Y.A)(),[p,v]=(0,s.J0)(),[g,A,b]=(0,Y.A)(),f=(0,s.Kr)((()=>{if(void 0!==o)return o<=7?"7":o<=30?"30":o<=93?"90":o<=183?"183":o>183?"365":void 0}),[o]),C=(0,s.Kr)((()=>{const e=[{label:d("Weeks",1,"i"),value:"7"},{label:d("Months",1,"i"),value:"30"},{label:d("Months",3,"i"),value:"90"},{label:d("Months",6,"i"),value:"183"}];return o&&o>=365&&e.push({label:d("Years",1,"i"),value:"365"}),e}),[d,o]),y=(0,s.hb)((e=>{r({hash:e})}),[r]),S=(0,s.hb)((()=>{u(),l()}),[u,l]),w=(0,s.hb)((e=>{v(e),A()}),[A]),k=(0,s.hb)((()=>{v(void 0),b()}),[b]),N=(0,s.hb)((e=>{c({days:Number(e)})}),[c]),I=(0,s.Kr)((()=>{const e=a.find((e=>i[e].isCurrent));return e?i[e]:void 0}),[i,a]),P=(0,s.Kr)((()=>a.filter((e=>!i[e].isCurrent))),[i,a]),F=Boolean(P.length);return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content custom-scroll SettingsActiveSessions",children:[I&&(T=I,(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0,children:d("AuthSessions.CurrentSession")}),(0,ee.Y)(ci.A,{narrow:!0,inactive:!0,icon:`device-${Kd(T)}`,iconClassName:"icon-device",children:(0,ee.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,ee.Y)("span",{className:"title",dir:"auto",children:T.deviceModel}),(0,ee.FD)("span",{className:"subtitle black tight",children:[T.appName," ",T.appVersion,","," ",T.platform," ",T.systemVersion]}),(0,ee.FD)("span",{className:"subtitle",children:[T.ip," ","-"," ",zd(T)]})]})}),F&&(0,ee.Y)(ci.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:m,children:d("TerminateAllSessions")})]})),F&&(D=P,(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0,children:d("OtherSessions")}),D.map((function(e){const t=i[e];return(0,ee.Y)(ci.A,{ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{y(t.hash)}}],icon:`device-${Kd(t)}`,iconClassName:"icon-device",onClick:()=>{w(t.hash)},children:(0,ee.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,ee.Y)("span",{className:"date",children:(0,ze.be)(d,1e3*t.dateActive)}),(0,ee.Y)("span",{className:"title",children:t.deviceModel}),(0,ee.FD)("span",{className:"subtitle black tight",children:[t.appName," ",t.appVersion,","," ",t.platform," ",t.systemVersion]}),(0,ee.FD)("span",{className:"subtitle",children:[t.ip," ",zd(t)]})]})},t.hash)}))]})),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:d.isRtl?"rtl":void 0,children:d("TerminateOldSessionHeader")}),(0,ee.Y)("p",{className:"settings-item-description-larger",children:d("IfInactiveFor")}),(0,ee.Y)(X.A,{name:"session_ttl",options:C,selected:f,onChange:N})]}),F&&(0,ee.Y)(vi.A,{isOpen:h,onClose:u,text:d("AreYouSureSessions"),confirmLabel:d("TerminateAllSessions"),confirmHandler:S,confirmIsDestructive:!0,areButtonsInColumn:!0}),(0,ee.Y)(jd,{isOpen:g,hash:p,onClose:k})]});var D,T}))),$d="YRYk96ki",qd=(0,s.ph)((0,n.EK)(((e,{hash:t})=>{const i=t?e.activeWebSessions.byHash[t]:void 0;return{session:i,bot:i?e.users.byId[i.botId]:void 0}}))((({isOpen:e,session:t,bot:i,onClose:a})=>{const{terminateWebAuthorization:o}=(0,n.ko)(),r=(0,M.A)(),l=(0,Bi.A)(t,!0),c=(0,Bi.A)(i,!0),d=(0,s.hb)((()=>{o({hash:t.hash}),a()}),[a,t,o]);if(l)return(0,ee.FD)(Z.A,{header:(0,ee.FD)("div",{className:"modal-header-condensed",dir:r.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:r("Close"),onClick:a,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:"modal-title",children:r("WebSessionsTitle")}),(0,ee.Y)(W.A,{color:"danger",onClick:d,className:(0,me.A)("modal-action-button","lUf0RJ2h"),children:r("AuthSessions.LogOut")})]}),isOpen:e,hasCloseButton:!0,onClose:a,className:"Wd0fmiSY",children:[(0,ee.Y)(Dt.A,{className:"OhZHdRsP",peer:c,size:"large"}),c&&(0,ee.Y)(Hs.A,{className:"EQ7__xGn",peer:c}),(0,ee.Y)("div",{className:$d,children:l?.domain}),(0,ee.FD)("dl",{className:"kmCTIfvf",children:[(0,ee.Y)("dt",{children:r("AuthSessions.View.Browser")}),(0,ee.Y)("dd",{children:l?.browser}),(0,ee.Y)("dt",{children:r("SessionPreview.Ip")}),(0,ee.Y)("dd",{children:l?.ip}),(0,ee.Y)("dt",{children:r("SessionPreview.Location")}),(0,ee.Y)("dd",{children:l?.region})]}),(0,ee.Y)("p",{className:$d,children:r("AuthSessions.View.LocationInfo")})]})}))),Wd={avatar:"v0wP46TR","clear-help":"WnnxcARX",clearHelp:"WnnxcARX",subtitle:"uEUfjByC"},Qd=(0,s.ph)((0,n.EK)((e=>{const{byHash:t,orderedHashes:i}=e.activeWebSessions;return{byHash:t,orderedHashes:i}}))((({isActive:e,byHash:t,orderedHashes:i,onReset:a})=>{const{terminateWebAuthorization:o,terminateAllWebAuthorizations:r}=(0,n.ko)(),l=(0,M.A)(),[c,d,h]=(0,Y.A)(),[m,u]=(0,s.J0)(),[p,v,g]=(0,Y.A)(),A=(0,s.hb)((e=>{o({hash:e})}),[o]),b=(0,s.hb)((()=>{h(),r()}),[h,r]),f=(0,s.hb)((e=>{u(e),v()}),[v]),C=(0,s.hb)((()=>{u(void 0),g()}),[g]);var y;if((0,s.vJ)((()=>{i.length||a()}),[a,i]),(0,fe.A)({isActive:e,onBack:a}),i.length)return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{className:"destructive mb-0 no-icon",icon:"stop",ripple:!0,narrow:!0,onClick:d,children:l("AuthSessions.LogOutApplications")}),(0,ee.Y)("p",{className:(0,me.A)("settings-item-description",Wd.clearHelp),children:l("ClearOtherWebSessionsHelp")})]}),(y=i,(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("WebSessionsTitle")}),y.map((function(e){const i=t[e],s=(0,n.mS)().users.byId[i.botId];return(0,ee.FD)(ci.A,{ripple:!0,narrow:!0,contextActions:[{title:"Terminate",icon:"stop",destructive:!0,handler:()=>{A(i.hash)}}],onClick:()=>f(i.hash),children:[(0,ee.Y)(Dt.A,{className:Wd.avatar,peer:s,size:"tiny"}),(0,ee.FD)("div",{className:"multiline-item full-size",dir:"auto",children:[(0,ee.Y)("span",{className:"date",children:(0,ze.be)(l,1e3*i.dateActive)}),s&&(0,ee.Y)(Hs.A,{className:Wd.title,peer:s}),(0,ee.FD)("span",{className:(0,me.A)("subtitle","black","tight",Wd.platform),children:[i.domain,",",i.browser,",",i.platform]}),(0,ee.FD)("span",{className:(0,me.A)("subtitle",Wd.subtitle),children:[i.ip," ",i.region]})]})]},i.hash)}))]})),(0,ee.Y)(vi.A,{isOpen:c,onClose:h,title:l("AuthSessions.LogOutApplications"),text:l("AreYouSureWebSessions"),confirmHandler:b,confirmIsDestructive:!0}),(0,ee.Y)(qd,{isOpen:p,hash:m,onClose:C})]})}))),Zd=(0,s.ph)((({stickerSet:e,noPlay:t,className:i,observeIntersection:s,onClick:n})=>{const a=(0,M.A)(),r=e?.stickers?.[0],l=(0,D.A)((()=>{r&&n(r)}));if(e?.stickers)return(0,ee.FD)(ci.A,{className:(0,me.A)("StickerSetCard","chat-item-clickable small-icon",i),style:`height: ${o.yq1}px;`,inactive:!r,onClick:l,children:[function(){if(e)return e.hasThumbnail||!r?(0,ee.Y)(W.A,{ariaLabel:e.title,color:"translucent",isRtl:a.isRtl,children:(0,ee.Y)(kr,{stickerSet:e,size:o.RCH,noPlay:t,observeIntersection:s})}):(0,ee.Y)(Fr,{sticker:r,size:o.RCH,title:e.title,noPlay:t,observeIntersection:s,noContextMenu:!0,isCurrentUserPremium:!0,clickArg:void 0})}(),(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("div",{className:"title",children:e.title}),(0,ee.Y)("div",{className:"subtitle",children:a("StickerPack.StickerCount",e.count,"i")})]})]})})),Xd=(0,s.ph)((0,n.EK)((e=>({...(0,fi.Up)(e.settings.byKey,["shouldSuggestCustomEmoji"]),customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,canPlayAnimatedEmojis:(0,c.BWX)(e)})))((({isActive:e,customEmojiSetIds:t,stickerSetsById:i,shouldSuggestCustomEmoji:a,canPlayAnimatedEmojis:o,onReset:r})=>{const{openStickerSet:l,setSettingOption:c}=(0,n.ko)(),d=(0,M.A)(),h=(0,s.li)(),{observe:m}=(0,gr.BL)({rootRef:h});(0,fe.A)({isActive:e,onBack:r});const u=(0,s.hb)((e=>{l({stickerSetInfo:e.stickerSetInfo})}),[l]),p=(0,s.hb)((e=>{c({shouldSuggestCustomEmoji:e})}),[c]),v=(0,s.Kr)((()=>t&&Object.values((0,fi.Up)(i,t))),[t,i]);return(0,ee.Y)("div",{className:"settings-content custom-scroll",children:v&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(un.A,{label:d("SuggestAnimatedEmoji"),checked:a,onCheck:p}),(0,ee.Y)("div",{className:"mt-4",ref:h,children:v.map((e=>(0,ee.Y)(Zd,{stickerSet:e,observeIntersection:m,onClick:u,noPlay:!o},e.id)))}),(0,ee.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:(0,Ft.A)(d("EmojiBotInfo"),["links"])})]})})}))),eh=(0,s.ph)((0,n.EK)((e=>(0,fi.Up)(e.settings.byKey,["canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","autoLoadFileMaxSizeMb"])))((({isActive:e,onReset:t,canAutoLoadPhotoFromContacts:i,canAutoLoadPhotoInPrivateChats:a,canAutoLoadPhotoInGroups:r,canAutoLoadPhotoInChannels:l,canAutoLoadVideoFromContacts:c,canAutoLoadVideoInPrivateChats:d,canAutoLoadVideoInGroups:h,canAutoLoadVideoInChannels:m,canAutoLoadFileFromContacts:u,canAutoLoadFileInPrivateChats:p,canAutoLoadFileInGroups:v,canAutoLoadFileInChannels:g,autoLoadFileMaxSizeMb:A})=>{const{setSettingOption:b}=(0,n.ko)(),f=(0,_i.A)();(0,fe.A)({isActive:e,onBack:t});const C=(0,s.hb)((e=>f("AutodownloadSizeLimitUpTo",{limit:f("FileSizeMB",{count:o.$gx[e]})})),[f]),y=(0,s.hb)((e=>{b({autoLoadFileMaxSizeMb:o.$gx[e]})}),[b]);function S(){const e=o.$gx.indexOf(A);return(0,ee.Y)("div",{className:"pt-5",children:(0,ee.Y)(qe.A,{label:f("AutoDownloadMaxFileSize"),min:0,max:5,value:-1!==e?e:2,renderValue:C,onChange:y})})}function w(e,t,i,s,n,a){return(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:f.isRtl?"rtl":void 0,children:e}),(0,ee.Y)(un.A,{label:f("AutoDownloadSettingsContacts"),checked:i,onCheck:e=>b({[`canAutoLoad${t}FromContacts`]:e})}),(0,ee.Y)(un.A,{label:f("AutoDownloadSettingsPrivateChats"),checked:s,onCheck:e=>b({[`canAutoLoad${t}InPrivateChats`]:e})}),(0,ee.Y)(un.A,{label:f("AutoDownloadSettingsGroupChats"),checked:n,onCheck:e=>b({[`canAutoLoad${t}InGroups`]:e})}),(0,ee.Y)(un.A,{label:f("AutoDownloadSettingsChannels"),checked:a,onCheck:e=>b({[`canAutoLoad${t}InChannels`]:e})}),"File"===t&&S()]})}return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[w(f("AutoDownloadPhotosTitle"),"Photo",i,a,r,l),w(f("AutoDownloadVideosTitle"),"Video",c,d,h,m),w(f("AutoDownloadFilesTitle"),"File",u,p,v,g)]})}))),th={root:"Ys1i4ssl",item:"skaVPMTF"},ih=["af","als","am","an","ar","arz","as","ast","av","az","azb","ba","bar","bcl","be","bg","bh","bn","bo","bpy","br","bs","bxr","ca","cbk","ce","ceb","ckb","co","cs","cv","cy","da","de","diq","dsb","dty","dv","el","eml","en","eo","es","et","eu","fa","fi","fr","frr","fy","ga","gd","gl","gn","gom","gu","gv","he","hi","hif","hr","hsb","ht","hu","hy","ia","id","ie","ilo","io","is","it","ja","jbo","jv","ka","kk","km","kn","ko","krc","ku","kv","kw","ky","la","lb","lez","li","lmo","lo","lrc","lt","lv","mai","mg","mhr","min","mk","ml","mn","mr","mrj","ms","mt","mwl","my","myv","mzn","nah","nap","nds","ne","new","nl","nn","no","oc","or","os","pa","pam","pfl","pl","pms","pnb","ps","pt","qu","rm","ro","ru","rue","sa","sah","sc","scn","sco","sd","sh","si","sk","sl","so","sq","sr","su","sv","sw","ta","te","tg","th","tk","tl","tr","tt","tyv","ug","uk","ur","uz","vec","vep","vi","vls","vo","wa","war","wuu","xal","xmf","yi","yo","yue","zh"],sh=o.N89.filter((e=>ih.includes(e))),nh=(0,s.ph)((0,n.EK)((e=>{const{doNotTranslate:t}=e.settings.byKey;return{doNotTranslate:t}}))((({isActive:e,doNotTranslate:t,onReset:i})=>{const{setSettingOption:a}=(0,n.ko)(),o=(0,M.A)().code||"en",[r,l]=(0,s.J0)([]),[c,d]=(0,s.J0)(""),h=(0,s.Kr)((()=>{const e=sh.map((e=>({langCode:e,translatedName:new Intl.DisplayNames([o],{type:"language"}).of(e),originalName:new Intl.DisplayNames([e],{type:"language"}).of(e)}))).filter(Boolean).map((({langCode:e,translatedName:t,originalName:i})=>({label:t,subLabel:i,value:e})));if(!c.trim()){const t=e.find((e=>e.value===o)),i=e.filter((e=>e.value!==o));return t?[t,...i]:e}return e?.filter((e=>e.label.toLowerCase().includes(c.toLowerCase())))}),[o,c]);(0,wi.A)((([i,s])=>{if(i===e&&s?.find((e=>e===o)))return;const[n]=(0,fi.jB)(h,(e=>t.includes(e.value)));l([...n.map((e=>e.value))])}),[e,t,r.length,o,h]);const m=(0,D.A)((e=>{l(e),a({doNotTranslate:e})}));return(0,fe.A)({isActive:e,onBack:i}),(0,ee.Y)("div",{className:(0,me.A)(th.root,"settings-content infinite-scroll"),children:(0,ee.Y)("div",{className:(0,me.A)(th.item),children:(0,ee.Y)(Bo,{className:th.picker,items:h,selectedValues:r,onSelectedValuesChange:m,filterValue:c,onFilterChange:d,isSearchable:!0,allowMultiple:!0,withDefaultPadding:!0,itemInputType:"checkbox",searchInputId:"lang-picker-search"})})})}))),ah=(0,s.ph)((({chatId:e,usernames:t,onEditUsername:i})=>{const{showNotification:a,toggleUsername:o,toggleChatUsername:r,sortUsernames:l,sortChatUsernames:c}=(0,n.ko)(),d=(0,M.A)(),[h,m]=(0,s.J0)(),u=(0,s.Kr)((()=>t.map((({username:e})=>e))),[t]),p=(0,V.A)(u),[v,g]=(0,s.J0)({orderedUsernames:u,dragOrderUsernames:u,draggedIndex:void 0});(0,s.vJ)((()=>{p!==u&&g({orderedUsernames:u,dragOrderUsernames:u,draggedIndex:void 0})}),[p,u]);const A=(0,s.hb)((e=>{(0,uc.eM)(`@${e}`),a({message:d("UsernameCopied")})}),[d,a]),b=(0,s.hb)((e=>{e.isEditable?i(e.username):m(e)}),[i]),f=(0,s.hb)((()=>{m(void 0)}),[]),C=(0,s.hb)((()=>{h&&(e?r({chatId:e,username:h.username,isActive:!h.isActive}):o({username:h.username,isActive:!h.isActive}),f())}),[e,f,r,o,h]),y=(0,s.hb)(((e,t)=>{const i=Math.round(e.y/56),s=v.orderedUsernames?.indexOf(t)||0,n=v.orderedUsernames?.filter((e=>e!==t));n&&(0,pe.Bt)(s+i,0,u.length)&&(n.splice(s+i,0,t),g((e=>({...e,draggedIndex:s,dragOrderUsernames:n}))))}),[v.orderedUsernames,u.length]),S=(0,s.hb)((()=>{g((t=>(e?c({chatId:e,usernames:t.dragOrderUsernames}):l({usernames:t.dragOrderUsernames}),{...t,orderedUsernames:t.dragOrderUsernames,draggedIndex:void 0})))}),[e,c,l]);return(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"PaO1MMi5",children:[(0,ee.Y)("h4",{className:"wSswdVkR",dir:d.isRtl?"rtl":void 0,children:d("lng_usernames_subtitle")}),(0,ee.Y)("div",{className:"lAeeBh9K",style:`height: ${56*t.length}px`,children:t.map(((e,t)=>{const i=v.draggedIndex===t,s=56*(v.orderedUsernames?.indexOf(e.username)??0),n=56*(v.dragOrderUsernames?.indexOf(e.username)??0),a=e.isEditable?"lng_usernames_edit":e.isActive?"lng_usernames_active":"lng_usernames_non_active";return(0,ee.Y)(fd.A,{id:e.username,onDrag:y,onDragEnd:S,style:`top: ${i?s:n}px;`,knobStyle:(d.isRtl?"left":"right")+": 3rem;",isDisabled:!e.isActive,children:(0,ee.FD)(ci.A,{className:(0,me.A)("drag-item no-icon","l04OwRBg"),narrow:!0,secondaryIcon:"more",icon:e.isActive?"link":"link-broken",multiline:!0,contextActions:[{handler:()=>{A(e.username)},title:d("Copy"),icon:"copy"}],onClick:()=>{b(e)},children:[(0,ee.FD)("span",{className:"title",children:["@",e.username]}),(0,ee.Y)("span",{className:"subtitle",children:d(a)})]},e.username)},e.username)}))}),(0,ee.Y)("p",{className:"oiJc22Aj",dir:d.isRtl?"rtl":void 0,children:d("lng_usernames_description")})]}),(0,ee.Y)(vi.A,{isOpen:Boolean(h),onClose:f,title:d(h?.isActive?"Username.DeactivateAlertTitle":"Username.ActivateAlertTitle"),text:d(h?.isActive?"Username.DeactivateAlertText":"Username.ActivateAlertText"),confirmLabel:d(h?.isActive?"Username.DeactivateAlertHide":"Username.ActivateAlertShow"),confirmHandler:C,confirmIsDestructive:!h?.isActive})]})}));var oh=i(11116);const rh=/https:\/\/t\.me\/?/i,lh=(0,ve.sg)((e=>e()),250,!1),ch=(0,s.ph)((({currentUsername:e,asLink:t,isLoading:i,isUsernameAvailable:a,checkedUsername:r,onChange:l})=>{const{checkUsername:c,checkPublicLink:d}=(0,n.ko)(),[h,m]=(0,s.J0)(e||""),u=(0,M.A)(),p=t?"SetUrl":"Username",v=u(t?"SetUrlPlaceholder":"Username"),g=(0,V.A)(a),A=e!==h?a??g:void 0,b=h&&e!==h&&r!==h,[f,C]=(0,s.Kr)((()=>h.length?h.length<oh.tX?[void 0,u(`${p}InvalidShort`)]:h.length>oh.Tk?[void 0,u(`${p}InvalidLong`)]:oh.Ny.test(h)?void 0===A||b?[]:[A?u(`${p}Available`,v):void 0,!1===A?u(`${p}InUse`):void 0]:[void 0,u(`${p}Invalid`)]:[]),[h,A,b,u,p,v]);(0,s.vJ)((()=>{m(e||"")}),[t,e]);const y=(0,s.hb)((i=>{const s=i.target.value.trim();if(t&&!s.match(rh))return void(s.length||(m(""),l?.("")));const n=s.replace(rh,"");m(n),(""===n||(0,oh.BU)(n,!0))&&(l?.(n),lh((()=>{n!==e&&(t?d:c)({username:n})})))}),[t,d,c,e,l]);return(0,ee.Y)(Q.A,{value:`${t?o.jsp:""}${h}`,onChange:y,label:b?u("Checking"):v,error:C,success:f,readOnly:i,teactExperimentControlled:!0})}));var dh=i(43434);const hh=(0,ve.nF)((e=>e()),6e4,!0),mh="Please provide your first name",uh=(0,s.ph)((0,n.EK)((e=>{const{currentUserId:t}=e,{progress:i,isUsernameAvailable:s,checkedUsername:n,error:a}=(0,c.nTw)(e).profileEdit||{},o=t?(0,c.mBe)(e,t):void 0,r=(0,ya.d)(e,"aboutLength");if(!o)return{progress:i,checkedUsername:n,isUsernameAvailable:s,editUsernameError:a,maxBioLength:r};const{firstName:d,lastName:h,usernames:m}=o,u=t?(0,c.vGo)(e,t):void 0;return{currentAvatarHash:(0,l.cP)(o),currentFirstName:d,currentLastName:h,currentBio:u?.bio,progress:i,isUsernameAvailable:s,checkedUsername:n,editUsernameError:a,maxBioLength:r,usernames:m}}))((({isActive:e,currentAvatarHash:t,currentFirstName:i,currentLastName:r,currentBio:l,progress:c,checkedUsername:d,editUsernameError:h,isUsernameAvailable:m,maxBioLength:u,usernames:p,onReset:v})=>{const{loadCurrentUser:g,updateProfile:A}=(0,n.ko)(),b=(0,M.A)(),f=(0,s.Kr)((()=>p?.find((({isEditable:e})=>e))),[p]),C=f?.username||"",[y,S]=(0,s.J0)(!1),[w,k]=(0,s.J0)(!1),[N,I]=(0,s.J0)(),[P,Y]=(0,s.J0)(),[F,D]=(0,s.J0)(i||""),[T,B]=(0,s.J0)(r||""),[R,L]=(0,s.J0)(l||""),[x,E]=(0,s.J0)(C),_=(0,j.A)(t,!1,U.qZ.BlobUrl),O=c===a.DV.InProgress,K=!1===x,J=(0,V.A)(m),G=m??J,z=p&&p.length>1,H=(0,s.Kr)((()=>!K&&(Boolean(P)||w||y&&!0===G)),[K,P,w,y,G]);(0,fe.A)({isActive:e,onBack:v}),(0,s.vJ)((()=>{hh((()=>{g()}))}),[g]),(0,s.vJ)((()=>{Y(void 0)}),[_]),(0,s.vJ)((()=>{D(i||""),B(r||""),L(l||"")}),[i,r,l]),(0,s.vJ)((()=>{E(C||"")}),[C]),(0,s.vJ)((()=>{c===a.DV.Complete&&(k(!1),S(!1),I(void 0))}),[c]);const $=(0,s.hb)((e=>{Y(e)}),[]),W=(0,s.hb)((e=>{D(e.target.value),k(!0)}),[]),Z=(0,s.hb)((e=>{B(e.target.value),k(!0)}),[]),X=(0,s.hb)((e=>{L(e.target.value),k(!0)}),[]),te=(0,s.hb)((e=>{E(e),S(C!==e)}),[C]),ie=(0,s.hb)((()=>{const e=F.trim(),t=T.trim(),i=R.trim();x&&(e.length?A({photo:P,...w&&{firstName:e,lastName:t,bio:i},...y&&{username:x}}):I(mh))}),[P,F,T,R,w,x,y,A]);return(0,ee.FD)("div",{className:"settings-fab-wrapper",children:[(0,ee.FD)("div",{className:"settings-content no-border custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.FD)("div",{className:"settings-input",children:[(0,ee.Y)(dh.A,{currentAvatarBlobUrl:_,onChange:$,title:"Edit your profile photo",disabled:O}),(0,ee.Y)(Q.A,{value:F,onChange:W,label:b("FirstName"),disabled:O,error:N===mh?N:void 0}),(0,ee.Y)(Q.A,{value:T,onChange:Z,label:b("LastName"),disabled:O}),(0,ee.Y)(Ll.A,{value:R,onChange:X,label:b("UserBio"),disabled:O,maxLength:u,maxLengthIndicator:u?(u-R.length).toString():void 0})]}),(0,ee.Y)("p",{className:"settings-item-description",dir:b.isRtl?"rtl":void 0,children:(0,Ft.A)(b("lng_settings_about_bio"),["br","simple_markdown"])})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:b.isRtl?"rtl":void 0,children:b("Username")}),(0,ee.Y)("div",{className:"settings-input",children:(0,ee.Y)(ch,{currentUsername:C,isLoading:O,isUsernameAvailable:m,checkedUsername:d,onChange:te})}),h===o.Y3M&&function(){const e=`${o.jsp}${o.NjX}`;return(0,ee.Y)("p",{className:"settings-item-description",dir:b.isRtl?"rtl":void 0,children:b("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map((t=>"PURCHASE_LINK"===t?(0,ee.Y)(fl.A,{url:e,text:`@${o.NjX}`}):t))})}(),(0,ee.Y)("p",{className:"settings-item-description",dir:b.isRtl?"rtl":void 0,children:(0,Ft.A)(b("UsernameHelp"),["br","simple_markdown"])}),x&&(0,ee.FD)("p",{className:"settings-item-description",dir:b.isRtl?"rtl":void 0,children:[b("lng_username_link"),(0,ee.Y)("br",{}),(0,ee.FD)("span",{className:"username-link",children:[o.jsp,x]})]})]}),z&&(0,ee.Y)(ah,{usernames:p,onEditUsername:E})]}),(0,ee.Y)(ki.A,{isShown:H,onClick:ie,disabled:O,ariaLabel:b("Save"),children:O?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})})));var ph=i(61182),vh=i(15006);const gh=(0,s.ph)((0,n.EK)((e=>{const{shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:s,shouldDebugExportedSenders:n}=(0,Nn.l)(e);return{shouldForceHttpTransport:t,shouldAllowHttpTransport:i,shouldCollectDebugLogs:s,shouldDebugExportedSenders:n}}))((({isActive:e,onReset:t,shouldForceHttpTransport:i,shouldAllowHttpTransport:a,shouldCollectDebugLogs:r,shouldDebugExportedSenders:l})=>{const{requestConfetti:c,setSharedSettingOption:d,requestWave:h}=(0,n.ko)(),m=(0,s.li)(),[u,p]=(0,s.J0)(!1),v=(0,M.A)(),[g,A]=(0,s.J0)(!1);(0,s.vJ)((()=>{window.electron?.getIsAutoUpdateEnabled().then(A)}),[]),(0,fe.A)({isActive:e,onBack:t});const f=(0,D.A)((()=>{const e=new File([(0,ph.F8)()],o.lFE,{type:"text/plain"}),t=URL.createObjectURL(e);(0,Li.A)(t,o.lFE)})),C=(0,s.hb)((e=>{window.electron?.setIsAutoUpdateEnabled(e)}),[]),y=(0,D.A)((e=>{h({startX:e.clientX,startY:e.clientY})})),S=(0,D.A)((()=>{c({withStars:!0})})),w=(0,D.A)((()=>{const e=m.current;e&&(0,vh.U)(e)&&(p(!0),setTimeout((()=>{p(!1)}),1500))}));return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Experimental,size:200,className:"experimental-duck",nonInteractive:!0,noLoop:!1}),(0,ee.Y)("p",{className:"settings-item-description pt-3",dir:"auto",children:v("lng_settings_experimental_about")})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{onClick:S,icon:"animations",children:(0,ee.Y)("div",{className:"title",children:"Launch some confetti!"})}),(0,ee.Y)(ci.A,{onClick:y,icon:"story-expired",disabled:!b.J6,children:(0,ee.Y)("div",{className:"title",children:"Start wave"})}),(0,ee.Y)(ci.A,{ref:m,onClick:w,icon:"spoiler",disabled:!b.bW,style:u?"visibility: hidden":"",children:(0,ee.Y)("div",{className:"title",children:"Vaporize this button"})}),(0,ee.Y)(un.A,{label:"Allow HTTP Transport",checked:Boolean(a),onCheck:()=>d({shouldAllowHttpTransport:!a})}),(0,ee.Y)(un.A,{label:"Force HTTP Transport",disabled:!a,checked:Boolean(i),onCheck:()=>d({shouldForceHttpTransport:!i})}),(0,ee.Y)(un.A,{label:v("DebugMenuEnableLogs"),checked:Boolean(r),onCheck:()=>d({shouldCollectDebugLogs:!r})}),(0,ee.Y)(un.A,{label:"Enable exported senders debug",checked:Boolean(l),onCheck:()=>d({shouldDebugExportedSenders:!l})}),b.cp&&(0,ee.Y)(un.A,{label:"Enable autoupdates",checked:Boolean(g),onCheck:C}),(0,ee.Y)(ci.A,{onClick:f,icon:"bug",children:(0,ee.Y)("div",{className:"title",children:"Download log"})})]})]})})));var Ah=i(6e4),bh=i(84382);const fh=(0,s.ph)((0,n.EK)((e=>{const{theme:t,shouldUseSystemTheme:i,messageSendKeyCombo:s,messageTextSize:n,timeFormat:a}=(0,Nn.l)(e);return{messageSendKeyCombo:s,messageTextSize:n,timeFormat:a,theme:t,shouldUseSystemTheme:i}}))((({isActive:e,messageTextSize:t,messageSendKeyCombo:i,timeFormat:o,theme:r,shouldUseSystemTheme:l,onReset:c})=>{const{setSharedSettingOption:d,openSettingsScreen:h}=(0,n.ko)(),m=(0,_i.A)(),{isMobile:u}=(0,I.Ay)(),p=u&&(b.pz||b.Ni),v=[{label:m("SettingsTimeFormat12"),value:"12h"},{label:m("SettingsTimeFormat24"),value:"24h"}],g=[{label:m("EmptyChatAppearanceLight"),value:"light"},{label:m("EmptyChatAppearanceDark"),value:"dark"},{label:m("EmptyChatAppearanceSystem"),value:"auto"}],A=p?void 0:[{value:"enter",label:m("SettingsSendEnter"),subLabel:m("SettingsSendEnterDescription")},{value:"ctrl-enter",label:m(b.MP||b.pz?"SettingsSendCmdenter":"SettingsSendCtrlenter"),subLabel:m("SettingsSendPlusEnterDescription")}],f=(0,s.hb)((e=>{document.documentElement.style.setProperty("--composer-text-size",`${Math.max(e,b.pz?16:15)}px`),document.documentElement.style.setProperty("--message-meta-height",`${Math.floor(1.3125*e)}px`),document.documentElement.style.setProperty("--message-text-size",`${e}px`),document.documentElement.setAttribute("data-message-text-size",e.toString()),d({messageTextSize:e})}),[]),C=(0,s.hb)((e=>{const t="auto"===e?(0,bh.V)():e;d({theme:t}),d({shouldUseSystemTheme:"auto"===e})}),[]),y=(0,s.hb)((e=>{d({timeFormat:e}),d({wasTimeFormatSetManually:!0}),(0,Ah.bV)(e)}),[]),S=(0,s.hb)((e=>{d({messageSendKeyCombo:e})}),[]),[w,k]=(0,s.J0)(!1);(0,s.vJ)((()=>{window.electron?.getIsTrayIconEnabled().then(k)}),[]);const N=(0,s.hb)((e=>{window.electron?.setIsTrayIconEnabled(e)}),[]);return(0,fe.A)({isActive:e,onBack:c}),(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("Settings")}),(0,ee.Y)(qe.A,{label:m("TextSize"),min:12,max:20,value:t,onChange:f}),(0,ee.Y)(ci.A,{icon:"photo",narrow:!0,onClick:()=>h({screen:a.VS.GeneralChatBackground}),children:m("ChatBackground")}),b.cp&&b.H8&&(0,ee.Y)(un.A,{label:m("SettingsTray"),checked:Boolean(w),onCheck:N})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("Theme")}),(0,ee.Y)(X.A,{name:"theme",options:g,selected:l?"auto":r,onChange:C})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("SettingsTimeFormat")}),(0,ee.Y)(X.A,{name:"timeformat",options:v,selected:o,onChange:y})]}),A&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:m.isRtl?"rtl":void 0,children:m("SettingsKeyboard")}),(0,ee.Y)(X.A,{name:"keyboard-send-settings",options:A,onChange:S,selected:i})]})]})})));var Ch=i(52844),yh=i(74824);const Sh=(0,s.ph)((({wallpaper:e,theme:t,isSelected:i,onClick:n})=>{const{slug:r,document:l}=e,c=`wallpaper${l.id}`,d=l.previewBlobUrl,h=(0,j.A)(`${c}?size=m`),m=(0,Vi.A)(l.thumbnail?.dataUri,Boolean(h),!0),{transitionClassNames:u}=(0,Oe.A)(Boolean(h||d),void 0,void 0,"slow"),p=(0,s.li)(!1),[v,g]=(0,s.J0)(!1),{mediaData:A,loadProgress:b}=(0,z.A)(c,!v),f=!1===(0,V.A)(v),{shouldRender:C,transitionClassNames:y}=(0,Oe.A)(v&&!A||r===a.Vw,void 0,f,"slow"),S=(0,s.li)();S.current=t;const w=(0,s.hb)((()=>{(async()=>{const e=await(0,K.sZ)(A);await yh.save(o.nfi,S.current,e),n(r)})()}),[A,n,r]);(0,s.vJ)((()=>{A&&p.current&&(w(),p.current=!1)}),[A,w]);const k=(0,s.hb)((()=>{A?w():(p.current=!0,g((e=>!e)))}),[A,w]),N=(0,me.A)("WallpaperTile",i&&"selected");return(0,ee.Y)("div",{className:N,onClick:k,children:(0,ee.FD)("div",{className:"media-inner",children:[(0,ee.Y)("canvas",{ref:m,className:"thumbnail"}),(0,ee.Y)("img",{src:h||d,className:(0,me.A)("full-media",u),alt:"",draggable:!1}),C&&(0,ee.Y)("div",{className:(0,me.A)("spinner-container",y),children:(0,ee.Y)(de.A,{progress:b,onClick:k})})]})})})),wh=(0,ve.nF)((e=>e()),6e4,!0),kh=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.SJA)(e),{background:i,isBlurred:s}=(0,c.Gyz)(e,t)||{},{loadedWallpapers:n}=e.settings;return{background:i,isBlurred:s,loadedWallpapers:n,theme:t}}))((({isActive:e,onReset:t,background:i,isBlurred:r,loadedWallpapers:l,theme:c})=>{const{loadWallpapers:d,uploadWallpaper:h,setThemeSettings:m,openSettingsScreen:u}=(0,n.ko)(),p=(0,s.li)();p.current=c,(0,s.vJ)((()=>{wh((()=>{d()}))}),[d]);const v=(0,s.hb)((e=>{const{files:t}=e.target,i=(0,K.kc)(t);i?.length&&h(i[0])}),[h]),g=(0,s.hb)((()=>{(0,Ch.p)("image/jpeg",v,!0)}),[v]),A=(0,s.hb)((()=>{u({screen:a.VS.GeneralChatBackgroundColor})}),[]),b=(0,s.hb)((()=>{m({theme:c,background:void 0,backgroundColor:void 0,isBlurred:!0,patternColor:"dark"===c?o.MkD:o.be8})}),[m,c]),f=(0,s.hb)((e=>{m({theme:p.current,background:e});const t=l&&l.find((t=>t.slug===e));t?.document.thumbnail&&(0,In.rX)(t.document.thumbnail.dataUri).then((e=>{const t=(0,In.Yi)(e),i=`#${(0,In.v2)(e)}`;m({theme:p.current,backgroundColor:i,patternColor:t})}))}),[l,m]),C=(0,s.hb)((e=>{m({theme:p.current,isBlurred:e.target.checked})}),[m]),y=(0,M.A)();(0,fe.A)({isActive:e,onBack:t});const S=l?.[0]&&l[0].slug===a.Vw;return(0,ee.FD)("div",{className:"SettingsGeneralBackground settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{icon:"camera-add",className:"mb-0",disabled:S,onClick:g,children:y("UploadImage")}),(0,ee.Y)(ci.A,{icon:"colorize",className:"mb-0",onClick:A,children:y("SetColor")}),(0,ee.Y)(ci.A,{icon:"favorite",onClick:b,children:y("ThemeResetToDefaults")}),(0,ee.Y)(un.A,{label:y("BackgroundBlurred"),checked:Boolean(r),onChange:C})]}),l?(0,ee.Y)("div",{className:"settings-wallpapers",children:l.map((e=>(0,ee.Y)(Sh,{wallpaper:e,theme:c,isSelected:i===e.slug,onClick:f},e.slug)))}):(0,ee.Y)(zs.A,{})]})}))),Nh=(0,In.bM)((0,In.xp)("e6ebee")),Ih=["#e6ebee","#b2cee1","#008dd0","#c6e7cb","#c4e1a6","#60b16e","#ccd0af","#a6a997","#7a7072","#fdd7af","#fdb76e","#dd8851"];function Ph(e,t){return{colorPosition:[Math.round(e[1]*(t.colorRect.width-1)),Math.round((1-e[2])*(t.colorRect.height-1))],huePosition:Math.round(e[0]*(t.hueRect.width-1))}}function Yh({colorPosition:e,huePosition:t},i){return[t/(i.hueRect.width-1),e[0]/(i.colorRect.width-1),1-e[1]/(i.colorRect.height-1)]}const Fh=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.SJA)(e),{backgroundColor:i}=(0,c.Gyz)(e,t)||{};return{backgroundColor:i,theme:t}}))((({isActive:e,onReset:t,theme:i,backgroundColor:a})=>{const{setThemeSettings:o}=(0,n.ko)(),r=(0,s.li)();r.current=i;const l=(0,s.li)(),c=(0,s.li)(),d=(0,s.li)(),h=(0,s.li)(!0),[m,u]=(0,s.J0)(function(e){return e&&e.startsWith("#")?(0,In.bM)((0,In.xp)(e.replace("#",""))):Nh}(a)),p=(0,s.li)(m);(0,s.vJ)((()=>{p.current=m}),[m]);const[v,g,A]=(0,Y.A)(),[b,f]=(0,s.J0)(""),[C,y]=(0,s.J0)(""),S=(0,s.li)(),w=(0,s.li)();(0,s.vJ)((()=>{const e={offsetLeft:c.current.offsetLeft,...(0,fi.Up)(c.current.getBoundingClientRect(),["top","width","height"])},t={offsetLeft:d.current.offsetLeft,...(0,fi.Up)(d.current.getBoundingClientRect(),["width"])};function i(t){const i=[Math.min(Math.max(0,t.pageX-e.offsetLeft),e.width-1),Math.min(Math.max(0,t.pageY-e.top+l.current.scrollTop),e.height-1)],{huePosition:s}=Ph(p.current,S.current);return u(Yh({colorPosition:i,huePosition:s},S.current)),g(),!0}function s(e){const{colorPosition:i}=Ph(p.current,S.current),s=Math.min(Math.max(0,e.pageX-t.offsetLeft),t.width-1);return u(Yh({colorPosition:i,huePosition:s},S.current)),g(),!0}S.current={colorRect:e,hueRect:t},(0,ue.wJ)(c.current,{onCapture:i,onDrag:i,onRelease:A,onClick:A,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0}),(0,ue.wJ)(d.current,{onCapture:s,onDrag:s,onRelease:A,onClick:A,selectorToPreventScroll:".SettingsGeneralBackgroundColor",withCursor:!0})}),[g,A]);const{colorPosition:k=[0,0],huePosition:N=0}=S.current?Ph(m,S.current):{},I=(0,In.v2)((0,In.Zf)(m)),P=m[0],F=(0,In.v2)((0,In.Zf)([P,1,1]));(0,s.vJ)((()=>{const e=(0,In.Zf)(m),t=`#${(0,In.v2)(e)}`;if(f(e.join(", ")),y(t),!h.current){const i=(0,In.Yi)(e);o({theme:r.current,background:void 0,backgroundColor:t,patternColor:i})}h.current=!1}),[m,o]),(0,s.vJ)((()=>{!function(e,t,i,s){let n,a,o;i.current&&s.current?(n=s.current.colorRect.width,a=s.current.colorRect.height,o=i.current):(n=e.offsetWidth,a=e.offsetHeight,o=e.getContext("2d"),e.width=n,e.height=a,i.current=o);const r=o.createImageData(n,a),l=r.data,c=(0,In.Zf)([t,1,1]);let d=0;for(let e=0;e<a;e++){const t=1-e/(a-1),i=[255*t,255*t,255*t],s=[c[0]*t,c[1]*t,c[2]*t];for(let e=0;e<n;e++){const t=e/(n-1);l[d++]=i[0]+(s[0]-i[0])*t,l[d++]=i[1]+(s[1]-i[1])*t,l[d++]=i[2]+(s[2]-i[2])*t,l[d++]=255}}o.putImageData(r,0,0)}(c.current.firstChild,P,w,S)}),[P]),(0,s.vJ)((()=>{!function(e){const t=e.offsetWidth;e.width=t,e.height=1;const i=e.getContext("2d"),s=i.createImageData(t,1),n=s.data;let a=0;for(let e=0;e<t;e++){const i=e/(t-1),s=(0,In.Zf)([i,1,1]);n[a++]=s[0],n[a++]=s[1],n[a++]=s[2],n[a++]=255}i.putImageData(s,0,0)}(d.current.firstChild)}),[]);const D=(0,s.hb)((e=>{const t=e.currentTarget.value.replace(/[^\d, ]/g,"").slice(0,13);if(t.match(/^\d{1,3},\s?\d{1,3},\s?\d{1,3}$/)){const e=t.split(",").map((e=>Number(e.trim())));u((0,In.bM)(e))}e.currentTarget.value=t}),[]),M=(0,s.hb)((e=>{const t=e.currentTarget.value.replace(/[^0-9a-fA-F]/g,"").slice(0,6);t.match(/^#?[0-9a-fA-F]{6}$/)&&u((0,In.bM)((0,In.xp)(t.replace("#","")))),e.currentTarget.value=t}),[]),T=(0,s.hb)((e=>{u((0,In.bM)((0,In.xp)(e.currentTarget.dataset.color.replace("#",""))))}),[]),B=(0,me.A)("SettingsGeneralBackgroundColor settings-content custom-scroll",v&&"is-dragging");return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{ref:l,className:B,children:[(0,ee.FD)("div",{className:"settings-item pt-3",children:[(0,ee.FD)("div",{ref:c,className:"color-picker",children:[(0,ee.Y)("canvas",{}),(0,ee.Y)("div",{className:"handle",style:`transform: translate(${k[0]}px, ${k[1]}px); background-color: #${I};`})]}),(0,ee.FD)("div",{ref:d,className:"hue-picker",children:[(0,ee.Y)("canvas",{}),(0,ee.Y)("div",{className:"handle",style:`transform: translateX(${N}px); background-color: #${F};`})]}),(0,ee.FD)("div",{className:"tools",children:[(0,ee.Y)(Q.A,{value:C,label:"HEX",onChange:M}),(0,ee.Y)(Q.A,{value:b,label:"RGB",onChange:D})]})]}),(0,ee.Y)("div",{className:"predefined-colors",children:Ih.map((e=>(0,ee.Y)("div",{className:(0,me.A)("predefined-color",e===`#${I}`?"active":void 0),"data-color":e,style:`background-color: ${e};`,onClick:T})))})]})}))),Dh=(0,s.ph)((({currentScreen:e,editedFolderId:t,onReset:i})=>{const{signOut:o,openDeleteChatFolderModal:r,openSettingsScreen:l}=(0,n.ko)(),{isMobile:c}=(0,I.Ay)(),[d,h]=(0,s.J0)(!1),m=function(e,t){const i=(0,s.li)(0),n=(0,s.li)();return(0,s.hb)((()=>{if(i.current++,5===i.current)return i.current=0,void t();n.current&&clearTimeout(n.current),n.current=setTimeout((()=>{i.current=0}),300)}),[5,t])}(0,(()=>{l({screen:a.VS.Experimental})})),u=(0,s.hb)((()=>{h(!0)}),[]),p=(0,s.hb)((()=>{h(!1)}),[]),v=(0,s.hb)((()=>{t&&r({folderId:t})}),[t,r]),g=(0,s.hb)((()=>{p(),o({forceInitApi:!0})}),[p,o]),A=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.Y)(W.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",children:(0,ee.Y)(q.A,{name:"more"})})),[c]),b=(0,M.A)(),f=(0,_i.A)();return(0,ee.FD)("div",{className:"left-header",children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:i,ariaLabel:b("AccDescrGoBack"),children:(0,ee.Y)(q.A,{name:"arrow-left"})}),function(){switch(e){case a.VS.EditProfile:return(0,ee.Y)("h3",{children:b("lng_settings_information")});case a.VS.General:return(0,ee.Y)("h3",{children:b("General")});case a.VS.QuickReaction:return(0,ee.Y)("h3",{children:b("DoubleTapSetting")});case a.VS.CustomEmoji:return(0,ee.Y)("h3",{children:b("Emoji")});case a.VS.Notifications:return(0,ee.Y)("h3",{children:b("Notifications")});case a.VS.DataStorage:return(0,ee.Y)("h3",{children:b("DataSettings")});case a.VS.Privacy:return(0,ee.Y)("h3",{children:b("PrivacySettings")});case a.VS.Language:return(0,ee.Y)("h3",{children:b("Language")});case a.VS.DoNotTranslate:return(0,ee.Y)("h3",{children:b("DoNotTranslate")});case a.VS.Stickers:return(0,ee.Y)("h3",{children:b("StickersName")});case a.VS.Experimental:return(0,ee.Y)("h3",{children:b("lng_settings_experimental")});case a.VS.GeneralChatBackground:return(0,ee.Y)("h3",{children:b("ChatBackground")});case a.VS.GeneralChatBackgroundColor:return(0,ee.Y)("h3",{children:b("SetColor")});case a.VS.PrivacyPhoneNumber:return(0,ee.Y)("h3",{children:b("PrivacyPhone")});case a.VS.PrivacyLastSeen:return(0,ee.Y)("h3",{children:b("PrivacyLastSeen")});case a.VS.PrivacyProfilePhoto:return(0,ee.Y)("h3",{children:b("Privacy.ProfilePhoto")});case a.VS.PrivacyBio:return(0,ee.Y)("h3",{children:b("PrivacyBio")});case a.VS.PrivacyBirthday:return(0,ee.Y)("h3",{children:b("PrivacyBirthday")});case a.VS.PrivacyGifts:return(0,ee.Y)("h3",{children:f("PrivacyGifts")});case a.VS.PrivacyForwarding:return(0,ee.Y)("h3",{children:b("PrivacyForwards")});case a.VS.PrivacyVoiceMessages:return(0,ee.Y)("h3",{children:b("PrivacyVoiceMessages")});case a.VS.PrivacyMessages:return(0,ee.Y)("h3",{children:b("PrivacyMessages")});case a.VS.PrivacyGroupChats:return(0,ee.Y)("h3",{children:b("AutodownloadGroupChats")});case a.VS.PrivacyPhoneCall:return(0,ee.Y)("h3",{children:b("Calls")});case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyGroupChatsAllowedContacts:return(0,ee.Y)("h3",{children:b("AlwaysShareWith")});case a.VS.PrivacyLastSeenDeniedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:case a.VS.PrivacyBioDeniedContacts:case a.VS.PrivacyGroupChatsDeniedContacts:return(0,ee.Y)("h3",{children:b("NeverShareWith")});case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneP2PAllowedContacts:return(0,ee.Y)("h3",{children:b("AlwaysAllow")});case a.VS.PrivacyPhoneNumberDeniedContacts:case a.VS.PrivacyBirthdayDeniedContacts:case a.VS.PrivacyGiftsDeniedContacts:case a.VS.PrivacyForwardingDeniedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:return(0,ee.Y)("h3",{children:b("NeverAllow")});case a.VS.PrivacyNoPaidMessages:return(0,ee.Y)("h3",{children:f("RemoveFeeTitle")});case a.VS.Performance:return(0,ee.Y)("h3",{children:f("MenuAnimations")});case a.VS.ActiveSessions:return(0,ee.Y)("h3",{children:b("SessionsTitle")});case a.VS.ActiveWebsites:return(0,ee.Y)("h3",{children:b("OtherWebSessions")});case a.VS.PrivacyBlockedUsers:return(0,ee.Y)("h3",{children:b("BlockedUsers")});case a.VS.TwoFaDisabled:case a.VS.TwoFaEnabled:return(0,ee.Y)("h3",{children:b("TwoStepVerification")});case a.VS.TwoFaNewPassword:case a.VS.TwoFaChangePasswordNew:case a.VS.TwoFaChangePasswordConfirm:return(0,ee.Y)("h3",{children:b("PleaseEnterCurrentPassword")});case a.VS.TwoFaNewPasswordConfirm:return(0,ee.Y)("h3",{children:b("PleaseReEnterPassword")});case a.VS.TwoFaNewPasswordHint:case a.VS.TwoFaChangePasswordHint:return(0,ee.Y)("h3",{children:b("PasswordHint")});case a.VS.TwoFaNewPasswordEmail:case a.VS.TwoFaRecoveryEmail:return(0,ee.Y)("h3",{children:b("RecoveryEmailTitle")});case a.VS.TwoFaNewPasswordEmailCode:case a.VS.TwoFaRecoveryEmailCode:return(0,ee.Y)("h3",{children:"Recovery Email Code"});case a.VS.TwoFaCongratulations:return(0,ee.Y)("h3",{children:b("TwoStepVerificationPasswordSet")});case a.VS.TwoFaChangePasswordCurrent:case a.VS.TwoFaTurnOff:case a.VS.TwoFaRecoveryEmailCurrentPassword:return(0,ee.Y)("h3",{children:b("PleaseEnterCurrentPassword")});case a.VS.PasscodeDisabled:case a.VS.PasscodeEnabled:case a.VS.PasscodeNewPasscode:case a.VS.PasscodeNewPasscodeConfirm:case a.VS.PasscodeCongratulations:return(0,ee.Y)("h3",{children:b("Passcode")});case a.VS.PasscodeTurnOff:return(0,ee.Y)("h3",{children:b("PasscodeController.Disable.Title")});case a.VS.PasscodeChangePasscodeCurrent:case a.VS.PasscodeChangePasscodeNew:return(0,ee.Y)("h3",{children:b("PasscodeController.Change.Title")});case a.VS.PasscodeChangePasscodeConfirm:return(0,ee.Y)("h3",{children:b("PasscodeController.ReEnterPasscode.Placeholder")});case a.VS.Folders:return(0,ee.Y)("h3",{children:b("Filters")});case a.VS.FoldersCreateFolder:return(0,ee.Y)("h3",{children:b("FilterNew")});case a.VS.FoldersShare:return(0,ee.Y)("h3",{children:b("FolderLinkScreen.Title")});case a.VS.FoldersEditFolder:case a.VS.FoldersEditFolderFromChatList:case a.VS.FoldersEditFolderInvites:return(0,ee.FD)("div",{className:"settings-main-header",children:[(0,ee.Y)("h3",{children:b("FilterEdit")}),Boolean(t)&&(0,ee.Y)(le.A,{className:"settings-more-menu",trigger:A,positionX:"right",children:(0,ee.Y)(ce.A,{icon:"delete",destructive:!0,onClick:v,children:b("Delete")})})]});case a.VS.FoldersIncludedChats:case a.VS.FoldersIncludedChatsFromChatList:case a.VS.FoldersExcludedChats:case a.VS.FoldersExcludedChatsFromChatList:return(0,ee.Y)("h3",{children:b(e===a.VS.FoldersIncludedChats||e===a.VS.FoldersIncludedChatsFromChatList?"FilterInclude":"FilterExclude")});default:return(0,ee.FD)("div",{className:"settings-main-header",children:[(0,ee.Y)("h3",{onClick:m,children:b("SETTINGS")}),(0,ee.Y)(W.A,{round:!0,ripple:!c,size:"smaller",color:"translucent",onClick:()=>l({screen:a.VS.EditProfile}),ariaLabel:b("lng_settings_information"),children:(0,ee.Y)(q.A,{name:"edit"})}),(0,ee.Y)(le.A,{className:"settings-more-menu",trigger:A,positionX:"right",children:(0,ee.Y)(ce.A,{icon:"logout",onClick:u,children:b("LogOutTitle")})})]})}}(),(0,ee.Y)(vi.A,{isOpen:d,onClose:p,text:b("lng_sure_logout"),confirmLabel:b("AccountSettings.Logout"),confirmHandler:g,confirmIsDestructive:!0})]})})),Mh=(0,s.ph)((0,n.EK)((e=>{const{canTranslate:t,canTranslateChats:i,doNotTranslate:s}=e.settings.byKey,{language:n,languages:a}=(0,Nn.l)(e);return{isCurrentUserPremium:(0,c.g29)(e),languages:a,language:n,canTranslate:t,canTranslateChats:i,doNotTranslate:s}}))((({isActive:e,isCurrentUserPremium:t,languages:i,language:o,canTranslate:r,canTranslateChats:l,doNotTranslate:c,onReset:d})=>{const{loadLanguages:h,setSettingOption:m,setSharedSettingOption:u,openPremiumModal:p,openSettingsScreen:v}=(0,n.ko)(),[g,A]=(0,s.J0)(o),[f,C,y]=(0,Y.A)(),S=t&&l,w=(0,M.A)();(0,s.vJ)((()=>{i?.length||h()}),[i]);const k=(0,D.A)((e=>{A(e),C(),(0,Ah.wT)(e,(()=>{y(),u({language:e})}))})),N=(0,s.Kr)((()=>{if(!i)return;const e=(window.navigator.language||"en").toLowerCase(),t=e.substr(0,2);return i.map((({langCode:e,nativeName:t,name:i})=>({value:e,label:t,subLabel:i,isLoading:e===g&&f}))).sort((i=>!e||i.value!==e&&i.value!==t?0:-1))}),[f,i,g]),I=(0,D.A)((e=>{m({canTranslate:e})})),P=(0,D.A)((e=>{m({canTranslateChats:e})})),F=(0,D.A)((()=>{t||p({initialSection:"translations"})})),T=(0,s.Kr)((()=>{if(b.CM&&c.length)return 1===c.length?new Intl.DisplayNames([o],{type:"language"}).of(c[0]):w("Languages",c.length)}),[c,w,o]),B=(0,D.A)((()=>{v({screen:a.VS.DoNotTranslate})}));return(0,fe.A)({isActive:e,onBack:d}),(0,ee.FD)("div",{className:"settings-content settings-language custom-scroll",children:[b.CM&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(un.A,{label:w("ShowTranslateButton"),checked:r,onCheck:I}),(0,ee.Y)(un.A,{label:w("ShowTranslateChatButton"),checked:S,disabled:!t,rightIcon:t?void 0:"lock",onClickLabel:F,onCheck:P}),(r||S)&&(0,ee.FD)(ci.A,{narrow:!0,onClick:B,children:[w("DoNotTranslate"),(0,ee.Y)("span",{className:"settings-item__current-value",children:T})]}),(0,ee.Y)("p",{className:"settings-item-description mb-0 mt-1",children:w("lng_translate_settings_about")})]}),(0,ee.FD)("div",{className:"settings-item settings-item-picker",children:[(0,ee.Y)("h4",{className:"settings-item-header",children:w("Localization.InterfaceLanguage")}),N?(0,ee.Y)(Bo,{items:N,selectedValue:g,forceRenderAllItems:!0,onSelectedValueChange:k,itemInputType:"radio",className:"settings-picker"}):(0,ee.Y)(zs.A,{})]})]})})));var Th=i(86046),Bh=i(44784),Rh=i(70195);const Lh=(0,s.ph)((0,n.EK)((e=>{const{currentUserId:t}=e,i=(0,c.hc)(e),s=e.stars?.balance;return{sessionCount:e.activeSessions.orderedHashes.length,currentUserId:t,canBuyPremium:!(0,c.n_C)(e),isGiveawayAvailable:i,starsBalance:s}}))((({isActive:e,currentUserId:t,sessionCount:i,canBuyPremium:r,isGiveawayAvailable:l,starsBalance:c,onReset:d})=>{const{loadMoreProfilePhotos:h,openPremiumModal:m,openSupportChat:u,openUrl:p,openGiftRecipientPicker:v,openStarsBalanceModal:g,openSettingsScreen:A}=(0,n.ko)(),[b,f,C]=(0,Y.A)(!1),y=(0,_i.A)();(0,s.vJ)((()=>{t&&h({peerId:t,isPreload:!0})}),[t]),(0,fe.A)({isActive:e,onBack:d});const S=(0,D.A)((()=>{u(),C()}));return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-main-menu self-profile",children:[t&&(0,ee.Y)(Rh.A,{peerId:t,canPlayVideo:Boolean(e),forceShowSelf:!0}),t&&(0,ee.Y)(Bh.A,{chatOrUserId:t,isInSettings:!0})]}),(0,ee.FD)("div",{className:"settings-main-menu",children:[(0,ee.Y)(ci.A,{icon:"settings",narrow:!0,onClick:()=>A({screen:a.VS.General}),children:y("TelegramGeneralSettingsViewController")}),(0,ee.Y)(ci.A,{icon:"animations",narrow:!0,onClick:()=>A({screen:a.VS.Performance}),children:y("MenuAnimations")}),(0,ee.Y)(ci.A,{icon:"unmute",narrow:!0,onClick:()=>A({screen:a.VS.Notifications}),children:y("Notifications")}),(0,ee.Y)(ci.A,{icon:"data",narrow:!0,onClick:()=>A({screen:a.VS.DataStorage}),children:y("DataSettings")}),(0,ee.Y)(ci.A,{icon:"lock",narrow:!0,onClick:()=>A({screen:a.VS.Privacy}),children:y("PrivacySettings")}),(0,ee.Y)(ci.A,{icon:"folder",narrow:!0,onClick:()=>A({screen:a.VS.Folders}),children:y("Filters")}),(0,ee.FD)(ci.A,{icon:"active-sessions",narrow:!0,onClick:()=>A({screen:a.VS.ActiveSessions}),children:[y("SessionsTitle"),i>0&&(0,ee.Y)("span",{className:"settings-item__current-value",children:i})]}),(0,ee.FD)(ci.A,{icon:"language",narrow:!0,onClick:()=>A({screen:a.VS.Language}),children:[y("Language"),(0,ee.Y)("span",{className:"settings-item__current-value",children:y.languageInfo.nativeName})]}),(0,ee.Y)(ci.A,{icon:"stickers",narrow:!0,onClick:()=>A({screen:a.VS.Stickers}),children:y("MenuStickers")})]}),(0,ee.FD)("div",{className:"settings-main-menu",children:[r&&(0,ee.Y)(ci.A,{leftElement:(0,ee.Y)(Vd.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),narrow:!0,onClick:()=>m(),children:y("TelegramPremium")}),(0,ee.FD)(ci.A,{leftElement:(0,ee.Y)(Vd.A,{className:"icon ListItem-main-icon",type:"gold",size:"big"}),narrow:!0,onClick:()=>g({}),children:[y("MenuStars"),Boolean(c)&&(0,ee.Y)("span",{className:"settings-item__current-value",children:(0,Th.ZF)(y,c)})]}),l&&(0,ee.Y)(ci.A,{icon:"gift",narrow:!0,onClick:()=>v(),children:y("MenuSendGift")})]}),(0,ee.FD)("div",{className:"settings-main-menu",children:[(0,ee.Y)(ci.A,{icon:"ask-support",narrow:!0,onClick:f,children:y("AskAQuestion")}),(0,ee.Y)(ci.A,{icon:"help",narrow:!0,onClick:()=>p({url:o.r9K}),children:y("MenuTelegramFaq")}),(0,ee.Y)(ci.A,{icon:"privacy-policy",narrow:!0,onClick:()=>p({url:o.pkx}),children:y("MenuPrivacyPolicy")})]}),(0,ee.Y)(vi.A,{isOpen:b,confirmLabel:y("OK"),title:y("AskAQuestion"),textParts:y("MenuAskText",void 0,{withNodes:!0,renderTextFilters:["br"]}),confirmHandler:S,onClose:C})]})})));var xh=i(5560),Eh=i(56133);const Vh=(0,s.ph)((0,n.EK)((e=>({hasContactJoinedNotifications:Boolean(e.settings.byKey.hasContactJoinedNotifications),hasWebNotifications:e.settings.byKey.hasWebNotifications,hasPushNotifications:e.settings.byKey.hasPushNotifications,notificationSoundVolume:e.settings.byKey.notificationSoundVolume})))((({isActive:e,onReset:t,notifyDefaults:i,hasContactJoinedNotifications:a,hasPushNotifications:o,hasWebNotifications:r,notificationSoundVolume:l})=>{const{loadNotificationSettings:c,updateContactSignUpNotification:d,updateNotificationSettings:h,updateWebNotificationSettings:m}=(0,n.ko)();(0,s.vJ)((()=>{c()}),[c]);const u=(0,Eh.A)(500,!0),p=(0,xh.M2)(),v=p&&!(0,xh.Ac)(),g=(0,s.hb)(((e,t,s)=>{const n=Boolean(i?.[t]?.mutedUntil),a=Boolean(i?.[t]?.shouldShowPreviews);h({peerType:t,isMuted:"mute"===s?!e.target.checked:n,shouldShowPreviews:"showPreviews"===s?e.target.checked:a})}),[i]),A=(0,s.hb)((e=>{const t=e.target.checked;m({hasWebNotifications:t,...!t&&{hasPushNotifications:!1}})}),[m]),b=(0,s.hb)((e=>{m({hasPushNotifications:e.target.checked})}),[m]),f=(0,s.hb)((e=>{g(e,"users","mute")}),[g]),C=(0,s.hb)((e=>{g(e,"users","showPreviews")}),[g]),y=(0,s.hb)((e=>{g(e,"groups","mute")}),[g]),S=(0,s.hb)((e=>{g(e,"groups","showPreviews")}),[g]),w=(0,s.hb)((e=>{g(e,"channels","mute")}),[g]),k=(0,s.hb)((e=>{g(e,"channels","showPreviews")}),[g]),N=(0,s.hb)((e=>{d({isSilent:!e.target.checked})}),[d]),I=(0,s.hb)((e=>{m({notificationSoundVolume:e}),u((()=>(0,xh.BA)(void 0,e)))}),[u,m]),P=(0,_i.A)();return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0,children:P("NotificationsWeb")}),(0,ee.Y)(un.A,{label:P("NotificationsWeb"),subLabel:P(r?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:r,disabled:!p,onChange:A}),(0,ee.Y)(un.A,{label:P("NotificationsOffline"),disabled:!r||!v,subLabel:P(v?o?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled":"SettingsOfflineNotificationUnsupported"),checked:o,onChange:b}),(0,ee.Y)("div",{className:"settings-item-slider",children:(0,ee.Y)(qe.A,{label:P("NotificationsSound"),min:0,max:10,disabled:!p,value:l,onChange:I})})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0,children:P("AutodownloadPrivateChats")}),(0,ee.Y)(un.A,{label:P("NotificationsForPrivateChats"),subLabel:P(i?.users?.mutedUntil?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.users?.mutedUntil),onChange:f}),(0,ee.Y)(un.A,{label:P("MessagePreview"),disabled:!i?.users?.mutedUntil,subLabel:P(i?.users?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.users?.shouldShowPreviews),onChange:C})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0,children:P("FilterGroups")}),(0,ee.Y)(un.A,{label:P("NotificationsForGroups"),subLabel:P(i?.groups?.mutedUntil?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.groups?.mutedUntil),onChange:y}),(0,ee.Y)(un.A,{label:P("MessagePreview"),disabled:!i?.groups?.mutedUntil,subLabel:P(i?.groups?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.groups?.shouldShowPreviews),onChange:S})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0,children:P("FilterChannels")}),(0,ee.Y)(un.A,{label:P("NotificationsForChannels"),subLabel:P(i?.channels?.mutedUntil?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.channels?.mutedUntil),onChange:w}),(0,ee.Y)(un.A,{label:P("MessagePreview"),disabled:!i?.channels?.mutedUntil,subLabel:P(i?.channels?.shouldShowPreviews?"UserInfoNotificationsEnabled":"UserInfoNotificationsDisabled"),checked:Boolean(i?.channels?.shouldShowPreviews),onChange:k})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:P.isRtl?"rtl":void 0,children:P("PhoneOther")}),(0,ee.Y)(un.A,{label:P("ContactJoined"),checked:a,onChange:N})]})]})})));var _h=i(20714),Uh=i(22986);const Oh=["SettingsPerformanceSliderLow","SettingsPerformanceSliderMedium","SettingsPerformanceSliderHigh"],Kh=["SettingsPerformanceSliderLow","SettingsPerformanceSliderCustom","SettingsPerformanceSliderHigh"],Jh=[["SettingsPerformanceInterfaceAnimations",[{key:"pageTransitions",label:"SettingsPerformancePageTransitions"},{key:"messageSendingAnimations",label:"SettingsPerformanceSending"},{key:"mediaViewerAnimations",label:"SettingsPerformanceMediaViewer"},{key:"messageComposerAnimations",label:"SettingsPerformanceComposer"},{key:"contextMenuAnimations",label:"SettingsPerformanceContextAnimation"},{key:"contextMenuBlur",label:"SettingsPerformanceContextBlur",disabled:!b.Fy},{key:"rightColumnAnimations",label:"SettingsPerformanceRightColumn"},{key:"snapEffect",label:"SettingsPerformanceThanos"}]],["SettingsPerformanceStickers",[{key:"animatedEmoji",label:"SettingsPerformanceAnimatedEmoji"},{key:"loopAnimatedStickers",label:"SettingsPerformanceLoopStickers"},{key:"reactionEffects",label:"SettingsPerformanceReactionEffects"},{key:"stickerEffects",label:"SettingsPerformanceStickerEffects"}]],["SettingsPerformanceMediaAutoplay",[{key:"autoplayGifs",label:"SettingsPerformanceAutoplayGif"},{key:"autoplayVideos",label:"SettingsPerformanceAutoplayVideo"}]]],Gh=(0,s.ph)((0,n.EK)((e=>({performanceSettings:(0,c.Cw0)(e)})))((function({isActive:e,performanceSettings:t,onReset:i}){const{setSharedSettingOption:a,updatePerformanceSettings:r}=(0,n.ko)();(0,fe.A)({isActive:e,onBack:i});const l=(0,_i.A)(),[c,d]=(0,s.J0)({}),h=(0,s.Kr)((()=>Jh.reduce(((e,[,i],s)=>(e[s]=i.every((({key:e})=>t[e])),e)),{})),[t]),m=(0,s.Kr)((()=>(0,Uh.T)(t,_h.LH)?o.zP3:(0,Uh.T)(t,_h.PI)?o.dnp:(0,Uh.T)(t,_h.PX)?o.zHL:o.M8B),[t]),u=(0,s.Kr)((()=>(m===o.M8B?Kh:Oh).map((e=>l(e)))),[m,l]),p=(0,s.hb)(((e,t)=>{e.preventDefault();const i=Number(t);d((e=>({...e,[i]:!e[i]})))}),[]),v=(0,s.hb)((e=>{const t=e===o.dnp?_h.PI:e===o.zHL?_h.PX:_h.LH;a({animationLevel:e}),r(t)}),[]),g=(0,s.hb)((e=>{const{name:t,checked:i}=e.target,s=Jh.find((([e])=>e===t));if(!s)return;const n=s[1].reduce(((e,{key:t})=>(e[t]=i,e)),{});r(n)}),[]),A=(0,s.hb)((e=>{const{name:t,checked:i}=e.target;r({[t]:i})}),[]);return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("SettingsPerformanceSliderTitle")}),(0,ee.Y)("p",{className:"settings-item-description",dir:l.isRtl?"rtl":void 0,children:l("SettingsPerformanceSliderSubtitle")}),(0,ee.Y)(qe.A,{options:u,value:m===o.M8B?o.zHL:m,onChange:v})]}),(0,ee.FD)("div",{className:"settings-item-simple settings-item__with-shifted-dropdown",children:[(0,ee.Y)("h3",{className:"settings-item-header",dir:"auto",children:"Resource-Intensive Processes"}),Jh.map((([e,i],s)=>(0,ee.FD)("div",{className:"settings-dropdown-section",children:[(0,ee.Y)("div",{className:"ListItem with-checkbox",children:(0,ee.Y)(un.A,{name:e,value:s.toString(),checked:h[s],label:l(e),rightIcon:c[s]?"up":"down",onChange:g,onClickLabel:p})}),Boolean(c[s])&&(0,ee.Y)("div",{className:"DropdownList DropdownList--open",children:i.map((({key:e,label:i,disabled:s})=>{if("snapEffect"!==e||b.bW)return(0,ee.Y)(un.A,{name:e,checked:t[e],label:l(i),disabled:s,onChange:A},e)}))})]},e)))]})]})}))),jh=(0,s.ph)((0,n.EK)((e=>{const{settings:{byKey:{hasPassword:t,isSensitiveEnabled:i,canChangeSensitive:s,shouldArchiveAndMuteNewNonContact:n,shouldNewNonContactPeersRequirePremium:a,nonContactPeersPaidStars:o},privacy:r,accountDaysTtl:l},blocked:d,passcode:{hasPasscode:h},appConfig:m}=e,{canDisplayChatInTitle:u}=(0,Nn.l)(e),p=Boolean(o),v=(0,c.trm)(e);return{isCurrentUserPremium:(0,c.g29)(e),hasPassword:t,hasPasscode:Boolean(h),blockedCount:d.totalCount,webAuthCount:e.activeWebSessions.orderedHashes.length,isSensitiveEnabled:i,canDisplayAutoarchiveSetting:Boolean(m?.canDisplayAutoarchiveSetting),shouldArchiveAndMuteNewNonContact:n,canChangeSensitive:s,shouldNewNonContactPeersRequirePremium:a,shouldChargeForMessages:p,privacy:r,canDisplayChatInTitle:u,canSetPasscode:(0,c.Ntz)(e),isCurrentUserFrozen:v,accountDaysTtl:l}}))((({isActive:e,isCurrentUserPremium:t,hasPassword:i,hasPasscode:r,blockedCount:l,webAuthCount:c,isSensitiveEnabled:d,canChangeSensitive:h,canDisplayAutoarchiveSetting:m,shouldArchiveAndMuteNewNonContact:u,shouldNewNonContactPeersRequirePremium:p,shouldChargeForMessages:v,canDisplayChatInTitle:g,canSetPasscode:A,privacy:b,onReset:f,isCurrentUserFrozen:C,accountDaysTtl:y})=>{const{openDeleteAccountModal:S,loadPrivacySettings:w,loadBlockedUsers:k,loadContentSettings:N,updateContentSettings:I,loadGlobalPrivacySettings:P,updateGlobalPrivacySettings:Y,loadWebAuthorizations:F,setSharedSettingOption:T,openSettingsScreen:B,loadAccountDaysTtl:R}=(0,n.ko)();(0,s.vJ)((()=>{C||(k(),w(),N(),F())}),[C]),(0,s.vJ)((()=>{e&&!C&&(P(),R())}),[e,C,P]);const L=(0,M.A)(),x=(0,_i.A)();(0,fe.A)({isActive:e,onBack:f});const E=(0,s.hb)((e=>{Y({shouldArchiveAndMuteNewNonContact:e})}),[Y]),V=(0,s.hb)((e=>{T({canDisplayChatInTitle:e})}),[]),_=(0,s.hb)((e=>{I({isSensitiveEnabled:e})}),[I]),U=(0,D.A)((()=>{y&&S({days:y})})),O=(0,s.Kr)((()=>{if(y)return rl(o.WF4,y/30).toString()}),[y]);function K(e){if(!e)return L("Loading");const{visibility:t,shouldAllowPremium:i,botsPrivacy:s}=e,n="everybody"===t,a="allow"===s&&!n,o=e.blockChatIds.length+e.blockUserIds.length,r=e.allowChatIds.length+e.allowUserIds.length,l=[];o&&l.push(`-${o}`),r&&!n&&l.push(`+${r}`);const c=[a?x("PrivacyValueBots"):"",x.conjunction(l)].filter(Boolean).join(" ");if(a&&!n)return c;if(i)return L(c?"ContactsAndPremium":"PrivacyPremium");switch(t){case"everybody":return`${L("P2PEverybody")} ${c}`;case"contacts":return`${L("P2PContacts")} ${c}`;case"nobody":return`${L("P2PNobody")} ${c}`}}return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.FD)(ci.A,{icon:"delete-user",narrow:!0,onClick:()=>B({screen:a.VS.PrivacyBlockedUsers}),children:[L("BlockedUsers"),(0,ee.Y)("span",{className:"settings-item__current-value",children:l||""})]}),A&&(0,ee.Y)(ci.A,{icon:"key",narrow:!0,onClick:()=>B({screen:r?a.VS.PasscodeEnabled:a.VS.PasscodeDisabled}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("Passcode")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:L(r?"PasswordOn":"PasswordOff")})]})}),(0,ee.Y)(ci.A,{icon:"lock",narrow:!0,onClick:()=>B({screen:i?a.VS.TwoFaEnabled:a.VS.TwoFaDisabled}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("TwoStepVerification")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:L(i?"PasswordOn":"PasswordOff")})]})}),c>0&&(0,ee.FD)(ci.A,{icon:"web",narrow:!0,onClick:()=>B({screen:a.VS.ActiveWebsites}),children:[L("PrivacySettings.WebSessions"),(0,ee.Y)("span",{className:"settings-item__current-value",children:c})]})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:L.isRtl?"rtl":void 0,children:L("PrivacyTitle")}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyPhoneNumber}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyPhoneTitle")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.phoneNumber)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyLastSeen}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("LastSeenTitle")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.lastSeen)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyProfilePhoto}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyProfilePhotoTitle")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.profilePhoto)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyBio}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyBio")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.bio)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyBirthday}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyBirthday")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.birthday)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyGifts}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:x("PrivacyGifts")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.gifts)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyForwarding}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyForwardsTitle")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.forwards)})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyPhoneCall}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("WhoCanCallMe")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.phoneCall)})]})}),(0,ee.Y)(ci.A,{narrow:!0,allowDisabledClick:!0,rightElement:t&&(0,ee.Y)(Vd.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyVoiceMessages}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyVoiceMessagesTitle")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.voiceMessages)})]})}),(0,ee.Y)(ci.A,{narrow:!0,rightElement:t&&(0,ee.Y)(Vd.A,{size:"big",type:"premium"}),className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyMessages}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("PrivacyMessagesTitle")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:v?x("PrivacyPaidMessagesValue"):L(p?"PrivacyMessagesContactsAndPremium":"P2PEverybody")})]})}),(0,ee.Y)(ci.A,{narrow:!0,className:"no-icon",onClick:()=>B({screen:a.VS.PrivacyGroupChats}),children:(0,ee.FD)("div",{className:"multiline-item",children:[(0,ee.Y)("span",{className:"title",children:L("WhoCanAddMe")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:K(b.chatInvite)})]})})]}),h&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:L.isRtl?"rtl":void 0,children:L("lng_settings_sensitive_title")}),(0,ee.Y)(un.A,{label:L("lng_settings_sensitive_disable_filtering"),subLabel:L("lng_settings_sensitive_about"),checked:Boolean(d),disabled:!h,onCheck:_})]}),m&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:L.isRtl?"rtl":void 0,children:L("NewChatsFromNonContacts")}),(0,ee.Y)(un.A,{label:L("ArchiveAndMute"),subLabel:L("ArchiveAndMuteInfo"),checked:Boolean(u),onCheck:E})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:L.isRtl?"rtl":void 0,children:L("lng_settings_window_system")}),(0,ee.Y)(un.A,{label:L("lng_settings_title_chat_name"),checked:Boolean(g),onCheck:V})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:L.isRtl?"rtl":void 0,children:x("DeleteMyAccount")}),(0,ee.FD)(ci.A,{narrow:!0,onClick:U,children:[x("DeleteAccountIfAwayFor"),(0,ee.Y)("span",{className:"settings-item__current-value",children:x("Months",{count:O},{pluralValue:1})})]})]})]})}))),zh=(0,s.ph)((0,n.EK)((e=>{const{users:{byId:t},blocked:{ids:i},contactList:s,currentUserId:n}=e;return{usersById:t,blockedIds:i,contactIds:s?.userIds,localContactIds:(0,c.nTw)(e).userSearch.localUserIds,currentUserId:n}}))((({usersById:e,blockedIds:t,contactIds:i,localContactIds:a,currentUserId:o,isOpen:r,onClose:c})=>{const{setUserSearchQuery:d,blockUser:h}=(0,n.ko)(),m=(0,M.A)(),[u,p]=(0,s.J0)("");(0,s.vJ)((()=>{d({query:u})}),[u,d]);const v=(0,s.Kr)((()=>{const s=(0,fi.Am)([...i||[],...a||[]].filter((e=>e!==o&&!t.includes(e))));return(0,Yt.PU)({ids:s,query:u,type:"user"}).sort(((t,i)=>{const s=(0,l.Yg)(e[t])||"",n=(0,l.Yg)(e[i])||"";return s.localeCompare(n)}))}),[t,i,o,u,a,e]),g=(0,s.hb)((e=>{h({userId:e}),c()}),[c]);return(0,ee.Y)(Zs,{isOpen:r,chatOrUserIds:v,searchPlaceholder:m("BlockedUsers.BlockUser"),search:u,onSearchChange:p,onSelectChatOrUser:g,onClose:c})}))),Hh=(0,s.ph)((0,n.EK)((e=>{const{chats:{byId:t},users:{byId:i},blocked:{ids:s},countryList:{phoneCodes:n}}=e;return{chatsByIds:t,usersByIds:i,blockedIds:s,phoneCodeList:n}}))((({isActive:e,onReset:t,chatsByIds:i,usersByIds:a,blockedIds:r,phoneCodeList:c})=>{const{unblockUser:d}=(0,n.ko)(),h=(0,M.A)(),[m,p,v]=(0,Y.A)(),g=(0,s.hb)((e=>{d({userId:e})}),[d]);(0,fe.A)({isActive:e,onBack:t});const A=(0,s.Kr)((()=>r.reduce(((e,t)=>{const i=(0,u.L8)(t)?a[t]:void 0,s=i&&!i.phoneNumber&&(0,l.Kl)(i);return s&&(e[t]=s),e}),{})),[r,a]);return(0,ee.FD)("div",{className:"settings-fab-wrapper",children:[(0,ee.FD)("div",{className:"settings-content infinite-scroll",children:[(0,ee.Y)("div",{className:"settings-item no-border",children:(0,ee.Y)("p",{className:"settings-item-description-larger mt-0 mb-2",dir:h.isRtl?"rtl":void 0,children:h("BlockedUsersInfo")})}),(0,ee.Y)("div",{className:"chat-list custom-scroll",children:r?.length?(0,ee.Y)("div",{className:"scroll-container settings-item",children:r.map(((e,t)=>function(e,t){const s=(0,u.L8)(e),n=a[e],r=i[e],l=n||r,d=(0,me.A)("Chat chat-item-clickable blocked-list-item small-icon",s?"private":"group"),h=A[e];return(0,ee.FD)(ci.A,{className:d,ripple:!0,narrow:!0,contextActions:[{title:"Unblock",icon:"unlock",handler:()=>{g(e)}}],style:`top: ${(0+t)*o.yq1}px;`,children:[(0,ee.Y)(Dt.A,{size:"medium",peer:l}),(0,ee.FD)("div",{className:"contact-info",dir:"auto",children:[l&&(0,ee.Y)(Hs.A,{peer:l}),n?.phoneNumber&&(0,ee.Y)("div",{className:"contact-phone",dir:"auto",children:(0,Sn.Ox)(c,n.phoneNumber)}),h&&(0,ee.FD)("div",{className:"contact-username",dir:"auto",children:["@",h]})]})]},`blocked_${e}`)}(e,t)))}):r&&!r.length?(0,ee.Y)("div",{className:"no-results",dir:"auto",children:h("NoBlocked")}):(0,ee.Y)(zs.A,{},"loading")})]}),(0,ee.Y)(ki.A,{isShown:!0,className:"block-user-button",onClick:p,ariaLabel:h("BlockContact"),children:(0,ee.Y)(q.A,{name:"add"})}),(0,ee.Y)(zh,{isOpen:m,onClose:v})]})})));function $h(e){switch(e){case a.VS.PrivacyPhoneNumber:case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyPhoneNumberDeniedContacts:return"phoneNumber";case a.VS.PrivacyLastSeen:case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyLastSeenDeniedContacts:return"lastSeen";case a.VS.PrivacyProfilePhoto:case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:return"profilePhoto";case a.VS.PrivacyBio:case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyBioDeniedContacts:return"bio";case a.VS.PrivacyBirthday:case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyBirthdayDeniedContacts:return"birthday";case a.VS.PrivacyGifts:case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyGiftsDeniedContacts:return"gifts";case a.VS.PrivacyForwarding:case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyForwardingDeniedContacts:return"forwards";case a.VS.PrivacyVoiceMessages:case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:return"voiceMessages";case a.VS.PrivacyGroupChats:case a.VS.PrivacyGroupChatsAllowedContacts:case a.VS.PrivacyGroupChatsDeniedContacts:return"chatInvite";case a.VS.PrivacyPhoneCall:case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:return"phoneCall";case a.VS.PrivacyPhoneP2P:case a.VS.PrivacyPhoneP2PAllowedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:return"phoneP2P";case a.VS.PrivacyAddByPhone:return"addByPhone";case a.VS.PrivacyNoPaidMessages:return"noPaidMessages"}}const qh=(0,s.ph)((0,n.EK)((e=>{const{settings:{byKey:{disallowedGifts:t}}}=e;return{disallowedGifts:t,isCurrentUserPremium:(0,c.g29)(e)}}))((({disallowedGifts:e,isCurrentUserPremium:t})=>{const{showNotification:i,updateGlobalPrivacySettings:s}=(0,n.ko)(),a=(0,_i.A)(),o=(0,D.A)((()=>{i({message:a("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})})),r=(0,D.A)((()=>{t?s({disallowedGifts:{...e,shouldDisallowLimitedStarGifts:!e?.shouldDisallowLimitedStarGifts||void 0}}):o()})),l=(0,D.A)((()=>{t?s({disallowedGifts:{...e,shouldDisallowUnlimitedStarGifts:!e?.shouldDisallowUnlimitedStarGifts||void 0}}):o()})),c=(0,D.A)((()=>{t?s({disallowedGifts:{...e,shouldDisallowUniqueStarGifts:!e?.shouldDisallowUniqueStarGifts||void 0}}):o()})),d=(0,D.A)((()=>{t?s({disallowedGifts:{...e,shouldDisallowPremiumGifts:!e?.shouldDisallowPremiumGifts||void 0}}):o()}));return(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:a.isRtl?"rtl":void 0,children:a("PrivacyAcceptedGiftTitle")}),(0,ee.FD)(ci.A,{onClick:r,children:[(0,ee.Y)("span",{children:a("PrivacyGiftLimitedEdition")}),(0,ee.Y)(bi.A,{id:"limited_edition",label:a(e?.shouldDisallowLimitedStarGifts?"PrivacyDisableLimitedEditionStarGifts":"PrivacyEnableLimitedEditionStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowLimitedStarGifts})]}),(0,ee.FD)(ci.A,{onClick:l,children:[(0,ee.Y)("span",{children:a("PrivacyGiftUnlimited")}),(0,ee.Y)(bi.A,{id:"unlimited",label:a(e?.shouldDisallowUnlimitedStarGifts?"PrivacyDisableUnlimitedStarGifts":"PrivacyEnableUnlimitedStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUnlimitedStarGifts})]}),(0,ee.FD)(ci.A,{onClick:c,children:[(0,ee.Y)("span",{children:a("PrivacyGiftUnique")}),(0,ee.Y)(bi.A,{id:"unique",label:a(e?.shouldDisallowUniqueStarGifts?"PrivacyDisableUniqueStarGifts":"PrivacyEnableUniqueStarGifts"),disabled:!t,checked:!t||!e?.shouldDisallowUniqueStarGifts})]}),(0,ee.FD)(ci.A,{onClick:d,children:[(0,ee.Y)("span",{children:a("PrivacyGiftPremiumSubscription")}),(0,ee.Y)(bi.A,{id:"premium_subscription",label:a(e?.shouldDisallowPremiumGifts?"PrivacyDisablePremiumGifts":"PrivacyEnablePremiumGifts"),disabled:!t,checked:!t||!e?.shouldDisallowPremiumGifts})]}),(0,ee.Y)("p",{className:"settings-item-description-larger",dir:a.isRtl?"rtl":void 0,children:a("PrivacyAcceptedGiftInfo")})]})}))),Wh=(0,s.ph)((0,n.EK)((e=>({isCurrentUserPremium:(0,c.g29)(e),shouldHideReadMarks:Boolean((0,c.KIM)(e))})))((({isCurrentUserPremium:e,shouldHideReadMarks:t,visibility:i})=>{const{updateGlobalPrivacySettings:s,openPremiumModal:a}=(0,n.ko)(),o=(0,M.A)(),r="nobody"===i||"contacts"===i,l=(0,D.A)((e=>s({shouldHideReadMarks:e}))),c=(0,D.A)((()=>{a({initialSection:"last_seen"})}));return(0,ee.FD)(ee.FK,{children:[r&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(un.A,{label:o("HideReadTime"),checked:t,onCheck:l}),(0,ee.Y)("p",{className:"settings-item-description-larger",dir:o.isRtl?"rtl":void 0,children:(0,Ft.A)(o("HideReadTimeInfo"),["br"])})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{leftElement:(0,ee.Y)(Vd.A,{className:"icon ListItem-main-icon",type:"premium",size:"big"}),onClick:c,children:o(e?"PrivacyLastSeenPremiumForPremium":"PrivacyLastSeenPremium")}),(0,ee.Y)("p",{className:"settings-item-description-larger premium-info",dir:o.isRtl?"rtl":void 0,children:o(e?"PrivacyLastSeenPremiumInfoForPremium":"PrivacyLastSeenPremiumInfo")})]})]})})));var Qh=i(91356);const Zh=(0,s.ph)((({currentUserId:e,hasCurrentUserFullInfo:t,currentUserFallbackPhoto:i})=>{const{loadFullUser:a,uploadProfilePhoto:o,deleteProfilePhoto:r,showNotification:l}=(0,n.ko)(),c=(0,M.A)(),[d,h,m]=(0,Y.A)(!1),u=(0,s.li)();(0,s.vJ)((()=>{t||a({userId:e})}),[t,e,a]);const p=(0,s.hb)((e=>{o({file:e,isFallback:!0}),l({message:c("Privacy.ProfilePhoto.PublicPhotoSuccess")})}),[c,l,o]),v=(0,s.hb)((()=>{m(),r({photo:i})}),[m,r,i]),g=(0,s.hb)((()=>{u.current?.click()}),[]);return(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.FD)(ci.A,{narrow:!0,icon:"camera-add",onClick:g,children:[(0,ee.Y)(Qh.A,{onChange:p,inputRef:u}),c(i?"Privacy.ProfilePhoto.UpdatePublicPhoto":"Privacy.ProfilePhoto.SetPublicPhoto")]}),i&&(0,ee.FD)(ci.A,{narrow:!0,leftElement:(0,ee.Y)(Dt.A,{photo:i,size:"mini",className:"Qvhl9Jjv"}),onClick:h,destructive:!0,children:[c(i.isVideo?"Privacy.ProfilePhoto.RemovePublicVideo":"Privacy.ProfilePhoto.RemovePublicPhoto"),(0,ee.Y)(vi.A,{isOpen:d,onClose:m,text:c("Privacy.ResetPhoto.Confirm"),confirmLabel:c("Delete"),confirmHandler:v,confirmIsDestructive:!0})]}),(0,ee.Y)("p",{className:"settings-item-description-larger",dir:c.isRtl?"rtl":void 0,children:c("Privacy.ProfilePhoto.PublicPhotoInfo")})]})}));function Xh({screen:e,privacy:t,isPremiumRequired:i}){const{setPrivacyVisibility:o,openSettingsScreen:r}=(0,n.ko)(),l=(0,M.A)(),c=(0,_i.A)(),d=(0,s.Kr)((()=>{const t=e!==a.VS.PrivacyAddByPhone,s=[{value:"everybody",label:l("P2PEverybody")},{value:"contacts",label:i?(0,ee.Y)(Ud,{label:l("P2PContacts")}):l("P2PContacts"),hidden:i}];return t&&s.push({value:"nobody",label:i?(0,ee.Y)(Ud,{label:l("P2PNobody")}):l("P2PNobody"),hidden:i}),s}),[l,e,i]),h=(0,s.Kr)((()=>e===a.VS.PrivacyAddByPhone?{shouldShowDenied:!1,shouldShowAllowed:!1}:{shouldShowDenied:"nobody"!==t?.visibility,shouldShowAllowed:"everybody"!==t?.visibility}),[t,e]),m=$h(e),u=(0,s.Kr)((()=>{switch(e){case a.VS.PrivacyGifts:return c("PrivacyGiftsInfo");case a.VS.PrivacyLastSeen:return l("CustomHelp");case a.VS.PrivacyAddByPhone:return l("everybody"===t?.visibility?"PrivacyPhoneInfo":"PrivacyPhoneInfo3");case a.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesInfo");default:return}}),[l,c,e,t]),p=(0,s.Kr)((()=>{switch(e){case a.VS.PrivacyPhoneNumber:return l("PrivacyPhoneTitle");case a.VS.PrivacyAddByPhone:return l("PrivacyPhoneTitle2");case a.VS.PrivacyLastSeen:return l("LastSeenTitle");case a.VS.PrivacyProfilePhoto:return l("PrivacyProfilePhotoTitle");case a.VS.PrivacyBio:return l("PrivacyBioTitle");case a.VS.PrivacyBirthday:return l("PrivacyBirthdayTitle");case a.VS.PrivacyGifts:return c("PrivacyGiftsTitle");case a.VS.PrivacyForwarding:return l("PrivacyForwardsTitle");case a.VS.PrivacyVoiceMessages:return l("PrivacyVoiceMessagesTitle");case a.VS.PrivacyGroupChats:return l("WhoCanAddMe");case a.VS.PrivacyPhoneCall:return l("WhoCanCallMe");case a.VS.PrivacyPhoneP2P:return l("PrivacyP2P");default:return}}),[l,c,e]),v=(0,D.A)(((e,t,i,s)=>{const n=e?.length||0,a=t?.length||0,o="allow"===s;if(!n&&!a&&!o)return l(i?"PrivacyPremium":"EditAdminAddUsers");if(i)return l("ContactsAndPremium");const r=n>0?l("Users",n):void 0,d=a>0?l("Chats",a):void 0;return[o?c("PrivacyValueBots"):"",c.conjunction([r,d].filter(Boolean))].filter(Boolean).join(" ")})),g=(0,s.Kr)((()=>v(t?.allowUserIds,t?.allowChatIds,t?.shouldAllowPremium,t?.botsPrivacy)),[t]),A=(0,s.Kr)((()=>v(t?.blockUserIds,t?.blockChatIds)),[t]),b=(0,s.hb)((e=>{o({privacyKey:m,visibility:e})}),[m]),f=(()=>{switch(e){case a.VS.PrivacyPhoneNumber:return a.VS.PrivacyPhoneNumberAllowedContacts;case a.VS.PrivacyLastSeen:return a.VS.PrivacyLastSeenAllowedContacts;case a.VS.PrivacyProfilePhoto:return a.VS.PrivacyProfilePhotoAllowedContacts;case a.VS.PrivacyBio:return a.VS.PrivacyBioAllowedContacts;case a.VS.PrivacyBirthday:return a.VS.PrivacyBirthdayAllowedContacts;case a.VS.PrivacyGifts:return a.VS.PrivacyGiftsAllowedContacts;case a.VS.PrivacyForwarding:return a.VS.PrivacyForwardingAllowedContacts;case a.VS.PrivacyPhoneCall:return a.VS.PrivacyPhoneCallAllowedContacts;case a.VS.PrivacyPhoneP2P:return a.VS.PrivacyPhoneP2PAllowedContacts;case a.VS.PrivacyVoiceMessages:return a.VS.PrivacyVoiceMessagesAllowedContacts;default:return a.VS.PrivacyGroupChatsAllowedContacts}})(),C=(()=>{switch(e){case a.VS.PrivacyPhoneNumber:return a.VS.PrivacyPhoneNumberDeniedContacts;case a.VS.PrivacyLastSeen:return a.VS.PrivacyLastSeenDeniedContacts;case a.VS.PrivacyProfilePhoto:return a.VS.PrivacyProfilePhotoDeniedContacts;case a.VS.PrivacyBio:return a.VS.PrivacyBioDeniedContacts;case a.VS.PrivacyBirthday:return a.VS.PrivacyBirthdayDeniedContacts;case a.VS.PrivacyGifts:return a.VS.PrivacyGiftsDeniedContacts;case a.VS.PrivacyForwarding:return a.VS.PrivacyForwardingDeniedContacts;case a.VS.PrivacyPhoneCall:return a.VS.PrivacyPhoneCallDeniedContacts;case a.VS.PrivacyPhoneP2P:return a.VS.PrivacyPhoneP2PDeniedContacts;case a.VS.PrivacyVoiceMessages:return a.VS.PrivacyVoiceMessagesDeniedContacts;default:return a.VS.PrivacyGroupChatsDeniedContacts}})();return(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:p}),(0,ee.Y)(X.A,{name:`visibility-${m}`,options:d,onChange:b,selected:t?.visibility}),u&&(0,ee.Y)("p",{className:"settings-item-description-larger",dir:l.isRtl?"rtl":void 0,children:u})]}),!i&&(h.shouldShowAllowed||h.shouldShowDenied)&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:l.isRtl?"rtl":void 0,children:l("PrivacyExceptions")}),h.shouldShowAllowed&&(0,ee.Y)(ci.A,{narrow:!0,icon:"add-user",onClick:()=>{r({screen:f})},children:(0,ee.FD)("div",{className:"multiline-item full-size",children:[(0,ee.Y)("span",{className:"title",children:l("AlwaysAllow")}),(0,ee.Y)("span",{className:"subtitle",children:g})]})}),h.shouldShowDenied&&(0,ee.Y)(ci.A,{narrow:!0,icon:"delete-user",onClick:()=>{r({screen:C})},children:(0,ee.FD)("div",{className:"multiline-item full-size",children:[(0,ee.Y)("span",{className:"title",children:l("NeverAllow")}),(0,ee.Y)("span",{className:"subtitle",children:A})]})})]}),i&&(0,ee.Y)(_d,{})]})}const em=(0,s.ph)((0,n.EK)(((e,{screen:t})=>{let i,s;const{currentUserId:n,settings:{privacy:o,byKey:{shouldDisplayGiftsButton:r}}}=e,l=(0,c.vGo)(e,n);switch(t){case a.VS.PrivacyPhoneNumber:i=o.phoneNumber,s=o.addByPhone;break;case a.VS.PrivacyLastSeen:i=o.lastSeen;break;case a.VS.PrivacyProfilePhoto:i=o.profilePhoto;break;case a.VS.PrivacyBio:i=o.bio;break;case a.VS.PrivacyBirthday:i=o.birthday;break;case a.VS.PrivacyGifts:i=o.gifts;break;case a.VS.PrivacyPhoneP2P:case a.VS.PrivacyPhoneCall:i=o.phoneCall,s=o.phoneP2P;break;case a.VS.PrivacyForwarding:i=o.forwards;break;case a.VS.PrivacyVoiceMessages:i=o.voiceMessages;break;case a.VS.PrivacyGroupChats:i=o.chatInvite}return i?{primaryPrivacy:i,secondaryPrivacy:s,currentUserId:n,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto,isPremiumRequired:t===a.VS.PrivacyVoiceMessages&&!(0,c.g29)(e),shouldDisplayGiftsButton:r,isCurrentUserPremium:(0,c.g29)(e)}:{currentUserId:n,hasCurrentUserFullInfo:Boolean(l),currentUserFallbackPhoto:l?.fallbackPhoto}}))((({screen:e,isActive:t,primaryPrivacy:i,secondaryPrivacy:o,currentUserId:r,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c,isPremiumRequired:d,onReset:h,shouldDisplayGiftsButton:m,isCurrentUserPremium:u})=>{const{updateGlobalPrivacySettings:p,showNotification:v}=(0,n.ko)(),g=(0,_i.A)();(0,fe.A)({isActive:t,onBack:h});const A=(0,D.A)((()=>{u?p({shouldDisplayGiftsButton:!m}):v({message:g("PrivacySubscribeToTelegramPremium"),action:{action:"openPremiumModal",payload:{}},actionText:{key:"Open"},icon:"star"})})),b=(0,s.Kr)((()=>{switch(e){case a.VS.PrivacyPhoneCall:return a.VS.PrivacyPhoneP2P;case a.VS.PrivacyPhoneNumber:return"nobody"===i?.visibility?a.VS.PrivacyAddByPhone:void 0;default:return}}),[i,e]);return(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[e===a.VS.PrivacyGifts&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.FD)(ci.A,{onClick:A,children:[(0,ee.Y)("span",{children:g("PrivacyDisplayGiftsButton")}),(0,ee.Y)(bi.A,{id:"gift",disabled:!u,label:g(m?"HideGiftsButton":"DisplayGiftsButton"),checked:m})]}),(0,ee.Y)("p",{className:"settings-item-description-larger",dir:g.isRtl?"rtl":void 0,children:g("PrivacyDisplayGiftIconInChats",{icon:(0,ee.Y)(q.A,{name:"gift",className:"gift-icon"}),gift:g("PrivacyDisplayGift")},{withNodes:!0})})]}),(0,ee.Y)(Xh,{screen:e,privacy:i,isPremiumRequired:d}),e===a.VS.PrivacyProfilePhoto&&"everybody"!==i?.visibility&&(0,ee.Y)(Zh,{currentUserId:r,hasCurrentUserFullInfo:l,currentUserFallbackPhoto:c}),e===a.VS.PrivacyLastSeen&&(0,ee.Y)(Wh,{visibility:i?.visibility}),e===a.VS.PrivacyGifts&&(0,ee.Y)(qh,{}),Boolean(b)&&(0,ee.Y)(Xh,{screen:b,privacy:o})]})}))),tm=[ud.lw];function im(e,t){const{privacy:i}=e.settings;switch(t){case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyPhoneNumberDeniedContacts:return i.phoneNumber;case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyLastSeenDeniedContacts:return i.lastSeen;case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:return i.profilePhoto;case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyBioDeniedContacts:return i.bio;case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyBirthdayDeniedContacts:return i.birthday;case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyGiftsDeniedContacts:return i.gifts;case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:return i.phoneCall;case a.VS.PrivacyPhoneP2PAllowedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:return i.phoneP2P;case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyForwardingDeniedContacts:return i.forwards;case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:return i.voiceMessages;case a.VS.PrivacyGroupChatsDeniedContacts:case a.VS.PrivacyGroupChatsAllowedContacts:return i.chatInvite;case a.VS.PrivacyNoPaidMessages:return i.noPaidMessages}}const sm=(0,s.ph)((0,n.EK)(((e,{screen:t})=>({currentUserId:e.currentUserId,settings:im(e,t)})))((({isAllowList:e,withPremiumCategory:t,withMiniAppsCategory:i,screen:a,isActive:r,currentUserId:c,settings:d,usersOnly:h=!1,onReset:m})=>{const{setPrivacySettings:u}=(0,n.ko)(),p=(0,M.A)(),v=(0,_i.A)(),g=(0,s.Kr)((()=>({isCustomPeer:!0,type:"bots",title:v("PrivacyValueBots"),avatarIcon:"bots",isAvatarSquare:!0,peerColorId:6})),[v]),A=(0,s.Kr)((()=>[g]),[g]),b=(0,s.Kr)((()=>d?e?[...d.allowUserIds,...d.allowChatIds]:[...d.blockUserIds,...d.blockChatIds]:[]),[e,d]),f=(0,s.Kr)((()=>d?d.shouldAllowPremium?[ud.lw.type]:"allow"===d.botsPrivacy&&e?[g.type]:[]:[]),[d,e,g]),[C,y]=(0,s.J0)(""),[S,w]=(0,s.J0)(!1),[k,N]=(0,s.J0)(b),[I,P]=(0,s.J0)(f);(0,s.vJ)((()=>{r||(N(b),P(f))}),[r,f,b]);const Y=(0,pd.Rh)(o.DSF),F=(0,pd.Rh)(o._E9),D=(0,s.Kr)((()=>{const e=(0,n.mS)().chats.byId,t=(0,n.mS)().users.byId,i=(0,fi.Am)([...Y||[],...F||[]]).filter((i=>{const s=e[i],n=t[i],a=n&&(0,l.PL)(n),r=s&&(0,l.WX)(s);return(!h||n)&&i!==c&&i!==o.zv8&&!r&&!a})),s=(0,Yt.PU)({ids:i,query:C});return C?s:(0,fi.Am)([...b,...i])}),[Y,F,b,C,c,h]),T=(0,s.hb)((e=>{P(e),w(!0)}),[]),B=(0,s.hb)((e=>{N(e),w(!0)}),[]),R=(0,s.hb)((()=>{u({privacyKey:$h(a),isAllowList:Boolean(e),updatedIds:k,isPremiumAllowed:I.includes(ud.lw.type)||void 0,botsPrivacy:i?I.includes(g.type)?"allow":"disallow":"none"}),m()}),[e,i,I,k,m,a,g]);return(0,fe.A)({isActive:r,onBack:m}),(0,ee.FD)("div",{className:"NewChat-inner step-1",children:[(0,ee.Y)(yi.A,{categories:t?tm:i&&e?A:void 0,itemIds:D||[],selectedIds:k,selectedCategories:I,filterValue:C,filterPlaceholder:p(e?"AlwaysAllowPlaceholder":"NeverAllowPlaceholder"),categoryPlaceholderKey:"PrivacyUserTypes",searchInputId:"new-group-picker-search",isSearchable:!0,onSelectedIdsChange:B,onSelectedCategoriesChange:T,onFilterChange:y,allowMultiple:!0,itemInputType:"checkbox",withDefaultPadding:!0,withStatus:!0}),(0,ee.Y)(ki.A,{isShown:S,onClick:R,ariaLabel:p(e?"AlwaysAllow":"NeverAllow"),children:(0,ee.Y)(q.A,{name:"check"})})]})}))),nm=(0,s.ph)((0,n.EK)((e=>{const{config:t,reactions:i}=e;return{availableReactions:i.availableReactions,selectedReaction:t?.defaultReaction}}))((({isActive:e,availableReactions:t,selectedReaction:i,onReset:a})=>{const{setDefaultReaction:o}=(0,n.ko)();(0,fe.A)({isActive:e,onBack:a});const r=(0,s.Kr)((()=>(t||[]).filter((e=>!e.isInactive)).map((e=>({label:(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(Ls.A,{reaction:e.reaction,availableReactions:t}),e.title]}),value:e.reaction.emoticon})))),[t]),l=(0,s.hb)((e=>{o({reaction:{type:"emoji",emoticon:e}})}),[o]);return(0,ee.Y)("div",{className:"settings-content settings-item custom-scroll settings-quick-reaction",children:(0,ee.Y)(X.A,{name:"quick-reaction-settings",options:r,selected:i,onChange:l,withIcon:!0})})}))),am=1.5*p.$,om=(0,s.ph)((0,n.EK)((e=>({...(0,fi.Up)(e.settings.byKey,["shouldSuggestStickers","shouldUpdateStickerSetOrder"]),addedSetIds:e.stickers.added.setIds,customEmojiSetIds:e.customEmojis.added.setIds,stickerSetsById:e.stickers.setsById,defaultReaction:e.config?.defaultReaction,availableReactions:e.reactions.availableReactions,canPlayAnimatedEmojis:(0,c.BWX)(e)})))((({isActive:e,addedSetIds:t,customEmojiSetIds:i,stickerSetsById:o,defaultReaction:r,shouldSuggestStickers:l,shouldUpdateStickerSetOrder:c,availableReactions:d,canPlayAnimatedEmojis:h,onReset:m})=>{const{setSettingOption:u,openStickerSet:p,openSettingsScreen:v}=(0,n.ko)(),g=(0,M.A)(),A=(0,s.li)(),{observe:b}=(0,gr.BL)({rootRef:A}),f=(0,s.hb)((e=>{p({stickerSetInfo:e.stickerSetInfo})}),[p]),C=(0,s.hb)((e=>{u({shouldUpdateStickerSetOrder:e})}),[u]),y=(0,s.hb)((e=>{u({shouldSuggestStickers:e})}),[u]),S=(0,s.Kr)((()=>t&&Object.values((0,fi.Up)(o,t))),[t,o]);return(0,fe.A)({isActive:e,onBack:m}),(0,ee.FD)("div",{className:"settings-content custom-scroll",children:[(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(un.A,{label:g("SuggestStickers"),checked:l,onCheck:y}),(0,ee.FD)(ci.A,{narrow:!0,onClick:()=>v({screen:a.VS.CustomEmoji}),icon:"smile",children:[g("StickersList.EmojiItem"),i&&(0,ee.Y)("span",{className:"settings-item__current-value",children:i.length})]}),r&&(0,ee.FD)(ci.A,{className:"SettingsDefaultReaction",narrow:!0,onClick:()=>v({screen:a.VS.QuickReaction}),children:[(0,ee.Y)(Ls.A,{reaction:r,className:"current-default-reaction",size:am,availableReactions:d}),(0,ee.Y)("div",{className:"title",children:g("DoubleTapSetting")})]})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("InstalledStickers.DynamicPackOrder")}),(0,ee.Y)(un.A,{label:g("InstalledStickers.DynamicPackOrder"),checked:c,onCheck:C}),(0,ee.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:g("InstalledStickers.DynamicPackOrderInfo")})]}),S&&(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)("h4",{className:"settings-item-header",dir:g.isRtl?"rtl":void 0,children:g("ChooseStickerMyStickerSets")}),(0,ee.Y)("div",{ref:A,children:S.map((e=>(0,ee.Y)(Zd,{stickerSet:e,observeIntersection:b,onClick:f,noPlay:!h},e.id)))}),(0,ee.Y)("p",{className:"settings-item-description mt-3",dir:"auto",children:(0,Ft.A)(g("StickersBotInfo"),["links"])})]})]})}))),rm=(0,s.ph)((({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,n.ko)(),s=(0,M.A)(),r=(0,D.A)((()=>{i({screen:a.VS.Privacy})}));return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Sd.A,{size:o.r2x,tgsUrl:Mr.w.Congratulations,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:s("TwoStepVerificationPasswordSetInfo")})]}),(0,ee.Y)("div",{className:"settings-item settings-group",children:(0,ee.Y)(W.A,{onClick:r,children:s("TwoStepVerificationPasswordReturnSettings")})})]})}));var lm=i(79577);const cm=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e).recoveryEmail;return{animatedEmoji:(0,c.oei)(e,"ðŸ’Œ"),codeLength:e.twoFaSettings.waitingEmailCodeLength,recoveryEmail:t}}))((({animatedEmoji:e,codeLength:t,isLoading:i,error:n,clearError:a,onSubmit:o,isActive:r,onReset:l,recoveryEmail:c})=>{const d=(0,s.li)(),{isMobile:h}=(0,I.Ay)(),m=h?550:400,[u,p]=(0,s.J0)("");(0,s.vJ)((()=>{b.TF||setTimeout((()=>{d.current.focus()}),m)}),[m]);const v=(0,M.A)();(0,fe.A)({isActive:r,onBack:l});const g=(0,s.hb)((e=>{n&&a&&a();const i=e.target.value.slice(0,t);i.length===t&&o(i),p(i),e.target.value=i}),[a,t,n,o]);return(0,ee.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(lm.A,{sticker:e,size:160,className:"settings-content-icon"}),c&&(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:v("TwoStepAuth.ConfirmEmailDescription",c)})]}),(0,ee.FD)("div",{className:"settings-item settings-group",children:[(0,ee.Y)(Q.A,{value:u,ref:d,inputMode:"decimal",label:v("YourEmailCode"),error:n,onChange:g}),i&&(0,ee.Y)(zs.A,{})]})]})}))),dm=(0,s.ph)((({isActive:e,onReset:t})=>{const{openSettingsScreen:i}=(0,n.ko)(),s=(0,M.A)();return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Lock,previewUrl:Fd,size:160,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:(0,Ft.A)(s("EnabledPasswordText"),["br"])})]}),(0,ee.FD)("div",{className:"settings-item",children:[(0,ee.Y)(ci.A,{icon:"edit",onClick:()=>i({screen:a.VS.TwoFaChangePasswordCurrent}),children:s("ChangePassword")}),(0,ee.Y)(ci.A,{icon:"password-off",onClick:()=>i({screen:a.VS.TwoFaTurnOff}),children:s("TurnPasswordOff")}),(0,ee.Y)(ci.A,{icon:"email",onClick:()=>i({screen:a.VS.TwoFaRecoveryEmailCurrentPassword}),children:s("SetRecoveryEmail")})]})]})})),hm=(0,s.ph)((0,n.EK)(((e,{icon:t})=>({animatedEmoji:(0,c.oei)(e,"email"===t?"ðŸ’Œ":"ðŸ’¡")})))((({animatedEmoji:e,type:t="text",isLoading:i,error:n,placeholder:a,shouldConfirm:o,clearError:r,onSubmit:l,isActive:c,onReset:d})=>{const h=(0,s.li)(),{isMobile:m}=(0,I.Ay)(),u=m?550:400,[p,v]=(0,s.J0)(""),[g,A,f]=(0,Y.A)(!1);(0,s.vJ)((()=>{b.TF||setTimeout((()=>{h.current.focus()}),u)}),[u]);const C=(0,s.hb)((e=>{n&&r&&r(),v(e.target.value)}),[r,n]),y=(0,s.hb)((()=>{l()}),[l]),S=(0,s.hb)((()=>{f(),l()}),[l,f]),w=(0,M.A)();return(0,fe.A)({isActive:c,onBack:d}),(0,ee.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(lm.A,{sticker:e,size:160,className:"settings-content-icon"}),"email"===t&&(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:w("RecoveryEmailSubtitle")})]}),(0,ee.FD)("div",{className:"settings-item settings-group",children:[(0,ee.FD)("form",{action:"",onSubmit:e=>{e.preventDefault(),h.current&&l(p)},children:[(0,ee.Y)(Q.A,{ref:h,value:p,inputMode:t,label:a,error:n,onChange:C}),p?(0,ee.Y)(W.A,{type:"submit",isLoading:i,ripple:!0,children:w("Continue")}):(0,ee.Y)(W.A,{isText:!0,isLoading:i,ripple:!0,onClick:o?A:y,children:w("YourEmailSkip")})]}),o&&(0,ee.FD)(Z.A,{className:"narrow",isOpen:g,title:w("YourEmailSkipWarning"),onClose:f,children:[(0,Ft.A)(w("YourEmailSkipWarningText"),["br","simple_markdown"]),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{color:"danger",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:S,children:w("YourEmailSkip")}),(0,ee.Y)(W.A,{color:"primary",ripple:!0,isText:!0,className:"confirm-dialog-button",onClick:f,children:w("Cancel")})]})]})]})]})}))),mm=(0,s.ph)((({isActive:e,onReset:t,onStart:i})=>{const s=(0,M.A)();return(0,fe.A)({isActive:e,onBack:t}),(0,ee.FD)("div",{className:"settings-content two-fa custom-scroll",children:[(0,ee.FD)("div",{className:"settings-content-header no-border",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Lock,previewUrl:Fd,size:160,className:"settings-content-icon"}),(0,ee.Y)("p",{className:"settings-item-description mb-3",dir:"auto",children:s("SetAdditionalPasswordInfo")})]}),(0,ee.Y)("div",{className:"settings-item settings-group",children:(0,ee.Y)(W.A,{onClick:i,children:s("EditAdminTransferSetPassword")})})]})})),um=(0,s.ph)((0,n.EK)((e=>({...e.twoFaSettings})))((({currentScreen:e,shownScreen:t,state:i,hint:o,isLoading:r,errorKey:l,waitingEmailCodeLength:c,dispatch:d,isActive:h,onReset:m})=>{const{updatePassword:u,checkPassword:p,clearTwoFaError:v,updateRecoveryEmail:g,provideTwoFaEmailCode:A,clearPassword:b,openSettingsScreen:f}=(0,n.ko)(),C=(0,_i.A)(),y=(0,M.A)();(0,s.vJ)((()=>{c&&(e===a.VS.TwoFaNewPasswordEmail?f({screen:a.VS.TwoFaNewPasswordEmailCode}):e===a.VS.TwoFaRecoveryEmail&&f({screen:a.VS.TwoFaRecoveryEmailCode}))}),[e,c,f]);const S=(0,s.hb)((()=>{d({type:"reset"}),f({screen:a.VS.TwoFaNewPassword})}),[d,f]),w=(0,s.hb)((e=>{d({type:"setPassword",payload:e}),f({screen:a.VS.TwoFaNewPasswordConfirm})}),[d,f]),k=(0,s.hb)((()=>{f({screen:a.VS.TwoFaNewPasswordHint})}),[f]),N=(0,s.hb)((e=>{d({type:"setHint",payload:e}),f({screen:a.VS.TwoFaNewPasswordEmail})}),[d,f]),I=(0,s.hb)((e=>{d({type:"setEmail",payload:e}),u({...i,email:e,onSuccess:()=>{f({screen:a.VS.TwoFaCongratulations})}})}),[d,i,u,f]),P=(0,s.hb)((e=>{d({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{f({screen:a.VS.TwoFaChangePasswordNew})}})}),[p,d,f]),Y=(0,s.hb)((e=>{d({type:"setPassword",payload:e}),f({screen:a.VS.TwoFaChangePasswordConfirm})}),[d,f]),F=(0,s.hb)((()=>{f({screen:a.VS.TwoFaChangePasswordHint})}),[f]),D=(0,s.hb)((e=>{d({type:"setHint",payload:e}),u({...i,hint:e,onSuccess:()=>{f({screen:a.VS.TwoFaCongratulations})}})}),[d,i,u,f]),T=(0,s.hb)((e=>{b({currentPassword:e,onSuccess:()=>{f({screen:a.VS.Privacy})}})}),[b,f]),B=(0,s.hb)((e=>{d({type:"setCurrentPassword",payload:e}),p({currentPassword:e,onSuccess:()=>{f({screen:a.VS.TwoFaRecoveryEmail})}})}),[p,d,f]),R=(0,s.hb)((e=>{d({type:"setEmail",payload:e}),g({...i,email:e,onSuccess:()=>{f({screen:a.VS.TwoFaCongratulations})}})}),[d,i,g,f]),L=(0,s.hb)((e=>{A({code:e})}),[A]);switch(e){case a.VS.TwoFaDisabled:return(0,ee.Y)(mm,{onStart:S,isActive:h||[a.VS.TwoFaNewPassword,a.VS.TwoFaNewPasswordConfirm,a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaNewPassword:return(0,ee.Y)(Pd,{placeholder:y("PleaseEnterPassword"),submitLabel:y("Continue"),onSubmit:w,isActive:h||[a.VS.TwoFaNewPasswordConfirm,a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaNewPasswordConfirm:return(0,ee.Y)(Pd,{expectedPassword:i.password,placeholder:y("PleaseReEnterPassword"),submitLabel:y("Continue"),onSubmit:k,isActive:h||[a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaNewPasswordHint:return(0,ee.Y)(hm,{icon:"hint",placeholder:y("PasswordHintPlaceholder"),onSubmit:N,isActive:h||[a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaNewPasswordEmail:return(0,ee.Y)(hm,{icon:"email",type:"email",isLoading:r,error:l&&C.withRegular(l),clearError:v,placeholder:y("RecoveryEmailTitle"),shouldConfirm:!0,onSubmit:I,isActive:h||[a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaNewPasswordEmailCode:return(0,ee.Y)(cm,{isLoading:r,error:l&&C.withRegular(l),clearError:v,onSubmit:L,isActive:h||t===a.VS.TwoFaCongratulations,onReset:m});case a.VS.TwoFaCongratulations:return(0,ee.Y)(rm,{isActive:h,onReset:m});case a.VS.TwoFaEnabled:return(0,ee.Y)(dm,{isActive:h||[a.VS.TwoFaChangePasswordCurrent,a.VS.TwoFaChangePasswordNew,a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaTurnOff,a.VS.TwoFaRecoveryEmailCurrentPassword,a.VS.TwoFaRecoveryEmail,a.VS.TwoFaRecoveryEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaChangePasswordCurrent:return(0,ee.Y)(Pd,{isLoading:r,error:l&&C.withRegular(l),clearError:v,hint:o,onSubmit:P,isActive:h||[a.VS.TwoFaChangePasswordNew,a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaChangePasswordNew:return(0,ee.Y)(Pd,{placeholder:y("PleaseEnterNewFirstPassword"),onSubmit:Y,isActive:h||[a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaChangePasswordConfirm:return(0,ee.Y)(Pd,{expectedPassword:i.password,placeholder:y("PleaseReEnterPassword"),onSubmit:F,isActive:h||[a.VS.TwoFaChangePasswordHint,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaChangePasswordHint:return(0,ee.Y)(hm,{isLoading:r,error:l&&C.withRegular(l),clearError:v,icon:"hint",placeholder:y("PasswordHintPlaceholder"),onSubmit:D,isActive:h||t===a.VS.TwoFaCongratulations,onReset:m});case a.VS.TwoFaTurnOff:return(0,ee.Y)(Pd,{isLoading:r,error:l&&C.withRegular(l),clearError:v,hint:o,onSubmit:T,isActive:h,onReset:m});case a.VS.TwoFaRecoveryEmailCurrentPassword:return(0,ee.Y)(Pd,{isLoading:r,error:l&&C.withRegular(l),clearError:v,hint:o,onSubmit:B,isActive:h||[a.VS.TwoFaRecoveryEmail,a.VS.TwoFaRecoveryEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaRecoveryEmail:return(0,ee.Y)(hm,{icon:"email",type:"email",placeholder:y("RecoveryEmailTitle"),onSubmit:R,isActive:h||[a.VS.TwoFaRecoveryEmailCode,a.VS.TwoFaCongratulations].includes(t),onReset:m});case a.VS.TwoFaRecoveryEmailCode:return(0,ee.Y)(cm,{isLoading:r,error:l&&C.withRegular(l),clearError:v,onSubmit:L,isActive:h||t===a.VS.TwoFaCongratulations,onReset:m});default:return}}))),pm=Object.keys(a.VS).length/2,vm=[a.VS.TwoFaDisabled,a.VS.TwoFaNewPassword,a.VS.TwoFaNewPasswordConfirm,a.VS.TwoFaNewPasswordHint,a.VS.TwoFaNewPasswordEmail,a.VS.TwoFaNewPasswordEmailCode,a.VS.TwoFaCongratulations,a.VS.TwoFaEnabled,a.VS.TwoFaChangePasswordCurrent,a.VS.TwoFaChangePasswordNew,a.VS.TwoFaChangePasswordConfirm,a.VS.TwoFaChangePasswordHint,a.VS.TwoFaTurnOff,a.VS.TwoFaRecoveryEmailCurrentPassword,a.VS.TwoFaRecoveryEmail,a.VS.TwoFaRecoveryEmailCode],gm=[a.VS.PasscodeDisabled,a.VS.PasscodeEnabled],Am=[a.VS.Folders,a.VS.FoldersCreateFolder,a.VS.FoldersEditFolder,a.VS.FoldersEditFolderFromChatList,a.VS.FoldersEditFolderInvites,a.VS.FoldersIncludedChats,a.VS.FoldersIncludedChatsFromChatList,a.VS.FoldersExcludedChats,a.VS.FoldersExcludedChatsFromChatList,a.VS.FoldersShare],bm=[a.VS.PrivacyBlockedUsers,a.VS.ActiveWebsites],fm=[a.VS.PrivacyPhoneNumberAllowedContacts,a.VS.PrivacyPhoneNumberDeniedContacts],Cm=[a.VS.PrivacyLastSeenAllowedContacts,a.VS.PrivacyLastSeenDeniedContacts],ym=[a.VS.PrivacyProfilePhotoAllowedContacts,a.VS.PrivacyProfilePhotoDeniedContacts],Sm=[a.VS.PrivacyBioAllowedContacts,a.VS.PrivacyBioDeniedContacts],wm=[a.VS.PrivacyBirthdayAllowedContacts,a.VS.PrivacyBirthdayDeniedContacts],km=[a.VS.PrivacyGiftsAllowedContacts,a.VS.PrivacyGiftsDeniedContacts],Nm=[a.VS.PrivacyPhoneCallAllowedContacts,a.VS.PrivacyPhoneCallDeniedContacts],Im=[a.VS.PrivacyPhoneP2PAllowedContacts,a.VS.PrivacyPhoneP2PDeniedContacts],Pm=[a.VS.PrivacyForwardingAllowedContacts,a.VS.PrivacyForwardingDeniedContacts],Ym=[a.VS.PrivacyVoiceMessagesAllowedContacts,a.VS.PrivacyVoiceMessagesDeniedContacts],Fm=[a.VS.PrivacyGroupChatsAllowedContacts,a.VS.PrivacyGroupChatsDeniedContacts],Dm=[a.VS.PrivacyNoPaidMessages],Mm=(0,s.ph)((({isActive:e,currentScreen:t,foldersState:i,foldersDispatch:o,onReset:r,shouldSkipTransition:l})=>{const{closeShareChatFolderModal:d,openSettingsScreen:h}=(0,n.ko)(),m=(0,s.li)(),[u,p]=(0,ld.A)(dd,cd),[v,g]=(0,s.J0)("");(0,hd.A)({containerRef:m,selector:".settings-content"},[t]);const A=(0,D.A)((e=>{const s=(0,c.nTw)((0,n.mS)()).shareFolderScreen?.isFromSettings;t===a.VS.FoldersShare&&d(),!0===e||void 0!==s&&!s?r(!0):(t!==a.VS.FoldersCreateFolder&&t!==a.VS.FoldersEditFolder&&t!==a.VS.FoldersEditFolderFromChatList&&t!==a.VS.FoldersEditFolderInvites||setTimeout((()=>{o({type:"reset"})}),200),t!==a.VS.FoldersIncludedChats&&t!==a.VS.FoldersExcludedChats?r():"create"===i.mode?h({screen:a.VS.FoldersCreateFolder}):h({screen:a.VS.FoldersEditFolder}))}));function f(s,n){const r={[a.VS.PrivacyPhoneNumber]:fm.includes(n),[a.VS.PrivacyLastSeen]:Cm.includes(n),[a.VS.PrivacyProfilePhoto]:ym.includes(n),[a.VS.PrivacyBio]:Sm.includes(n),[a.VS.PrivacyBirthday]:wm.includes(n),[a.VS.PrivacyGifts]:km.includes(n),[a.VS.PrivacyPhoneCall]:Nm.includes(n),[a.VS.PrivacyPhoneP2P]:Im.includes(n),[a.VS.PrivacyForwarding]:Pm.includes(n),[a.VS.PrivacyVoiceMessages]:Ym.includes(n),[a.VS.PrivacyGroupChats]:Fm.includes(n),[a.VS.PrivacyMessages]:Dm.includes(n)},l=vm.includes(n),c=gm.includes(n),d=Am.includes(n),h=bm.includes(n)||l||c||Object.keys(r).map(Number).includes(n)||Object.values(r).includes(!0);switch(t){case a.VS.Main:return(0,ee.Y)(Lh,{isActive:e,onReset:A});case a.VS.EditProfile:return(0,ee.Y)(uh,{isActive:e&&s,onReset:A});case a.VS.General:return(0,ee.Y)(fh,{isActive:s||n===a.VS.GeneralChatBackgroundColor||n===a.VS.GeneralChatBackground||n===a.VS.QuickReaction||n===a.VS.CustomEmoji||h||d,onReset:A});case a.VS.QuickReaction:return(0,ee.Y)(nm,{isActive:s,onReset:A});case a.VS.CustomEmoji:return(0,ee.Y)(Xd,{isActive:s,onReset:A});case a.VS.Notifications:return(0,ee.Y)(Vh,{isActive:s,onReset:A});case a.VS.DataStorage:return(0,ee.Y)(eh,{isActive:s,onReset:A});case a.VS.Privacy:return(0,ee.Y)(jh,{isActive:s||h,onReset:A});case a.VS.Language:return(0,ee.Y)(Mh,{isActive:s||n===a.VS.DoNotTranslate,onReset:A});case a.VS.DoNotTranslate:return(0,ee.Y)(nh,{isActive:s,onReset:A});case a.VS.Stickers:return(0,ee.Y)(om,{isActive:s,onReset:A});case a.VS.Experimental:return(0,ee.Y)(gh,{isActive:s,onReset:A});case a.VS.GeneralChatBackground:return(0,ee.Y)(kh,{isActive:s||n===a.VS.GeneralChatBackgroundColor,onReset:A});case a.VS.GeneralChatBackgroundColor:return(0,ee.Y)(Fh,{isActive:s,onReset:A});case a.VS.ActiveSessions:return(0,ee.Y)(Hd,{isActive:s,onReset:A});case a.VS.ActiveWebsites:return(0,ee.Y)(Qd,{isActive:s,onReset:A});case a.VS.PrivacyBlockedUsers:return(0,ee.Y)(Hh,{isActive:s,onReset:A});case a.VS.PrivacyPhoneNumber:case a.VS.PrivacyLastSeen:case a.VS.PrivacyProfilePhoto:case a.VS.PrivacyBio:case a.VS.PrivacyBirthday:case a.VS.PrivacyGifts:case a.VS.PrivacyPhoneCall:case a.VS.PrivacyForwarding:case a.VS.PrivacyVoiceMessages:case a.VS.PrivacyGroupChats:return(0,ee.Y)(em,{screen:t,isActive:s||r[t],onReset:A});case a.VS.PrivacyPhoneNumberAllowedContacts:case a.VS.PrivacyLastSeenAllowedContacts:case a.VS.PrivacyProfilePhotoAllowedContacts:case a.VS.PrivacyBioAllowedContacts:case a.VS.PrivacyBirthdayAllowedContacts:case a.VS.PrivacyGiftsAllowedContacts:case a.VS.PrivacyPhoneCallAllowedContacts:case a.VS.PrivacyPhoneP2PAllowedContacts:case a.VS.PrivacyForwardingAllowedContacts:case a.VS.PrivacyVoiceMessagesAllowedContacts:case a.VS.PrivacyGroupChatsAllowedContacts:case a.VS.PrivacyNoPaidMessages:return(0,ee.Y)(sm,{isAllowList:!0,usersOnly:t===a.VS.PrivacyNoPaidMessages,withPremiumCategory:t===a.VS.PrivacyGroupChatsAllowedContacts,withMiniAppsCategory:t===a.VS.PrivacyGiftsAllowedContacts,screen:t,isActive:s||r[t],onReset:A});case a.VS.PrivacyPhoneNumberDeniedContacts:case a.VS.PrivacyLastSeenDeniedContacts:case a.VS.PrivacyProfilePhotoDeniedContacts:case a.VS.PrivacyBioDeniedContacts:case a.VS.PrivacyBirthdayDeniedContacts:case a.VS.PrivacyGiftsDeniedContacts:case a.VS.PrivacyPhoneCallDeniedContacts:case a.VS.PrivacyPhoneP2PDeniedContacts:case a.VS.PrivacyForwardingDeniedContacts:case a.VS.PrivacyVoiceMessagesDeniedContacts:case a.VS.PrivacyGroupChatsDeniedContacts:return(0,ee.Y)(sm,{screen:t,isActive:s,onReset:A});case a.VS.PrivacyMessages:return(0,ee.Y)(Od,{isActive:s,onReset:A});case a.VS.Folders:case a.VS.FoldersCreateFolder:case a.VS.FoldersEditFolder:case a.VS.FoldersEditFolderFromChatList:case a.VS.FoldersEditFolderInvites:case a.VS.FoldersIncludedChats:case a.VS.FoldersIncludedChatsFromChatList:case a.VS.FoldersExcludedChats:case a.VS.FoldersExcludedChatsFromChatList:case a.VS.FoldersShare:return(0,ee.Y)(kd,{currentScreen:t,shownScreen:n,state:i,dispatch:o,isActive:s,onReset:A});case a.VS.TwoFaDisabled:case a.VS.TwoFaNewPassword:case a.VS.TwoFaNewPasswordConfirm:case a.VS.TwoFaNewPasswordHint:case a.VS.TwoFaNewPasswordEmail:case a.VS.TwoFaNewPasswordEmailCode:case a.VS.TwoFaCongratulations:case a.VS.TwoFaEnabled:case a.VS.TwoFaChangePasswordCurrent:case a.VS.TwoFaChangePasswordNew:case a.VS.TwoFaChangePasswordConfirm:case a.VS.TwoFaChangePasswordHint:case a.VS.TwoFaTurnOff:case a.VS.TwoFaRecoveryEmailCurrentPassword:case a.VS.TwoFaRecoveryEmail:case a.VS.TwoFaRecoveryEmailCode:return(0,ee.Y)(um,{currentScreen:t,state:u,dispatch:p,shownScreen:n,isActive:s,onReset:A});case a.VS.PasscodeDisabled:case a.VS.PasscodeNewPasscode:case a.VS.PasscodeNewPasscodeConfirm:case a.VS.PasscodeChangePasscodeCurrent:case a.VS.PasscodeChangePasscodeNew:case a.VS.PasscodeChangePasscodeConfirm:case a.VS.PasscodeCongratulations:case a.VS.PasscodeEnabled:case a.VS.PasscodeTurnOff:return(0,ee.Y)(Td,{currentScreen:t,passcode:v,onSetPasscode:g,shownScreen:n,isActive:s,onReset:A});case a.VS.Performance:return(0,ee.Y)(Gh,{isActive:s,onReset:A});default:return}}return(0,ee.Y)(se.Ay,{ref:m,id:"Settings",name:l?"none":b.Uh,activeKey:t,renderCount:pm,shouldWrap:!0,withSwipeControl:!0,children:function(e,s,n,a){return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(Dh,{currentScreen:t,onReset:A,editedFolderId:i.folderId}),f(e,a)]})}})})),Tm=(0,s.ph)((0,n.EK)((e=>{const{userIds:t}=e.contactList||{},{byId:i,statusesById:s}=e.users;return{usersById:i,userStatusesById:s,contactIds:t}}))((({isActive:e,filter:t,usersById:i,userStatusesById:o,contactIds:r,onReset:c})=>{const{openChat:d,openNewContactDialog:h}=(0,n.ko)(),m=(0,M.A)(),{isMobile:u}=(0,I.Ay)();(0,fe.A)({isActive:e,onBack:c});const p=(0,s.hb)((e=>{d({id:e,shouldReplaceHistory:!0})}),[d]),v=(0,s.Kr)((()=>{if(!r)return;const e=(0,Yt.PU)({ids:r,query:t,type:"user"});return(0,l.UB)(e,i,o)}),[r,t,i,o]),[g,A]=(0,Js.A)(void 0,v,Boolean(t));return(0,ee.FD)(Ds.A,{items:g,onLoadMore:A,className:"chat-list custom-scroll",children:[g?.length?g.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable contact-list-item",onClick:()=>p(e),children:(0,ee.Y)(Rs.A,{userId:e,forceShowSelf:!0,avatarSize:"large",withStory:!0,storyViewerOrigin:a.G9.ChatList,ripple:!u})},e))):g&&!g.length?(0,ee.Y)("p",{className:"no-results",dir:"auto",children:t.length?"No contacts matched your search.":"Contact list is empty."},"no-results"):(0,ee.Y)(zs.A,{},"loading"),(0,ee.Y)(ki.A,{isShown:!0,onClick:h,ariaLabel:m("CreateNewContact"),children:(0,ee.Y)(q.A,{name:"add-user-filled"})},"create-new-contact")]})}))),Bm=(0,s.ph)((0,n.EK)((e=>{const{userIds:t}=e.contactList||{},{query:i,fetchingStatus:s,globalResults:n,localResults:a}=(0,c.nTw)(e).globalSearch,{peerIds:o}=n||{},{peerIds:r}=a||{};return{localContactIds:t,searchQuery:i,isSearching:s?.chats,globalPeerIds:o,localPeerIds:r}}))((({isChannel:e,isActive:t,selectedMemberIds:i,localContactIds:a,searchQuery:o,isSearching:r,localPeerIds:c,globalPeerIds:d,onSelectedMemberIdsChange:h,onNextStep:m,onReset:u})=>{const{setGlobalSearchQuery:p}=(0,n.ko)(),v=(0,M.A)();(0,fe.A)({isActive:t,onBack:u});const g=(0,s.hb)((e=>{p({query:e})}),[]),A=(0,s.Kr)((()=>{const e=(0,n.mS)().users.byId,t=a?(0,Yt.PU)({ids:a,query:o,type:"user"}):[];return(0,Os.A)((0,fi.Am)([...t,...c||[],...d||[]]).filter((t=>{const i=e[t];return i&&!i.isSelf&&(i.canBeInvitedToGroup||!(0,l.tv)(i))})),!1,i)}),[a,o,c,d,i]),b=(0,s.hb)((()=>{p({query:""}),m()}),[m]);return(0,ee.FD)("div",{className:"NewChat step-1",children:[(0,ee.FD)("div",{className:"left-header",children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:u,ariaLabel:"Return to Chat List",children:(0,ee.Y)(q.A,{name:"arrow-left"})}),(0,ee.Y)("h3",{children:v("GroupAddMembers")})]}),(0,ee.FD)("div",{className:"NewChat-inner step-1",children:[(0,ee.Y)(yi.A,{itemIds:A,selectedIds:i,filterValue:o,filterPlaceholder:v("SendMessageTo"),searchInputId:"new-group-picker-search",isLoading:r,isSearchable:!0,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox",withDefaultPadding:!0,onSelectedIdsChange:h,onFilterChange:g}),(0,ee.Y)(ki.A,{isShown:!0,onClick:b,ariaLabel:e?"Continue To Channel Info":"Continue To Group Info",children:(0,ee.Y)(q.A,{name:"arrow-right"})})]})]})}))),Rm=(0,s.ph)((0,n.EK)((e=>{const{progress:t,error:i}=(0,c.nTw)(e).chatCreation||{};return{creationProgress:t,creationError:i,maxGroupSize:e.config?.maxGroupSize}}))((({isChannel:e,isActive:t,memberIds:i,maxGroupSize:o,creationProgress:r,creationError:c,onReset:d})=>{const{createGroupChat:h,createChannel:m}=(0,n.ko)(),u=(0,M.A)();(0,fe.A)({isActive:t,onBack:d});const[p,v]=(0,s.J0)(""),[g,A]=(0,s.J0)(""),[b,f]=(0,s.J0)(),[C,y]=(0,s.J0)(),S="Chat title can't be empty",w="Channel title can't be empty",k=r===a.n7.InProgress;(0,s.vJ)((()=>{if(e)return;if(!i.length||i.length>4)return void v("");const t=(0,n.mS)(),s=t.users.byId,a=[t.currentUserId,...i].map((e=>(0,l.u0)(s[e]))).filter(Boolean),o=a.slice(0,-1).join(", ")+u("CreateGroup.PeersTitleLastDelimeter")+a[a.length-1];v(o)}),[e,i,u]);const N=(0,s.hb)((e=>{const{value:t}=e.currentTarget,i=t.replace(/^\s+/,"");v(i),i!==t&&(e.currentTarget.value=i)}),[]),I=(0,s.hb)((e=>{A(e.currentTarget.value)}),[]),P=(0,s.hb)((()=>{p.length?o&&i.length>=o?y("Sorry, creating supergroups is not yet supported"):h({title:p,photo:b,memberIds:i}):y(S)}),[p,i,o,h,b]),Y=(0,s.hb)((()=>{p.length?m({title:p,about:g,photo:b,memberIds:i,isChannel:!0}):y(w)}),[p,m,g,b,i,w]);(0,s.vJ)((()=>{r===a.n7.Complete&&d(!0)}),[r,d]);const F=c&&u(c)||(C!==S&&C!==w?C:void 0);return(0,ee.FD)("div",{className:"NewChat",children:[(0,ee.FD)("div",{className:"left-header",children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>d(),ariaLabel:"Return to member selection",children:(0,ee.Y)(q.A,{name:"arrow-left"})}),(0,ee.Y)("h3",{children:u(e?"NewChannel":"NewGroup")})]}),(0,ee.FD)("div",{className:"NewChat-inner step-2",children:[(0,ee.Y)(dh.A,{onChange:f,title:u("AddPhoto")}),(0,ee.Y)(Q.A,{value:p,onChange:N,label:u(e?"EnterChannelName":"GroupName"),error:C===S||C===w?C:void 0}),e&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(Q.A,{value:g,onChange:I,label:u("DescriptionOptionalPlaceholder")}),(0,ee.Y)("p",{className:"note",children:u("DescriptionInfo")})]}),F&&(0,ee.Y)("p",{className:"error",children:F}),i.length>0&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{className:"chat-members-heading",children:u("GroupInfo.ParticipantCount",i.length,"i")}),(0,ee.Y)("div",{className:"chat-members-list custom-scroll",children:i.map((e=>(0,ee.Y)(ci.A,{inactive:!0,className:"chat-item-clickable",children:(0,ee.Y)(Rs.A,{userId:e})})))})]})]}),(0,ee.Y)(ki.A,{isShown:0!==p.length,onClick:e?Y:P,disabled:k,ariaLabel:e?u("ChannelIntro.CreateChannel"):"Create Group",children:k?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"arrow-right"})})]})}))),Lm=Object.keys(a.Bn).length/2,xm=(0,s.ph)((({isActive:e,isChannel:t=!1,content:i,onReset:o})=>{const{openLeftColumnContent:r,setGlobalSearchQuery:l}=(0,n.ko)(),[c,d]=(0,s.J0)([]),h=(0,s.hb)((()=>{r({contentKey:t?a.Bn.NewChannelStep2:a.Bn.NewGroupStep2})}),[t]),m=(0,D.A)((e=>{const t=e.length>c.length;d(e),t&&l({query:""})}));return(0,ee.Y)(se.Ay,{id:"NewChat",name:b.Uh,renderCount:Lm,activeKey:i,children:s=>{switch(i){case a.Bn.NewChannelStep1:case a.Bn.NewGroupStep1:return(0,ee.Y)(Bm,{isChannel:t,isActive:e,selectedMemberIds:c,onSelectedMemberIdsChange:m,onNextStep:h,onReset:o});case a.Bn.NewChannelStep2:case a.Bn.NewGroupStep2:return(0,ee.Y)(Rm,{isChannel:t,isActive:s&&e,memberIds:c,onReset:o});default:return}}})})),Em="HMp3KTKQ",Vm="unYkDic1",_m="dZJGfaXC",Um=250,Om=.25*p.$,Km=11,Jm=.1875*p.$,Gm=.125*p.$,jm=new Set;function zm(e){let t=document.getElementById("LeftColumn");if(t&&e&&(t=t.querySelector(".ArchivedChats")),!t)return{};const i=t.querySelector("#StoryToggler"),s=t.querySelector("#StoryRibbon"),n=t.querySelector(".left-header"),a=s?.querySelectorAll(`.${Lt}`),o=i?.querySelectorAll(".Avatar");return{container:t,toggler:i,leftMainHeader:n,ribbonPeers:a,toggleAvatars:o}}function Hm(e){const t=e.cloneNode(!0);t.classList.add("E1IeDpeb"),t.classList.remove("animating"),t.draggable=!1,t.oncontextmenu=f.A;const i=e.querySelector("canvas");if(i){const e=t.querySelector("canvas");e?.getContext("2d")?.drawImage(i,0,0)}return t}function $m(e){return e?.getAttribute("data-peer-id")}function qm(e,t){return e?.querySelector(`[data-peer-id="${t}"]`)}function Wm(e,t){const i=setTimeout(e,t);return()=>{clearTimeout(i),e()}}function Qm(){jm.forEach((e=>e())),jm.clear()}var Zm=i(11462);const Xm=(0,s.ph)((function({peer:e,isArchived:t}){const{openChat:i,openChatWithInfo:o,openStoryViewer:r,toggleStoriesHidden:l}=(0,n.ko)(),c=(0,M.A)(),d=(0,s.li)(),h="isSelf"in e&&e.isSelf,m=!(0,u.L8)(e.id);ts(e.id);const{isContextMenuOpen:p,contextMenuAnchor:v,handleBeforeContextMenu:g,handleContextMenu:A,handleContextMenuClose:b,handleContextMenuHide:f}=(0,Fn.A)(d),C=(0,D.A)((()=>d.current)),y=(0,D.A)((()=>document.body)),S=(0,D.A)((()=>d.current.querySelector(".story-peer-context-menu .bubble"))),w=(0,D.A)((()=>({withPortal:!0,isDense:!0}))),k=(0,D.A)((()=>{p||r({peerId:e.id,origin:a.G9.StoryRibbon})})),N=(0,D.A)((e=>{(0,Nr.u)(e),g(e)})),I=(0,D.A)((()=>{o({id:e.id,shouldReplaceHistory:!0,profileTab:"stories"})})),P=(0,D.A)((()=>{o({id:e.id,shouldReplaceHistory:!0,profileTab:"storiesArchive"})})),Y=(0,D.A)((()=>{i({id:e.id,shouldReplaceHistory:!0})})),F=(0,D.A)((()=>{o({id:e.id,shouldReplaceHistory:!0})})),T=(0,D.A)((()=>{l({peerId:e.id,isHidden:!t})}));return(0,ee.FD)("div",{ref:d,role:"button","data-peer-id":e.id,tabIndex:0,className:Lt,onMouseDown:N,onClick:k,onContextMenu:A,children:[(0,ee.Y)(Dt.A,{peer:e,withStory:!0,storyViewerOrigin:a.G9.StoryRibbon,storyViewerMode:"full"}),(0,ee.Y)("div",{className:(0,me.A)("BDZrSTO_",e.hasUnreadStories&&"OoUm5AUZ"),children:h?c("MyStory"):(0,Yt.F9)(c,e)}),void 0!==v&&(0,ee.Y)($e.A,{isOpen:p,anchor:v,getTriggerElement:C,getRootElement:y,getMenuElement:S,getLayout:w,className:(0,me.A)("story-peer-context-menu","N1sagA0s"),autoClose:!0,withPortal:!0,onClose:b,onCloseAnimationEnd:f,children:h?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(ce.A,{onClick:I,icon:"play-story",children:c("StoryList.Context.SavedStories")}),(0,ee.Y)(ce.A,{onClick:P,icon:"archive",children:c("StoryList.Context.ArchivedStories")})]}):(0,ee.FD)(ee.FK,{children:[!m&&(0,ee.Y)(ce.A,{onClick:Y,icon:"message",children:c("SendMessageTitle")}),m?(0,ee.Y)(ce.A,{onClick:F,icon:"channel",children:c("ChatList.ContextOpenChannel")}):(0,ee.Y)(ce.A,{onClick:F,icon:"user",children:c("StoryList.Context.ViewProfile")}),(0,ee.Y)(ce.A,{onClick:T,icon:t?"unarchive":"archive",children:c(t?"StoryList.Context.Unarchive":"StoryList.Context.Archive")})]})})]})})),eu=(0,s.ph)((0,n.EK)(((e,{isArchived:t})=>{const{orderedPeerIds:{active:i,archived:s}}=e.stories;return{orderedPeerIds:t?s:i,usersById:e.users.byId,chatsById:e.chats.byId}}))((function({isArchived:e,className:t,orderedPeerIds:i,usersById:n,chatsById:a,isClosing:o}){const r=(0,M.A)(),l=(0,me.A)(Rt,!i.length&&"lnVtxMZI",o&&"EZbKn_M3",t,"no-scrollbar"),c=(0,s.li)();return(0,Ln.A)(c,(0,I.Ny)()),(0,ee.Y)("div",{ref:c,id:"StoryRibbon",className:l,dir:r.isRtl?"rtl":void 0,children:i.map((t=>{const i=n[t]||a[t];if(i)return(0,ee.Y)(Xm,{peer:i,isArchived:e},t)}))})})));var tu=i(21511);const iu=(0,s.ph)((0,n.EK)(((e,{isArchived:t})=>{const{orderedPeerIds:{archived:i,active:s},byPeerId:n}=e.stories,{storyViewer:{isRibbonShown:a,isArchivedRibbonShown:o}}=(0,c.nTw)(e),r=(0,c.clw)(e),l=(0,c.xYJ)(e,"storyRibbonAnimations");return{currentUserId:e.currentUserId,orderedPeerIds:t?i:s,isShown:t?!o:!a,isForumPanelOpen:r,withAnimation:l,usersById:e.users.byId,chatsById:e.chats.byId,peerStories:n}}))((function({currentUserId:e,orderedPeerIds:t,usersById:i,chatsById:a,canShow:l,isShown:c,isForumPanelOpen:d,isArchived:h,withAnimation:m,peerStories:u}){const{toggleStoryRibbon:p}=(0,n.ko)(),v=(0,M.A)(),g=(0,s.Kr)((()=>1===t.length?[i[t[0]]||a[t[0]]]:t.map((e=>i[e]||a[e])).filter((t=>t&&t.id!==e)).slice(0,o.dqH).reverse()),[e,t,i,a]),b=(0,s.Kr)((()=>g?.length?g.reduce(((e,t)=>{const i=u[t.id];if(!i)return e;const s=i.orderedIds.some((e=>{const t=i.byId[e];if(!t||!("isForCloseFriends"in t))return!1;const s=i.lastReadId&&t.id<=i.lastReadId;return t.isForCloseFriends&&!s}));return e[t.id]=s,e}),{}):{}),[u,g]),f=(0,s.Kr)((()=>t.slice(0,5)),[t]);ts(f);const C=l&&c,{ref:y,shouldRender:S}=(0,tu.A)({isOpen:C,className:"slow",withShouldRender:!0});if((0,s.vJ)((()=>{m&&!d&&(C?((0,s.VK)(Um+o.xB5),function(e){Qm();const{container:t,toggler:i,toggleAvatars:s,ribbonPeers:n,leftMainHeader:a}=zm(e);if(!(i&&s&&n&&t&&a))return;const{right:l}=a.getBoundingClientRect(),c=s[0],d=s[s.length-1],h=$m(c);Array.from(n).reverse().forEach(((e,s,{length:n})=>{const a=$m(e);if(!a)return;const m=a===h;let u=qm(i,a),p=Km+s+1;if(u||(u=s===n-1?d:c,p=Km),!u)return;const{top:v,left:g,width:b}=e.getBoundingClientRect();let{left:f,width:C,top:y}=u.getBoundingClientRect();if(g>l)return;f-=Jm,C+=2*Jm;const S=f-g,w=y-v-Gm,k=C/b;y-=Jm;const N=g-f+2*Jm,I=v-y+Jm,P=b/(C+2*Jm);(0,r.RK)((()=>{const i=Hm(e);let s;p>Km?(s=Hm(u),m&&s.classList.add(_m)):i.classList.add(Em,Vm),(0,A.ZM)(i,{top:`${v}px`,left:`${g}px`,width:`${b}px`,zIndex:String(p)}),s&&(0,A.ZM)(s,{top:`${y}px`,left:`${f}px`,zIndex:String(p),opacity:"0",transform:`translate3d(${N}px, ${I}px, 0) scale(${P})`}),e.classList.add("animating"),u.classList.add("animating"),t.appendChild(i),s&&t.appendChild(s),(0,r.RK)((()=>{(0,A.ZM)(i,{opacity:s?"0":"",transform:`translate3d(${S}px, ${w}px, 0) scale(${k})`}),s?(0,A.ZM)(s,{opacity:"",transform:""}):i.classList.remove(Vm);const n=Wm((()=>{(0,r.RK)((()=>{t.contains(i)&&t.removeChild(i),s&&t.contains(s)&&t.removeChild(s),e.classList.remove("animating"),u.classList.remove("animating")})),jm.delete(n)}),Um+o.xB5);jm.add(n)}))}))}))}(h)):((0,s.VK)(Um+o.xB5),function(e){Qm();const{container:t,toggler:i,leftMainHeader:s,ribbonPeers:n,toggleAvatars:a}=zm(e);if(!(i&&a&&n&&t&&s))return;const{bottom:l,right:c}=s.getBoundingClientRect(),d=l+Om,h=a[0],m=a[a.length-1],u=$m(h);Array.from(n).reverse().forEach(((e,s,{length:n})=>{const a=$m(e);if(!a)return;const l=a===u;let p=qm(i,a),v=Km+s+1;if(p||(p=s===n-1?m:h,v=Km),!p)return;let{top:g,left:b,width:f}=p.getBoundingClientRect();const{left:C,width:y}=e.getBoundingClientRect();if(C>c)return;b-=Jm,f+=2*Jm;const S=b-C,w=g-d,k=f/y;g-=Jm;const N=C-b+2*Jm,I=d-g+Jm,P=y/(f+2*Jm);(0,r.RK)((()=>{if(!p)return;const i=Hm(e);let s;v>Km?(s=Hm(p),l&&s.classList.add(_m)):i.classList.add(Em),(0,A.ZM)(i,{top:`${d}px`,left:`${C}px`,zIndex:String(v),opacity:s?"0":"",transform:`translate3d(${S}px, ${w}px, 0) scale(${k})`}),s&&(0,A.ZM)(s,{top:`${g}px`,left:`${b}px`,zIndex:String(v)}),t.appendChild(i),s&&t.appendChild(s),p.classList.add("animating"),e.classList.add("animating"),(0,r.RK)((()=>{(0,A.ZM)(i,{opacity:"",transform:""}),s?(0,A.ZM)(s,{opacity:"0",transform:`translate3d(${N}px, ${I}px, 0) scale(${P})`}):i.classList.add(Vm);const n=Wm((()=>{(0,r.RK)((()=>{t.contains(i)&&t.removeChild(i),s&&t.contains(s)&&t.removeChild(s),p?.classList.remove("animating"),e.classList.remove("animating"),jm.delete(n)}))}),Um+o.xB5);jm.add(n)}))}))}))}(h)))}),[h,C,m,d]),S)return(0,ee.Y)("button",{ref:y,type:"button",id:"StoryToggler",className:"QOz6fQFU","aria-label":v("Chat.Context.Peer.OpenStory"),onClick:()=>p({isShown:!0,isArchived:h}),dir:v.isRtl?"rtl":void 0,children:g.map((e=>(0,ee.Y)(Dt.A,{peer:e,size:"tiny",className:"dXSy0i2c",withStorySolid:!0,forceFriendStorySolid:b[e.id]},e.id)))})})));var su=i(41118),nu=i(35033);const au=(0,s.ph)((({isActive:e,isForumPanelOpen:t,archiveSettings:i,isStoryRibbonShown:a,onReset:r,onTopicSearch:l,foldersDispatch:c})=>{const{updateArchiveSettings:d}=(0,n.ko)(),h=(0,M.A)();(0,fe.A)({isActive:e,onBack:r});const m=(0,D.A)((()=>{d({isHidden:!1})})),{shouldDisableDropdownMenuTransitionRef:u,handleDropdownMenuTransitionEnd:p}=function(e){const t=(0,F.A)(),i=(0,s.li)(e),n=(0,V.A)(e);return!1===e&&n!==e&&(i.current=!1),{shouldDisableDropdownMenuTransitionRef:i,handleDropdownMenuTransitionEnd:function(){i.current=Boolean(e),t()}}}(t),{shouldRender:v,transitionClassNames:g}=(0,Oe.A)(!t,void 0,void 0,!1),{shouldRenderForumPanel:A,handleForumPanelAnimationEnd:b,handleForumPanelAnimationStart:f,isAnimationStarted:C}=(0,Zm.A)(t),y=t&&C,{shouldRender:S,transitionClassNames:w,isClosing:k}=(0,Oe.A)(a,void 0,void 0,"",!1,Um+o.xB5);return(0,ee.FD)("div",{className:"ArchivedChats",children:[(0,ee.FD)("div",{className:(0,me.A)("left-header",!S&&"left-header-shadow"),children:[h.isRtl&&(0,ee.Y)("div",{className:"DropdownMenuFiller"}),(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:r,ariaLabel:"Return to chat list",className:(0,me.A)(h.isRtl&&"rtl",y&&h.isRtl&&"right-aligned",u.current&&h.isRtl&&"disable-transition"),onTransitionEnd:p,children:(0,ee.Y)(q.A,{name:"arrow-left"})}),v&&(0,ee.Y)("h3",{className:g,children:h("ArchivedChats")}),(0,ee.Y)("div",{className:"story-toggler-wrapper",children:(0,ee.Y)(iu,{canShow:!0,isArchived:!0})}),i.isHidden&&(0,ee.Y)(le.A,{className:"archived-chats-more-menu",positionX:"right",onTransitionEnd:h.isRtl?p:void 0,children:(0,ee.Y)(ce.A,{icon:"archive-from-main",onClick:m,children:h("lng_context_archive_to_list")})})]}),(0,ee.FD)("div",{className:(0,me.A)("chat-list-wrapper",S&&"with-story-ribbon",w),children:[S&&(0,ee.Y)(eu,{isArchived:!0,className:"left-header-shadow",isClosing:k}),(0,ee.Y)(su.A,{folderType:"archived",isActive:e,isForumPanelOpen:y,isMainList:!0,foldersDispatch:c,archiveSettings:i})]}),A&&(0,ee.Y)(nu.A,{isOpen:t,onTopicSearch:l,onOpenAnimationStart:f,onCloseAnimationEnd:b})]})})),ou=(0,s.ph)((0,n.EK)((e=>{const{byId:t,orderedIds:i}=e.chatFolders;return{foldersById:t,folderOrderedIds:i}}))((({isOpen:e,chatId:t,foldersById:i,folderOrderedIds:a,onClose:r,onCloseAnimationEnd:l})=>{const{editChatFolders:c}=(0,n.ko)(),d=(0,M.A)(),h=(0,s.Kr)((()=>i?Object.keys(i).reduce(((e,s)=>{const{includedChatIds:n,pinnedChatIds:a}=i[Number(s)];return(n.includes(t)||a?.includes(t))&&e.push(s),e}),[]):[]),[t,i]),[m,u]=(0,s.J0)(h),p=(0,s.Kr)((()=>a?.filter((e=>e!==o.DSF)).map((e=>{const t=i?i[e]:void 0;return{label:t?(0,ds.fd)({text:t.title.text,entities:t.title.entities,noCustomEmojiPlayback:t.noTitleAnimations}):"",value:String(e)}}))||[]),[a,i]),v=(0,s.hb)((()=>{const e=h.filter((e=>!m.includes(e))).map(Number),i=m.filter((e=>!h.includes(e))).map(Number);c({chatId:t,idsToRemove:e,idsToAdd:i}),r()}),[t,c,h,r,m]);if(i&&a)return(0,ee.FD)(Z.A,{isOpen:e,onClose:r,onCloseAnimationEnd:l,onEnter:v,className:(0,me.A)("_fJBBCCE","delete"),contentClassName:"EG5lPWY1",title:d("FilterAddTo"),children:[(0,ee.Y)("div",{className:(0,me.A)("heYMHiUt","custom-scroll"),children:(0,ee.Y)(ql.A,{options:p,selected:m,onChange:u})}),(0,ee.Y)("div",{className:"_jtqAaUU",children:(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:v,children:d("FilterAddTo")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:r,children:d("Cancel")})]})})]})})));var ru=function(e){return e.OneHour="3600",e.FourHours="14400",e.EightHours="28800",e.OneDay="86400",e.ThreeDays="259200",e.Forever="-1",e}(ru||{});const lu=(0,s.ph)((({isOpen:e,chatId:t,topicId:i,onClose:a,onCloseAnimationEnd:r})=>{const[l,c]=(0,s.J0)(ru.Forever),{updateChatMutedState:d,updateTopicMutedState:h}=(0,n.ko)(),m=(0,M.A)(),u=(0,s.Kr)((()=>[{label:m("MuteFor.Hours",1),value:ru.OneHour},{label:m("MuteFor.Hours",4),value:ru.FourHours},{label:m("MuteFor.Hours",8),value:ru.EightHours},{label:m("MuteFor.Days",1),value:ru.OneDay},{label:m("MuteFor.Days",3),value:ru.ThreeDays},{label:m("MuteFor.Forever"),value:ru.Forever}]),[m]),p=(0,s.hb)((()=>{let e;e=l===ru.Forever?o.fRl:Math.floor(Date.now()/1e3)+Number(l),i?h({chatId:t,topicId:i,mutedUntil:e}):d({chatId:t,mutedUntil:e}),a()}),[t,l,a,i]);return(0,ee.FD)(Z.A,{isOpen:e,onClose:a,onCloseAnimationEnd:r,onEnter:p,className:"delete",title:m("Notifications"),children:[(0,ee.Y)(X.A,{className:"dialog-checkbox-group",name:"muteFor",options:u,selected:l,onChange:c}),(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(W.A,{color:"primary",className:"confirm-dialog-button",isText:!0,onClick:p,children:m("Common.Done")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:a,children:m("Cancel")})]})]})}));var cu=i(99515),du=i(24531);const hu=(0,s.ph)((0,n.EK)(((e,{fromSticker:t,stickerSetShortName:i})=>{const s=(0,c.Xf0)(e),{chatId:n,threadId:a}=s||{},o=n&&(0,c.hds)(e,n),r=n?(0,c.AWZ)(e,n):void 0,d=o?(0,l.Q_)(o,r):void 0,h=n&&a?(0,c.Vw0)(e,n,a):void 0,m=Boolean(!h?.isCommentsInfo&&h?.fromChannelId),u=n&&a?(0,c.S0q)(e,n,a):void 0,p=Boolean(o&&a&&(0,l.__)(o,u,m,r)&&d?.canSendStickers),v=Boolean(n)&&(0,c.nZ4)(e,n),g=t?t.stickerSetInfo:i?{shortName:i}:void 0,A=g?(0,c.ycM)(e,g):void 0,b=n?(0,c.WA9)(e,n):void 0;return{canScheduleUntilOnline:Boolean(n)&&(0,c.RBq)(e,n),canSendStickers:p,isSavedMessages:v,shouldSchedule:!b&&(0,c.PIP)(e),stickerSet:A,isCurrentUserPremium:(0,c.g29)(e),shouldUpdateStickerSetOrder:e.settings.byKey.shouldUpdateStickerSetOrder,currentMessageList:s}}))((({isOpen:e,fromSticker:t,stickerSetShortName:i,stickerSet:a,canSendStickers:r,canScheduleUntilOnline:l,shouldSchedule:c,isSavedMessages:d,isCurrentUserPremium:h,shouldUpdateStickerSetOrder:m,currentMessageList:u,onClose:p})=>{const{loadStickers:v,toggleStickerSet:g,sendMessage:A,showNotification:b}=(0,n.ko)(),f=(0,s.li)(),C=(0,s.li)(),y=(0,M.A)(),{isMobile:S}=(0,I.Ay)(),w=(0,V.A)(a),k=a||w,N=Boolean(!k?.isArchived&&k?.installedDate),P=k?.isEmoji,[Y,F]=(0,du.A)(l),{handleScroll:D,isAtBeginning:T}=Fs(),{observe:B}=(0,gr.BL)({rootRef:f,throttleMs:200,isDisabled:!e});(0,s.vJ)((()=>{e&&!k?.stickers&&v({stickerSetInfo:t?t.stickerSetInfo:{shortName:i}})}),[e,t,v,i,k]);const R=(0,s.hb)(((e,t,i)=>{u&&(e={...e,isPreloadedGlobally:!0},c||i?Y((i=>{A({messageList:u,sticker:e,isSilent:t,scheduledAt:i}),p()})):(A({messageList:u,sticker:e,isSilent:t,shouldUpdateStickerSetOrder:m&&N}),p()))}),[u,c,Y,p,m,N]),L=(0,s.hb)((()=>{k&&(g({stickerSetId:k.id}),p())}),[p,k,g]),x=(0,s.hb)((()=>{if(!k)return;const{shortName:e}=k,t=P?"addemoji":"addstickers",i=`${o.jsp}${t}/${e}`;(0,uc.eM)(i),b({message:y("LinkCopied")})}),[P,y,k,b]),E=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.Y)(W.A,{round:!0,ripple:!S,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",children:(0,ee.Y)(q.A,{name:"more"})})),[S]);return(0,ee.FD)(Z.A,{className:(0,me.A)("StickerSetModal",P&&"custom-emoji"),isOpen:e,onClose:p,header:function(){const e=(0,me.A)("modal-header",!T&&"with-top-border");return(0,ee.FD)("div",{className:e,dir:y.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:y("Close"),onClick:p,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:"modal-title",children:k?(0,Ft.A)(k.title,["emoji","links"]):y("AccDescrStickerSet")}),(0,ee.Y)(le.A,{className:"stickers-more-menu with-menu-transitions",trigger:E,positionX:"right",children:(0,ee.Y)(ce.A,{icon:"copy",onClick:x,children:y("StickersCopy")})})]})}(),children:[k?.stickers?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{ref:f,className:"stickers custom-scroll",onScroll:D,children:(0,ee.FD)("div",{className:"shared-canvas-container stickers-grid",children:[(0,ee.Y)("canvas",{ref:C,className:"shared-canvas"}),k.stickers.map((e=>(0,ee.Y)(Fr,{sticker:e,size:P?o.$nk:o.GhT,observeIntersection:B,onClick:r&&!P?R:void 0,clickArg:e,isSavedMessages:d,isCurrentUserPremium:h,sharedCanvasRef:C})))]})}),(0,ee.Y)("div",{className:"button-wrapper",children:(0,ee.Y)(W.A,{size:"smaller",fluid:!0,color:N?"danger":"primary",onClick:L,children:(()=>{if(!k)return y("Loading");const e=P?"Emoji":"Sticker";return y(N?`StickerPack.Remove${e}Count`:`StickerPack.Add${e}Count`,k.count,"i")})()})})]}):(0,ee.Y)(zs.A,{}),F]})}))),mu={root:"nZYT4vJ3",sets:"JzkmXjFF"},uu=(0,s.ph)((0,n.EK)((e=>({canPlayAnimatedEmojis:(0,c.BWX)(e)})))((({customEmojiSetIds:e,canPlayAnimatedEmojis:t,onClose:i})=>{const{openStickerSet:a}=(0,n.ko)(),o=(0,M.A)(),r=(0,s.Kr)((()=>e?.map((e=>(0,n.mS)().stickers.setsById[e]))),[e]),l=(0,s.li)(),{observe:c}=(0,gr.BL)({rootRef:l,isDisabled:!r}),d=(0,V.A)(r),h=r||d,m=(0,D.A)((e=>{a({stickerSetInfo:e.stickerSetInfo})}));return(0,ee.Y)(Z.A,{isOpen:Boolean(r),className:mu.root,onClose:i,hasCloseButton:!0,title:o("lng_custom_emoji_used_sets"),children:(0,ee.Y)("div",{className:(0,me.A)(mu.sets,"custom-scroll"),ref:l,teactFastList:!0,children:h?.map((e=>(0,ee.Y)(Zd,{className:mu.setCard,stickerSet:e,onClick:m,observeIntersection:c,noPlay:!t},e.id)))})})})));var pu=i(54314),vu=i(60859);const gu={settings:{icon:"bots",label:"BotSettings"},help:{icon:"help",label:"BotHelp"}},Au=(0,s.ph)((0,n.EK)(((e,{chatId:t,threadId:i})=>{const s=(0,c.hds)(e,t);if(!s||s.isRestricted)return{};const n=(0,u.L8)(s.id),a=n?(0,c.mBe)(e,t):void 0,o=a&&(0,l.Gh)(a),r=i===U.l3,d=(0,c.nZ4)(e,t),{chatId:h,threadId:m}=(0,c.Xf0)(e)||{},p=r&&!a&&((0,l.WX)(s)||(0,l.YE)(s)),v=(0,l.DX)(t)?void 0:(0,c.yps)(e,t),g=n?(0,c.vGo)(e,t):void 0,A=n?void 0:(0,c.AWZ)(e,t),b=g||A,f=(0,c.X2D)(e,t),C=(0,c.S0q)(e,t,i),y=s.isForum&&(s.isCreator||!(0,l.Sq)(s,"manageTopics")||(0,l.ub)(s,"manageTopics")),S=C&&(0,l.l1)(s,C),w=(0,c.e5V)(e,t),k=(0,c.jGY)(e,t)&&b?.isTranslationDisabled,N=(0,l.cG)(t,i,e.currentUserId)?(0,c.hds)(e,String(i)):void 0,I=(0,c.trm)(e);return{chat:s,isMuted:(0,Nc.If)(s,(0,c.K52)(e),(0,c.P5N)(e,s.id)),isPrivate:n,isTopic:s?.isForum&&!r,isForum:s?.isForum,isForumAsMessages:s?.isForumAsMessages,canAddContact:o,canDeleteChat:(0,l.IC)(s),canReportChat:p,canGift:f,hasLinkedChat:Boolean(A?.linkedChatId),botCommands:v?g?.botInfo?.commands:void 0,botPrivacyPolicyUrl:v?g?.botInfo?.privacyPolicyUrl:void 0,isChatInfoShown:(0,c.nTw)(e).isChatInfoShown&&h===t&&m===i,canCreateTopic:y,canEditTopic:S,canManage:w,isRightColumnShown:(0,c.gjV)(e),canTranslate:k,isBlocked:g?.isBlocked,isBot:Boolean(v),isChatWithSelf:d,savedDialog:N,disallowedGifts:g?.disallowedGifts,isAccountFrozen:I}}))((({chatId:e,threadId:t,isOpen:i,withExtraActions:a,anchor:o,isChannel:r,botCommands:l,botPrivacyPolicyUrl:c,withForumActions:d,isTopic:h,isForum:m,isForumAsMessages:u,isChatInfoShown:p,canStartBot:v,canSubscribe:g,canReportChat:A,canSearch:b,canCall:f,canMute:C,canViewStatistics:y,canViewMonetization:S,canViewBoosts:w,pendingJoinRequests:k,canLeave:N,canEnterVoiceChat:P,canCreateVoiceChat:F,chat:T,isPrivate:B,isMuted:R,canDeleteChat:L,canGift:x,hasLinkedChat:E,canAddContact:V,canCreateTopic:_,canEditTopic:U,canManage:O,isRightColumnShown:K,canTranslate:J,isBlocked:G,isBot:j,isChatWithSelf:z,savedDialog:H,canShowBoostModal:$,onJoinRequestsClick:q,onSubscribeChannel:W,onSearchClick:Q,onAsMessagesClick:Z,onClose:X,onCloseAnimationEnd:te,disallowedGifts:ie,isAccountFrozen:se})=>{const{updateChatMutedState:ne,enterMessageSelectMode:ae,sendBotCommand:oe,restartBot:re,requestMasterAndJoinGroupCall:le,createGroupCall:de,openLinkedChat:he,openAddContactDialog:me,openFrozenAccountModal:ue,requestMasterAndRequestCall:pe,toggleStatistics:ve,openMonetizationStatistics:ge,openBoostStatistics:Ae,openGiftModal:be,openThreadWithInfo:fe,openCreateTopicPanel:Ce,openEditTopicPanel:ye,openChat:Se,openUrl:we,toggleManagement:ke,togglePeerTranslations:Ne,blockUser:Ie,unblockUser:Pe,setViewForumAsMessages:Ye,openBoostModal:Fe,reportMessages:De,showNotification:Me}=(0,n.ko)(),Te=(0,M.A)(),Be=(0,_i.A)(),{isMobile:Re}=(0,I.Ay)(),[Le,xe]=(0,s.J0)(!0),[Ee,Ve]=(0,s.J0)(!1),[_e,Ue]=(0,s.J0)(!1),[Ke,Je]=(0,s.J0)(!1),[Ge,je,ze]=(0,Y.A)(),{x:He,y:qe}=o;(0,Oe.A)(i,te,void 0,!1);const We=(0,ls.A)(!(p||!m)||void 0,200),Qe=(0,s.Kr)((()=>{if(ie)return Object.values(ie).every(Boolean)}),[ie]),Ze=(0,D.A)((()=>{Je(!1),X()})),Xe=(0,D.A)((()=>{se?ue():(xe(!1),De({chatId:e,messageIds:[]})),X()})),et=(0,D.A)((()=>{se?(ue(),X()):Ue(!0),xe(!1)})),tt=(0,D.A)((()=>{xe(!1),X()})),it=(0,D.A)((()=>{fe({chatId:e,threadId:t}),Ve(!K),tt()})),st=(0,D.A)((()=>{Ue(!1),X()})),nt=(0,D.A)((()=>{se?ue():oe({command:"/start"})})),at=(0,D.A)((()=>{se?ue():re({chatId:e})})),ot=(0,D.A)((()=>{se?ue():ne({chatId:e,isMuted:!1}),tt()})),rt=(0,D.A)((()=>{se?(ue(),tt()):(je(),Je(!0)),xe(!1)})),lt=(0,D.A)((()=>{se?ue():(Ce({chatId:e}),Ve(!K)),tt()})),ct=(0,D.A)((()=>{se?ue():(ke({force:!0}),Ve(!K)),tt()})),dt=(0,D.A)((()=>{se?ue():(ye({chatId:e,topicId:Number(t)}),Ve(!K)),tt()})),ht=(0,D.A)((()=>{Se({id:void 0}),Ye({chatId:e,isEnabled:!1}),tt()})),mt=(0,D.A)((()=>{se?ue():F?de({chatId:e}):le({chatId:e}),tt()})),ut=(0,D.A)((()=>{he({id:e}),tt()})),pt=(0,D.A)((()=>{Qe&&T?Me({message:Be("SendDisallowError")}):(be({forUserId:e}),se?ue():be({forUserId:e}),tt())})),vt=(0,D.A)((()=>{se?ue():me({userId:e}),tt()})),gt=(0,D.A)((()=>{se?ue():W(),tt()})),At=(0,D.A)((()=>{se?ue():pe({userId:e,isVideo:!0}),tt()})),bt=(0,D.A)((()=>{se?ue():pe({userId:e}),tt()})),ft=(0,D.A)((()=>{Q(),tt()})),Ct=(0,D.A)((()=>{ve(),Ve(!K),tt()})),yt=(0,D.A)((()=>{ge({chatId:e}),Ve(!K),tt()})),St=(0,D.A)((()=>{se?ue():w?(Ae({chatId:e}),Ve(!K)):Fe({chatId:e}),tt()})),wt=(0,D.A)((()=>{Ne({chatId:e,isEnabled:!0}),tt()})),kt=(0,D.A)((()=>{se?ue():ae(),tt()})),Nt=(0,D.A)((()=>{Z(),tt()})),It=(0,D.A)((()=>{se?ue():Ie({userId:e}),tt()})),Pt=(0,D.A)((()=>{se?ue():Pe({userId:e}),tt()}));(0,s.vJ)(Ti.M6,[]);const Yt=(0,s.Kr)((()=>{const e=l?.map((({command:e})=>{const t=gu[e];if(t)return(0,ee.Y)(ce.A,{icon:t.icon,onClick:()=>{oe({command:`/${e}`}),tt()},children:Te(t.label)},e)})),t=l?.some((({command:e})=>"privacy"===e));return[...e||[],j&&(0,ee.Y)(ce.A,{icon:"privacy-policy",onClick:()=>{t&&!c?oe({command:"/privacy"}):we({url:c||Te("BotDefaultPrivacyPolicy")}),tt()},children:Te("BotPrivacyPolicy")})].filter(Boolean)}),[l,Te,c,j]),Ft=(0,s.Kr)((()=>{if(T)return Te(H?"Delete":B?"DeleteChatUser":L?"GroupInfo.DeleteAndExit":r?"LeaveChannel":"Group.LeaveGroup")}),[L,T,r,B,H,Te]);return(0,ee.Y)(Hr.A,{children:(0,ee.FD)("div",{className:"HeaderMenuContainer",children:[(0,ee.FD)($e.A,{isOpen:Le,positionX:"right",style:`left: ${He}px;top: ${qe}px;`,onClose:tt,shouldCloseFast:Ee,children:[Re&&b&&(0,ee.Y)(ce.A,{icon:"search",onClick:ft,children:Te("Search")}),d&&_&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(ce.A,{icon:"comments",onClick:lt,children:Te("lng_forum_create_topic")}),(0,ee.Y)(vu.A,{})]}),We&&(0,ee.Y)(ce.A,{icon:"info",onClick:it,children:Te(h?"lng_context_view_topic":"lng_context_view_group")}),O&&!U&&(0,ee.Y)(ce.A,{icon:"edit",onClick:ct,children:Te("Edit")}),U&&(0,ee.Y)(ce.A,{icon:"edit",onClick:dt,children:Te("lng_forum_topic_edit")}),Re&&!d&&m&&!h&&(0,ee.Y)(ce.A,{icon:"forums",onClick:ht,children:Te("Chat.ContextViewAsTopics")}),d&&Boolean(k)&&(0,ee.FD)(ce.A,{icon:"user",onClick:q,children:[Te(r?"SubscribeRequests":"MemberRequests"),(0,ee.Y)("div",{className:"right-badge",children:k})]}),d&&!h&&!u&&(0,ee.Y)(ce.A,{icon:"message",onClick:Nt,children:Te("lng_forum_view_as_messages")}),a&&v&&(0,ee.Y)(ce.A,{icon:"bots",onClick:nt,children:Te("BotStart")}),a&&g&&(0,ee.Y)(ce.A,{icon:r?"channel":"group",onClick:gt,children:Te(r?"ProfileJoinChannel":"ProfileJoinGroup")}),$&&!w&&(0,ee.Y)(ce.A,{icon:"boost-outline",onClick:St,children:Te(r?"BoostingBoostChannelMenu":"BoostingBoostGroupMenu")}),V&&(0,ee.Y)(ce.A,{icon:"add-user",onClick:vt,children:Te("AddContact")}),Re&&f&&(0,ee.Y)(ce.A,{icon:"phone",onClick:bt,children:Te("Call")}),f&&(0,ee.Y)(ce.A,{icon:"video-outlined",onClick:At,children:Te("VideoCall")}),C&&(R?(0,ee.Y)(ce.A,{icon:"unmute",onClick:ot,children:Te("ChatsUnmute")}):(0,ee.FD)(ce.A,{icon:"mute",onClick:rt,children:[Te("ChatsMute"),"..."]})),(P||F)&&(0,ee.Y)(ce.A,{icon:"voice-chat",onClick:mt,children:Te(F?"StartVoipChat":"VoipGroupJoinCall")}),E&&(0,ee.Y)(ce.A,{icon:r?"comments":"channel",onClick:ut,children:Te(r?"ViewDiscussion":"lng_profile_view_channel")}),!d&&(0,ee.Y)(ce.A,{icon:"select",onClick:kt,children:Te("ReportSelectMessages")}),w&&(0,ee.Y)(ce.A,{icon:"boost-outline",onClick:St,children:Te("Boosts")}),y&&(0,ee.Y)(ce.A,{icon:"stats",onClick:Ct,children:Te("Statistics")}),r&&S&&(0,ee.Y)(ce.A,{icon:"cash-circle",onClick:yt,children:Te("lng_channel_earn_title")}),J&&(0,ee.Y)(ce.A,{icon:"language",onClick:wt,children:Te("lng_context_translate")}),A&&(0,ee.Y)(ce.A,{icon:"flag",onClick:Xe,children:Te("ReportPeer.Report")}),Yt,x&&(0,ee.Y)(ce.A,{icon:"gift",onClick:pt,children:Te("ProfileSendAGift")}),j&&(0,ee.Y)(ce.A,{icon:G?"bots":"hand-stop",onClick:G?at:It,children:Te(G?"BotRestart":"Bot.Stop")}),B&&!z&&!j&&(0,ee.Y)(ce.A,{icon:G?"user":"hand-stop",onClick:G?Pt:It,children:Te(G?"Unblock":"BlockUser")}),N&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(vu.A,{}),(0,ee.Y)(ce.A,{destructive:!0,icon:"delete",onClick:et,children:Ft})]})]}),T&&(0,ee.Y)(pu.A,{isOpen:_e,onClose:st,chat:H||T,isSavedDialog:Boolean(H)}),C&&Ge&&T?.id&&(0,ee.Y)(Fc.A,{isOpen:Ke,onClose:Ze,onCloseAnimationEnd:ze,chatId:T.id})]})})})));var bu=i(92915),fu=i(81642),Cu=i(18653);const yu={root:"vv5ppXel",active:"FVgqrSSK",info:"DboxqiZd",topRow:"Ymu2m1PR",meta:"A2rsvUBm",subtitle:"qUzmwaIn"},Su=(0,s.ph)((({isActive:e,message:t,senderPeer:i,messageChat:s,shouldShowChat:n,query:a,className:o,onClick:r})=>{const l=(0,M.A)(),c=t.forwardInfo?.hiddenUserName,d=n?s:i,h=n&&i?(0,Yt.Q5)(l,t.chatId,i):void 0,m=(0,D.A)((()=>{r(t)}));return(0,ee.FD)("div",{role:"button",tabIndex:0,className:(0,me.A)(yu.root,e&&yu.active,o),onClick:m,children:[(0,ee.Y)(Dt.A,{className:yu.avatar,peer:d,text:c,size:"medium"}),(0,ee.FD)("div",{className:yu.info,children:[(0,ee.FD)("div",{className:yu.topRow,children:[d&&(0,ee.Y)(Hs.A,{peer:d,withEmojiStatus:!0})||c,(0,ee.Y)(fu.A,{className:yu.meta,message:t})]}),(0,ee.FD)("div",{className:yu.subtitle,dir:"auto",children:[h&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("span",{className:"sender-name",children:(0,Ft.A)(h)}),(0,ee.Y)("span",{className:"colon",children:":"})]}),(0,ee.Y)(Cu.A,{message:t,highlight:a,truncateLength:200})]})]})]})})),wu={root:"FTMljUuX",header:"OvmjSMwA",active:"DEIUzXQd",avatar:"mp1PmoMq",input:"z2K8Q7ib",mobile:"u0fb78AA",focused:"dqF8dYNx",withDropdown:"AqhBggrp",adaptSearchBorders:"Q9RZQaTu",dropdown:"MFGvbICO",dropdownHidden:"Alee0CKy",results:"RtfTOE72",placeholder:"O1HoZFge",separator:"_Yy43QLl",savedTags:"BcvAfv1E",wrap:"JkESCST6",searchTags:"rO3pH3LI",savedSearchTag:"qA4gov4D",hash:"q5NOmUAM",searchTypes:"rVYZG__K",searchType:"nE1Xwoo7",selectedType:"i29dP8iT",footer:"jyS1l9yn","keyboard-visible":"ao05jKHW",keyboardVisible:"ao05jKHW",counter:"NmmL_cO3",mobileNavigation:"dLO1hlHU",navigationButton:"Z4vLAlsu",navigationDisabled:"IqA7R2xO",jumpIn:"n9kXbTu6"},ku={isCustomPeer:!0,avatarIcon:"channel-filled",titleKey:"SearchPublicPosts"},Nu="MiddleSearchResult",Iu=(0,ve.sg)((e=>e()),200,!1),Pu=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.Xf0)(e);if(!t)return{};const{chatId:i,threadId:s}=t,n=(0,c.hds)(e,i);if(!n)return{};const{requestedQuery:a,savedTag:o,results:r,fetchingQuery:d,isHashtag:h,type:m}=(0,c.TCk)(e)||{},{totalCount:u,foundIds:p,query:v}=r||{},g=e.currentUserId,A=(0,c.nZ4)(e,i),b=(0,l.cG)(i,s,g),f=A&&!b?e.savedReactionTags?.byKey:void 0;return{chat:n,requestedQuery:a,totalCount:u,threadId:s,foundIds:p,isHistoryCalendarOpen:Boolean((0,c.nTw)(e).historyCalendarSelectedAt),savedTags:f,savedTag:o,isCurrentUserPremium:(0,c.g29)(e),isSavedMessages:A,fetchingQuery:d,isHashtagQuery:h,currentUserId:g,searchType:m,lastSearchQuery:v}}))((({isActive:e,chat:t,threadId:i,requestedQuery:a,savedTags:d,savedTag:m,totalCount:u,lastSearchQuery:p,foundIds:v,isHistoryCalendarOpen:g,isCurrentUserPremium:A,isSavedMessages:f,fetchingQuery:C,isHashtagQuery:y,searchType:S="chat",currentUserId:w})=>{const{updateMiddleSearch:k,resetMiddleSearch:N,performMiddleSearch:P,focusMessage:F,closeMiddleSearch:T,openHistoryCalendar:B,openPremiumModal:R,loadSavedReactionTags:L}=(0,n.ko)(),x=(0,s.li)(),E=(0,s.li)(),V=(0,s.li)(),_=(0,s.li)(!1),{isMobile:U}=(0,I.Ay)(),O=(0,M.A)(),K=(0,_i.A)(),[J,G]=(0,s.J0)(a||""),[j,z]=(0,s.J0)(0),H=v&&j>0,$=v&&j<v.length-1,[Q,Z]=(0,s.J0)(!e),X=(0,s.li)(),te=(0,s.li)(!0),[ie,se,ne]=(0,Y.A)(),[ae,oe]=(0,s.J0)(!0),[re,le]=(0,s.J0)(!1);!function(e,t){const i=(0,D.A)((i=>{e.every((e=>e.current&&!e.current.contains(i.target)))&&t(i)}));(0,s.vJ)((()=>(document.addEventListener("click",i),()=>{document.removeEventListener("click",i)})),[i])}([x],(0,D.A)((e=>{te.current||e.target.closest(".Modal")||ne()})));const ce=Boolean(J&&v||y),de=y&&!J,he=Boolean(J&&v&&!v.length&&!re&&!de),ue=e&&(ae||!U)&&(ie||"myChats"===S||"channels"===S)&&Boolean(ce||he||de||d),pe=Boolean(J&&!de||m),ge="chat"===S&&Boolean(v?.length),Ae=(0,D.A)((()=>{T()})),be=(0,D.A)((()=>{(0,r.YS)((()=>{E.current?.focus()}))})),Ce=(0,D.A)((()=>{E.current?.blur()}));(0,s.vJ)((()=>{const{visualViewport:e}=window;if(!e)return;const t=document.getElementById("Main"),i=()=>{const{activeElement:i}=document;if(i&&i===E.current){const{pageTop:i,height:s}=e;(0,r.RK)((()=>{t.style.transform=`translateY(${i}px)`,t.style.height=`${s}px`,document.documentElement.scrollTop=i}))}else(0,r.RK)((()=>{t.style.transform="",t.style.height=""}))};return e.addEventListener("resize",i),()=>{e.removeEventListener("resize",i)}}),[]),(0,s.vJ)((()=>{z(-1)}),[p]),(0,s.Nf)((()=>{b.pz&&Array.from(document.querySelectorAll("input")).forEach((t=>{t.disabled=Boolean(e&&t!==E.current)}))}),[e]),(0,s.vJ)((()=>{e?(Z(!1),clearTimeout(X.current)):(E.current.blur(),oe(!0),z(0),G(""),X.current=window.setTimeout((()=>Z(!0)),200))}),[e]),(0,s.vJ)((()=>{a&&t?.id&&(G(a),k({chatId:t.id,threadId:i,update:{requestedQuery:void 0}}),le(!0),(0,r.Uz)((()=>{const e=E.current;e&&((0,Mi.A)(e,!0,!0),se())})))}),[t?.id,a,i]),(0,wi.A)((([t])=>{e!==t&&!J&&p&&G(p)}),[e,p,J]),(0,wi.A)((([t])=>{e&&t!==g&&(g?(Ce(),ne()):be())}),[g,e]);const ye=(0,D.A)((()=>{J?.length||m?(G(""),le(!1),N(),be()):Ae()}));(0,s.vJ)((()=>e?(0,h.A)(ye):void 0),[e,Ae]);const Se=(0,s.Kr)((()=>{if(d)return Object.values(d)}),[d]),we=Boolean(Se?.length),ke=we&&!A;(0,s.vJ)((()=>{f&&e&&L()}),[f,e]);const Ne=(0,D.A)((()=>{const e=t?.id;e&&Iu((()=>{_.current||P({chatId:e,threadId:i,query:J})}))})),Ie=(0,D.A)((e=>{if(_.current=!1,e.startsWith("#")&&!y)return k({chatId:t.id,threadId:i,update:{isHashtag:!0}}),G(e.slice(1)),void Ne();G(e),e||(le(!1),N(),_.current=!0)}));(0,s.vJ)((()=>{J&&Ne()}),[J]),(0,s.vJ)((()=>{le(Boolean(C))}),[C]),(0,s.vJ)((()=>{v?.length&&v.length-j<5&&Ne()}),[j,v?.length]),(0,s.vJ)((()=>{if(e)return te.current=!0,window.addEventListener("touchend",t),window.addEventListener("mouseup",t),window.addEventListener("touchstart",i),window.addEventListener("mousedown",i),()=>{i(),window.removeEventListener("touchstart",i),window.removeEventListener("mousedown",i)};function t(){E.current?.focus(),se(),(0,ve.IJ)((()=>{te.current=!1}))}function i(){window.removeEventListener("touchend",t),window.removeEventListener("mouseup",t),(0,ve.IJ)((()=>{te.current=!1}))}}),[e]),(0,fe.A)({isActive:e,onBack:Ae});const[Pe,Ye,Fe=0]=(0,Js.A)(Ne,v),De=(0,s.Kr)((()=>{if(!J&&!m||!Pe?.length)return Ci.p;const e=(0,n.mS)();return Pe.map((t=>{const[i,s]=(0,bc.a)(t),n=(0,c.O5q)(e,i,s);if(!n)return;const a=f||(0,l.DX)(i)||i===o.Ckz?(0,c.Szq)(e,n):void 0,r=(0,c.Y7C)(e,n);return{searchResultKey:t,message:n,messageChat:(0,c.hds)(e,n.chatId),senderPeer:a||r}})).filter(Boolean)}),[J,m,Pe,f]),Me=(0,D.A)((e=>{const t=(0,bc.D)(e),s=v?.indexOf(t)||0;z(s+Fe),"chat"===S&&oe(!1),F({chatId:e.chatId,messageId:e.id,threadId:y?void 0:i}),ne()})),Te=(0,D.A)((()=>{oe((e=>!e)),se()})),Be=(0,js.A)(V,ce,(e=>{const t=De?.[-1===e?0:e];t&&(Me(t.message),z(e+Fe))}),`.${Nu}`,!0),Re=(0,D.A)((e=>{k({chatId:t.id,threadId:i,update:e}),Ne()})),Le=(0,D.A)((e=>{ke?R({initialSection:"saved_tags"}):Re({savedTag:e})})),xe=(0,D.A)((()=>{Re({savedTag:void 0})})),Ee=(0,D.A)((()=>{y?Re({isHashtag:!1}):m&&xe()})),Ve=(0,D.A)((e=>{Re({type:e}),oe(!0)})),_e=(0,D.A)((()=>{if("chat"===S&&(ne(),Ce(),v)){const e=j+1,[t,s]=(0,bc.a)(v[e]);F({chatId:t,messageId:s,threadId:i}),z(e)}})),Ue=(0,D.A)((()=>{if("chat"===S&&(ne(),Ce(),v)){const e=j-1,[t,s]=(0,bc.a)(v[e]);F({chatId:t,messageId:s,threadId:i}),z(e)}}));function Oe(e,i){const s=!i&&S===e;switch(e){case"chat":return(0,ee.Y)(qr.A,{className:(0,me.A)(wu.searchType,s&&wu.selectedType),peerId:t?.id,title:O("SearchThisChat"),clickArg:"chat",onClick:i?Ee:Ve});case"myChats":return(0,ee.Y)(qr.A,{className:(0,me.A)(wu.searchType,s&&wu.selectedType),peerId:w,forceShowSelf:!0,title:O("SearchMyMessages"),clickArg:"myChats",onClick:i?Ee:Ve});case"channels":return(0,ee.Y)(qr.A,{className:(0,me.A)(wu.searchType,s&&wu.selectedType),customPeer:ku,title:O("SearchPublicPosts"),clickArg:"channels",onClick:i?Ee:Ve})}}function Ke(){return(0,ee.FD)("div",{className:(0,me.A)(wu.dropdown,!ue&&wu.dropdownHidden),children:[!U&&(0,ee.Y)("div",{className:wu.separator}),we&&!y&&(0,ee.Y)("div",{className:(0,me.A)(wu.savedTags,!U&&wu.wrap,"no-scrollbar"),children:Se.map((e=>{const t=(0,l.a0)(e.reaction,m);return(0,ee.Y)(bu.A,{containerId:"local-search",reaction:e.reaction,tag:e,withCount:!0,isDisabled:ke,isChosen:t,onClick:t?xe:Le},(0,l.Jj)(e.reaction))}))}),y&&(0,ee.FD)("div",{className:(0,me.A)(wu.searchTypes,"no-scrollbar"),children:[Oe("chat"),Oe("myChats"),Oe("channels")]}),ce&&(0,ee.FD)(Ds.A,{ref:V,className:(0,me.A)(wu.results,"custom-scroll"),items:De,itemSelector:`.${Nu}`,preloadBackwards:0,onLoadMore:Ye,onKeyDown:Be,children:[he&&(0,ee.Y)("span",{className:wu.placeholder,children:O("NoResultFoundFor",J)},"nothing"),de&&(0,ee.Y)("span",{className:wu.placeholder,children:O("HashtagSearchPlaceholder")},"enterhash"),De?.map((({message:e,senderPeer:t,messageChat:i,searchResultKey:s},n)=>(0,ee.Y)(Su,{teactOrderKey:-e.date,className:Nu,query:J,message:e,senderPeer:t,messageChat:i,shouldShowChat:y,isActive:j-Fe===n,onClick:Me},s)))]})]})}return(0,ee.FD)("div",{id:"MiddleSearch",className:(0,me.A)(wu.root,e&&wu.active,!e&&Q&&"visually-hidden",ie&&wu.focused,U&&wu.mobile),ref:x,children:[(0,ee.FD)("div",{className:wu.header,children:[!U&&(0,ee.Y)(Dt.A,{className:wu.avatar,peer:t,size:"medium",isSavedMessages:f}),(0,ee.FD)(Ts.A,{ref:E,value:J,className:(0,me.A)(wu.input,ue&&wu.withDropdown,ue&&!U&&wu.adaptSearchBorders),canClose:!U,isLoading:re,resultsItemSelector:`.${wu.results} .${Nu}`,hasUpButton:ge&&!U,hasDownButton:ge&&!U,placeholder:O(y?"SearchHashtagsHint":"Search"),teactExperimentControlled:!0,onChange:Ie,onStartBackspace:Ee,onReset:ye,withBackIcon:U,onFocus:se,focused:ie,onUpClick:$?_e:void 0,onDownClick:H?Ue:void 0,children:[(0,ee.FD)("div",{className:wu.searchTags,children:[m&&(0,ee.Y)(bu.A,{containerId:"local-search-tags",className:wu.savedSearchTag,reaction:m,tag:d[(0,l.Jj)(m)],onClick:xe}),y&&(0,ee.Y)("div",{className:wu.hash,children:"#"})]}),!U&&Ke()]}),!U&&(0,ee.Y)("div",{className:wu.icons,children:(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>B({selectedAt:(0,ze.CS)(Date.now())}),ariaLabel:O("JumpToDate"),children:(0,ee.Y)(q.A,{name:"calendar"})})})]}),U&&Ke(),U&&(0,ee.FD)("div",{className:wu.footer,children:[(0,ee.Y)(W.A,{round:!0,size:"smaller",color:"translucent",onClick:()=>B({selectedAt:(0,ze.CS)(Date.now())}),ariaLabel:O("JumpToDate"),children:(0,ee.Y)(q.A,{name:"calendar"})}),(0,ee.Y)("div",{className:wu.counter,children:pe&&(v?.length?O("Of",[Math.max(j+1,1),u]):v&&!v.length&&O("NoResult"))}),"chat"===S&&Boolean(v?.length)&&(0,ee.Y)(W.A,{className:wu.viewStyle,size:"smaller",isText:!0,fluid:!0,noForcedUpperCase:!0,onClick:Te,children:O(ae?"SearchAsChat":"SearchAsList")}),ge&&!ue&&(0,ee.FD)("div",{className:wu.mobileNavigation,children:[(0,ee.Y)(W.A,{className:(0,me.A)(wu.navigationButton,!$&&wu.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:_e,nonInteractive:!$,ariaLabel:K("AriaSearchOlderResult"),children:(0,ee.Y)(q.A,{name:"up"})}),(0,ee.Y)(W.A,{className:(0,me.A)(wu.navigationButton,!H&&wu.navigationDisabled),round:!0,size:"smaller",color:"secondary",onClick:Ue,nonInteractive:!H,ariaLabel:K("AriaSearchNewerResult"),children:(0,ee.Y)(q.A,{name:"down"})})]})]})]})})));var Yu=i(80539),Fu=i(58734),Du=i(73172);const Mu=2.5*p.$,Tu=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{setsById:i,added:s,recent:n,favorite:a,effect:o}=e.stickers,r=(0,c.nZ4)(e,t),l=(0,c.hds)(e,t),d=(0,u.L8)(t)?void 0:(0,c.AWZ)(e,t)?.stickerSet?.id;return{chat:l,effectStickers:o?.stickers,effectEmojis:o?.emojis,recentStickers:n.stickers,favoriteStickers:a.stickers,stickerSetsById:i,addedSetIds:s.setIds,canAnimate:(0,c.ML4)(e),isSavedMessages:r,isCurrentUserPremium:(0,c.g29)(e),chatStickerSetId:d}}))((({chat:e,threadId:t,className:i,isHidden:a,isTranslucent:r,loadAndPlay:l,canSendStickers:c,recentStickers:d,favoriteStickers:h,effectStickers:m,effectEmojis:u,addedSetIds:p,stickerSetsById:v,chatStickerSetId:g,canAnimate:A,isSavedMessages:f,isCurrentUserPremium:C,noContextMenus:y,idPrefix:S,onStickerSelect:w,isForEffects:k})=>{const{loadRecentStickers:N,addRecentSticker:I,unfaveSticker:P,faveSticker:Y,removeRecentSticker:F}=(0,n.ko)(),T=(0,s.li)(),B=(0,s.li)(),R=(0,s.li)(),{handleScroll:L,isAtBeginning:x}=Fs(),E=(0,Du.A)(e?.id,t),V=`${S}-sticker-set`,{activeSetIndex:_,observeIntersectionForSet:U,observeIntersectionForPlayingItems:O,observeIntersectionForShowingItems:K,observeIntersectionForCovers:J,selectStickerSet:G}=fr(T,B,V,a),j=(0,M.A)(),z=Boolean(p),H=(0,s.Kr)((()=>{if(k&&m){const e=[];return u?.length&&e.push({id:o.hfH,accessHash:"0",title:"",stickers:u,count:u.length,isEmoji:!0}),m?.length&&e.push({id:o.Kp3,accessHash:"0",title:j("StickerEffects"),stickers:m,count:m.length}),e}if(!p)return Ci.p;const e=[];h.length&&e.push({id:o.tRH,accessHash:"0",title:j("FavoriteStickers"),stickers:h,count:h.length}),d.length&&e.push({id:o.sR2,accessHash:"0",title:j("RecentStickers"),stickers:d,count:d.length});const t=[...p||[]];g&&t.unshift(g);const i=Object.values((0,fi._E)(v,t));return[...e,...i]}),[p,v,h,d,g,j,m,k,u]),$=(0,s.Kr)((()=>z&&0===H.filter((e=>e.stickers?.length)).length),[H,z]);(0,s.vJ)((()=>{l&&(N(),c&&E({type:"chooseSticker"}))}),[c,l,N,E]);const Q=(0,pr.A)([],o.jhd),Z=z&&Q&&!$&&(c||k);(0,Ln.A)(B,!Z||!B.current),(0,s.vJ)((()=>{if(!z)return;const e=B.current;if(!e)return;const t=_*Mu-(e.offsetWidth/2-Mu/2);(0,Pa.A)(e,t)}),[z,_]);const X=(0,D.A)(((e,t,i)=>{w(e,t,i,!0),I({sticker:e})})),te=(0,D.A)((e=>{P({sticker:e})})),ie=(0,D.A)((e=>{Y({sticker:e})})),se=(0,D.A)((()=>{c&&E({type:"chooseSticker"})})),ne=(0,D.A)((e=>{F({sticker:e})}));if(!e)return;const ae=(0,me.A)("lq8BD6Hc",i);if(!Z)return(0,ee.Y)("div",{className:ae,children:c||k?$?(0,ee.Y)("div",{className:Kr,children:j("NoStickers")}):(0,ee.Y)(zs.A,{}):(0,ee.Y)("div",{className:Kr,children:j("ErrorSendRestrictedStickersAll")})});const oe=(0,me.A)(_r,"no-scrollbar",!x&&Ur);return(0,ee.FD)("div",{className:ae,children:[!k&&(0,ee.Y)("div",{ref:B,className:oe,children:(0,ee.FD)("div",{className:"shared-canvas-container",children:[(0,ee.Y)("canvas",{ref:R,className:"shared-canvas"}),H.map((function(t,i){const s=t.stickers?.[0],n=(0,me.A)(Or,i===_&&"y02WwQk6"),a=i<o.j41;return t.id===o.sR2||t.id===o.tRH||t.id===o.eKB||t.hasThumbnail||!s?(0,ee.Y)(W.A,{className:n,ariaLabel:t.title,round:!0,faded:t.id===o.sR2||t.id===o.tRH,color:"translucent",onClick:()=>G(i),children:t.id===o.sR2?(0,ee.Y)(q.A,{name:"recent"}):t.id===o.tRH?(0,ee.Y)(q.A,{name:"favorite"}):t.id===o.eKB?(0,ee.Y)(Dt.A,{peer:e,size:"small"}):(0,ee.Y)(kr,{stickerSet:t,noPlay:!A||!l,observeIntersection:J,sharedCanvasRef:a?R:void 0,forcePlayback:!0})},t.id):(0,ee.Y)(Fr,{sticker:s,size:o.TBj,title:t.title,className:n,noPlay:!A||!l,observeIntersection:J,noContextMenu:!0,isCurrentUserPremium:!0,sharedCanvasRef:a?R:void 0,withTranslucentThumb:r,onClick:G,clickArg:i,forcePlayback:!0},t.id)}))]})}),(0,ee.Y)("div",{ref:T,onMouseMove:se,onScroll:L,className:(0,me.A)(Er,b.TF?"no-scrollbar":"custom-scroll",!k&&Vr),children:H.map(((e,t)=>(0,ee.Y)(Lr,{stickerSet:e,loadAndPlay:Boolean(A&&l),noContextMenus:y,index:t,idPrefix:V,observeIntersection:U,observeIntersectionForPlayingItems:O,observeIntersectionForShowingItems:K,isNearActive:_>=t-1&&_<=t+1,favoriteStickers:h,isSavedMessages:f,isCurrentUserPremium:C,isTranslucent:r,isChatStickerSet:e.id===g,onStickerSelect:X,onStickerUnfave:te,onStickerFave:ie,onStickerRemoveRecent:ne,forcePlayback:!0,shouldHideHeader:e.id===o.hfH},e.id)))})]})}))),Bu=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{availableReactions:i,topReactions:s}=e.reactions,{maxUniqueReactions:n}=e.appConfig||{},{enabledReactions:a,isPaidReactionAvailable:o}=(0,c.AWZ)(e,t)||{};return{enabledReactions:a,availableReactions:i,topReactions:s,reactionsLimit:n,isWithPaidReaction:o}}))((({loadAndPlay:e,enabledReactions:t,availableReactions:i,topReactions:n,selectedReactionIds:a,isWithPaidReaction:o,message:r,reactionsLimit:c,onReactionSelect:d,onReactionContext:h})=>{const m=(0,s.li)(),u=(0,s.li)(),{width:v}=(0,we.A)(),{isTouchScreen:g}=(0,I.Ay)(),A=r?.reactions?.results,b=c&&A&&A.length>=c,f=(0,s.Kr)((()=>{if(b){const e=A.map((({reaction:e})=>e));return o&&e.unshift({type:"paid"}),e}if(!t)return[];if("all"===t.type){const e=(i||[]).map((({reaction:e})=>e));return o&&e.unshift({type:"paid"}),(0,l.fu)(e,n)}const e=t.allowed.slice();return o&&e.unshift({type:"paid"}),(0,l.fu)(e,n)}),[i,t,n,b,A,o]),C=(0,s.Kr)((()=>{const e=Math.min(26.25*p.$,v),t=(v>600?.625:.5)*p.$,i=e-.5*p.$,s=Math.floor((i+t)/(36+t)),n=Math.ceil(f.length/s),a=36*n+(n-1)*t+.5*p.$*2;return Math.min(18*p.$,a)}),[f.length,v]);return(0,ee.Y)("div",{className:"MhpiTAwi",style:`height: ${C}px`,children:(0,ee.Y)("div",{className:(0,me.A)("NIaqmosK",g?"no-scrollbar":"custom-scroll"),children:(0,ee.FD)("div",{className:"symbol-set-container shared-canvas-container",children:[(0,ee.Y)("canvas",{ref:m,className:"shared-canvas"}),(0,ee.Y)("canvas",{ref:u,className:"shared-canvas"}),f.map((t=>{const s=(0,l.Jj)(t),n=s?a?.includes(s):void 0;return(0,ee.Y)(Br,{reaction:t,isSelected:n,loadAndPlay:e,availableReactions:i,onClick:d,onContextMenu:h,sharedCanvasRef:m,sharedCanvasHqRef:u},s)}))]})})})}))),Ru=16.375*p.$,Lu=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.nTw)(e),i=e.availableEffectById,{chatId:s,messageId:n,storyPeerId:a,storyId:o,position:r,sendAsMessage:l,isForEffects:d}=t.reactionPicker||{},h=a&&o?(0,c.Msb)(e,a,o):void 0,m=s?(0,c.hds)(e,s):void 0,p=s?(0,c.AWZ)(e,s):void 0,v=s&&n?(0,c.O5q)(e,s,n):void 0,g=(0,u.L8)(s||a||""),A="some"===p?.enabledReactions?.type,{maxUniqueReactions:b}=e.appConfig||{},f="all"===p?.enabledReactions?.type&&p?.enabledReactions?.areCustomAllowed,C=v?.reactions?.results,y=Boolean(b&&C&&C.length>=b);return{message:v,story:h,position:r,shouldUseFullPicker:!(m?.isForbidden||A||y)&&(f||g),isTranslucent:(0,c.cwE)(e),isCurrentUserPremium:(0,c.g29)(e),sendAsMessage:l,isForEffects:d,chatId:s,availableEffectById:i}}))((({isOpen:e,message:t,story:i,position:a,isTranslucent:o,isCurrentUserPremium:r,shouldUseFullPicker:c,sendAsMessage:d,chatId:h,isForEffects:m,availableEffectById:u})=>{const{toggleReaction:p,closeReactionPicker:v,sendMessage:g,showNotification:A,sendStoryReaction:b,saveEffectInDraft:f,requestEffectInComposer:C,addLocalPaidReaction:y,openPaidReactionModal:S}=(0,n.ko)(),w=(0,M.A)(),k=(0,Bi.A)(t?.id,!0),N=(0,Bi.A)(t?.chatId,!0),P=(0,Bi.A)(i?.peerId,!0),Y=(0,Bi.A)(i?.id),F=(0,Bi.A)(a,!0),T=(0,s.li)(),B=(0,s.Kr)((()=>{if(F)return Y?F:{x:F.x+(c?-23:-21),y:F.y+(c?-64:-10)}}),[Y,F,c]),R=(0,D.A)((()=>T.current)),L=(0,D.A)((()=>({withPortal:!0,isDense:!P,deltaX:!(0,I.Ny)()&&T.current?-(T.current.offsetWidth-Ru)/2- -11.5:0}))),x=(0,D.A)((e=>{if(!N||!k)return;const t=e.isCustomEmoji?{type:"custom",documentId:e.id}:{type:"emoji",emoticon:e.emoji};p({chatId:N,messageId:k,reaction:t,shouldAddToRecent:!0}),v()})),E=(0,D.A)((e=>{N&&k&&("paid"===e.type?y({chatId:N,messageId:k,count:1}):p({chatId:N,messageId:k,reaction:e,shouldAddToRecent:!0}),v())})),V=(0,D.A)((e=>{"paid"===e.type&&(S({chatId:N,messageId:k}),v())})),_=(0,D.A)((e=>{if("type"in e&&"paid"===e.type)return;const t="id"in e?{type:"custom",documentId:e.id}:e,i="type"in e&&"custom"===e.type?(0,n.mS)().customEmojis.byId[e.documentId]:"id"in e?e:void 0;if(i&&!i.isFree&&!r)return A({message:w("UnlockPremiumEmojiHint"),action:{action:"openPremiumModal",payload:{initialSection:"animated_emoji"}},actionText:w("PremiumMore")}),void v();if(!d)return b({peerId:P,storyId:Y,containerId:(0,l.$_)(P,Y),reaction:t,shouldAddToRecent:!0}),void v();let s,a;if("type"in e&&"emoji"===e.type)s=e.emoticon;else{const e=(0,Yu.Ay)((0,Fu.hB)(i));s=e.text,a=e.entities}g({text:s,entities:a,isReaction:!0}),v()})),O=(0,D.A)((e=>{const t=Object.values(u),i=t.find((t=>t.effectStickerId===e.id))?.id;h&&f({chatId:h,threadId:U.l3,effectId:i}),i&&C({}),v()})),K=(0,s.Kr)((()=>(t?.reactions?.results||[]).reduce(((e,{chosenOrder:t,reaction:i})=>(void 0!==t&&e.push((0,l.Jj)(i)),e)),[])),[t?.reactions?.results]);return(0,ee.Y)($e.A,{isOpen:e,ref:T,className:(0,me.A)("gBh4WvBC","ReactionPicker"),bubbleClassName:(0,me.A)("qSfKwMzX",!c&&!Y&&"dRNSqkOC",Y&&"srpBMrqr"),withPortal:!0,noCompact:!0,anchor:B,positionY:i&&"bottom",getTriggerElement:xu,getRootElement:Eu,getMenuElement:R,getLayout:L,backdropExcludedSelector:".Modal.confirm",onClose:v,children:m&&h?(0,ee.Y)(Tu,{className:"",isHidden:!e,loadAndPlay:Boolean(e&&c),idPrefix:"message-effect",canSendStickers:!1,noContextMenus:!1,chatId:h,isTranslucent:o,onStickerSelect:O,isForEffects:m}):(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(zr,{chatId:N,idPrefix:"message-emoji-set-",isHidden:!e||!(c||Y),loadAndPlay:Boolean(e&&c),isReactionPicker:!0,className:c||Y?void 0:"KVwgF6DG",selectedReactionIds:K,isTranslucent:o,onCustomEmojiSelect:Y?_:x,onReactionSelect:Y?_:E,onReactionContext:V}),!c&&Boolean(N)&&(0,ee.Y)(Bu,{chatId:N,loadAndPlay:e,onReactionSelect:Y?_:E,onReactionContext:V,selectedReactionIds:K,message:t})]})})})));function xu(){return document.querySelector("body")}function Eu(){return document.querySelector("body")}var Vu=i(39074),_u=i(45761);const Uu=document.createElement("div");var Ou=i(41316),Ku=i(3225),Ju=i(25498),Gu=i(9442),ju=i(91525),zu=i(52988),Hu=i(27860);const $u="SHoF85Vw",qu="Zo7u5epf",Wu=15*p.$,Qu=(0,s.ph)((({attachment:e,className:t,isSingle:i,shouldDisplayCompressed:n,shouldDisplayGrouped:a,index:r,onDelete:l,onToggleSpoiler:c})=>{const d=function(e,t){if(t&&e.quick){if(o.gex.has(e.mimeType))return"photo";if(o.fNs.has(e.mimeType))return"video"}return"file"}(e,n),h=(0,D.A)((()=>{c?.(r)})),m=(0,s.Kr)((()=>{switch(d){case"photo":return(0,ee.Y)("img",{className:$u,src:e.blobUrl,alt:"",draggable:!1});case"video":return(0,ee.FD)(ee.FK,{children:[Boolean(e.quick?.duration)&&(0,ee.Y)("div",{className:"nI2M1SBH",children:(0,ze.QO)(e.quick.duration)}),(0,ee.Y)("video",{className:$u,src:e.blobUrl,autoPlay:!0,muted:!0,loop:!0,disablePictureInPicture:!0})]});default:return(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(zu.A,{className:"B6f6GcvN",name:e.filename,extension:(0,ju.QC)(e.filename,e.mimeType),previewData:e.previewBlobUrl,size:e.size,smaller:!0}),l&&(0,ee.Y)(q.A,{name:"delete",className:(0,me.A)(qu,"CYJwy9T_"),onClick:()=>l(r)})]})}}),[e,d,r,l]),u="file"===d||!a,p=Boolean("file"!==d&&e.shouldSendAsSpoiler),v="file"!==d,g=(0,me.A)(t,"QucaiGVU",i&&"FjrnqGba",u&&"g0cTsM9d");return(0,ee.FD)("div",{className:g,children:[m,(0,ee.Y)(Hu.A,{isVisible:p,thumbDataUri:e.previewBlobUrl||e.blobUrl,width:Wu,height:Wu}),v&&(0,ee.FD)("div",{className:"bX7LdgxW",children:[(0,ee.Y)(q.A,{name:e.shouldSendAsSpoiler?"spoiler-disable":"spoiler",className:qu,onClick:h}),l&&(0,ee.Y)(q.A,{name:"delete",className:qu,onClick:()=>l(r)})]})]})}));var Zu=i(25897),Xu=i(83689),ep=i(49068);function tp(e,t,i=!1){const s=e[i?"scrollLeft":"scrollTop"],n=s+e[i?"offsetWidth":"offsetHeight"],a=t[i?"offsetLeft":"offsetTop"],o=a+t[i?"offsetWidth":"offsetHeight"];return a>s&&o<n}function ip(e,t,i=0,s=!1,n=!1,a=!1){const o=e[a?"scrollLeft":"scrollTop"],r=o+e[a?"offsetWidth":"offsetHeight"],l="string"==typeof t?e.querySelectorAll(t):t,{length:c}=l,d=[];let h=!1;for(let e=0;e<c;e++){const t=l[e],c=t[a?"offsetLeft":"offsetTop"],m=c+t[a?"offsetWidth":"offsetHeight"];if(n?m>=o-i&&m<=r+i:c<=r+i&&m>=o-i)d.push(e),h=!0;else if(h&&!s)break}return{allElements:l,visibleIndexes:d}}function sp(e,t,i){const s=i.current;if(!s||t<0)return;const{visibleIndexes:n,allElements:a}=ip(s,e,8,!0,!0);if(!a.length||!a[t])return;const o=n[0];if(!n.includes(t)||t===o&&!tp(s,a[o])){const e=t>n[n.length-1]?"start":"end";(0,vr.Ay)({container:s,element:a[t],position:e,margin:10})}}function np({isActive:e,isHorizontal:t,shouldSaveSelectionOnUpdateItems:i,shouldRemoveSelectionOnReset:n,noArrowNavigation:a,items:o,shouldSelectOnTab:r,onSelect:l,onClose:c}){const[d,h]=(0,s.J0)(-1),m=(0,D.A)((e=>o?(0,xa.A)(o.length,e):-1)),u=(0,D.A)(((e,t)=>{t.preventDefault(),h((t=>m(t+e)))})),p=(0,D.A)((t=>{if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return!1;if(!e)return!1;if(o&&o.length&&d>-1){const e=o[d];if(e){if(!1===l(e))return!1;t.preventDefault()}}return!0}));(0,s.vJ)((()=>{e||h(n?-1:0)}),[e,n]);const v=!o||d>o.length-1;return(0,s.vJ)((()=>{i&&!v||h(n?-1:0)}),[v,n,i]),(0,s.vJ)((()=>e?(0,Ri.A)({onEsc:c,onUp:a||t?void 0:e=>u(-1,e),onDown:a||t?void 0:e=>u(1,e),onLeft:a||!t?void 0:e=>u(-1,e),onRight:a||!t?void 0:e=>u(1,e),onTab:r?p:void 0,onEnter:p}):void 0),[a,u,p,e,t,c,r]),d}const ap=(0,s.ph)((({isOpen:e,onClose:t,onInsertUserName:i,filteredUsers:a})=>{const o=(0,s.li)(),{shouldRender:r,transitionClassNames:l}=(0,Oe.A)(e,void 0,void 0,!1),c=(0,D.A)(((e,t=!1)=>{const s=(0,n.mS)().users.byId[e];s&&i(s,t)})),d=(0,D.A)(((e,t)=>{e.preventDefault(),c(t)})),h=(0,D.A)((e=>{c(e.id,!0)})),m=np({isActive:e,items:a,onSelect:h,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:t});(0,s.vJ)((()=>{sp(".chat-item-clickable",m,o)}),[m]),(0,s.vJ)((()=>{a&&!a.length&&t()}),[a,t]);const u=(0,V.A)(a?.length?a:void 0,r),p=a&&!a.length?u:a;if(!r||p&&!p.length)return;const v=(0,me.A)("MentionTooltip composer-tooltip custom-scroll",l);return(0,ee.Y)("div",{className:v,ref:o,children:p?.map((({id:e},t)=>(0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item smaller-icon",onClick:d,clickArg:e,focus:m===t,children:(0,ee.Y)(Rs.A,{userId:e,avatarSize:"small",withUsername:!0})},e)))})}));var op=i(78407),rp=i(26440);const lp="AT_d9l0W",cp="AnO3BgVv",dp="caption-input-text",hp=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{currentUserId:i,recentEmojis:s,customEmojis:n,attachmentSettings:a}=e,r=(0,c.AWZ)(e,t),l=(0,c.nZ4)(e,t),{shouldSuggestCustomEmoji:d}=e.settings.byKey,{language:h}=(0,Nn.l)(e),m=e.emojiKeywords[o.cUY],u=h!==o.cUY?e.emojiKeywords[h]:void 0;return{isChatWithSelf:l,currentUserId:i,groupChatMembers:r?.members,recentEmojis:s,baseEmojiKeywords:m?.keywords,emojiKeywords:u?.keywords,shouldSuggestCustomEmoji:d,customEmojiForEmoji:n.forEmoji.stickers,captionLimit:(0,ya.d)(e,"captionLength"),attachmentSettings:a}}))((({chatId:e,threadId:t,attachments:i,getHtml:a,editingMessage:c,canShowCustomSendMenu:d,captionLimit:m,isReady:u,isChatWithSelf:p,currentUserId:v,groupChatMembers:g,recentEmojis:A,baseEmojiKeywords:b,emojiKeywords:f,isForMessage:C,shouldSchedule:y,shouldSuggestCustomEmoji:S,customEmojiForEmoji:w,attachmentSettings:k,shouldSuggestCompression:N,shouldForceCompression:P,shouldForceAsFile:F,isForCurrentMessageList:T,forceDarkTheme:B,onAttachmentsUpdate:R,onCaptionUpdate:L,onSend:x,onFileAppend:E,onClear:_,onSendSilent:U,onSendScheduled:O,onCustomEmojiSelect:J,onRemoveSymbol:G,onEmojiSelect:j,canScheduleUntilOnline:z,canSchedule:H,onSendWhenOnline:$,paidMessagesStars:Q})=>{const X=(0,s.li)(),te=(0,s.li)(),{addRecentCustomEmoji:ie,addRecentEmoji:se,updateAttachmentSettings:ne}=(0,n.ko)(),ae=(0,M.A)(),oe=(0,_i.A)(),re=(0,s.li)(),de=(0,s.li)(),he=(0,s.li)(),ue=(0,V.A)(i),pe=i.length?i:ue,{isMobile:ve}=(0,I.Ay)(),ge=c&&Boolean(c),Ae=c&&c?.groupedId,fe="file"!==(ge&&i?.length&&(0,l.ES)(i[0])),[ye,Se,we]=(0,Y.A)(),[ke,Ne]=(0,s.J0)(N??k.shouldCompress),Ie=Boolean((ke||P||Ae)&&!F),[Pe,Ye]=(0,s.J0)(k.shouldSendGrouped),Fe=k.isInvertedMedia,{handleScroll:De,isAtBeginning:Me,isAtEnd:Te}=Fs(),{handleScroll:Be,isAtBeginning:Re}=Fs(),Le=Boolean(i.length),xe=Boolean(pe?.length),[Ee,Ve,_e]=(0,Y.A)();(0,s.vJ)((()=>{Le||(we(),ne({isInvertedMedia:void 0}))}),[we,Le]);const[Ue,Oe]=(0,s.Kr)((()=>Boolean(pe?.every((e=>e.quick||e.audio)))?[!0,!0]:[Boolean(pe?.some((e=>e.quick||e.audio))),!1]),[pe]),[Ke,Je]=(0,s.Kr)((()=>Boolean(pe?.every((e=>e.shouldSendAsSpoiler)))?[!0,!0]:[Boolean(pe?.some((e=>e.shouldSendAsSpoiler))),!1]),[pe]),Ge=(0,Ou.A)(`#${o.e0F}`),{isEmojiTooltipOpen:je,filteredEmojis:ze,filteredCustomEmojis:He,insertEmoji:$e,closeEmojiTooltip:qe}=(0,Ju.A)(Boolean(u&&(T||!C)&&xe),a,L,o.e0F,A,b,f),{isCustomEmojiTooltipOpen:We,insertCustomEmoji:Qe,closeCustomEmojiTooltip:Ze}=(0,Ku.A)(Boolean(u&&(T||!C)&&xe&&S),a,L,Ge,de,w),{isMentionTooltipOpen:Xe,closeMentionTooltip:et,insertMention:tt,mentionFilteredUsers:it}=(0,Gu.A)(Boolean(u&&T&&xe),a,L,Ge,de,g,void 0,v);function st(e){ne({isInvertedMedia:e})}(0,s.vJ)((()=>Le?(0,h.A)(_):void 0),[Le,_]),(0,s.vJ)((()=>{Le&&(Ne(N??k.shouldCompress),Ye(k.shouldSendGrouped))}),[k,Le,N]),(0,s.vJ)((()=>{Le||ne({isInvertedMedia:void 0})}),[ne,Le,N]),(0,s.vJ)((()=>{Le&&ve&&(0,Vu.DY)()}),[ve,Le]);const{isContextMenuOpen:nt,handleContextMenu:at,handleContextMenuClose:ot,handleContextMenuHide:rt}=(0,Fn.A)(re,!d||!Le),lt=(0,D.A)(((e,t)=>{Le&&(((y||t)&&C&&!c?O:e?U:x)(Ie,Pe,Fe),ne({shouldCompress:void 0===N?Ie:void 0,shouldSendGrouped:Pe,isInvertedMedia:Fe}))})),ct=(0,D.A)((()=>{lt(!0)})),dt=(0,D.A)((()=>{lt()})),ht=(0,D.A)((()=>{lt(!1,!0)})),mt=(0,D.A)((async e=>{e.preventDefault(),_e();const{dataTransfer:t}=e,i=await(0,_u.A)(t.items);i?.length&&E(i,Je)})),ut=(0,D.A)((e=>{const{files:t}=e.target,i=(0,K.kc)(t);i?.length&&E(i,Je)})),pt=(0,D.A)((()=>{(0,Ch.p)("*",(e=>ut(e)))})),vt=(0,D.A)((e=>{R(i.filter(((t,i)=>i!==e)))})),gt=(0,D.A)((()=>{R(i.map((e=>({...e,shouldSendAsSpoiler:!0}))))})),At=(0,D.A)((()=>{R(i.map((e=>({...e,shouldSendAsSpoiler:void 0}))))})),bt=(0,D.A)((e=>{R(i.map(((t,i)=>i===e?{...t,shouldSendAsSpoiler:!t.shouldSendAsSpoiler||void 0}:t)))})),ft=(0,D.A)((()=>{const e=te.current;if(!e)return;const{width:t,height:i}=e.getBoundingClientRect();e.viewBox.baseVal.width=t,e.viewBox.baseVal.height=i}));(0,Dr.A)(X,ft),(0,Ce.A)(ft),(0,s.vJ)((()=>{const e=re.current,t=document.getElementById(dp);if(!e||!t)return;const{width:i}=e.getBoundingClientRect();(0,r.RK)((()=>{t.style.setProperty("--margin-for-scrollbar",`${i}px`)}))}),[ae,Le]);const Ct=(0,s.Kr)((()=>({onTrigger:e,isOpen:t})=>(0,ee.Y)(W.A,{round:!0,ripple:!ve,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:"More actions",children:(0,ee.Y)(q.A,{name:"more"})})),[ve]),yt=(0,be.A)((()=>{if(!xe)return;const e=m-(t=a(),Uu.innerHTML=t,(0,Yu.g4)(Uu),Uu.querySelectorAll("br").forEach((e=>{e.replaceWith("\n")})),Uu.textContent?.trim().length||0);var t;return e<=100?e:void 0}),[m,a,xe]),St=Ie&&Oe,[wt,kt,Nt]=(0,s.Kr)((()=>St&&pe?[pe.every((e=>o.gex.has(e.mimeType))),pe.every((e=>o.fNs.has(e.mimeType))),pe.every((e=>o.IH3.has(e.mimeType)))]:[!1,!1,!1]),[pe,St]),It=(0,s.Kr)((()=>!!pe&&pe.some((e=>!o.IH3.has(e.mimeType)))),[pe]);if(!pe)return;const Pt=pe.length>1,Yt=!(ge||!Ue||!(F||P||Ie)||Pt&&Pe);let Ft="";const Dt=pe.length;Ft=ae(wt?ge?"EditMessageReplacePhoto":"PreviewSender.SendPhoto":kt?ge?"EditMessageReplaceVideo":"PreviewSender.SendVideo":Nt?ge?"EditMessageReplaceAudio":"PreviewSender.SendAudio":ge?"EditMessageReplaceFile":"PreviewSender.SendFile",Dt,"i");const Mt=!Te||!Re,Tt=Q?(0,xi.U)(oe,Dt*Q,{className:"C1OOt81o",asFont:!0}):ae("Send");return(0,ee.Y)(Z.A,{isOpen:Le,onClose:_,header:function(){if(pe)return(0,ee.FD)("div",{className:"modal-header-condensed",dir:ae.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel attachments",onClick:_,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:"modal-title",children:Ft}),fe&&!Ae&&(0,ee.FD)(le.A,{className:"attachmeneditingMessaget-modal-more-menu with-menu-transitions",trigger:Ct,positionX:"right",children:[Boolean(!c)&&(0,ee.Y)(ce.A,{icon:"add",onClick:pt,children:ae("Add")}),Ue&&(0,ee.FD)(ee.FK,{children:[Yt&&(Fe?(0,ee.Y)(ce.A,{icon:"move-caption-down",onClick:()=>st(void 0),children:ae("PreviewSender.MoveTextDown")}):(0,ee.Y)(ce.A,{icon:"move-caption-up",onClick:()=>st(!0),children:ae("PreviewSender.MoveTextUp")})),!F&&!P&&(Ie?(0,ee.Y)(ce.A,{icon:"document",onClick:()=>Ne(!1),children:ae(Pt?"Attachment.SendAsFiles":"Attachment.SendAsFile")}):(0,ee.Y)(ce.A,{icon:"photo",onClick:()=>Ne(!0),children:Pt?"Send All as Media":"Send as Media"})),Ie&&It&&Boolean(!c)&&(Ke?(0,ee.Y)(ce.A,{icon:"spoiler-disable",onClick:At,children:ae("Attachment.DisableSpoiler")}):(0,ee.Y)(ce.A,{icon:"spoiler",onClick:gt,children:ae("Attachment.EnableSpoiler")}))]}),Pt&&(Pe?(0,ee.Y)(ce.A,{icon:"grouped-disable",onClick:()=>Ye(!1),children:"Ungroup All Media"}):(0,ee.Y)(ce.A,{icon:"grouped",onClick:()=>Ye(!0),children:"Group All Media"}))]})]})}(),className:(0,me.A)("a27O2Qlr",Ee&&cp,!Me&&"Pc1k8G8s",ve&&"khvUZbGZ",ye&&"ir5kkMy1",B&&"component-theme-dark"),noBackdropClose:!0,isLowStackPriority:!0,children:(0,ee.FD)("div",{className:lp,onDragEnter:Ve,onDrop:mt,onDragOver:function(e){e.preventDefault(),he.current&&(window.clearTimeout(he.current),he.current=void 0)},onDragLeave:e=>{const{relatedTarget:t,target:i}=e;i.matches(`.${lp}`)&&!t&&(he.current=window.setTimeout(_e,150)),i&&i.closest(`.${cp}`)||(t&&e.stopPropagation(),_e())},onClick:_e,"data-attach-description":ae("Preview.Dragging.AddItems",10),"data-dropzone":!0,children:[(0,ee.Y)("svg",{className:"d9O65j_I",children:(0,ee.Y)("rect",{className:"jzCBDWMw",x:"0",y:"0",width:"100%",height:"100%",rx:"8"})}),(0,ee.Y)("div",{className:(0,me.A)("_bxSIFgj","custom-scroll",Mt&&"RPVunBe2"),onScroll:De,children:pe.map(((e,t)=>(0,ee.Y)(Qu,{attachment:e,shouldDisplayCompressed:Ie,shouldDisplayGrouped:Pe,isSingle:1===pe.length,index:t,onDelete:vt,onToggleSpoiler:bt},e.uniqueId||t)))}),(0,ee.FD)("div",{className:(0,me.A)("EtmiUn2k",Mt&&"FjjSKMYe"),children:[(0,ee.Y)(ap,{isOpen:Xe,filteredUsers:it,onInsertUserName:tt,onClose:et}),(0,ee.Y)(ep.A,{isOpen:je,emojis:ze,customEmojis:He,addRecentEmoji:se,addRecentCustomEmoji:ie,onEmojiSelect:$e,onCustomEmojiSelect:$e,onClose:qe}),(0,ee.Y)(Zu.A,{chatId:e,isOpen:We,addRecentCustomEmoji:ie,onCustomEmojiSelect:Qe,onClose:Ze}),(0,ee.FD)("div",{className:"Te7lIfpB",children:[(0,ee.Y)(rp.A,{chatId:e,threadId:t,isMobile:ve,isReady:u,isSymbolMenuOpen:ye,openSymbolMenu:Se,closeSymbolMenu:we,onCustomEmojiSelect:J,onRemoveSymbol:G,onEmojiSelect:j,isAttachmentModal:!0,canSendPlainText:!0,className:"attachment-modal-symbol-menu with-menu-transitions",idPrefix:"attachment",forceDarkTheme:B}),(0,ee.Y)(op.A,{ref:de,id:dp,chatId:e,threadId:t,isAttachmentModalInput:!0,customEmojiPrefix:"attachment",isReady:u,isActive:Le,getHtml:a,editableInputId:o.e0F,placeholder:ae("AddCaption"),onUpdate:L,onSend:dt,onScroll:Be,canAutoFocus:Boolean(u&&T&&i.length),captionLimit:yt,shouldSuppressFocus:ve&&ye,onSuppressedFocus:we}),(0,ee.FD)("div",{className:"wDqWK9MD",children:[(0,ee.Y)(W.A,{ref:re,className:"kNlWmBJI",onClick:dt,onContextMenu:d?at:void 0,children:y&&!c?ae("Next"):c?ae("Save"):Tt}),d&&(0,ee.Y)(Xu.A,{isOpen:nt,canSchedule:H&&C,onSendSilent:p?void 0:ct,onSendSchedule:ht,onClose:ot,onCloseAnimationEnd:rt,isSavedMessages:p,onSendWhenOnline:$,canScheduleUntilOnline:z})]})]})]})]})})}))),mp=(0,s.ph)((({isOpen:e,isQuiz:t,shouldBeAnonymous:i,onSend:n,onClear:a})=>{const o=(0,s.li)(),l=(0,s.li)(),[c,d]=(0,s.J0)(""),[m,u]=(0,s.J0)([""]),[p,v]=(0,s.J0)(!0),[g,A]=(0,s.J0)(!1),[b,f]=(0,s.J0)(t||!1),[C,y]=(0,s.J0)(""),[S,w]=(0,s.J0)(),[k,N]=(0,s.J0)(!1),I=(0,M.A)(),P=(0,D.A)((e=>{y(e.target.value)})),Y=(0,D.A)((t=>{e&&t.current&&t.current.focus()}));(0,s.vJ)((()=>e?(0,h.A)(a):void 0),[e,a]),(0,s.vJ)((()=>{e||(d(""),u([""]),v(!0),A(!1),f(t||!1),y(""),w(void 0),N(!1))}),[t,e]),(0,s.vJ)((()=>Y(o)),[Y,e]);const F=(0,D.A)(((e=[])=>{u([...e,""]),(0,r.Uz)((()=>{const e=l.current;e&&(0,r.YS)((()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})}))}))})),T=(0,D.A)((()=>{if(N(!1),!e)return;const t=b&&(void 0===S||!m[S].trim()),i=m.map(((e,t)=>{if(e=e.trim())return{text:{text:e},option:String(t),...t===S&&{correct:!0}}})).filter(Boolean),s=c.trim().substring(0,255);if(!s||i.length<2){if(d(s),i.length){const e=m.map((e=>e.trim().substring(0,100))).filter(Boolean);e.length<2?F(e):u(e)}else F();return void N(!0)}if(t)return void N(!0);const a={summary:{question:{text:s},answers:i,...!p&&{isPublic:!0},...g&&{multipleChoice:!0},...b&&{quiz:!0}}};if(b){const{text:e,entities:t}=C&&(0,Yu.Ay)(C.substring(0,200))||{};a.quiz={correctAnswers:[String(S)],...e&&{solution:e},...t&&{solutionEntities:t}}}n(a)})),B=(0,D.A)(((e,t)=>{const i=[...m];i[e]=t,i[i.length-1].trim().length&&i.length<10?F(i):u(i)})),R=(0,D.A)((e=>{const t=[...m];t.splice(e,1),u(t),void 0!==S&&(S===e?w(void 0):e<S&&w(S-1)),(0,r.Uz)((()=>{l.current&&l.current.classList.toggle("overflown",l.current.scrollHeight>320)}))})),L=(0,D.A)((e=>{w(Number(e))})),x=(0,D.A)((e=>{v(e.target.checked)})),E=(0,D.A)((e=>{A(e.target.checked)})),V=(0,D.A)((e=>{f(e.target.checked)})),_=(0,D.A)((e=>{13===e.keyCode&&T()})),U=(0,D.A)((e=>{d(e.target.value)})),O=(0,D.A)((()=>{if(k&&!c.trim().length)return I("lng_polls_choose_question")})),K=(0,D.A)((e=>{const t=m.map((e=>e.trim())).filter((e=>e.length));if(k&&t.length<2&&!m[e].trim().length)return I("lng_polls_choose_answers")}));function J(){return m.map(((e,t)=>(0,ee.FD)("div",{className:"option-wrapper",children:[(0,ee.Y)(Q.A,{maxLength:100,label:t!==m.length-1||10===m.length?I("OptionHint"):I("CreatePoll.AddOption"),error:K(t),value:e,onChange:e=>B(t,e.currentTarget.value),onKeyPress:_}),t!==m.length-1&&(0,ee.Y)(W.A,{className:"option-remove-button",round:!0,color:"translucent",size:"smaller",ariaLabel:I("Delete"),onClick:()=>R(t),children:(0,ee.Y)(q.A,{name:"close"})})]})))}return(0,ee.FD)(Z.A,{isOpen:e,onClose:a,header:(0,ee.FD)("div",{className:"modal-header-condensed",children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Cancel poll creation",onClick:a,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)("div",{className:"modal-title",children:I("NewPoll")}),(0,ee.Y)(W.A,{color:"primary",size:"smaller",className:"modal-action-button",onClick:T,children:I("Create")})]}),className:"PollModal",children:[(0,ee.Y)(Q.A,{ref:o,label:I("AskAQuestion"),value:c,error:O(),onChange:U,onKeyPress:_}),(0,ee.Y)("div",{className:"options-divider"}),(0,ee.FD)("div",{className:"options-list custom-scroll",ref:l,children:[(0,ee.Y)("h3",{className:"options-header",children:I("PollOptions")}),k&&function(){const e=m.map((e=>e.trim())).filter((e=>e.length));return b&&(void 0===S||!e[S])&&(0,ee.Y)("p",{className:"poll-error",children:I("lng_polls_choose_correct")})}(),b?(0,ee.Y)(X.A,{name:"correctOption",options:J().map(((e,t)=>({value:String(t),label:e,hidden:!m[t].trim()}))),selected:String(S),onChange:L}):J()]}),(0,ee.Y)("div",{className:"options-divider"}),(0,ee.FD)("div",{className:"quiz-mode",children:[(0,ee.FD)("div",{className:"dialog-checkbox-group",children:[!i&&(0,ee.Y)(un.A,{label:I("PollAnonymous"),checked:p,onChange:x}),(0,ee.Y)(un.A,{label:I("PollMultiple"),checked:g,disabled:b,onChange:E}),(0,ee.Y)(un.A,{label:I("PollQuiz"),checked:b,disabled:g||void 0!==t,onChange:V})]}),b&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{className:"options-header",children:I("lng_polls_solution_title")}),(0,ee.Y)(Ll.A,{value:C,onChange:P,noReplaceNewlines:!0}),(0,ee.Y)("div",{className:"note",children:I("CreatePoll.ExplanationInfo")})]})]})]})}));var up=i(36680),pp=i(52491);const vp=(0,s.ph)((({emoji:e,focus:t,onClick:i})=>{const s=(0,D.A)((t=>{t.preventDefault(),i(e.native,e.id)})),n=(0,me.A)("EmojiButton",t&&"focus"),a=`${o.jht?o.C1b:"."}/img-apple-64/${e.image}.png`,r=pp.On.has(a);return(0,ee.Y)("div",{className:n,onMouseDown:s,title:`:${e.names[0]}:`,children:b.TL?e.native:(0,ee.Y)("img",{src:a,className:r?void 0:"opacity-transition shown",alt:e.native,loading:"lazy","data-path":a,onLoad:r?void 0:pp.P_,draggable:!1})})})),gp=.625*p.$,Ap=.25*p.$,bp=.5*p.$,fp=.5*p.$,Cp=(0,s.ph)((({category:e,index:t,allEmojis:i,observeIntersection:n,shouldRender:a,onEmojiSelect:r})=>{const l=(0,s.li)();(0,gr.mv)(l,n);const c=(0,Oi.A)(a),d=(0,M.A)(),{isMobile:h}=(0,I.Ay)(),m=h?Math.floor((S.A.get().width-fp+gp)/(o.g0Q+gp)):8,u=Math.ceil(e.emojis.length/m)*(o.g0Q+(h?bp:Ap));return(0,ee.FD)("div",{ref:l,id:`emoji-category-${t}`,className:"symbol-set",children:[(0,ee.Y)("div",{className:"symbol-set-header",children:(0,ee.Y)("p",{className:"symbol-set-name",dir:"auto",children:d(e.id===o.sR2?"RecentStickers":`Emoji${t}`)})}),(0,ee.Y)("div",{className:(0,me.A)("symbol-set-container",c),style:`height: ${u}px;`,dir:d.isRtl?"rtl":void 0,children:a&&e.emojis.map((e=>{const t=i[e];if(!t)return;const s="id"in t?t:t[1];return(0,ee.Y)(vp,{emoji:s,onClick:r},s.id)}))})]},e.id)})),yp={recent:"recent",people:"smile",nature:"animals",foods:"eats",activity:"sport",places:"car",objects:"lamp",symbols:"language",flags:"flag"},Sp=3.25*p.$,wp=2.625*p.$,kp=[];let Np,Ip,Pp;const Yp=(0,s.ph)((0,n.EK)((e=>(0,fi.Up)(e,["recentEmojis"])))((({className:e,recentEmojis:t,onEmojiSelect:n})=>{const a=(0,s.li)(),r=(0,s.li)(),[l,c]=(0,s.J0)(),[d,h]=(0,s.J0)(),[m,u]=(0,s.J0)(0),{isMobile:p}=(0,I.Ay)(),{handleScroll:v,isAtBeginning:g}=Fs(),{observe:A}=(0,gr.BL)({rootRef:a,throttleMs:200},(e=>{e.forEach((e=>{const{id:t}=e.target;if(!t||!t.startsWith("emoji-category-"))return;const i=Number(t.replace("emoji-category-",""));kp[i]=e.isIntersecting}));const t=kp.reduce(((e,t,i)=>t&&i<e?i:e),1/0);t!==1/0&&u(t)})),f=(0,pr.A)([],o.vVF),C=d&&f;(0,Ln.A)(r,!(p&&C)),(0,s.vJ)((()=>{if(!l)return;const e=r.current;if(!e)return;const t=m*wp-e.offsetWidth/2+wp/2;(0,Pa.A)(e,t)}),[l,m]);const y=(0,M.A)(),S=(0,s.Kr)((()=>{if(!l)return Ci.p;const e=[...l];return t?.length&&e.unshift({id:o.sR2,name:y("RecentStickers"),emojis:t}),e}),[l,y,t]);(0,s.vJ)((()=>{setTimeout((()=>{const e=()=>{c(Pp.categories),h(Pp.emojis)};Pp?e():async function(){return Np||(Np=i.e(996).then(i.t.bind(i,20996,19)),Ip=(await Np).default,Pp=(0,pp.cp)(Ip)),Np}().then(e)}),200)}),[]);const w=(0,D.A)((e=>{u(e);const t=a.current.closest(".SymbolMenu-main").querySelector(`#emoji-category-${e}`);(0,vr.Ay)({container:a.current,element:t,position:"start",margin:Sp,maxDistance:100})})),k=(0,D.A)(((e,t)=>{n(e,t)})),N=(0,me.A)("EmojiPicker",e);if(!C)return(0,ee.Y)("div",{className:N,children:(0,ee.Y)(zs.A,{})});const P=(0,me.A)("EmojiPicker-header",!g&&"with-top-border");return(0,ee.FD)("div",{className:N,children:[(0,ee.Y)("div",{ref:r,className:P,dir:y.isRtl?"rtl":void 0,children:S.map((function(e,t){const i=yp[e.id];return i&&(0,ee.Y)(W.A,{className:"symbol-set-button "+(t===m?"activated":""),round:!0,faded:!0,color:"translucent",onClick:()=>w(t),ariaLabel:e.name,children:(0,ee.Y)(q.A,{name:i})})}))}),(0,ee.Y)("div",{ref:a,onScroll:v,className:(0,me.A)("EmojiPicker-main",b.TF?"no-scrollbar":"custom-scroll"),children:S.map(((e,t)=>(0,ee.Y)(Cp,{category:e,index:t,allEmojis:d,observeIntersection:A,shouldRender:m>=t-1&&m<=t+1,onEmojiSelect:k})))})]})}))),Fp=(0,s.ph)((({gif:e,isDisabled:t,className:i,observeIntersection:n,onClick:a,onUnsaveClick:o,isSavedMessages:r})=>{const c=(0,s.li)(),d=(0,M.A)(),h=(0,gr.Vz)(c,n)&&!t,m=!e.hasVideoPreview&&e.thumbnail&&(0,l.sC)(e,"pictogram"),u=(0,j.A)(m,!h),[p]=(0,s.J0)(e.thumbnail?.dataUri&&!u),v=(0,Vi.A)(e.thumbnail?.dataUri,!p),g=(0,l.Ct)(e)||(0,l.sC)(e,"full"),A=(0,j.A)(g,!h),f=Boolean(h&&A),{isBuffered:C,bufferingHandlers:y}=(0,Ue.A)(!0),S=h&&!C,w=h&&C,{isContextMenuOpen:k,contextMenuAnchor:N,handleBeforeContextMenu:I,handleContextMenu:P,handleContextMenuClose:Y,handleContextMenuHide:F}=(0,Fn.A)(c),T=(0,D.A)((()=>c.current)),B=(0,D.A)((()=>c.current.closest(".custom-scroll, .no-scrollbar"))),R=(0,D.A)((()=>c.current.querySelector(".gif-context-menu .bubble"))),L=(0,D.A)((()=>{!k&&a&&a({...e,blobUrl:A})})),x=(0,D.A)((t=>{t.stopPropagation(),t.preventDefault(),o(e)})),E=(0,D.A)((()=>{o?.(e)})),V=(0,D.A)((()=>{a({...e,blobUrl:A},!0)})),_=(0,D.A)((()=>{a({...e,blobUrl:A},void 0,!0)})),U=(0,D.A)((e=>{(0,Nr.u)(e),I(e)}));(0,s.vJ)((()=>{t&&Y()}),[Y,t]);const O=(0,me.A)("GifButton",e.width&&e.height&&e.width<e.height?"vertical":"horizontal",a&&"interactive",i);return(0,ee.FD)("div",{ref:c,className:O,onMouseDown:U,onClick:L,onContextMenu:P,children:[!b.TF&&o&&(0,ee.Y)(W.A,{className:"gif-unsave-button",color:"dark",pill:!0,noFastClick:!0,onClick:x,children:(0,ee.Y)(q.A,{name:"close",className:"gif-unsave-button-icon"})}),p&&(0,ee.Y)("canvas",{ref:v,className:"thumbnail"}),u&&!w&&(0,ee.Y)("img",{src:u,alt:"",className:"preview",draggable:!1}),f&&(0,ee.Y)(ss.A,{canPlay:!0,src:A,autoPlay:!0,loop:!0,muted:!0,disablePictureInPicture:!0,playsInline:!0,preload:"none",...y}),S&&(0,ee.Y)(xe.A,{color:u||p?"white":"black"}),a&&void 0!==N&&(0,ee.FD)($e.A,{isOpen:k,anchor:N,getTriggerElement:T,getRootElement:B,getMenuElement:R,className:"gif-context-menu",autoClose:!0,onClose:Y,onCloseAnimationEnd:F,children:[!r&&(0,ee.Y)(ce.A,{onClick:V,icon:"mute",children:d("SendWithoutSound")}),(0,ee.Y)(ce.A,{onClick:_,icon:"calendar",children:d(r?"SetReminder":"ScheduleMessage")}),o&&(0,ee.Y)(ce.A,{destructive:!0,icon:"delete",onClick:E,children:d("Delete")})]})]})})),Dp=(0,s.ph)((0,n.EK)((e=>{const{chatId:t}=(0,c.Xf0)(e)||{},i=Boolean(t)&&(0,c.nZ4)(e,t);return{savedGifs:e.gifs.saved.gifs,isSavedMessages:i}}))((({className:e,loadAndPlay:t,canSendGifs:i,savedGifs:a,isSavedMessages:r,onGifSelect:l})=>{const{loadSavedGifs:c,saveGif:d}=(0,n.ko)(),h=(0,s.li)(),{observe:m}=(0,gr.BL)({rootRef:h,debounceMs:300});(0,s.vJ)((()=>{t&&c()}),[t,c]);const u=(0,D.A)((e=>{d({gif:e,shouldUnsave:!0})})),p=(0,pr.A)([],o.jhd);return(0,ee.Y)("div",{children:(0,ee.Y)("div",{ref:h,className:(0,me.A)("GifPicker",e,b.TF?"no-scrollbar":"custom-scroll"),children:i?p&&a&&a.length?a.map((e=>(0,ee.Y)(Fp,{gif:e,observeIntersection:m,isDisabled:!t,onClick:i?l:void 0,onUnsaveClick:u,isSavedMessages:r},e.id))):p&&a?(0,ee.Y)("div",{className:"picker-disabled",children:"No saved GIFs."}):(0,ee.Y)(zs.A,{}):(0,ee.Y)("div",{className:"picker-disabled",children:"Sending GIFs is not allowed in this chat."})})})})));let Mp=function(e){return e[e.Emoji=0]="Emoji",e[e.CustomEmoji=1]="CustomEmoji",e[e.Stickers=2]="Stickers",e[e.GIFs=3]="GIFs",e}({});const Tp={[Mp.Emoji]:"Emoji",[Mp.CustomEmoji]:"StickersList.EmojiItem",[Mp.Stickers]:"AccDescrStickers",[Mp.GIFs]:"GifsTab"},Bp={[Mp.Emoji]:"icon-smile",[Mp.CustomEmoji]:"icon-favorite",[Mp.Stickers]:"icon-stickers",[Mp.GIFs]:"icon-gifs"},Rp=(0,s.ph)((({activeTab:e,onSwitchTab:t,onRemoveSymbol:i,onSearchOpen:s,isAttachmentModal:n,canSendPlainText:a,canSearch:o})=>{const r=(0,M.A)();function l(i){return(0,ee.Y)(W.A,{className:"symbol-tab-button "+(e===i?"activated":""),onClick:()=>t(i),ariaLabel:r(Tp[i]),round:!0,faded:!0,color:"translucent",children:(0,ee.Y)("i",{className:(0,me.A)("icon",Bp[i])})})}const c=(0,D.A)((()=>{s(e===Mp.Stickers?"stickers":"gifs")}));return(0,ee.FD)("div",{className:"SymbolMenu-footer",onClick:function(e){e.stopPropagation()},dir:r.isRtl?"rtl":void 0,children:[e!==Mp.Emoji&&e!==Mp.CustomEmoji&&o&&(0,ee.Y)(W.A,{className:"symbol-search-button",ariaLabel:e===Mp.Stickers?"Search Stickers":"Search GIFs",round:!0,faded:!0,color:"translucent",onClick:c,children:(0,ee.Y)(q.A,{name:"search"})}),a&&l(Mp.Emoji),a&&l(Mp.CustomEmoji),!n&&l(Mp.Stickers),!n&&l(Mp.GIFs),(e===Mp.Emoji||e===Mp.CustomEmoji)&&(0,ee.Y)(W.A,{className:"symbol-delete-button",onClick:i,ariaLabel:"Remove Symbol",round:!0,faded:!0,color:"translucent",children:(0,ee.Y)(q.A,{name:"delete-left"})})]})}));let Lp=!1;const xp=(0,s.ph)((0,n.EK)((e=>({isLeftColumnShown:(0,c.nTw)(e).isLeftColumnShown,isBackgroundTranslucent:(0,c.cwE)(e)})))((({chatId:e,threadId:t,isOpen:i,canSendStickers:n,canSendGifs:a,isMessageComposer:o,isLeftColumnShown:l,idPrefix:c,isAttachmentModal:d,canSendPlainText:h,className:m,isBackgroundTranslucent:u,onLoad:p,onClose:v,onEmojiSelect:g,onCustomEmojiSelect:A,onStickerSelect:f,onGifSelect:C,onRemoveSymbol:y,onSearchOpen:S,addRecentEmoji:w,addRecentCustomEmoji:k,...N})=>{const[P,Y]=(0,s.J0)(Mp.Emoji),[F,T]=(0,s.J0)([]),[B,R]=(0,s.J0)([]),{isMobile:L}=(0,I.Ay)(),[x,E]=(0,up.A)(i,v,void 0,L),{shouldRender:V,transitionClassNames:_}=(0,Oe.A)(i,v,!1,!1),U=(0,M.A)();!Lp&&i&&(Lp=!0),(0,s.vJ)((()=>{p()}),[p]),(0,s.vJ)((()=>{h||Y(2)}),[h]),(0,s.Nf)((()=>{if(L&&i&&!d)return document.body.classList.add("enable-symbol-menu-transforms"),document.body.classList.add("is-symbol-menu-open"),()=>{document.body.classList.remove("is-symbol-menu-open"),setTimeout((()=>{(0,r.RK)((()=>{document.body.classList.remove("enable-symbol-menu-transforms")}))}),350)}}),[d,L,i]);const O=(0,s.li)(F);O.current=F,(0,s.vJ)((()=>{O.current.length&&!i&&(O.current.forEach((e=>{w({emoji:e})})),T([]))}),[i,w]);const K=(0,D.A)(((e,t)=>{T((e=>[...e,t])),g(e)})),J=(0,s.li)(B);J.current=B,(0,s.vJ)((()=>{J.current.length&&!i&&(J.current.forEach((e=>{k({documentId:e})})),T([]))}),[i,k]);const G=(0,D.A)((e=>{R((t=>[...t,e.id])),A(e)})),j=(0,D.A)((e=>{v(),S(e)})),z=(0,D.A)(((e,t,i,s)=>{f?.(e,t,i,!0,s)})),H=(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{className:"SymbolMenu-main",onClick:function(e){e.stopPropagation()},children:Lp&&(0,ee.Y)(se.Ay,{name:"slide",activeKey:P,renderCount:Object.values(Tp).length,children:function(s,r){switch(P){case Mp.Emoji:return(0,ee.Y)(Yp,{className:"picker-tab",onEmojiSelect:K});case Mp.CustomEmoji:return(0,ee.Y)(zr,{className:"picker-tab",isHidden:!i||!s,idPrefix:c,loadAndPlay:i&&(s||r),chatId:e,isTranslucent:!L&&u,onCustomEmojiSelect:G});case Mp.Stickers:return(0,ee.Y)(Tu,{className:"picker-tab",isHidden:!i||!s,loadAndPlay:!!n&&i&&(s||r),idPrefix:c,canSendStickers:n,noContextMenus:!o,chatId:e,threadId:t,isTranslucent:!L&&u,onStickerSelect:z});case Mp.GIFs:return(0,ee.Y)(Dp,{className:"picker-tab",loadAndPlay:!!a&&i&&(s||r),canSendGifs:a,onGifSelect:C})}}})}),L&&(0,ee.Y)(W.A,{round:!0,faded:!0,color:"translucent",ariaLabel:U("Close"),className:"symbol-close-button",size:"tiny",onClick:v,children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.Y)(Rp,{activeTab:P,onSwitchTab:Y,onRemoveSymbol:y,canSearch:o,onSearchOpen:j,isAttachmentModal:d,canSendPlainText:h})]});if(L){if(!V)return;const e=(0,me.A)("SymbolMenu mobile-menu",_,l&&"left-column-open",d&&"in-attachment-modal",o&&"in-middle-column");return d?(0,ee.Y)("div",{className:e,children:H}):(0,ee.Y)(Hr.A,{children:(0,ee.Y)("div",{className:e,children:H})})}return(0,ee.Y)($e.A,{isOpen:i,onClose:v,withPortal:d,className:(0,me.A)("SymbolMenu",m),onCloseAnimationEnd:v,onMouseEnter:b.TF?void 0:x,onMouseLeave:b.TF?void 0:E,noCloseOnBackdrop:!b.TF,noCompact:!0,...d?N:{positionX:"left",positionY:"bottom"},children:H})})));var Ep=i(91034);const Vp=(0,s.ph)((({withAvatar:e,focus:t,command:i,description:s,peer:n,clickArg:a,onClick:o})=>{const r=(0,D.A)((()=>{o(a)}));return(0,ee.FD)(ci.A,{className:(0,me.A)("BotCommand chat-item-clickable scroll-item",e&&"with-avatar"),multiline:!0,onClick:r,focus:t,children:[e&&(0,ee.Y)(Dt.A,{size:"small",peer:n}),(0,ee.FD)("div",{className:"content-inner",children:[(0,ee.FD)("span",{className:"title",children:["/",i]}),(0,ee.Y)("span",{className:"subtitle",children:(0,Ft.A)(s)})]})]},i)})),_p=(0,s.ph)((0,Ep.A)((({isOpen:e,chatId:t,withUsername:i,botCommands:a,quickReplies:o,quickReplyMessages:r,self:c,getHtml:d,onClick:h,onClose:m})=>{const{sendBotCommand:u,sendQuickReply:p}=(0,n.ko)(),v=(0,s.li)(),{shouldRender:g,transitionClassNames:A}=(0,Oe.A)(e,void 0,void 0,!1),b=(0,D.A)((({botId:e,command:t})=>{const s=(0,n.mS)().users.byId[e];u({command:`/${t}${i&&s?`@${(0,l.Kl)(s)}`:""}`}),h()})),f=(0,D.A)((e=>{p({chatId:t,quickReplyId:e}),h()})),C=(0,s.Kr)((()=>{if(o?.length&&r)return o.map((e=>{const t=r[e.topMessageId];return{id:e.id,command:e.shortcut,description:t?.content.text?.text||""}}))}),[o,r]),y=(0,D.A)((e=>!!e.command.startsWith(d().slice(1))&&("id"in e?f(e.id):b(e),!0))),S=np({isActive:e,items:(0,s.Kr)((()=>{if(a||C)return[].concat(C||[],a||[])}),[a,C]),onSelect:y,onClose:m}),w=a&&!a.length||o&&!o.length;if((0,s.vJ)((()=>{w&&m()}),[w,m]),(0,s.vJ)((()=>{sp(".chat-item-clickable",S,v)}),[S]),!g||w)return;const k=(0,me.A)("iaTB59vy","composer-tooltip custom-scroll",A);return(0,ee.FD)("div",{className:k,ref:v,children:[C?.map(((e,t)=>(0,ee.Y)(Vp,{command:e.command,description:e.description,peer:c,withAvatar:!0,clickArg:e.id,onClick:f,focus:S===t},`quickReply_${e.id}`))),a?.map(((e,t)=>(0,ee.Y)(Vp,{command:e.command,description:e.description,peer:(0,n.mS)().users.byId[e.botId],withAvatar:!0,clickArg:e,onClick:b,focus:S+(C?.length||0)===t},`${e.botId}_${e.command}`)))]})}))),Up=(0,s.ph)((({isOpen:e,botCommands:t,onClose:i})=>{const{sendBotCommand:s}=(0,n.ko)(),{isMobile:a}=(0,I.Ay)(),[o,r]=(0,up.A)(e,i,void 0,a),l=(0,D.A)((e=>{s({command:`/${e}`}),i()}));return(0,ee.Y)($e.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:i,className:"BotCommandMenu",onCloseAnimationEnd:i,onMouseEnter:b.TF?void 0:o,onMouseLeave:b.TF?void 0:r,noCloseOnBackdrop:!b.TF,noCompact:!0,children:t.map((e=>(0,ee.Y)(Vp,{command:e.command,description:e.description,clickArg:e.command,onClick:l},e.command)))})})),Op=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{stickers:i}=e.stickers.forEmoji;return{stickers:i,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}}))((({chatId:e,threadId:t,isOpen:i,onStickerSelect:n,onClose:a,stickers:r,isSavedMessages:l,isCurrentUserPremium:c})=>{const d=(0,s.li)(),{shouldRender:m,transitionClassNames:u}=(0,Oe.A)(i,void 0,void 0,!1),p=(0,V.A)(r,!0),v=r||p,g=(0,Du.A)(e,t),{observe:A}=(0,gr.BL)({rootRef:d,throttleMs:200});(0,s.vJ)((()=>i?(0,h.A)(a):void 0),[i,a]);const b=(0,me.A)("StickerTooltip composer-tooltip custom-scroll",u,!v?.length&&"hidden");return(0,ee.Y)("div",{ref:d,className:b,onMouseMove:()=>{g({type:"chooseSticker"})},children:m&&v?v.map((e=>(0,ee.Y)(Fr,{sticker:e,size:o.bkT,observeIntersection:A,onClick:i?n:void 0,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c},e.id))):m?(0,ee.Y)(zs.A,{}):void 0})}))),Kp={root:"_8sFuAomM",emojiButton:"crWzZ2jr"},Jp=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{stickers:i}=e.customEmojis.forEmoji;return{customEmoji:i,isSavedMessages:(0,c.nZ4)(e,t),isCurrentUserPremium:(0,c.g29)(e)}}))((({isOpen:e,addRecentCustomEmoji:t,onCustomEmojiSelect:i,onClose:a,customEmoji:r,isSavedMessages:l,isCurrentUserPremium:c,noPlay:d})=>{const{clearCustomEmojiForEmoji:m}=(0,n.ko)(),u=(0,s.li)(),{shouldRender:p,transitionClassNames:v}=(0,Oe.A)(e,void 0,void 0,!1),g=(0,V.A)(r,!0),A=r||g;(0,Ln.A)(u);const{observe:b}=(0,gr.BL)({rootRef:u,throttleMs:200,isDisabled:!e});(0,s.vJ)((()=>e?(0,h.A)(a):void 0),[e,a]);const f=(0,D.A)((s=>{e&&(i(s),t({documentId:s.id}),m())})),C=(0,me.A)(Kp.root,"composer-tooltip custom-scroll-x",v,!A?.length&&Kp.hidden);return(0,ee.Y)("div",{ref:u,className:C,children:p&&A?A.map((e=>(0,ee.Y)(Fr,{sticker:e,className:Kp.emojiButton,size:o.x6_,observeIntersection:b,onClick:f,clickArg:e,isSavedMessages:l,canViewSet:!0,isCurrentUserPremium:c,noPlay:d},e.id))):p?(0,ee.Y)(zs.A,{}):void 0})})));var Gp=i(76283);const jp=(0,s.ph)((({isOpen:e,isOpenToBottom:t=!1,isSavedMessages:i,canSchedule:a,canScheduleUntilOnline:o,onSendSilent:r,onSendSchedule:l,onSendWhenOnline:c,onRemoveEffect:d,onClose:h,onCloseAnimationEnd:m,chatId:u,withEffects:p,hasCurrentEffect:v,effectReactions:g,allAvailableReactions:A,onToggleReaction:f,canBuyPremium:C,isCurrentUserPremium:y,isInSavedMessages:S,isInStoryViewer:w,canPlayAnimatedEmojis:k})=>{const{openEffectPicker:N}=(0,n.ko)(),[I,P]=(0,up.A)(e,h),[F,T]=(0,s.J0)(!1),B=(0,M.A)(),R=(0,_i.A)(),[L,x,E]=(0,Y.A)();(0,wi.A)((([t])=>{e&&!t&&(E(),T(Boolean(o)))}),[e,o]);const[V,_,U]=(0,Y.A)(),O=(0,D.A)((e=>{x(),u&&N({chatId:u,position:e})}));return(0,s.vJ)((()=>{e?setTimeout((()=>{_()}),200):U()}),[e,_,U]),(0,ee.FD)($e.A,{isOpen:e,autoClose:!0,positionX:"right",positionY:t?"top":"bottom",className:(0,me.A)("CustomSendMenu","fluid","with-menu-transitions",p&&"with-effects"),onClose:h,onCloseAnimationEnd:m,onMouseEnter:b.TF?void 0:I,onMouseLeave:b.TF?void 0:P,noCloseOnBackdrop:!b.TF,children:[p&&!w&&(0,ee.Y)(Gp.A,{allAvailableReactions:A,effectReactions:g,currentReactions:void 0,onToggleReaction:f,isPrivate:!0,isReady:V,canBuyPremium:C,isCurrentUserPremium:y,isInSavedMessages:S,isForEffects:!0,canPlayAnimatedEmojis:k,onShowMore:O,onClose:h,className:(0,me.A)(L&&"ReactionSelector-hidden")}),(0,ee.FD)("div",{className:(0,me.A)("CustomSendMenu_items",L&&"CustomSendMenu_items-hidden"),dir:B.isRtl?"rtl":void 0,children:[r&&(0,ee.Y)(ce.A,{icon:"mute",onClick:r,children:B("SendWithoutSound")}),a&&l&&(0,ee.Y)(ce.A,{icon:"schedule",onClick:l,children:B(i?"SetReminder":"ScheduleMessage")}),a&&l&&F&&(0,ee.Y)(ce.A,{icon:"user-online",onClick:c,children:B("SendWhenOnline")}),p&&v&&(0,ee.Y)(ce.A,{icon:"delete",onClick:d,children:R("RemoveEffect")})]})]})}));var zp=i(41510),Hp=i(22802);const $p={B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"underline",DEL:"strikethrough",CODE:"monospace",SPAN:"spoiler"},qp=document.createElement("div"),Wp=(0,s.ph)((({isOpen:e,anchorPosition:t,selectedRange:i,setSelectedRange:n,onClose:a})=>{const r=(0,s.li)(),l=(0,s.li)(),{shouldRender:c,transitionClassNames:d}=(0,Oe.A)(e),[m,u,p]=(0,Y.A)(),[v,g]=(0,s.J0)(""),[A,b]=(0,s.J0)(!1),[C,y]=(0,s.J0)(),[S,w]=(0,s.J0)({});(0,s.vJ)((()=>e?(0,h.A)(a):void 0),[e,a]),(0,Hp.A)(e,r,a,!0),(0,s.vJ)((()=>{m?l.current.focus():(g(""),b(!1))}),[m]),(0,s.vJ)((()=>{c||(p(),w({}),y(void 0))}),[p,c]),(0,s.vJ)((()=>{if(!e||!i)return;const t={};let{parentElement:s}=i.commonAncestorContainer;for(;s&&s.id!==o.CfG;){const e=$p[s.tagName];e&&(t[e]=!0),s=s.parentElement}w(t)}),[e,i,u]);const k=(0,D.A)((()=>{if(!i)return;const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(i))})),N=(0,D.A)((()=>{const e=window.getSelection();e&&n(e.getRangeAt(0))})),I=(0,D.A)((e=>{if(i)return qp.replaceChildren(i.cloneContents()),e&&qp.querySelectorAll(Fu._p).forEach((e=>{e.replaceWith(e.getAttribute("alt"))})),qp.innerHTML})),P=(0,D.A)((()=>{if(i)return i.commonAncestorContainer.parentElement}));function F(){const e=l.current;if(!e)return;const{offsetWidth:t,scrollWidth:i,scrollLeft:s}=e;if(i<=t)return void y(void 0);let n="";s<i-t&&(n="mask-right"),s>0&&(n+=" mask-left"),y(n)}function T(e){if(S[e])return"active";if("monospace"===e||"strikethrough"===e){if(Object.keys(S).some((t=>t!==e&&Boolean(S[t]))))return"disabled"}else if(S.monospace||S.strikethrough)return"disabled"}const B=(0,D.A)((()=>{if(S.spoiler){const e=P();if(!i||!e||e.dataset.entityType!==U.C7.Spoiler||!e.textContent)return;return e.replaceWith(e.textContent),void w((e=>({...e,spoiler:!1})))}const e=I();document.execCommand("insertHTML",!1,`<span class="spoiler" data-entity-type="${U.C7.Spoiler}">${e}</span>`),a()})),R=(0,D.A)((()=>{w((e=>(document.execCommand(e.bold?"removeFormat":"bold"),Object.keys(e).forEach((t=>{"italic"!==t&&"underline"!==t||!Boolean(e[t])||document.execCommand(t)})),N(),{...e,bold:!e.bold})))})),L=(0,D.A)((()=>{document.execCommand("italic"),N(),w((e=>({...e,italic:!e.italic})))})),x=(0,D.A)((()=>{document.execCommand("underline"),N(),w((e=>({...e,underline:!e.underline})))})),E=(0,D.A)((()=>{if(S.strikethrough){const e=P();if(!i||!e||"DEL"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void w((e=>({...e,strikethrough:!1})))}const e=I();document.execCommand("insertHTML",!1,`<del>${e}</del>`),a()})),V=(0,D.A)((()=>{if(S.monospace){const e=P();if(!i||!e||"CODE"!==e.tagName||!e.textContent)return;return e.replaceWith(e.textContent),void w((e=>({...e,monospace:!1})))}const e=I(!0);document.execCommand("insertHTML",!1,`<code class="text-entity-code" dir="auto">${e}</code>`),a()})),_=(0,D.A)((()=>{const e=((0,cn.Tc)(v)||"").split("%").map(encodeURI).join("%");if(A){const t=P();if(!t||"A"!==t.tagName)return;return t.href=e,void a()}const t=I(!0);k(),document.execCommand("insertHTML",!1,`<a href=${e} class="text-entity-link" dir="auto">${t}</a>`),a()})),O=(0,D.A)((e=>{const t={k:u,b:R,u:x,i:L,m:V,s:E,p:B}[function(e){const t=e.key||e.code;return t.startsWith("Key")?t.slice(3).toLowerCase():t}(e)];!e.altKey&&(e.ctrlKey||e.metaKey)&&t&&(e.preventDefault(),e.stopPropagation(),t())}));(0,s.vJ)((()=>(e&&document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O))),[e,O]);const K=(0,M.A)();if(!c)return;const J=(0,me.A)("TextFormatter",d,m&&"link-control-shown"),G=(0,me.A)("TextFormatter-link-url-confirm",Boolean(v.length)&&"shown"),j=t?`left: ${t.x}px; top: ${t.y}px;--text-formatter-left: ${t.x}px;`:"";return(0,ee.FD)("div",{ref:r,className:J,style:j,onKeyDown:function(e){"Enter"===e.key&&m&&(_(),e.preventDefault())},onMouseDown:f.A,children:[(0,ee.FD)("div",{className:"TextFormatter-buttons",children:[(0,ee.Y)(W.A,{color:"translucent",ariaLabel:"Spoiler text",className:T("spoiler"),onClick:B,children:(0,ee.Y)(q.A,{name:"eye-crossed"})}),(0,ee.Y)("div",{className:"TextFormatter-divider"}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:"Bold text",className:T("bold"),onClick:R,children:(0,ee.Y)(q.A,{name:"bold"})}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:"Italic text",className:T("italic"),onClick:L,children:(0,ee.Y)(q.A,{name:"italic"})}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:"Underlined text",className:T("underline"),onClick:x,children:(0,ee.Y)(q.A,{name:"underlined"})}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:"Strikethrough text",className:T("strikethrough"),onClick:E,children:(0,ee.Y)(q.A,{name:"strikethrough"})}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:"Monospace text",className:T("monospace"),onClick:V,children:(0,ee.Y)(q.A,{name:"monospace"})}),(0,ee.Y)("div",{className:"TextFormatter-divider"}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:K("TextFormat.AddLinkTitle"),onClick:u,children:(0,ee.Y)(q.A,{name:"link"})})]}),(0,ee.Y)("div",{className:"TextFormatter-link-control",children:(0,ee.FD)("div",{className:"TextFormatter-buttons",children:[(0,ee.Y)(W.A,{color:"translucent",ariaLabel:K("Cancel"),onClick:p,children:(0,ee.Y)(q.A,{name:"arrow-left"})}),(0,ee.Y)("div",{className:"TextFormatter-divider"}),(0,ee.Y)("div",{className:(0,me.A)("TextFormatter-link-url-input-wrapper",C),children:(0,ee.Y)("input",{ref:l,className:"TextFormatter-link-url-input",type:"text",value:v,placeholder:"Enter URL...",autoComplete:"off",inputMode:"url",dir:"auto",onChange:function(e){g(e.target.value),F()},onScroll:F})}),(0,ee.FD)("div",{className:G,children:[(0,ee.Y)("div",{className:"TextFormatter-divider"}),(0,ee.Y)(W.A,{color:"translucent",ariaLabel:K("Save"),className:"color-primary",onClick:_,children:(0,ee.Y)(q.A,{name:"check"})})]})]})})]})})),Qp=(0,s.ph)((({emoji:e,focus:t,onClick:i,observeIntersection:s})=>{const n=(0,D.A)((t=>{t.preventDefault(),i?.(e)})),a=(0,me.A)("EmojiButton",t&&"focus");return(0,ee.Y)("div",{className:a,onMouseDown:n,title:e.emoji,children:(0,ee.Y)(wa.A,{documentId:e.id,size:32,withSharedAnimation:!0,shouldPreloadPreview:!0,observeIntersectionForPlaying:s})})})),Zp=(0,s.ph)((({isOpen:e,emojis:t,customEmojis:i,onClose:n,onEmojiSelect:a,onCustomEmojiSelect:o,addRecentEmoji:r,addRecentCustomEmoji:l})=>{const c=(0,s.li)(),{shouldRender:d,transitionClassNames:h}=(0,Oe.A)(e,void 0,void 0,!1),m=(0,ls.A)(t.length?[...i,...t]:void 0,350)||[];(0,Ln.A)(c);const{observe:u}=(0,gr.BL)({rootRef:c,throttleMs:200,isDisabled:!e}),p=(0,D.A)((e=>{a(e.native),r({emoji:e.id})})),v=(0,D.A)((e=>{o(e),l({documentId:e.id})})),g=(0,D.A)((e=>{"native"in e?p(e):v(e)})),A=(0,D.A)(((e,t)=>{a(e),r({emoji:t})})),b=(0,D.A)((e=>{o(e),l({documentId:e.id})})),f=np({isActive:e,isHorizontal:!0,items:m,shouldRemoveSelectionOnReset:!0,onSelect:g,onClose:n});(0,wi.A)((([e])=>{void 0!==e&&-1!==e&&function(e,t){const i=t.current;if(!i)return;const{visibleIndexes:s,allElements:n}=ip(i,".EmojiButton",8,!0,!0,!0);if(!n.length||!n[e])return;const a=s[0];if(!s.includes(e)||e===a&&!tp(i,n[a],!0)){const t="start"==(e>s[s.length-1]?"start":"end")?44*e:0;(0,Pa.A)(i,t)}}(f,c)}),[f]);const C=(0,me.A)("EmojiTooltip composer-tooltip custom-scroll-x",h);return(0,ee.Y)("div",{ref:c,className:C,children:d&&m?m.map(((e,t)=>"native"in e?(0,ee.Y)(vp,{emoji:e,focus:f===t,onClick:A},e.id):(0,ee.Y)(Qp,{emoji:e,focus:f===t,onClick:b,observeIntersection:u},e.id))):d?(0,ee.Y)(zs.A,{}):void 0})})),Xp=(0,s.ph)((({title:e,description:t,thumbnail:i,thumbUrl:s,focus:n,transitionClassNames:a="",onClick:o})=>{let r;const c=(0,j.A)(i?(0,l.cy)(i):void 0);return(s=s||c)?r=(0,ee.Y)("img",{src:s,className:a,alt:"",decoding:"async",draggable:!1}):e&&(r=(0,He.Qh)(e,1)),(0,ee.FD)(ci.A,{focus:n,className:"BaseResult chat-item-clickable",onMouseDown:Nr.u,onClick:o,children:[(0,ee.Y)("span",{className:"thumb",children:"string"==typeof r?(0,Ft.A)(r):r}),(0,ee.FD)("div",{className:"content-inner",children:[e&&(0,ee.Y)("div",{className:"title",children:e}),t&&(0,ee.Y)("div",{className:"description",children:t})]})]})})),ev=(0,s.ph)((({focus:e,inlineResult:t,onClick:i})=>{const{title:s,description:n}=t,a="url"in t?t.url:void 0,o="webThumbnail"in t?t.webThumbnail:void 0,r=(0,D.A)((()=>{i(t)}));return(0,ee.Y)(Xp,{focus:e,thumbnail:o,title:s||a,description:n,onClick:r})})),tv=(0,s.ph)((({inlineResult:e,isSavedMessages:t,canSendGifs:i,observeIntersection:s,onClick:n})=>{const{gif:a}=e,o=(0,D.A)(((t,i,s)=>{n(e,i,s)}));if(a)return(0,ee.Y)(Fp,{gif:a,observeIntersection:s,className:"chat-item-clickable",onClick:i?o:void 0,isSavedMessages:t})})),iv=(0,s.ph)((({focus:e,isForGallery:t,inlineResult:i,onClick:s})=>{let n,a,o;"photo"in i&&(n=i.photo),"thumbnail"in i&&(a=i.thumbnail),"webThumbnail"in i&&(o=i.webThumbnail);const r=(0,j.A)((0,l.cy)(o)),c=(0,j.A)(n&&(0,l.rI)(n,"pictogram")),d=(0,Oi.A)(c||r),h=(0,D.A)((()=>{s(i)}));if(t)return(0,ee.FD)("div",{className:"MediaResult chat-item-clickable",onClick:h,children:[(0,ee.Y)("img",{src:n?.thumbnail?.dataUri||r,alt:"",draggable:!1}),(0,ee.Y)("img",{src:c,className:(0,me.A)("full-media",d),alt:"",draggable:!1})]});const{title:m,description:u}=i;return(0,ee.Y)(Xp,{focus:e,thumbnail:o,thumbUrl:c||a?.dataUri,transitionClassNames:d,title:m,description:u,onClick:h})})),sv=(0,s.ph)((({inlineResult:e,isSavedMessages:t,observeIntersection:i,onClick:s,isCurrentUserPremium:n})=>{const{sticker:a}=e;if(a)return(0,ee.Y)(Fr,{sticker:a,size:o.mD0,observeIntersection:i,title:a.emoji,className:"chat-item-clickable",onClick:s,clickArg:e,isSavedMessages:t,canViewSet:!0,noShowPremium:!0,isCurrentUserPremium:n})})),nv=(0,ve.nF)((e=>e()),500,!0),av=(0,s.ph)((({isOpen:e,botId:t,isGallery:i,inlineBotResults:o,switchPm:r,switchWebview:l,isSavedMessages:c,canSendGifs:d,loadMore:h,onClose:m,onSelectResult:u,isCurrentUserPremium:p})=>{const{openChat:v,startBot:g,requestSimpleWebView:A}=(0,n.ko)(),f=(0,s.li)(),{shouldRender:C,transitionClassNames:y}=(0,Oe.A)(e,void 0,void 0,!1),S=(0,Bi.A)(i,C),{observe:w}=(0,gr.BL)({rootRef:f,debounceMs:200,isDisabled:!e}),k=(0,D.A)((({direction:e})=>{e===a.TN.Backwards&&nv(h)})),N=np({isActive:e,shouldRemoveSelectionOnReset:S,noArrowNavigation:S,items:o,onSelect:u,onClose:m});(0,s.vJ)((()=>{sp(".chat-item-clickable",N,f)}),[N]);const I=(0,D.A)((()=>{v({id:t}),g({botId:t,param:r.startParam})})),P=(0,D.A)((()=>{const e=(0,En.A)();A({botId:t,url:l.url,buttonText:l.text,theme:e,isFromSwitchWebView:!0})})),Y=(0,V.A)(o?.length?o:void 0,C),F=o?.length?o:Y;if(!C||!F?.length&&!r)return;const M=(0,me.A)("InlineBotTooltip composer-tooltip",b.TF?"no-scrollbar":"custom-scroll",S&&"gallery",y);return(0,ee.FD)(Ds.A,{ref:f,className:M,items:F,itemSelector:".chat-item-clickable",noFastList:!0,onLoadMore:k,sensitiveArea:160,children:[r&&(0,ee.Y)(ci.A,{ripple:!0,className:"switch-pm scroll-item",onClick:I,children:(0,ee.Y)("span",{className:"title",children:r.text})}),l&&(0,ee.Y)(ci.A,{ripple:!0,className:"switch-pm scroll-item",onClick:P,children:(0,ee.Y)("span",{className:"title",children:l.text})}),Boolean(F?.length)&&F.map(((e,t)=>{switch(e.type){case"gif":return(0,ee.Y)(tv,{inlineResult:e,observeIntersection:w,onClick:u,isSavedMessages:c,canSendGifs:d},e.id);case"photo":return(0,ee.Y)(iv,{isForGallery:S,inlineResult:e,onClick:u},e.id);case"sticker":return(0,ee.Y)(sv,{inlineResult:e,observeIntersection:w,onClick:u,isSavedMessages:c,isCurrentUserPremium:p},e.id);case"video":case"file":case"game":return(0,ee.Y)(iv,{focus:N===t,inlineResult:e,onClick:u},e.id);case"article":case"audio":case"voice":return(0,ee.Y)(ev,{focus:N===t,inlineResult:e,onClick:u},e.id);default:return}}))]})})),ov=(0,s.ph)((({isOpen:e,chatId:t,selectedSendAsId:i,sendAsPeerIds:a,isCurrentUserPremium:o,onClose:r})=>{const{saveDefaultSendAs:l,showNotification:c}=(0,n.ko)(),d=(0,n.mS)().users.byId,h=(0,n.mS)().chats.byId,m=(0,M.A)(),u=(0,s.li)(),[p,v,g]=(0,up.A)(e,r,void 0);(0,s.vJ)((()=>{e&&g()}),[e,g]);const A=(0,D.A)((e=>{r(),l({chatId:t,sendAsId:e})})),f=np({isActive:e,items:a,onSelect:A,shouldSelectOnTab:!0,shouldSaveSelectionOnUpdateItems:!0,onClose:r});return(0,s.vJ)((()=>{sp(".chat-item-clickable",f,u)}),[f]),(0,s.vJ)((()=>{a&&!a.length&&r()}),[a,r]),(0,ee.FD)($e.A,{isOpen:e,positionX:"left",positionY:"bottom",onClose:r,className:"SendAsMenu",onCloseAnimationEnd:r,onMouseEnter:b.TF?void 0:p,onMouseLeave:b.TF?void 0:v,noCloseOnBackdrop:!b.TF,noCompact:!0,children:[(0,ee.Y)("div",{className:"send-as-title",dir:"auto",children:m("SendMessageAsTitle")}),d&&h&&a?.map((({id:e,isPremium:t},s)=>{const n=d[e],a=h[e],r=n||a,l=(0,me.A)(i===e&&"selected");return(0,ee.FD)(ci.A,{className:"SendAsItem chat-item-clickable scroll-item with-avatar",onClick:()=>{!t||o?A(e):c({message:m("SelectSendAsPeerPremiumHint"),actionText:m("Open"),action:{action:"openPremiumModal",payload:{}}})},focus:f===s,rightElement:!o&&t&&(0,ee.Y)(q.A,{name:"lock-badge",className:"send-as-icon-locked"}),children:[(0,ee.Y)(Dt.A,{size:"small",peer:r,className:l}),(0,ee.FD)("div",{className:"info",children:[r&&(0,ee.Y)(Hs.A,{peer:r,noFake:!0}),(0,ee.Y)("span",{className:"subtitle",children:n?m("VoipGroupPersonalAccount"):m("Subscribers",a?.membersCount,"i")})]})]},e)}))]})})),rv=(0,s.ph)((0,n.EK)(((e,{stickerSetId:t})=>({set:(0,c.ycM)(e,t),shouldPlay:(0,c.ML4)(e),isCurrentUserPremium:(0,c.g29)(e)})))((({stickerSetId:e,observeIntersection:t,set:i,shouldPlay:a,isModalOpen:r,isCurrentUserPremium:l})=>{const{loadStickers:c,toggleStickerSet:d,openStickerSet:h}=(0,n.ko)(),m=(0,s.li)(),u=(0,M.A)(),p=i&&!i.isArchived&&Boolean(i.installedDate),v=Boolean(i?.stickers),g=(0,s.Kr)((()=>{if(!i)return[];const e=(i.stickers?.filter((({hasEffect:e})=>e))??[]).slice(0,3),t=(i.covers||[]).map((({id:e})=>e)),s=i.stickers?i.stickers.filter((({id:e})=>!t.includes(e))):[];return[...e,...i.covers||[],...s].slice(0,5)}),[i]);(0,s.vJ)((()=>{!v&&g.length<5&&i&&c({stickerSetInfo:{shortName:i.shortName}})}),[v,g.length,c,i,e]);const A=(0,s.hb)((()=>{d({stickerSetId:e})}),[d,e]),b=(0,s.hb)((e=>{h({stickerSetInfo:e.stickerSetInfo})}),[h]);if(!i)return;const f=g.length>0;return(0,ee.FD)("div",{className:"sticker-set",dir:u.isRtl?"rtl":void 0,children:[(0,ee.FD)("div",{className:"sticker-set-header",children:[(0,ee.FD)("div",{className:"title-wrapper",children:[(0,ee.Y)("h3",{className:"title",dir:"auto",children:i.title}),(0,ee.Y)("p",{className:"count",dir:"auto",children:u("Stickers",i.count,"i")})]}),(0,ee.Y)(W.A,{className:p?"is-added":void 0,color:"primary",size:"tiny",pill:!0,fluid:!0,onClick:A,children:u(p?"Stickers.Installed":"Stickers.Install")})]}),(0,ee.FD)("div",{className:"sticker-set-main shared-canvas-container",children:[(0,ee.Y)("canvas",{ref:m,className:"shared-canvas"}),!f&&(0,ee.Y)(xe.A,{}),f&&g.map((e=>(0,ee.Y)(Fr,{sticker:e,size:o.Rqe,observeIntersection:t,noPlay:!a||r,clickArg:e,onClick:b,noContextMenu:!0,isCurrentUserPremium:l,sharedCanvasRef:m})))]})]},i.id)}))),lv=(0,ve.nF)((e=>e()),6e4,!0),cv=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.BmE)(e),{query:i,resultIds:s}=t||{},{featured:n}=e.stickers;return{query:i,featuredIds:n.setIds,resultIds:s,isModalOpen:Boolean((0,c.nTw)(e).openedStickerSetShortName)}}))((({isActive:e,query:t,featuredIds:i,resultIds:a,isModalOpen:o,onClose:r})=>{const{loadFeaturedStickers:l}=(0,n.ko)(),c=(0,s.li)(),d=(0,M.A)(),{observe:h}=(0,gr.BL)({rootRef:c,throttleMs:200});return(0,s.vJ)((()=>{lv((()=>{l()}))})),(0,fe.A)({isActive:e,onBack:r}),(0,ee.Y)("div",{ref:c,className:"StickerSearch custom-scroll",dir:d.isRtl?"rtl":void 0,children:function(){if(void 0!==t)return!t&&i?i.map((e=>(0,ee.Y)(rv,{stickerSetId:e,observeIntersection:h,isModalOpen:o},e))):a?a.length?a.map((e=>(0,ee.Y)(rv,{stickerSetId:e,observeIntersection:h,isModalOpen:o},e))):(0,ee.Y)("p",{className:"helper-text",dir:"auto",children:"Nothing found."}):(0,ee.Y)(zs.A,{})}()})}))),dv=(0,s.ph)((0,n.EK)((e=>{const t=(0,c.Wy7)(e),{query:i,results:s}=t||{},{chatId:n,threadId:a}=(0,c.Xf0)(e)||{},o=n?(0,c.hds)(e,n):void 0,r=n?(0,c.AWZ)(e,n):void 0,d=o?(0,c.ALW)(e,o):void 0,h=Boolean(n)&&(0,c.nZ4)(e,n),m=n&&a?(0,c.Vw0)(e,n,a):void 0,u=Boolean(!m?.isCommentsInfo&&m?.fromChannelId),p=n&&a?(0,c.S0q)(e,n,a):void 0;return{query:i,results:s,chat:o,isChatWithBot:d,isSavedMessages:h,canPostInChat:Boolean(o)&&Boolean(a)&&(0,l.__)(o,p,u,r),canScheduleUntilOnline:Boolean(n)&&(0,c.RBq)(e,n),currentMessageList:(0,c.Xf0)(e)}}))((({isActive:e,query:t,results:i,chat:a,chatFullInfo:o,isChatWithBot:r,canScheduleUntilOnline:c,isSavedMessages:d,canPostInChat:h,currentMessageList:m,onClose:u})=>{const{searchMoreGifs:p,sendMessage:v,setGifSearchQuery:g}=(0,n.ko)(),A=(0,s.li)(),[f,C]=(0,du.A)(c),{observe:y}=(0,gr.BL)({rootRef:A,debounceMs:300}),S=h&&(0,l.Q_)(a,o,r).canSendGifs,w=(0,s.hb)(((e,t,i)=>{if(S){if(!m)return;i?f((i=>{v({messageList:m,gif:e,scheduledAt:i,isSilent:t})})):v({messageList:m,gif:e,isSilent:t})}b.TF&&g({query:void 0})}),[S,m,f]),k=(0,s.hb)((()=>{p()}),[p]),N=(0,M.A)();(0,fe.A)({isActive:e,onBack:u});const I=Boolean(void 0!==t&&i&&i.length);return(0,ee.FD)("div",{className:"GifSearch",dir:N.isRtl?"rtl":void 0,children:[(0,ee.Y)(Ds.A,{ref:A,className:(0,me.A)("gif-container custom-scroll",I&&"grid"),items:i,itemSelector:".GifButton",preloadBackwards:96,noFastList:!0,onLoadMore:k,children:function(){if(void 0!==t)return i?i.length?i.map((e=>(0,ee.Y)(Fp,{gif:e,observeIntersection:y,onClick:S?w:void 0,isSavedMessages:d},e.id))):(0,ee.Y)("p",{className:"helper-text",dir:"auto",children:N("NoGIFsFound")}):(0,ee.Y)(zs.A,{})}()}),C]})})));var hv=i(71950);const mv="OAKzmAva",uv="BQ6HUOqN",pv="U96CW2I7",vv="vXi2JQlj",gv="bi3fL59p",Av="GUK4ajPK",bv="YH6jeZIh",fv="q1LnuIUn",Cv="PJZzyVLK",yv="C7NpG5Y9",Sv=(0,s.ph)((function({postStatistic:e}){const t=(0,M.A)(),i=(0,_i.A)();return(0,ee.FD)("div",{className:bv,children:[e.reactionsCount>0&&(0,ee.FD)("span",{className:fv,children:[(0,ee.Y)(q.A,{name:"heart-outline",className:Cv}),(0,He.Vw)(i,e.reactionsCount)]}),e.forwardsCount>0&&(0,ee.FD)("span",{className:fv,children:[(0,ee.Y)(q.A,{name:"forward",className:Cv}),(0,He.Vw)(i,e.forwardsCount)]}),!e.forwardsCount&&!e.reactionsCount&&t("ChannelStats.SharesCount_ZeroValueHolder")]})}));function wv(e,t,i,s){return i?(0,ee.FD)("span",{children:[(0,ee.Y)("img",{src:i,alt:"",draggable:!1,className:(0,me.A)(pv,s&&"yxjDeIct")}),(0,l.zX)(t)&&(0,ee.Y)(q.A,{name:"play"}),(0,v.C)(e,t,!0)]}):(0,v.C)(e,t)}const kv=(0,s.ph)((({postStatistic:e,message:t})=>{const i=(0,M.A)(),{toggleMessageStatistics:a}=(0,n.ko)(),o=(0,l.CI)(t),r=(0,j.A)((0,l.EO)(t,"micro")),c=Boolean((0,l.lk)(t)),d=(0,s.hb)((()=>{a({messageId:t.id})}),[a,t.id]);return(0,ee.FD)("div",{className:(0,me.A)(mv,Boolean(r||o)&&uv),onClick:d,children:[(0,ee.FD)("div",{className:gv,children:[(0,ee.Y)("div",{className:vv,children:wv(i,t,r||o,c)}),(0,ee.Y)("div",{className:bv,children:i("ChannelStats.ViewsCount",e.viewsCount,"i")})]}),(0,ee.FD)("div",{className:Av,children:[(0,ee.Y)("div",{className:yv,children:(0,ze.L2)(1e3*t.date,i.code)}),(0,ee.Y)(Sv,{postStatistic:e})]})]})}));function Nv(e,t,i){return(0,ee.FD)("span",{children:[i?(0,ee.Y)("span",{className:"TmJvv2A6",children:(0,ee.Y)("img",{src:i,alt:"",draggable:!1,className:(0,me.A)(pv,"cdfiLmXo","BOfHPv20")})}):(0,ee.Y)(Dt.A,{peer:t,size:"small",className:pv,withStorySolid:!0,forceUnreadStorySolid:!0}),e("Story")]})}const Iv=(0,s.ph)((function({chat:e,story:t,postStatistic:i}){const s=(0,M.A)(),{toggleStoryStatistics:a}=(0,n.ko)(),o=t&&"content"in t,r=o?t.content.video:void 0,c=o?(0,l.EN)(t):void 0,d=(0,j.A)(c),h=d||r?.thumbnail?.dataUri,m=(0,D.A)((()=>{a({storyId:i.storyId})}));return(0,ee.FD)("div",{className:(0,me.A)(mv,uv),onClick:m,children:[(0,ee.FD)("div",{className:gv,children:[(0,ee.Y)("div",{className:vv,children:Nv(s,e,d||h)}),(0,ee.Y)("div",{className:bv,children:s("ChannelStats.ViewsCount",i.viewsCount,"i")})]}),(0,ee.FD)("div",{className:Av,children:[(0,ee.Y)("div",{className:yv,children:o&&Boolean(t.date)&&(0,ze.L2)(1e3*t.date,s.code)}),(0,ee.Y)(Sv,{postStatistic:i})]})]})})),Pv="T1l_4J8z",Yv="S1x1ovkC",Fv="WxL3i5PM",Dv="aUrozL5_",Mv="QQHwjG88",Tv="QGctP1Nk";let Bv,Rv;const Lv={growthGraph:"ChannelStats.Graph.Growth",followersGraph:"ChannelStats.Graph.Followers",muteGraph:"ChannelStats.Graph.Notifications",topHoursGraph:"ChannelStats.Graph.ViewsByHours",viewsBySourceGraph:"ChannelStats.Graph.ViewsBySource",newFollowersBySourceGraph:"ChannelStats.Graph.NewFollowersBySource",languagesGraph:"ChannelStats.Graph.Language",interactionsGraph:"ChannelStats.Graph.Interactions",reactionsByEmotionGraph:"ChannelStats.Graph.Reactions",storyInteractionsGraph:"ChannelStats.Graph.Stories",storyReactionsByEmotionGraph:"ChannelStats.Graph.StoriesReactions"},xv=Object.keys(Lv),Ev={growthGraph:"Stats.GroupGrowthTitle",membersGraph:"Stats.GroupMembersTitle",languagesGraph:"Stats.GroupLanguagesTitle",messagesGraph:"Stats.GroupMessagesTitle",actionsGraph:"Stats.GroupActionsTitle",topHoursGraph:"Stats.GroupTopHoursTitle"},Vv=Object.keys(Ev),_v=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.gqw)(e,t),s=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t)?.statisticsDcId,a="chatTypeSuperGroup"===s?.type,o=(0,c.zeq)(e,t),r=(0,c._bp)(e,t)?.byId;return{statistics:i,dcId:n,isGroup:a,chat:s,messagesById:o,storiesById:r}}))((({chatId:e,chat:t,statistics:a,dcId:o,isGroup:r,messagesById:l,storiesById:c})=>{const d=(0,M.A)(),h=(0,s.li)(),[m,u]=(0,s.J0)(!1),p=(0,s.li)([]),{loadStatistics:v,loadStatisticsAsyncGraph:g}=(0,n.ko)(),A=(0,F.A)();(0,s.vJ)((()=>{v({chatId:e,isGroup:r})}),[e,v,r]);const b=(0,s.Kr)((()=>r?Vv:xv),[r]),f=(0,s.Kr)((()=>r?Ev:Lv),[r]);return(0,s.vJ)((()=>{a&&b.forEach((t=>{const i=a[t];"string"==typeof i&&g({name:t,chatId:e,token:i,isPercentage:"languagesGraph"===t})}))}),[b,e,a,g]),(0,s.vJ)((()=>{(async()=>{await async function(){return Bv||(Bv=i.e(4810).then(i.bind(i,24810)),Rv=await Bv),Bv}(),m?a&&h.current&&(b.forEach(((e,t)=>{const i=a[e];if("string"==typeof i||p.current.includes(e))return;if(!i)return void p.current.push(e);const{zoomToken:s}=i;Rv.create(h.current.children[t],{title:d(f[e]),...s?{onZoom:e=>(0,Qe.px)("fetchStatisticsAsyncGraph",{token:s,x:e,dcId:o}),zoomOutLabel:d("Graph.ZoomOut")}:{},...i}),p.current.push(e),h.current.children[t].classList.remove(Tv)})),A()):u(!0)})()}),[b,f,m,a,d,e,g,o,A]),(0,ee.FD)("div",{className:(0,me.A)(Pv,"panel-content custom-scroll",m&&Dv),children:[a&&(0,ee.Y)(hv.A,{statistics:a,type:r?"group":"channel",title:d("StatisticOverview")}),!p.current.length&&(0,ee.Y)(zs.A,{}),(0,ee.Y)("div",{ref:h,children:b.map((e=>(0,ee.Y)("div",{className:(0,me.A)(Mv,Tv)},e)))}),Boolean(a?.recentPosts?.length)&&(0,ee.FD)("div",{className:"suY9dEIz",children:[(0,ee.Y)("h2",{className:"evQIkAqx",children:d("ChannelStats.Recent.Header")}),a.recentPosts.map((e=>{if("msgId"in e){const t=l[e.msgId];if(!t||!("content"in t))return;return(0,ee.Y)(kv,{message:t,postStatistic:e},`statistic_message_${e.msgId}`)}if("storyId"in e&&t){const i=c?.[e.storyId];return(0,ee.Y)(Iv,{chat:t,story:i,postStatistic:e},`statistic_story_${e.storyId}`)}}))]})]})}))),Uv="oXLpD4Y4",Ov="paQ2VBe_",Kv="WvFuOAIf",Jv=(0,s.ph)((({data:e})=>{const t=(0,M.A)(),{openChatByUsername:i}=(0,n.ko)(),a=(0,s.Kr)((()=>e.chat?(0,l.Kl)(e.chat):void 0),[e.chat]),o=(0,s.hb)((()=>{i({username:a,messageId:e.messageId})}),[e.messageId,i,a]);return(0,ee.FD)("div",{className:(0,me.A)(Uv,"statistic-public-forward"),onClick:o,children:[(0,ee.Y)(Dt.A,{size:"medium",peer:e.chat}),(0,ee.FD)("div",{children:[(0,ee.Y)("div",{className:Ov,children:e.title}),(0,ee.Y)("div",{className:Kv,children:t("ChannelStats.ViewsCount",e.views,"i")})]})]})}));let Gv,jv;const zv={viewsGraph:"Stats.MessageInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Hv=Object.keys(zv),$v=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.AWZ)(e,t)?.statisticsDcId,s=(0,c.nTw)(e);return{statistics:s.statistics.currentMessage,dcId:i,messageId:s.statistics.currentMessageId}}))((function({chatId:e,isActive:t,statistics:r,dcId:l,messageId:c}){const d=(0,M.A)(),h=(0,s.li)(),[m,u]=(0,s.J0)(!1),p=(0,s.li)([]),{loadMessageStatistics:v,loadMessagePublicForwards:g,loadStatisticsAsyncGraph:A}=(0,n.ko)(),b=(0,F.A)();(0,s.vJ)((()=>{c&&v({chatId:e,messageId:c})}),[e,v,c]),(0,s.vJ)((()=>{t&&!c||(p.current=[],u(!1))}),[t,c]),(0,s.vJ)((()=>{r&&Hv.forEach((t=>{const i=r[t];"string"==typeof i&&A({name:t,chatId:e,token:i})}))}),[e,r,A]),(0,s.vJ)((()=>{(async()=>{await async function(){return Gv||(Gv=i.e(4810).then(i.bind(i,24810)),jv=await Gv),Gv}(),m?r&&h.current&&(Hv.forEach(((e,t)=>{const i=r[e];if("string"==typeof i||p.current.includes(e))return;if(!i)return void p.current.push(e);const{zoomToken:s}=i;jv.create(h.current.children[t],{title:d(zv[e]),...s?{onZoom:e=>(0,Qe.px)("fetchStatisticsAsyncGraph",{token:s,x:e,dcId:l}),zoomOutLabel:d("Graph.ZoomOut")}:{},...i}),p.current.push(e)})),b()):u(!0)})()}),[m,r,d,e,c,A,l,b]);const f=(0,D.A)((({direction:t})=>{t===a.TN.Backwards&&c&&g({chatId:e,messageId:c})}));return m&&r&&c?(0,ee.FD)("div",{className:(0,me.A)(Pv,"custom-scroll",m&&Dv),children:[(0,ee.Y)(hv.A,{statistics:r,type:"message",title:d("StatisticOverview")}),!p.current.length&&(0,ee.Y)(zs.A,{}),(0,ee.Y)("div",{ref:h,children:Hv.map((e=>(0,ee.Y)("div",{className:(0,me.A)(Mv,!p.current.includes(e)&&Tv)})))}),Boolean(r.publicForwards)&&(0,ee.FD)("div",{className:Yv,children:[(0,ee.Y)("h2",{className:Fv,children:d("Stats.Message.PublicShares")}),(0,ee.Y)(Ds.A,{items:r.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:f,preloadBackwards:o.DRJ,noFastList:!0,children:r.publicForwardsData.map((e=>(0,ee.Y)(Jv,{data:e},e.messageId)))})]})]}):(0,ee.Y)(zs.A,{})}))),qv=(0,s.ph)((function({data:e,chatsById:t,usersById:i}){const s=(0,M.A)(),{openChat:a}=(0,n.ko)(),o=i[e.peerId],r=t[e.peerId],c=(0,D.A)((()=>{a({id:o.id})}));return(0,ee.FD)("div",{className:(0,me.A)(Uv,"statistic-public-forward"),onClick:c,children:[(0,ee.Y)(Dt.A,{size:"medium",peer:o||r,withStorySolid:!0,forceUnreadStorySolid:!0}),(0,ee.FD)("div",{children:[(0,ee.Y)("div",{className:Ov,children:o?(0,l.Yg)(o):(0,l.Js)(s,r)}),(0,ee.Y)("div",{className:Kv,children:e.viewsCount?s("ChannelStats.ViewsCount",e.viewsCount,"i"):s("NoViews")})]})]})}));let Wv,Qv;const Zv={viewsGraph:"Stats.StoryInteractionsTitle",reactionsGraph:"ReactionsByEmotionChartTitle"},Xv=Object.keys(Zv),eg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.AWZ)(e,t)?.statisticsDcId,s=(0,c.nTw)(e),n=s.statistics.currentStory,a=s.statistics.currentStoryId,{byId:o}=e.users,{byId:r}=e.chats;return{statistics:n,dcId:i,storyId:a,usersById:o,chatsById:r}}))((function({chatId:e,isActive:t,statistics:a,dcId:r,storyId:l,chatsById:c,usersById:d}){const h=(0,M.A)(),m=(0,s.li)(),[u,p]=(0,s.J0)(!1),v=(0,s.li)([]),{loadStoryStatistics:g,loadStoryPublicForwards:A,loadStatisticsAsyncGraph:b}=(0,n.ko)(),f=(0,F.A)();(0,s.vJ)((()=>{l&&g({chatId:e,storyId:l})}),[e,l]),(0,s.vJ)((()=>{t&&!l||(v.current=[],p(!1))}),[t,l]),(0,s.vJ)((()=>{a&&Xv.forEach((t=>{const i=a[t];"string"==typeof i&&b({name:t,chatId:e,token:i})}))}),[e,a,b]),(0,s.vJ)((()=>{(async()=>{await async function(){return Wv||(Wv=i.e(4810).then(i.bind(i,24810)),Qv=await Wv),Wv}(),u?a&&m.current&&(Xv.forEach(((e,t)=>{const i=a[e];if("string"==typeof i||v.current.includes(e))return;if(!i)return void v.current.push(e);const{zoomToken:s}=i;Qv.create(m.current.children[t],{title:h(Zv[e]),...s?{onZoom:e=>(0,Qe.px)("fetchStatisticsAsyncGraph",{token:s,x:e,dcId:r}),zoomOutLabel:h("Graph.ZoomOut")}:{},...i}),v.current.push(e)})),f()):p(!0)})()}),[u,a,h,e,l,b,r,f]);const C=(0,D.A)((()=>{l&&A({chatId:e,storyId:l})}));return u&&a&&l?(0,ee.FD)("div",{className:(0,me.A)(Pv,"custom-scroll",u&&Dv),children:[(0,ee.Y)(hv.A,{statistics:a,type:"story",title:h("StatisticOverview")}),!v.current.length&&(0,ee.Y)(zs.A,{}),(0,ee.Y)("div",{ref:m,children:Xv.map((e=>(0,ee.Y)("div",{className:(0,me.A)(Mv,!v.current.includes(e)&&Tv)})))}),Boolean(a.publicForwards)&&(0,ee.FD)("div",{className:Yv,children:[(0,ee.Y)("h2",{className:Fv,children:h("Stats.Message.PublicShares")}),(0,ee.Y)(Ds.A,{items:a.publicForwardsData,itemSelector:".statistic-public-forward",onLoadMore:C,preloadBackwards:o.DRJ,noFastList:!0,children:a.publicForwardsData.map((e=>"messageId"in e?(0,ee.Y)(Jv,{data:e},`message_${e.messageId}`):(0,ee.Y)(qv,{data:e,chatsById:c,usersById:d},`story_${e.storyId}`)))})]})]}):(0,ee.Y)(zs.A,{})})));var tg=i(55573);const ig=(0,s.ph)((0,n.EK)(((e,{answer:t})=>{const{voters:i,offsets:s}=(0,c.nTw)(e).pollResults;return{voters:i?.[t.option],offset:s?.[t.option]||""}}))((({chat:e,message:t,answer:i,answerVote:a,totalVoters:o,voters:r,offset:l})=>{const{loadPollOptionResults:c,openChat:d,closePollResults:h}=(0,n.ko)(),m=(0,V.A)(a.votersCount),[p,v]=(0,s.J0)(!0),g=Boolean(r),{option:A,text:b}=i,f=(0,M.A)();(0,s.vJ)((()=>{g&&m===a.votersCount||c({chat:e,messageId:t.id,option:A,offset:l,limit:4,shouldResetVoters:!0})}),[a.votersCount,g]);const C=(0,s.hb)((()=>{v(!0),c({chat:e,messageId:t.id,option:A,offset:l,limit:50})}),[e,c,t.id,l,A]);(0,s.vJ)((()=>{v(!1)}),[r]);const y=(0,s.hb)((e=>{d({id:e}),h()}),[h,d]);return(0,ee.FD)("div",{className:"PollAnswerResults",children:[(0,ee.FD)("div",{className:"poll-voters",children:[r?r.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable",onClick:()=>y(e),children:(0,u.L8)(e)?(0,ee.Y)(Rs.A,{avatarSize:"tiny",userId:e,forceShowSelf:!0,noStatusOrTyping:!0}):(0,ee.Y)(Bs.A,{avatarSize:"tiny",chatId:e,noStatusOrTyping:!0})},e))):(0,ee.Y)(zs.A,{}),r&&function(){const e=a.votersCount-r.length;return a.votersCount>4&&e>0&&(0,ee.Y)(tg.A,{count:e,itemName:"voter",isLoading:p,onClick:C})}()]}),(0,ee.FD)("div",{className:"answer-head",dir:f.isRtl?"rtl":void 0,children:[(0,ee.Y)("span",{className:"answer-title",dir:"auto",children:(0,ds.fd)({text:b.text,entities:b.entities})}),(0,ee.FD)("span",{className:"answer-percent",dir:f.isRtl?"auto":void 0,children:[(S=a.votersCount,w=o,w>0?(S/w*100).toFixed():0),"%"]})]})]});var S,w}))),sg=(0,s.ph)((0,n.EK)((e=>{const{pollResults:{chatId:t,messageId:i}}=(0,c.nTw)(e);if(!t||!i)return{};const s=(0,c.hds)(e,t),n=(0,c.O5q)(e,t,i);return{chat:s,message:n,poll:n&&(0,c.zcZ)(e,n)}}))((({isActive:e,chat:t,message:i,poll:s,onClose:n})=>{const a=(0,M.A)();if((0,fe.A)({isActive:e,onBack:n}),!i||!s||!t)return(0,ee.Y)(zs.A,{});const{summary:o,results:r}=s;if(!r.results)return;const l=(0,fi.dU)(r.results,"option");return(0,ee.FD)("div",{className:"PollResults",dir:a.isRtl?"rtl":void 0,children:[(0,ee.Y)("h3",{className:"poll-question",dir:"auto",children:(0,ds.fd)({text:o.question.text,entities:o.question.entities})}),(0,ee.Y)("div",{className:"poll-results-list custom-scroll",children:o.answers.map((e=>(0,ee.Y)(ig,{chat:t,message:i,answer:e,answerVote:l[e.option],totalVoters:r.totalVoters},`${s.id}-${e.option}`)))})]})})));var ng=i(90603);const ag="xrnUE4e6",og="z7kF7tij",rg="T6wFpdQO",lg="CWsWIKQ1",cg="KBl0ycLl",dg="iJ1U9kDD",hg="Rk6PT_yc",mg="qlo3vSEw",ug="r06zwL42",pg=5*p.$,vg=(0,s.ph)((0,n.EK)((e=>{const{createTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,createTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}}))((({isActive:e,chat:t,createTopicPanel:i,isCurrentUserPremium:a,onClose:r})=>{const{createTopic:l,openPremiumModal:c}=(0,n.ko)(),[d,h]=(0,s.J0)(""),[m,u]=(0,s.J0)(0),[p,v]=(0,s.J0)(void 0),g=(0,M.A)(),A=Boolean(d),b=Boolean(i?.isLoading);(0,fe.A)({isActive:e,onBack:r}),(0,s.vJ)((()=>{e||(h(""),v(void 0))}),[e]);const f=(0,s.hb)((e=>{h(e.target.value)}),[]),C=(0,s.hb)((()=>{u((e=>(0,xa.A)((0,ng.e$)().length,e+1)))}),[]),y=(0,s.hb)((()=>{l({chatId:t.id,title:d,iconColor:(0,ng.e$)()[m],iconEmojiId:p})}),[t,l,m,p,d]),S=(0,s.hb)((e=>{e.isFree||a||e.id===o.MyF?e.id!==o.MyF?v(e.id):v(void 0):c({initialSection:"animated_emoji"})}),[a,c]),w=(0,s.Kr)((()=>({id:0,title:d,iconColor:(0,ng.e$)()[m],iconEmojiId:p})),[m,p,d]);if(t?.isForum)return(0,ee.FD)("div",{className:ag,children:[(0,ee.FD)("div",{className:(0,me.A)(og,"custom-scroll"),children:[(0,ee.FD)("div",{className:(0,me.A)(rg,lg),children:[(0,ee.Y)("span",{className:mg,children:g("CreateTopicTitle")}),(0,ee.Y)(se.Ay,{name:"zoomFade",activeKey:Number(w.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:dg,children:(0,ee.Y)($s.A,{topic:w,className:(0,me.A)(hg,"K1CTKtBS"),onClick:C,size:pg,noLoopLimit:!0})}),(0,ee.Y)(Q.A,{value:d,onChange:f,label:g("lng_forum_topic_title"),disabled:b,teactExperimentControlled:!0})]}),(0,ee.Y)("div",{className:(0,me.A)(rg,cg),children:(0,ee.Y)(zr,{idPrefix:"create-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:S,className:ug,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})})]}),(0,ee.Y)(ki.A,{isShown:A,disabled:b,onClick:y,ariaLabel:g("Save"),children:b?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})}))),gg=5*p.$,Ag=(0,s.ph)((0,n.EK)((e=>{const{editTopicPanel:t}=(0,c.nTw)(e);return{chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0,topic:t?.chatId&&t?.topicId?(0,c.S0q)(e,t.chatId,t.topicId):void 0,editTopicPanel:t,isCurrentUserPremium:(0,c.g29)(e)}}))((({isActive:e,chat:t,topic:i,editTopicPanel:a,isCurrentUserPremium:r,onClose:l})=>{const{editTopic:c,openPremiumModal:d}=(0,n.ko)(),[h,m]=(0,s.J0)(""),[u,p]=(0,s.J0)(void 0),v=(0,M.A)(),g=Boolean(a?.isLoading),A=i?.id===o.HxB;(0,fe.A)({isActive:e,onBack:l}),(0,s.vJ)((()=>{e||(m(""),p(void 0))}),[e]),(0,s.vJ)((()=>{(i?.title||i?.iconEmojiId)&&(m(i.title),p(i.iconEmojiId))}),[i]);const b=(0,s.Kr)((()=>h!==i?.title||u!==i?.iconEmojiId),[u,h,i?.iconEmojiId,i?.title]),f=(0,s.hb)((e=>{const t=e.target.value;m(t)}),[]),C=(0,s.hb)((()=>{c({chatId:t.id,title:h,topicId:i.id,iconEmojiId:u})}),[t,c,u,h,i]),y=(0,s.hb)((e=>{e.isFree||r||e.id===o.MyF?e.id!==o.MyF?p(e.id):p("0"):d({initialSection:"animated_emoji"})}),[r,d]),S=(0,s.Kr)((()=>({...i,title:h,iconEmojiId:u})),[u,h,i]);if(t?.isForum)return(0,ee.FD)("div",{className:ag,children:[(0,ee.FD)("div",{className:(0,me.A)(og,"custom-scroll"),children:[!i&&(0,ee.Y)(zs.A,{}),i&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:(0,me.A)(rg,lg,A&&"YftUWqqw"),children:[(0,ee.Y)("span",{className:mg,children:v(A?"CreateGeneralTopicTitle":"CreateTopicTitle")}),(0,ee.Y)(se.Ay,{name:"zoomFade",activeKey:Number(S.iconEmojiId)||0,shouldCleanup:!0,direction:1,className:dg,children:(0,ee.Y)($s.A,{topic:S,className:hg,size:gg,noLoopLimit:!0})}),(0,ee.Y)(Q.A,{value:h,onChange:f,label:v("lng_forum_topic_title"),disabled:g,teactExperimentControlled:!0})]}),!A&&(0,ee.Y)("div",{className:(0,me.A)(rg,cg),children:(0,ee.Y)(zr,{idPrefix:"edit-topic-icons-set-",isHidden:!e,loadAndPlay:e,onCustomEmojiSelect:y,className:ug,pickerListClassName:"fab-padding-bottom",withDefaultTopicIcons:!0})})]})]}),(0,ee.Y)(ki.A,{isShown:b,disabled:g,onClick:C,ariaLabel:v("Save"),children:g?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})}))),bg="Please provide name",fg=(0,s.ph)((0,n.EK)(((e,{userId:t})=>{const i=(0,c.yps)(e,t),s=(0,c.vGo)(e,t),{progress:n}=(0,c.nTw)(e).management,a=(0,ya.d)(e,"aboutLength");return{userId:t,user:i,progress:n,currentBio:s?.bio,maxBioLength:a}}))((({userId:e,user:t,progress:i,onClose:o,currentBio:r,isActive:c,maxBioLength:d})=>{const{setBotInfo:h,uploadProfilePhoto:m,uploadContactProfilePhoto:u,startBotFatherConversation:p}=(0,n.ko)(),[v,g,A]=(0,Y.A)(!1),[b,f,C]=(0,Y.A)(!1),[y,S]=(0,s.J0)(),w=(0,M.A)(),k=(0,s.Kr)((()=>t?(0,l.Kl)(t):void 0),[t]);(0,fe.A)({isActive:c,onBack:o});const N=t?(0,l.u0)(t):"",[I,P]=(0,s.J0)(),[F,T]=(0,s.J0)(N||""),[B,R]=(0,s.J0)(r||""),L=t&&(0,l.cP)(t),x=(0,j.A)(L,!1,U.qZ.BlobUrl);(0,s.vJ)((()=>{A(),C()}),[e]),(0,s.vJ)((()=>{T(N||""),R(r||"")}),[N,r,t]),(0,s.vJ)((()=>{P(void 0)}),[x]),(0,s.vJ)((()=>{i===a.TD.Complete&&(A(),C(),S(void 0))}),[i]);const E=(0,D.A)((e=>{T(e.target.value),g(),y===bg&&S(void 0)})),V=(0,D.A)((e=>{R(e.target.value),g()})),_=(0,D.A)((e=>{P(e),f()})),O=(0,D.A)((()=>{const e=F.trim(),i=B.trim();e.length?(h({...v&&{bot:t,name:e,description:i}}),I&&m({file:I,...b&&{bot:t}})):S(bg)})),K=(0,D.A)((()=>{p({param:`${k}-intro`})})),J=(0,D.A)((()=>{p({param:`${k}-commands`})})),G=(0,D.A)((()=>{p({param:k})})),z=(0,s.li)(),H=(0,s.li)(!1),$=(0,D.A)((t=>{f(),u({userId:e,file:t,isSuggest:H.current})}));if(!t)return;const W=i===a.TD.InProgress;return(0,ee.FD)("div",{className:"Management",children:[(0,ee.FD)("div",{className:"custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(dh.A,{currentAvatarBlobUrl:x,onChange:_,title:w("ChatSetPhotoOrVideo"),disabled:W}),(0,ee.Y)(Q.A,{id:"user-name",label:w("PaymentCheckoutName"),onChange:E,value:F,error:y===bg?y:void 0,teactExperimentControlled:!0}),(0,ee.Y)(Ll.A,{value:B,onChange:V,label:w("DescriptionPlaceholder"),disabled:W,maxLength:d,maxLengthIndicator:d?(d-B.length).toString():void 0})]}),(0,ee.Y)("div",{className:"section",children:(0,ee.FD)("div",{className:"dialog-buttons",children:[(0,ee.Y)(ci.A,{icon:"bot-commands-filled",ripple:!0,onClick:K,children:(0,ee.Y)("span",{children:w("BotEditIntro")})}),(0,ee.Y)(ci.A,{icon:"bot-command",ripple:!0,onClick:J,children:(0,ee.Y)("span",{children:w("BotEditCommands")})}),(0,ee.Y)(ci.A,{icon:"bots",ripple:!0,onClick:G,children:(0,ee.Y)("span",{children:w("BotChangeSettings")})}),(0,ee.Y)("div",{className:"section-info section-info_push",children:(0,Ft.A)(w("BotManageInfo"),["links"])})]})})]}),(0,ee.Y)(ki.A,{isShown:v||b,onClick:O,disabled:W,ariaLabel:w("Save"),children:W?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),(0,ee.Y)(Qh.A,{onChange:$,inputRef:z})]})}))),Cg="Channel title can't be empty",yg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{management:s}=(0,c.nTw)(e),{progress:n}=s,{invites:a}=s.byChatId[t]||{};return{chat:i,chatFullInfo:(0,c.AWZ)(e,t),progress:n,canChangeInfo:(0,l.ub)(i,"changeInfo"),canInvite:(0,l.ub)(i,"inviteUsers"),exportedInvites:a,availableReactions:e.reactions.availableReactions}}),((e,{chatId:t})=>Boolean((0,c.hds)(e,t))))((({chatId:e,chat:t,chatFullInfo:i,progress:o,canChangeInfo:r,canInvite:c,exportedInvites:d,isActive:h,availableReactions:m,onScreenSelect:u,onClose:p})=>{const{updateChat:v,closeManagement:g,leaveChannel:A,deleteChannel:b,openChat:f,loadExportedChatInvites:C,loadChatJoinRequests:y}=(0,n.ko)(),S=t?.title||"",w=i?.about||"",k=Boolean(i?.linkedChatId),[N,I,P]=(0,Y.A)(),[F,D]=(0,s.J0)(!1),[T,B]=(0,s.J0)(S),[R,L]=(0,s.J0)(w),[x,E]=(0,s.J0)(),[V,_]=(0,s.J0)(),O=t&&(0,l.cP)(t),K=(0,j.A)(O,!1,U.qZ.BlobUrl),J=(0,M.A)();(0,fe.A)({isActive:h,onBack:p}),(0,s.vJ)((()=>{c&&(C({chatId:e}),C({chatId:e,isRevoked:!0}),y({chatId:e}))}),[e,c]),(0,s.vJ)((()=>{o===a.TD.Complete&&(D(!1),_(void 0))}),[o]);const G=(0,s.Kr)((()=>Object.keys(i?.adminMembersById||{}).length),[i?.adminMembersById]),z=i?.kickedMembers?.length||0,H=(0,s.hb)((()=>{u(a.je.ChatPrivacyType)}),[u]),$=(0,s.hb)((()=>{u(a.je.Discussion)}),[u]),W=(0,s.hb)((()=>{u(a.je.Reactions)}),[u]),Z=(0,s.hb)((()=>{u(a.je.ChatAdministrators)}),[u]),X=(0,s.hb)((()=>{u(a.je.Invites)}),[u]),te=(0,s.hb)((()=>{u(a.je.JoinRequests)}),[u]),ie=(0,s.hb)((e=>{E(e),D(!0)}),[]),se=(0,s.hb)((e=>{B(e.target.value),D(!0)}),[]),ne=(0,s.hb)((e=>{L(e.target.value),D(!0)}),[]),ae=(0,s.hb)((()=>{const t=T.trim(),i=R.trim();t.length?v({chatId:e,title:t,about:i,photo:x}):_(Cg)}),[R,e,x,T,v]),oe=(0,s.hb)((()=>{u(a.je.ChannelSubscribers)}),[u]),re=(0,s.hb)((()=>{u(a.je.ChannelRemovedUsers)}),[u]),le=(0,s.hb)((()=>{t.isCreator?b({chatId:t.id}):A({chatId:t.id}),P(),g(),f({id:void 0})}),[t.isCreator,t.id,P,g,A,b,f]),ce=(0,s.Kr)((()=>{if(!i?.enabledReactions)return J("ReactionsOff");if("all"===i.enabledReactions.type)return J("ReactionsAll");const e=i.enabledReactions.allowed.length,t=m?.filter((e=>!e.isInactive)).length||0;return t?`${e} / ${t}`:e.toString()}),[m,i?.enabledReactions,J]),de=(0,s.Kr)((()=>(0,l.gA)(t)),[t]);if(t.isRestricted||t.isForbidden)return;const he=o===a.TD.InProgress;return(0,ee.FD)("div",{className:"Management",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(dh.A,{currentAvatarBlobUrl:K,onChange:ie,disabled:!r}),(0,ee.FD)("div",{className:"settings-edit",children:[(0,ee.Y)(Q.A,{id:"channel-title",label:J("EnterChannelName"),onChange:se,value:T,error:V===Cg?V:void 0,disabled:!r}),(0,ee.Y)(Ll.A,{id:"channel-about",label:J("DescriptionPlaceholder"),onChange:ne,value:R,maxLength:255,maxLengthIndicator:(255-R.length).toString(),disabled:!r,noReplaceNewlines:!0})]}),t.isCreator&&(0,ee.FD)(ci.A,{icon:"lock",multiline:!0,onClick:H,children:[(0,ee.Y)("span",{className:"title",children:J("ChannelType")}),(0,ee.Y)("span",{className:"subtitle",children:J(de?"TypePublic":"TypePrivate")})]}),(0,ee.FD)(ci.A,{icon:"message",multiline:!0,onClick:$,disabled:!r,children:[(0,ee.Y)("span",{className:"title",children:J("Discussion")}),(0,ee.Y)("span",{className:"subtitle",children:J(k?"DiscussionUnlink":"Add")})]}),c&&(0,ee.FD)(ci.A,{icon:"link",onClick:X,multiline:!0,disabled:!d,children:[(0,ee.Y)("span",{className:"title",children:J("GroupInfo.InviteLinks")}),(0,ee.Y)("span",{className:"subtitle",children:d?(0,He.Sm)(d.length):J("Loading")})]}),Boolean(t.joinRequests?.length)&&(0,ee.FD)(ci.A,{icon:"add-user-filled",onClick:te,multiline:!0,children:[(0,ee.Y)("span",{className:"title",children:J("SubscribeRequests")}),(0,ee.Y)("span",{className:"subtitle",children:(0,He.Sm)(t.joinRequests.length)})]}),(0,ee.FD)(ci.A,{icon:"heart-outline",multiline:!0,onClick:W,disabled:!r,children:[(0,ee.Y)("span",{className:"title",children:J("Reactions")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:ce})]})]}),(0,ee.FD)("div",{className:"section",children:[(0,ee.FD)(ci.A,{icon:"admin",multiline:!0,onClick:Z,children:[(0,ee.Y)("span",{className:"title",children:J("ChannelAdministrators")}),(0,ee.Y)("span",{className:"subtitle",children:G})]}),(0,ee.FD)(ci.A,{icon:"group",multiline:!0,onClick:oe,children:[(0,ee.Y)("span",{className:"title",dir:"auto",children:J("ChannelSubscribers")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:(0,He.Sm)(t.membersCount)})]}),(0,ee.FD)(ci.A,{icon:"delete-user",multiline:!0,onClick:re,children:[(0,ee.Y)("span",{className:"title",children:J("ChannelBlockedUsers")}),(0,ee.Y)("span",{className:"subtitle",children:z})]})]}),(0,ee.Y)("div",{className:"section",children:(0,ee.Y)(ci.A,{icon:"delete",ripple:!0,destructive:!0,onClick:I,children:t.isCreator?J("ChannelDelete"):J("LeaveChannel")})})]}),(0,ee.Y)(ki.A,{isShown:F,onClick:ae,disabled:he,ariaLabel:J("Save"),children:he?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),(0,ee.Y)(vi.A,{isOpen:N,onClose:P,text:t.isCreator?J("ChannelDeleteAlert"):J("ChannelLeaveAlert"),confirmLabel:t.isCreator?J("ChannelDelete"):J("LeaveChannel"),confirmHandler:le,confirmIsDestructive:!0})]})}))),Sg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,currentUserId:e.currentUserId,isChannel:i&&(0,l.WX)(i),adminMembersById:(0,c.AWZ)(e,t)?.adminMembersById}}))((({isActive:e,chat:t,isChannel:i,currentUserId:o,adminMembersById:r,onScreenSelect:c,onChatMemberSelect:d,onClose:h})=>{const{toggleSignatures:m}=(0,n.ko)(),u=(0,M.A)();(0,fe.A)({isActive:e,onBack:h});const p=Boolean(t?.areSignaturesShown),v=Boolean(t?.areProfilesShown),g=Boolean(t?.isCreator||t&&(0,l.ub)(t,"addAdmins")),A=i&&(0,l.ub)(t,"postMessages"),b=(0,s.Kr)((()=>{if(!r)return[];const[e,t]=(0,fi.jB)(Object.values(r),(e=>e.isOwner));return[...e,...t]}),[r]),f=(0,D.A)((e=>{d(e.userId,e.promotedByUserId===o),c(a.je.ChatAdminRights)})),C=(0,D.A)((()=>{m({chatId:t.id,areProfilesEnabled:v,areSignaturesEnabled:!p})})),y=(0,D.A)((()=>{m({chatId:t.id,areProfilesEnabled:!v,areSignaturesEnabled:p})})),S=(0,D.A)((()=>{c(a.je.GroupAddAdmins)})),w=(0,D.A)((e=>{if(e.isOwner)return u("ChannelCreator");const t=(0,n.mS)().users.byId,i=e.promotedByUserId?t[e.promotedByUserId]:void 0;return i?u("EditAdminPromotedBy",(0,l.Yg)(i)):u("ChannelAdmin")}));return(0,ee.Y)("div",{className:"Management",children:(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.Y)("div",{className:"section",children:(0,ee.FD)(ci.A,{icon:"recent",multiline:!0,disabled:!0,children:[(0,ee.Y)("span",{className:"title",children:u("EventLog")}),(0,ee.Y)("span",{className:"subtitle",children:u(i?"EventLogInfoDetailChannel":"EventLogInfoDetail")})]})}),(0,ee.FD)("div",{className:"section",dir:u.isRtl?"rtl":void 0,children:[(0,ee.Y)("p",{className:"section-help",dir:"auto",children:u(i?"Channel.Management.AddModeratorHelp":"Group.Management.AddModeratorHelp")}),b.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable",onClick:()=>f(e),children:(0,ee.Y)(Rs.A,{userId:e.userId,status:w(e),forceShowSelf:!0})},e.userId))),(0,ee.Y)(ki.A,{isShown:g,onClick:S,ariaLabel:u("Channel.Management.AddModerator"),children:(0,ee.Y)(q.A,{name:"add-user-filled"})})]}),A&&(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("div",{className:"ListItem narrow",children:(0,ee.Y)(un.A,{checked:p,label:u("ChannelSignMessages"),onChange:C})}),p&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("div",{className:"ListItem narrow",children:(0,ee.Y)(un.A,{checked:v,label:u("ChannelSignMessagesWithProfile"),onChange:y})}),(0,ee.Y)("p",{className:"section-info section-info_push",children:u("ChannelSignProfilesInfo")})]})]})]})})}))),wg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{isUsernameAvailable:s,checkedUsername:n,error:a}=(0,c.YK)(e,t);return{chat:i,isChannel:(0,l.WX)(i),progress:(0,c.nTw)(e).management.progress,error:a,isUsernameAvailable:s,checkedUsername:n,isProtected:i?.isProtected,maxPublicLinks:(0,ya.d)(e,"channelsPublic"),privateInviteLink:(0,c.AWZ)(e,t)?.inviteLink}}),((e,{chatId:t})=>Boolean((0,c.hds)(e,t)&&(0,c.YK)(e,t))))((({chat:e,isActive:t,isChannel:i,progress:r,isUsernameAvailable:c,checkedUsername:d,error:h,isProtected:m,maxPublicLinks:u,privateInviteLink:p,onClose:v})=>{const{updatePublicLink:g,updatePrivateLink:A,toggleIsProtected:b,openLimitReachedModal:f,resetManagementError:C}=(0,n.ko)(),y=(0,s.Kr)((()=>e.usernames?.find((({isEditable:e})=>e))),[e.usernames]),S=y?.username||"",w=(0,s.Kr)((()=>(0,l.gA)(e)),[e]),[k,N]=(0,s.J0)(!1),[I,P]=(0,s.J0)(w?"public":"private"),[F,D]=(0,s.J0)(),[T,B,R]=(0,Y.A)(),[L,x,E]=(0,Y.A)(),_=(0,V.A)(c),U=k&&Boolean("public"===I&&(F||S&&""===F)&&(c??_)||"private"===I&&w);(0,fe.A)({isActive:t,onBack:v}),(0,s.vJ)((()=>{N(!1)}),[S]),(0,s.vJ)((()=>{I&&!p&&A()}),[I,p,A]);const O=(0,s.hb)((t=>{D(t),N(!0),h&&C({chatId:e.id})}),[e.id,h]),K=(0,s.hb)(((e,t)=>{if(Object.values((0,n.mS)().chats.byId).filter((({isCreator:e,usernames:t})=>e&&t?.some((e=>e.isActive)))).length>=u&&"public"===e){f({limit:"channelsPublic"});const e=t.currentTarget.closest(".radio-group");return e.querySelector("[value=public]").checked=!1,void(e.querySelector("[value=private]").checked=!0)}P(e),N(!0)}),[u,f]),J=(0,s.hb)((t=>{b({chatId:e.id,isProtected:"protected"===t})}),[e.id,b]),G=(0,s.hb)((()=>{w&&"private"===I?x():g({username:"public"===I&&F||""})}),[w,x,I,g,F]),j=(0,s.hb)((()=>{g({username:"",shouldDisableUsernames:!0}),E()}),[E,g]),z=(0,s.hb)((()=>{R(),A()}),[R,A]),H=(0,M.A)(),$=i?"Channel":"Mega",W=i?"Channel":"Group",Q=[{value:"private",label:H(`${$}Private`),subLabel:H(`${$}PrivateInfo`)},{value:"public",label:H(`${$}Public`),subLabel:H(`${$}PublicInfo`)}],Z=[{value:"allowed",label:H("ChannelVisibility.Forwarding.Enabled")},{value:"protected",label:H("ChannelVisibility.Forwarding.Disabled")}],te=r===a.TD.InProgress,ie="public"===I&&e.usernames&&e.usernames.length>0;return(0,ee.FD)("div",{className:"Management",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.FD)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:[(0,ee.Y)("h3",{className:"section-heading",children:H(`${W}Type`)}),(0,ee.Y)(X.A,{selected:I,name:"channel-type",options:Q,onChange:K})]}),"private"===I?(0,ee.Y)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:p?(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(sl.A,{link:p,className:"invite-link"}),(0,ee.Y)("p",{className:"section-info",dir:H.isRtl?"rtl":void 0,children:H(`${$}PrivateLinkHelp`)}),(0,ee.Y)(ci.A,{icon:"delete",ripple:!0,destructive:!0,onClick:B,children:H("RevokeLink")}),(0,ee.Y)(vi.A,{isOpen:T,onClose:R,text:H("RevokeAlert"),confirmLabel:H("RevokeButton"),confirmHandler:z,confirmIsDestructive:!0})]}):(0,ee.Y)(zs.A,{})}):(0,ee.FD)("div",{className:"section no-border",children:[(0,ee.Y)("div",{className:"settings-input",children:(0,ee.Y)(ch,{asLink:!0,currentUsername:S,isLoading:te,isUsernameAvailable:c,checkedUsername:d,onChange:O})}),h===o.Y3M&&function(){const e=`${o.jsp}${o.NjX}`;return(0,ee.Y)("p",{className:"section-info",dir:"auto",children:H("lng_username_purchase_available").replace("{link}","%PURCHASE_LINK%").split("%").map((t=>"PURCHASE_LINK"===t?(0,ee.Y)(fl.A,{url:e,text:`@${o.NjX}`}):t))})}(),(0,ee.Y)("p",{className:"section-info",dir:"auto",children:H(`${W}.Username.CreatePublicLinkHelp`)})]}),ie&&(0,ee.Y)(ah,{chatId:e.id,usernames:e.usernames,onEditUsername:O}),(0,ee.FD)("div",{className:"section",dir:H.isRtl?"rtl":void 0,children:[(0,ee.Y)("h3",{className:"section-heading",children:H(i?"ChannelVisibility.Forwarding.ChannelTitle":"ChannelVisibility.Forwarding.GroupTitle")}),(0,ee.Y)(X.A,{selected:m?"protected":"allowed",name:"forwarding-type",options:Z,onChange:J}),(0,ee.Y)("p",{className:"section-info section-info_push",children:H(i?"ChannelVisibility.Forwarding.ChannelInfo":"ChannelVisibility.Forwarding.GroupInfo")})]})]}),(0,ee.Y)(ki.A,{isShown:U,disabled:te,ariaLabel:H("Save"),onClick:G,children:te?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),(0,ee.Y)(vi.A,{isOpen:L,onClose:E,text:H("ChannelVisibility.Confirm.MakePrivate.Channel",S),confirmHandler:j,confirmIsDestructive:!0})]})}))),kg=(0,s.ph)((0,n.EK)(((e,{chat:t})=>{const{currentUserId:i}=e;return{currentUserId:i,chatMembers:(0,c.AWZ)(e,t.id)?.members}}))((({chat:e,currentUserId:t,chatMembers:i,isOpen:a,onClose:o})=>{const{loadMoreMembers:r,deleteChatMember:l}=(0,n.ko)(),c=(0,M.A)(),[d,h]=(0,s.J0)(""),m=(0,s.Kr)((()=>{const e=(i||[]).reduce(((e,i)=>(i.isAdmin||i.isOwner||i.userId===t||e.push(i.userId),e)),[]);return(0,Yt.PU)({ids:e,query:d,type:"user"})}),[i,t,d]),u=(0,s.hb)((t=>{l({chatId:e.id,userId:t}),o()}),[e.id,l,o]);return(0,ee.Y)(Zs,{isOpen:a,chatOrUserIds:m,searchPlaceholder:c("ChannelBlockUser"),search:d,onSearchChange:h,loadMore:r,onSelectChatOrUser:u,onClose:o})}))),Ng=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{byId:s}=e.users;return{chat:i,usersById:s,canDeleteMembers:i&&((0,l.ub)(i,"banUsers")||i.isCreator),removedMembers:(0,c.AWZ)(e,t)?.kickedMembers||Ci.p,isChannel:i&&(0,l.WX)(i)}}))((({chat:e,usersById:t,canDeleteMembers:i,removedMembers:a,isChannel:o,onClose:r,isActive:c})=>{const{updateChatMemberBannedRights:d}=(0,n.ko)(),h=(0,M.A)(),[m,u,p]=(0,Y.A)();(0,fe.A)({isActive:c,onBack:r});const v=(0,s.hb)((e=>{if(!e.kickedByUserId)return;const i=t[e.kickedByUserId];return i?h("UserRemovedBy",(0,l.Yg)(i)):void 0}),[h,t]),g=(0,s.hb)((t=>{if(e)return[{title:h("Unblock"),icon:"delete",destructive:!0,handler:()=>d({chatId:e.id,userId:t.userId,bannedRights:{}})}]}),[h,e,d]);return(0,ee.Y)("div",{className:"Management",children:(0,ee.Y)("div",{className:"panel-content custom-scroll",children:(0,ee.FD)("div",{className:"section",dir:h.isRtl?"rtl":void 0,children:[(0,ee.Y)("p",{className:"section-help",children:h(o?"NoBlockedChannel2":"NoBlockedGroup2")}),a.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable",ripple:!0,contextActions:g(e),children:(0,ee.Y)(Rs.A,{userId:e.userId,status:v(e),forceShowSelf:!0})},e.userId))),i&&(0,ee.Y)(ki.A,{isShown:!0,onClick:u,ariaLabel:h("Channel.EditAdmin.Permission.BanUsers"),children:(0,ee.Y)(q.A,{name:"add-user-filled"})}),e&&i&&(0,ee.Y)(kg,{chat:e,isOpen:m,onClose:p})]})})})}))),Ig=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{linkedChatId:s}=(0,c.AWZ)(e,t)||{},{forDiscussionIds:n,byId:a}=e.chats;return{chat:i,chatsByIds:a,forDiscussionIds:n,linkedChat:s?(0,c.hds)(e,s):void 0,isChannel:i&&(0,l.WX)(i)}}))((({chat:e,onClose:t,isActive:i,chatId:r,chatsByIds:c,linkedChat:d,forDiscussionIds:h,isChannel:m,onScreenSelect:u})=>{const{loadGroupsForDiscussion:p,linkDiscussionGroup:v,unlinkDiscussionGroup:g,toggleJoinRequest:A,toggleJoinToSend:b}=(0,n.ko)(),[f,C]=(0,s.J0)(),[y,S,w]=(0,Y.A)(),[k,N,I]=(0,Y.A)(),[P,F]=(0,s.J0)(Boolean(d?.isJoinToSend)),[T,B]=(0,s.J0)(Boolean(d?.isJoinRequest)),R=(0,M.A)(),L=d?.id;(0,fe.A)({isActive:i,onBack:t}),(0,s.vJ)((()=>{p()}),[p]),(0,s.vJ)((()=>{i&&(F(d?.isJoinToSend||!1),B(d?.isJoinRequest||!1))}),[d,i]);const x=(0,s.hb)((()=>{w(),g({channelId:m?r:L}),m||u(a.je.Initial)}),[w,g,m,r,L,u]),E=(0,s.hb)((()=>{I(),v({channelId:r,chatId:f})}),[I,v,r,f]),V=(0,s.hb)((e=>{F(e),b({chatId:L,isEnabled:e}),e||B(!1)}),[L,b]),_=(0,s.hb)((e=>{B(e),A({chatId:L,isEnabled:e})}),[L,A]);const U=(0,D.A)((()=>{u(a.je.NewDiscussionGroup)}));return(0,ee.Y)("div",{className:"Management",children:(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.DiscussionGroups,size:o.Uyp,className:"section-icon"}),d&&(0,ee.FD)("div",{children:[(0,ee.Y)(ci.A,{className:"chat-item-clickable",inactive:!0,children:(0,ee.Y)(Bs.A,{chatId:d.id})}),(0,ee.Y)(ci.A,{icon:"delete",ripple:!0,destructive:!0,onClick:S,children:R(m?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")}),(0,ee.Y)(vi.A,{isOpen:y,onClose:w,header:(0,ee.FD)("div",{className:"modal-header",children:[(0,ee.Y)(Dt.A,{size:"tiny",peer:d}),(0,ee.Y)("div",{className:"modal-title",children:R(m?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel")})]}),textParts:(0,Ft.A)(R(m?"DiscussionUnlinkChannelAlert":"DiscussionUnlinkGroupAlert",d.title),["br","simple_markdown"]),confirmLabel:R(m?"DiscussionUnlinkGroup":"DiscussionUnlinkChannel"),confirmHandler:x,confirmIsDestructive:!0})]}),!d&&(0,ee.FD)("div",{children:[(0,ee.Y)("p",{className:"section-help",dir:"auto",children:R("DiscussionChannelHelp")}),(0,ee.FD)("div",{teactFastList:!0,children:[(0,ee.Y)(ci.A,{icon:"group",ripple:!0,className:"create-item",withPrimaryColor:!0,teactOrderKey:0,onClick:U,children:R("DiscussionCreateGroup")},"create-group"),h?h.map(((e,t)=>(0,ee.Y)(ci.A,{teactOrderKey:t+1,className:"chat-item-clickable scroll-item",onClick:()=>{C(e),N()},children:(0,ee.Y)(Bs.A,{chatId:e})},e))):(0,ee.Y)(Sc.A,{teactOrderKey:0,text:"No discussion groups found"},"nothing-found")]}),(0,ee.Y)("p",{className:"mt-4 mb-0 section-help",dir:"auto",children:R("DiscussionChannelHelp2")}),(0,ee.Y)(vi.A,{isOpen:k,onClose:I,header:function(){if(!f)return;const e=c[f];return e?(0,ee.FD)("div",{className:"modal-header",children:[(0,ee.Y)(Dt.A,{size:"tiny",peer:e}),(0,ee.Y)("div",{className:"modal-title",children:R("Channel.DiscussionGroup.LinkGroup")})]}):void 0}(),textParts:function(){if(!f)return;const t=c[f];return t?(0,l.gA)(t)?(0,Ft.A)(`Do you want to make **${t.title}** the discussion board for **${e.title}**?`,["br","simple_markdown"]):(0,Ft.A)(`Do you want to make **${t.title}** the discussion board for **${e.title}**?\n\nAnyone from the channel will be able to see messages in this group.`,["br","simple_markdown"]):void 0}(),confirmLabel:R("DiscussionLinkGroup"),confirmHandler:E})]})]}),d&&(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("h3",{className:"section-heading",children:R("ChannelSettingsJoinTitle")}),(0,ee.Y)("div",{className:"ListItem narrow",children:(0,ee.Y)(un.A,{checked:P,onCheck:V,label:R("ChannelSettingsJoinToSend")})}),P&&(0,ee.Y)("div",{className:"ListItem narrow",children:(0,ee.Y)(un.A,{checked:T,onCheck:_,label:R("ChannelSettingsJoinRequest")})}),(0,ee.Y)("p",{className:"section-info section-info_push",children:R(P?"ChannelSettingsJoinRequestInfo":"ChannelSettingsJoinToSendInfo")})]})]})})}))),Pg="Group title can't be empty",Yg=["sendMessages","embedLinks","sendPolls","changeInfo","inviteUsers","pinMessages","manageTopics","sendPhotos","sendVideos","sendRoundvideos","sendVoices","sendAudios","sendDocs"],Fg=Yg.length+1,Dg=(0,ve.sg)((e=>e()),500,!1),Mg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t),{management:n,limitReachedModal:a}=(0,c.nTw)(e),{progress:o}=n,r=Boolean(s?.linkedChatId),d=(0,l.yn)(i),{invites:h}=n.byChatId[t]||{},m=!r&&((0,l.ub)(i,"changeInfo")||i.isCreator);return{chat:i,chatFullInfo:s,progress:o,isBasicGroup:d,hasLinkedChannel:r,canChangeInfo:i.isCreator||(0,l.ub)(i,"changeInfo"),canBanUsers:i.isCreator||(0,l.ub)(i,"banUsers"),canInvite:i.isCreator||(0,l.ub)(i,"inviteUsers"),exportedInvites:h,isChannelsPremiumLimitReached:"channels"===a?.limit,availableReactions:e.reactions.availableReactions,canEditForum:m}}),((e,{chatId:t})=>Boolean((0,c.hds)(e,t))))((({chatId:e,chat:t,chatFullInfo:i,progress:o,isBasicGroup:r,hasLinkedChannel:c,canChangeInfo:d,canBanUsers:h,canInvite:m,canEditForum:u,isActive:p,exportedInvites:v,isChannelsPremiumLimitReached:g,availableReactions:A,onScreenSelect:b,onClose:f})=>{const{togglePreHistoryHidden:C,updateChat:y,deleteChat:S,leaveChannel:w,deleteChannel:k,closeManagement:N,openChat:I,loadExportedChatInvites:P,loadChatJoinRequests:F,toggleForum:T}=(0,n.ko)(),[B,R,L]=(0,Y.A)(),x=t.title,E=i?.about||"",[V,_]=(0,s.J0)(!1),[O,K]=(0,s.J0)(x),[J,G]=(0,s.J0)(E),[z,H]=(0,s.J0)(),[$,W]=(0,s.J0)(),[Z,X]=(0,s.J0)(t.isForum),te=(0,l.cP)(t),ie=(0,j.A)(te,!1,U.qZ.BlobUrl),se=(0,s.Kr)((()=>(0,l.gA)(t)),[t]),ne=(0,M.A)(),ae=(0,s.li)();(0,fe.A)({isActive:p,onBack:f}),(0,s.vJ)((()=>{m&&(P({chatId:e}),P({chatId:e,isRevoked:!0}),F({chatId:e}))}),[e,m]),(0,s.vJ)((()=>{X(Boolean(t.isForum))}),[t.isForum]),(0,s.vJ)((()=>{o===a.TD.Complete&&(_(!1),W(void 0))}),[o]);const oe=(0,D.A)((()=>{b(a.je.ChatPrivacyType)})),re=(0,D.A)((()=>{b(a.je.Discussion)})),le=(0,D.A)((()=>{b(a.je.Reactions)})),ce=(0,D.A)((()=>{b(a.je.GroupPermissions)})),de=(0,D.A)((()=>{b(a.je.ChatAdministrators)})),he=(0,D.A)((()=>{b(a.je.Invites)})),me=(0,D.A)((()=>{b(a.je.JoinRequests)})),ue=(0,D.A)((e=>{H(e),_(!0)})),pe=(0,D.A)((e=>{K(e.target.value),_(!0)})),ve=(0,D.A)((e=>{G(e.target.value),_(!0)})),ge=(0,D.A)((()=>{const t=O.trim(),i=J.trim();t.length?y({chatId:e,title:t,about:i,photo:z}):W(Pg)})),Ae=(0,D.A)((()=>{b(a.je.GroupMembers)})),be=(0,D.A)((()=>{if(!i)return;const{isPreHistoryHidden:e}=i;C({chatId:t.id,isEnabled:!e})})),Ce=(0,D.A)((()=>{X((t=>{const i=!t;return Dg((()=>{T({chatId:e,isEnabled:i})})),i}))}));(0,s.vJ)((()=>{if(!g)return;const e=ae.current?.querySelector("input");e.checked=!i?.isPreHistoryHidden}),[g,i?.isPreHistoryHidden]);const ye=(0,s.Kr)((()=>{if(!i?.enabledReactions)return ne("ReactionsOff");if("all"===i.enabledReactions.type)return ne("ReactionsAll");const e=i.enabledReactions.allowed.length,t=A?.filter((e=>!e.isInactive)).length||0;return t?`${e} / ${t}`:e.toString()}),[A,i?.enabledReactions,ne]),Se=(0,s.Kr)((()=>{if(!t.defaultBannedRights)return 0;let e=Yg.filter((e=>!("manageTopics"===e&&!Z||t.defaultBannedRights[e]))).length;const{sendStickers:i,sendGifs:s}=t.defaultBannedRights;return i||s||(e+=1),e}),[t.defaultBannedRights,Z]),we=(0,s.Kr)((()=>Object.keys(i?.adminMembersById||{}).length),[i?.adminMembersById]),ke=(0,D.A)((()=>{r?S({chatId:t.id}):t.isCreator?k({chatId:t.id}):w({chatId:t.id}),L(),N(),I({id:void 0})}));if(t.isRestricted||t.isForbidden)return;const Ne=o===a.TD.InProgress;return(0,ee.FD)("div",{className:"Management",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(dh.A,{isForForum:Z,currentAvatarBlobUrl:ie,onChange:ue,disabled:!d}),(0,ee.FD)("div",{className:"settings-edit",children:[(0,ee.Y)(Q.A,{id:"group-title",label:ne("GroupName"),onChange:pe,value:O,error:$===Pg?$:void 0,disabled:!d}),(0,ee.Y)(Ll.A,{id:"group-about",label:ne("DescriptionPlaceholder"),maxLength:255,maxLengthIndicator:(255-J.length).toString(),onChange:ve,value:J,disabled:!d,noReplaceNewlines:!0})]}),t.isCreator&&(0,ee.FD)(ci.A,{icon:"lock",multiline:!0,onClick:oe,children:[(0,ee.Y)("span",{className:"title",children:ne("GroupType")}),(0,ee.Y)("span",{className:"subtitle",children:ne(se?"TypePublic":"TypePrivate")})]}),c&&(0,ee.FD)(ci.A,{icon:"message",multiline:!0,onClick:re,children:[(0,ee.Y)("span",{className:"title",children:ne("LinkedChannel")}),(0,ee.Y)("span",{className:"subtitle",children:ne("DiscussionUnlink")})]}),(0,ee.FD)(ci.A,{icon:"permissions",multiline:!0,onClick:ce,disabled:!h,children:[(0,ee.Y)("span",{className:"title",children:ne("ChannelPermissions")}),(0,ee.FD)("span",{className:"subtitle",dir:"auto",children:[Se,"/",Fg-(Z?0:1)]})]}),(0,ee.FD)(ci.A,{icon:"heart-outline",multiline:!0,onClick:le,disabled:!d,children:[(0,ee.Y)("span",{className:"title",children:ne("Reactions")}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:ye})]}),(0,ee.FD)(ci.A,{icon:"admin",multiline:!0,onClick:de,children:[(0,ee.Y)("span",{className:"title",children:ne("ChannelAdministrators")}),(0,ee.Y)("span",{className:"subtitle",children:(0,He.Sm)(we)})]}),m&&(0,ee.FD)(ci.A,{icon:"link",onClick:he,multiline:!0,disabled:!v,children:[(0,ee.Y)("span",{className:"title",children:ne("GroupInfo.InviteLinks")}),(0,ee.Y)("span",{className:"subtitle",children:v?(0,He.Sm)(v.length):ne("Loading")})]}),Boolean(t.joinRequests?.length)&&(0,ee.FD)(ci.A,{icon:"add-user-filled",onClick:me,multiline:!0,children:[(0,ee.Y)("span",{className:"title",children:ne("MemberRequests")}),(0,ee.Y)("span",{className:"subtitle",children:(0,He.Sm)(t.joinRequests.length)})]}),u&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)(ci.A,{icon:"forums",ripple:!0,onClick:Ce,children:[(0,ee.Y)("span",{children:ne("ChannelTopics")}),(0,ee.Y)(bi.A,{id:"group-notifications",label:ne("ChannelTopics"),checked:Z,inactive:!0})]}),(0,ee.Y)("div",{className:"section-info section-info_push",children:ne("ForumToggleDescription")})]})]}),(0,ee.FD)("div",{className:"section",children:[(0,ee.FD)(ci.A,{icon:"group",multiline:!0,onClick:Ae,children:[(0,ee.Y)("span",{className:"title",children:ne("GroupMembers")}),(0,ee.Y)("span",{className:"subtitle",children:(0,He.Sm)(t.membersCount??0)})]}),!se&&!c&&Boolean(i)&&(0,ee.Y)("div",{className:"ListItem narrow",ref:ae,children:(0,ee.Y)(un.A,{checked:!i.isPreHistoryHidden,label:ne("ChatHistory"),onChange:be,subLabel:i.isPreHistoryHidden?ne("ChatHistoryHiddenInfo2"):ne("ChatHistoryVisibleInfo"),disabled:!h})})]}),(0,ee.Y)("div",{className:"section",children:(0,ee.Y)(ci.A,{icon:"delete",ripple:!0,destructive:!0,onClick:R,children:ne("DeleteMega")})})]}),(0,ee.Y)(ki.A,{isShown:V,onClick:ge,disabled:Ne,ariaLabel:ne("Save"),children:Ne?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),(0,ee.Y)(vi.A,{isOpen:B,onClose:L,textParts:(0,Ft.A)(r||!t.isCreator?ne("AreYouSureDeleteAndExit"):ne("AreYouSureDeleteThisChatWithGroup",t.title),["br","simple_markdown"]),confirmLabel:r||!t.isCreator?ne("DeleteMega"):ne("DeleteGroupForAll"),confirmHandler:ke,confirmIsDestructive:!0})]})}))),Tg=(0,s.ph)((0,n.EK)(((e,{chatId:t,isPromotedByCurrentUser:i})=>{const s=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t),{byId:a}=e.users,{currentUserId:o}=e,r=(0,l.WX)(s),d=!(s.isCreator||i);return{chat:s,usersById:a,currentUserId:o,isChannel:r,isForum:s.isForum,isFormFullyDisabled:d,defaultRights:s.adminRights,hasFullInfo:Boolean(n),adminMembersById:n?.adminMembersById}}),((e,{chatId:t})=>Boolean((0,c.hds)(e,t))))((({isActive:e,isNewAdmin:t,selectedUserId:i,defaultRights:o,chat:r,usersById:c,currentUserId:d,adminMembersById:h,hasFullInfo:m,isChannel:u,isForum:p,isFormFullyDisabled:v,onClose:g,onScreenSelect:A})=>{const{updateChatAdmin:b}=(0,n.ko)(),[f,C]=(0,s.J0)({}),[y,S]=(0,s.J0)(Boolean(t)),[w,k]=(0,s.J0)(!1),[N,I,P]=(0,Y.A)(),[F,D]=(0,s.J0)(""),T=(0,M.A)();(0,fe.A)({isActive:e,onBack:g});const B=(0,s.Kr)((()=>{const e=i?h?.[i]:void 0;if(!t||!e&&i){if(t){const e=(0,n.mS)().users.byId[i];return e?{userId:e.id,adminRights:o,customTitle:T("ChannelAdmin"),isOwner:!1,promotedByUserId:void 0}:void 0}return e}}),[h,o,t,T,i]);(0,s.vJ)((()=>{m&&i&&!B&&A(a.je.ChatAdministrators)}),[r,m,A,B,i]),(0,s.vJ)((()=>{C(B?.adminRights||{}),D((B?.customTitle||"").substr(0,16)),S(Boolean(t)),k(!1)}),[o,t,B]);const R=(0,s.hb)((e=>{const{name:t}=e.target;C((e=>{return{...e,[t]:(i=e[t],!i||void 0)};var i})),S(!0)}),[]),L=(0,s.hb)((()=>{i&&(k(!0),b({chatId:r.id,userId:i,adminRights:f,customTitle:F}))}),[i,b,r.id,f,F]),x=(0,s.hb)((()=>{i&&(b({chatId:r.id,userId:i,adminRights:{}}),P())}),[r.id,P,i,b]),E=(0,s.hb)((e=>!((0,l.yn)(r)||!v&&r.adminRights&&(r.isCreator||r.adminRights[e]))),[r,v]),V=(0,s.Kr)((()=>{if(t||!B)return;if(B.isOwner)return T("ChannelCreator");const e=B.promotedByUserId?c[B.promotedByUserId]:void 0;return e?T("EditAdminPromotedBy",(0,l.Yg)(e)):T("ChannelAdmin")}),[t,B,c,T]),_=(0,s.hb)((e=>{const{value:t}=e.target;D(t),S(!0)}),[]);if(B)return(0,ee.FD)("div",{className:"Management",children:[(0,ee.Y)("div",{className:"panel-content custom-scroll",children:(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(ci.A,{inactive:!0,className:"chat-item-clickable",children:(0,ee.Y)(Rs.A,{userId:B.userId,status:V,forceShowSelf:!0})}),(0,ee.Y)("h3",{className:"section-heading mt-4",dir:"auto",children:T("EditAdminWhatCanDo")}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"changeInfo",checked:Boolean(f.changeInfo),label:T(u?"EditAdminChangeChannelInfo":"EditAdminChangeGroupInfo"),blocking:!0,disabled:E("changeInfo"),onChange:R})}),u&&(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"postMessages",checked:Boolean(f.postMessages),label:T("EditAdminPostMessages"),blocking:!0,disabled:E("postMessages"),onChange:R})}),u&&(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"editMessages",checked:Boolean(f.editMessages),label:T("EditAdminEditMessages"),blocking:!0,disabled:E("editMessages"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"deleteMessages",checked:Boolean(f.deleteMessages),label:T(u?"EditAdminDeleteMessages":"EditAdminGroupDeleteMessages"),blocking:!0,disabled:E("deleteMessages"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"postStories",checked:Boolean(f.postStories),label:T("EditAdminPostStories"),blocking:!0,disabled:E("postStories"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"editStories",checked:Boolean(f.editStories),label:T("EditAdminEditStories"),blocking:!0,disabled:E("editStories"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"deleteStories",checked:Boolean(f.deleteStories),label:T("EditAdminDeleteStories"),blocking:!0,disabled:E("deleteStories"),onChange:R})}),!u&&(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"banUsers",checked:Boolean(f.banUsers),label:T("EditAdminBanUsers"),blocking:!0,disabled:E("banUsers"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"inviteUsers",checked:Boolean(f.inviteUsers),label:T("EditAdminAddUsers"),blocking:!0,disabled:E("inviteUsers"),onChange:R})}),!u&&(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"pinMessages",checked:Boolean(f.pinMessages),label:T("EditAdminPinMessages"),blocking:!0,disabled:E("pinMessages"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"addAdmins",checked:Boolean(f.addAdmins),label:T("EditAdminAddAdmins"),blocking:!0,disabled:E("addAdmins"),onChange:R})}),(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"manageCall",checked:Boolean(f.manageCall),label:T("StartVoipChatPermission"),blocking:!0,disabled:E("manageCall"),onChange:R})}),p&&(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"manageTopics",checked:Boolean(f.manageTopics),label:T("ManageTopicsPermission"),blocking:!0,disabled:E("manageTopics"),onChange:R})}),!u&&(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:"anonymous",checked:Boolean(f.anonymous),label:T("EditAdminSendAnonymously"),blocking:!0,disabled:E("anonymous"),onChange:R})}),v&&(0,ee.Y)("p",{className:"section-info mb-4",dir:"auto",children:T("Channel.EditAdmin.CannotEdit")}),!u&&(0,ee.Y)(Q.A,{id:"admin-title",label:T("EditAdminRank"),onChange:_,value:F,disabled:v,maxLength:16}),d!==i&&!v&&!t&&(0,ee.Y)(ci.A,{icon:"delete",ripple:!0,destructive:!0,onClick:I,children:T("EditAdminRemoveAdmin")})]})}),(0,ee.Y)(ki.A,{isShown:y,onClick:L,ariaLabel:T("Save"),disabled:w,children:w?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),!t&&(0,ee.Y)(vi.A,{isOpen:N,onClose:P,text:"Are you sure you want to dismiss this admin?",confirmLabel:T("Channel.Admin.Dismiss"),confirmHandler:x,confirmIsDestructive:!0})]})})));var Bg=i(23459),Rg=i(285);const Lg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{statusesById:s}=e.users,{members:n,adminMembersById:a,areParticipantsHidden:o}=(0,c.AWZ)(e,t)||{},r=i&&(0,l.WX)(i),{userIds:d}=e.contactList||{},h=e.appConfig?.hiddenMembersMinCount,m=i&&(i.isCreator||(0,l.ub)(i,"banUsers")),u=m&&!(0,l.yn)(i)&&void 0!==i.membersCount&&void 0!==h&&i.membersCount>=h,p=i&&((0,l.ub)(i,"inviteUsers")||!r&&!(0,l.Sq)(i,"inviteUsers")||i.isCreator),{query:v,fetchingStatus:g,globalUserIds:A,localUserIds:b}=(0,c.nTw)(e).userSearch;return{areParticipantsHidden:Boolean(i&&o),members:n,canAddMembers:p,adminMembersById:a,userStatusesById:s,isChannel:r,localContactIds:d,searchQuery:v,isSearching:g,globalUserIds:A,localUserIds:b,canDeleteMembers:m,currentUserId:e.currentUserId,canHideParticipants:u}}))((({chatId:e,noAdmins:t,members:i,canAddMembers:o,adminMembersById:r,userStatusesById:c,isChannel:d,isActive:h,globalUserIds:m,localContactIds:u,localUserIds:p,isSearching:v,searchQuery:g,currentUserId:A,canDeleteMembers:b,areParticipantsHidden:f,canHideParticipants:C,onClose:y,onScreenSelect:S,onChatMemberSelect:w})=>{const{openChat:k,setUserSearchQuery:N,closeManagement:I,toggleParticipantsHidden:P,setNewChatMembersDialogState:Y,toggleManagement:F}=(0,n.ko)(),T=(0,M.A)(),B=(0,s.li)(),R=(0,s.li)(),[L,x]=(0,s.J0)(),E=(0,s.Kr)((()=>t&&r?Object.keys(r):[]),[r,t]),V=(0,s.Kr)((()=>{const e=(0,n.mS)().users.byId;if(!i||!e)return[];const s=(0,l.UB)(i.map((({userId:e})=>e)),e,c);return t?s.filter((e=>!E.includes(e))):s}),[i,c,t,E]);(0,Bg.A)(V);const _=(0,s.Kr)((()=>{const e=(0,n.mS)().users.byId,i=Boolean(g),s=i?u?(0,Yt.PU)({ids:u,query:g,type:"user"}):[]:V;return(0,Os.A)((0,fi.Am)([...s,...i&&p||[],...i&&m||[]]).filter((i=>{const s=e[i];return!s||(d||s.canBeInvitedToGroup||!(0,l.tv)(s))&&(!t||!E.includes(i))})),!0)}),[V,u,g,p,m,d,t,E]),[U,O]=(0,Js.A)(void 0,_,Boolean(g)),K=(0,D.A)((e=>{t?(w(e,!0),S(a.je.ChatNewAdminRights)):(I(),k({id:e}))})),J=(0,D.A)((e=>{N({query:e.target.value})})),G=(0,js.A)(R,h,(e=>{U&&U.length>0&&K(U[-1===e?0:e])}),".ListItem-button",!0),j=(0,D.A)((()=>{x(void 0)})),z=(0,D.A)((()=>{P({chatId:e,isEnabled:!f})})),H=(0,D.A)((()=>{F(),Y({newChatMembersProgress:a.D7.InProgress})}));return(0,fe.A)({isActive:h,onBack:y}),(0,ee.FD)("div",{className:"Management",children:[t&&(0,ee.Y)("div",{className:"Management__filter",dir:T.isRtl?"rtl":void 0,children:(0,ee.Y)(Q.A,{ref:B,value:g,onChange:J,placeholder:T("Search")})}),(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[C&&!d&&(0,ee.FD)("div",{className:"section",children:[(0,ee.FD)(ci.A,{icon:"group",ripple:!0,onClick:z,children:[(0,ee.Y)("span",{children:T("ChannelHideMembers")}),(0,ee.Y)(bi.A,{label:T("ChannelHideMembers"),checked:f})]}),(0,ee.Y)("p",{className:"section-info",children:T(f?"GroupMembers.MembersHiddenOn":"GroupMembers.MembersHiddenOff")})]}),(0,ee.Y)("div",{className:"section",children:U?.length?(0,ee.Y)(Ds.A,{className:"picker-list custom-scroll",items:_,onLoadMore:O,noScrollRestore:Boolean(g),ref:R,onKeyDown:G,children:U.map((e=>{return(0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item",onClick:()=>K(e),contextActions:(t=e,t!==A&&b?[{title:T("lng_context_remove_from_group"),icon:"stop",handler:()=>{x(t)}}]:void 0),withPortalForMenu:!0,children:(0,ee.Y)(Rs.A,{userId:e,forceShowSelf:!0,withStory:!0})},e);var t}))}):v||!U||U.length?(0,ee.Y)(zs.A,{}):(0,ee.Y)(Sc.A,{teactOrderKey:0,text:d?"No subscribers found":"No members found"},"nothing-found")})]}),o&&(0,ee.Y)(ki.A,{isShown:!0,onClick:H,ariaLabel:T("lng_channel_add_users"),children:(0,ee.Y)(q.A,{name:"add-user-filled"})}),b&&(0,ee.Y)(Rg.A,{isOpen:Boolean(L),userId:L,onClose:j})]})}))),xg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),s=(0,c.AWZ)(e,t),{progress:n}=(0,c.nTw)(e).management,a=i?.paidMessagesStars,r=e.appConfig?.starsPaidMessageCommissionPermille;return{chat:i,progress:n,currentUserId:e.currentUserId,removedUsersCount:s?.kickedMembers?.length||0,members:s?.members,arePaidMessagesAvailable:Boolean(s?.arePaidMessagesAvailable&&r),canChargeForMessages:Boolean(a&&r),groupPeersPaidStars:a||o.wZe}}))((({onScreenSelect:e,onChatMemberSelect:t,chat:i,progress:o,currentUserId:r,removedUsersCount:l,members:c,onClose:d,isActive:h,arePaidMessagesAvailable:m,canChargeForMessages:u,groupPeersPaidStars:p})=>{const{updateChatDefaultBannedRights:v,updatePaidMessagesPrice:g}=(0,n.ko)(),{permissions:A,havePermissionChanged:b,isLoading:f,handlePermissionChange:C,setIsLoading:y}=zl(i?.defaultBannedRights),S=(0,M.A)(),w=(0,_i.A)();(0,fe.A)({isActive:h,onBack:d});const k=(0,s.hb)((()=>{e(a.je.GroupRemovedUsers)}),[e]),N=(0,s.hb)((()=>{e(a.je.GroupUserPermissionsCreate)}),[e]),I=(0,s.hb)((i=>{t(i.userId,i.promotedByUserId===r),e(a.je.GroupUserPermissions)}),[r,t,e]),[P,F]=(0,s.J0)(!1),[T,B,R]=(0,Y.A)(),[L,x]=(0,s.J0)(u),[E,V]=(0,s.J0)(p);(0,s.vJ)((()=>{o===a.TD.Complete&&R()}),[o]);const _=(0,D.A)((()=>{i&&(y(!0),v({chatId:i.id,bannedRights:A}))})),U=(0,D.A)((()=>{i&&g({chatId:i?.id,paidMessagesStars:L?E:0})})),O=(0,D.A)((()=>{T&&U(),b&&_()})),K=(0,s.Kr)((()=>c?c.filter((({bannedRights:e})=>Boolean(e))):[]),[c]),J=(0,s.hb)((e=>{const{bannedRights:t}=e;if(!t||!i)return;const{defaultBannedRights:s}=i;return Object.keys(t).reduce(((e,i)=>{const n=i;if(!t[n]||s?.[n]||"sendInline"===n||"viewMessages"===n||"sendGames"===n)return e;const a=function(e){switch(e){case"sendMessages":return"UserRestrictionsNoSend";case"sendMedia":return"UserRestrictionsNoSendMedia";case"sendStickers":return"UserRestrictionsNoSendStickers";case"embedLinks":return"UserRestrictionsNoEmbedLinks";case"sendPolls":return"UserRestrictionsNoSendPolls";case"changeInfo":return"UserRestrictionsNoChangeInfo";case"inviteUsers":return"UserRestrictionsInviteUsers";case"pinMessages":return"UserRestrictionsPinMessages";case"manageTopics":return"GroupPermission.NoManageTopics";case"sendPlain":return"UserRestrictionsNoSendText";case"sendDocs":return"UserRestrictionsNoSendDocs";case"sendRoundvideos":return"UserRestrictionsNoSendRound";case"sendVoices":return"UserRestrictionsNoSendVoice";case"sendAudios":return"UserRestrictionsNoSendMusic";case"sendVideos":return"UserRestrictionsNoSendVideos";case"sendPhotos":return"UserRestrictionsNoSendPhotos";default:return}}(n);if(!a)return e;const o=S(a);return`${e}${e.length?`, ${o}`:o}`}),"")}),[i,S]),G=(0,D.A)((()=>{x(!L),B()})),j=(0,D.A)((e=>{V(e),B()})),z=T||b,H=o===a.TD.InProgress||f;return(0,ee.FD)("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 432px;--before-shift-height: 96px;",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.FD)("div",{className:"section without-bottom-shadow",children:[(0,ee.Y)("h3",{className:"section-heading",dir:"auto",children:w("ChannelPermissionsHeader")}),(0,ee.Y)($l,{chatId:i?.id,isMediaDropdownOpen:P,setIsMediaDropdownOpen:F,handlePermissionChange:C,permissions:A,dropdownClassName:"DropdownListTrap",className:(0,me.A)("DropdownList",P&&"DropdownList--open"),shiftedClassName:(0,me.A)("part",P&&"shifted")})]}),m&&(0,ee.FD)("div",{className:(0,me.A)("section",P&&"shifted"),children:[(0,ee.FD)(ci.A,{onClick:G,children:[(0,ee.Y)("span",{children:w("GroupMessagesChargePrice")}),(0,ee.Y)(bi.A,{id:"charge_for_messages",label:w("GroupMessagesChargePrice"),checked:L})]}),(0,ee.Y)("p",{className:"settings-item-description-larger",dir:w.isRtl?"rtl":void 0,children:w("RightsChargeStarsAbout")})]}),L&&(0,ee.Y)("div",{className:(0,me.A)("section",P&&"shifted"),children:(0,ee.Y)(Ed,{canChangeChargeForMessages:!0,isGroupChat:!0,chargeForMessages:E,onChange:j})}),(0,ee.Y)("div",{className:(0,me.A)("section",P&&"shifted"),children:(0,ee.FD)(ci.A,{icon:"delete-user",multiline:!0,narrow:!0,onClick:k,children:[(0,ee.Y)("span",{className:"title",children:w("ChannelBlockedUsers")}),(0,ee.Y)("span",{className:"subtitle",children:l})]})}),(0,ee.FD)("div",{className:(0,me.A)("section",P&&"shifted"),children:[(0,ee.Y)("h3",{className:"section-heading",dir:"auto",children:w("PrivacyExceptions")}),(0,ee.Y)(ci.A,{icon:"add-user",onClick:N,children:w("ChannelAddException")}),K.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable exceptions-member",onClick:()=>I(e),children:(0,ee.Y)(Rs.A,{userId:e.userId,status:J(e),forceShowSelf:!0})},e.userId)))]})]}),(0,ee.Y)(ki.A,{isShown:z,onClick:O,ariaLabel:w("Save"),disabled:H,children:H?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})}))),Eg=(0,s.ph)((0,n.EK)(((e,{chatId:t,isPromotedByCurrentUser:i})=>{const s=(0,c.hds)(e,t),n=(0,c.AWZ)(e,t);return{chat:s,isFormFullyDisabled:!(s.isCreator||i),hasFullInfo:Boolean(n),members:n?.members}}),((e,{chatId:t})=>Boolean((0,c.hds)(e,t))))((({chat:e,selectedChatMemberId:t,hasFullInfo:i,members:o,onScreenSelect:r,isFormFullyDisabled:l,onClose:c,isActive:d})=>{const{updateChatMemberBannedRights:h}=(0,n.ko)(),m=(0,s.Kr)((()=>{if(o)return o.find((({userId:e})=>e===t))}),[o,t]),{permissions:u,havePermissionChanged:p,isLoading:v,handlePermissionChange:g,setIsLoading:A}=zl(m?.bannedRights||e?.defaultBannedRights),[b,f,C]=(0,Y.A)(),y=(0,_i.A)(),S=(0,M.A)();(0,fe.A)({isActive:d,onBack:c}),(0,s.vJ)((()=>{i&&t&&!m&&r(a.je.GroupPermissions)}),[e,i,r,m,t]);const w=(0,s.hb)((()=>{e&&t&&(A(!0),h({chatId:e.id,userId:t,bannedRights:u}))}),[e,t,A,h,u]),k=(0,s.hb)((()=>{e&&t&&h({chatId:e.id,userId:t,bannedRights:{viewMessages:!0}})}),[e,t,h]),N=(0,s.hb)((t=>!!l||!(!e||!e.defaultBannedRights)&&e.defaultBannedRights[t]),[e,l]),[I,P]=(0,s.J0)(!1);if(m)return(0,ee.FD)("div",{className:"Management with-shifted-dropdown",style:"--shift-height: 431px;--before-shift-height: 192px;",children:[(0,ee.FD)("div",{className:"custom-scroll",children:[(0,ee.FD)("div",{className:"section without-bottom-shadow",children:[(0,ee.Y)(ci.A,{inactive:!0,className:"chat-item-clickable",children:(0,ee.Y)(Rs.A,{userId:m.userId,forceShowSelf:!0})}),(0,ee.Y)("h3",{className:"section-heading mt-4",dir:"auto",children:S("UserRestrictionsCanDo")}),(0,ee.Y)($l,{chatId:e?.id,isMediaDropdownOpen:I,setIsMediaDropdownOpen:P,handlePermissionChange:g,permissions:u,className:(0,me.A)("DropdownList",I&&"DropdownList--open"),dropdownClassName:"DropdownListTrap",shiftedClassName:(0,me.A)("part",I&&"shifted"),getControlIsDisabled:N})]}),!l&&(0,ee.Y)("div",{className:(0,me.A)("section",I&&"shifted"),children:(0,ee.Y)(ci.A,{icon:"delete-user",ripple:!0,destructive:!0,onClick:f,children:S("UserRestrictionsBlock")})})]}),(0,ee.Y)(ki.A,{isShown:p,onClick:w,ariaLabel:S("Save"),disabled:v,children:v?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),(0,ee.Y)(vi.A,{isOpen:b,onClose:C,text:y("GroupManagementBanUserConfirm"),confirmLabel:"Remove",confirmHandler:k,confirmIsDestructive:!0})]})}))),Vg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{byId:s,statusesById:n}=e.users,a=(0,c.AWZ)(e,t)?.members;return{members:a,usersById:s,userStatusesById:n,isChannel:i&&(0,l.WX)(i)}}))((({usersById:e,userStatusesById:t,members:i,isChannel:n,onScreenSelect:o,onChatMemberSelect:r,onClose:c,isActive:d})=>{(0,fe.A)({isActive:d,onBack:c});const h=(0,s.Kr)((()=>{if(i&&e)return(0,l.UB)(i.filter((e=>!e.isOwner)).map((({userId:e})=>e)),e,t)}),[i,e,t]),m=(0,s.hb)((e=>{r(e),o(a.je.GroupUserPermissions)}),[r,o]);return(0,ee.Y)("div",{className:"Management",children:(0,ee.Y)("div",{className:"custom-scroll",children:(0,ee.Y)("div",{className:"section",teactFastList:!0,children:h?h.map(((e,t)=>(0,ee.Y)(ci.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item",onClick:()=>m(e),children:(0,ee.Y)(Rs.A,{userId:e,forceShowSelf:!0})},e))):(0,ee.Y)(Sc.A,{teactOrderKey:0,text:n?"No subscribers found":"No members found"},"nothing-found")})})})}))),_g=[1,10,100],Ug={hour:36e5,day:864e5,week:6048e5},Og=Ug.hour,Kg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{editingInvite:i}=(0,c.nTw)(e).management.byChatId[t]||{};return{editingInvite:i}}))((({chatId:e,editingInvite:t,isActive:i,onClose:o,onScreenSelect:r})=>{const{editExportedChatInvite:l,exportChatInvite:c}=(0,n.ko)(),d=(0,M.A)(),[h,m,u]=(0,Y.A)(),[p,v]=(0,s.J0)(!1),[g,A]=(0,s.J0)(""),[b,f]=(0,s.J0)(Date.now()+Og),[C,y]=(0,s.J0)("unlimited"),[S,w]=(0,s.J0)(10),[k,N]=(0,s.J0)("0"),[I,P]=(0,s.J0)(!1);(0,fe.A)({isActive:i,onBack:o}),(0,G.A)((([e])=>{if(e!==t)if(t){const{title:e,usageLimit:i,expireDate:s,isRequestNeeded:n}=t;if(e&&A(e),i&&(N(_g.includes(i)?i.toString():"custom"),w(i)),s){const e=(0,li.Fm)()+Og;y("custom"),f(1e3*Math.max(s,e))}n&&v(!0)}else A(""),y("unlimited"),N("0"),f(1e3*(0,li.Fm)()+Og),w(10),v(!1)}),[t]);const F=(0,s.hb)((e=>{v(e.target.checked)}),[]),D=(0,s.hb)((e=>{A(e.target.value)}),[]),T=(0,s.hb)((e=>{w(Number.parseInt(e.target.value,10))}),[]),B=(0,s.hb)((e=>{f(e.getTime()),u()}),[u]),R=(0,s.hb)((()=>{P(!0);const i="custom"===k?S:Number(k);let s;switch(C){case"custom":s=(0,li.Fm)()+(b-Date.now())/1e3;break;case"hour":case"day":case"week":s=(0,li.Fm)()+Ug[C]/1e3;break;case"unlimited":s=0;break;default:s=void 0}t?l({link:t.link,chatId:e,title:g,isRequestNeeded:p,expireDate:s,usageLimit:i}):c({chatId:e,title:g,isRequestNeeded:p,expireDate:s,usageLimit:i}),r(a.je.Invites)}),[e,b,S,l,t,c,p,C,k,g,r]);return(0,ee.FD)("div",{className:"Management ManageInvite",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.Y)("div",{className:"section",children:(0,ee.Y)(un.A,{label:d("ApproveNewMembers"),subLabel:d("ApproveNewMembersDescription"),checked:p,onChange:F})}),(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(Q.A,{className:"link-name",placeholder:d("LinkNameHint"),value:g,onChange:D}),(0,ee.Y)("p",{className:"section-help hint",children:d("LinkNameHelp")})]}),(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("div",{className:"section-heading",children:d("LimitByPeriod")}),(0,ee.Y)(X.A,{name:"expireOptions",options:[{value:"hour",label:d("Hours",1)},{value:"day",label:d("Days",1)},{value:"week",label:d("Weeks",1)},{value:"unlimited",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_expire_custom")}],onChange:y,selected:C}),"custom"===C&&(0,ee.FD)(W.A,{className:"expire-limit",isText:!0,onClick:m,children:[(0,ze.Lu)(d,b)," ",(0,ze.fU)(d,b)]}),(0,ee.Y)("p",{className:"section-help hint",children:d("TimeLimitHelp")})]}),!p&&(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("div",{className:"section-heading",children:d("LimitNumberOfUses")}),(0,ee.Y)(X.A,{name:"usageOptions",options:[..._g.map((e=>({value:e.toString(),label:e}))),{value:"0",label:d("NoLimit")},{value:"custom",label:d("lng_group_invite_usage_custom")}],onChange:N,selected:k}),"custom"===k&&(0,ee.Y)("input",{className:"form-control usage-limit",type:"number",min:"1",max:"99999",value:S,onChange:T}),(0,ee.Y)("p",{className:"section-help hint",children:d("UsesLimitHelp")})]}),(0,ee.Y)(ki.A,{isShown:!0,onClick:R,disabled:I,ariaLabel:d(t?"SaveLink":"CreateLink"),children:(0,ee.Y)(q.A,{name:"check"})})]}),(0,ee.Y)(Cn,{isOpen:h,isFutureMode:!0,withTimePicker:!0,onClose:u,onSubmit:B,selectedAt:b,submitButtonLabel:d("Save")})]})}))),Jg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{inviteInfo:i}=(0,c.nTw)(e).management.byChatId[t]||{},{invite:s,importers:n,requesters:a}=i||{},o=(0,c.hds)(e,t);return{invite:s,importers:n,requesters:a,isChannel:o&&(0,l.WX)(o)}}))((({chatId:e,invite:t,importers:i,requesters:a,isChannel:o,isActive:r,onClose:l})=>{const{loadChatInviteImporters:c,loadChatInviteRequesters:d,openChat:h}=(0,n.ko)(),m=(0,M.A)(),{usage:u=0,usageLimit:p,link:v,adminId:g}=t||{},A=t?.expireDate&&1e3*(t.expireDate-(0,li.Fm)())+Date.now(),b=(t?.expireDate||0)-(0,li.Fm)()<0;return(0,s.vJ)((()=>{v&&(c({chatId:e,link:v}),d({chatId:e,link:v}))}),[e,v,c,d]),(0,fe.A)({isActive:r,onBack:l}),(0,ee.Y)("div",{className:"Management ManageInviteInfo",children:(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[!t&&(0,ee.Y)("p",{className:"section-help",children:m("Loading")}),t&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(sl.A,{title:t.title,link:t.link,className:"invite-link"}),Boolean(A)&&(0,ee.Y)("p",{className:"section-help",children:b?m("ExpiredLink"):m("LinkExpiresIn",`${(0,ze.Lu)(m,A)} ${(0,ze.fU)(m,A)}`)})]}),g&&(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("p",{className:"section-heading",children:m("LinkCreatedeBy")}),(0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:g}),children:(0,ee.Y)(Rs.A,{userId:g,status:(0,ze.fS)(m,1e3*t.date,!0),forceShowSelf:!0})})]}),(()=>{if(i?.length||!a?.length)return i?(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("p",{className:"section-heading",children:i.length?m("PeopleJoined",u):m("NoOneJoined")}),(0,ee.FD)("p",{className:"section-help",children:[!i.length&&(p?m("PeopleCanJoinViaLinkCount",p-u):m("NoOneJoinedYet")),i.map((e=>{const t=(0,ze.fS)(m,1e3*e.date,!0),i=e.isFromChatList?`${t} â€¢ ${m("JoinedViaFolder")}`:t;return(0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:e.userId}),children:(0,ee.Y)(Rs.A,{userId:e.userId,status:i,forceShowSelf:!0})})}))]})]}):(0,ee.Y)(xe.A,{})})(),(()=>{if(!t?.isRevoked){if(!a&&i)return(0,ee.Y)(xe.A,{});if(a?.length)return(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("p",{className:"section-heading",children:m(o?"SubscribeRequests":"MemberRequests")}),(0,ee.Y)("p",{className:"section-help",children:a.map((e=>(0,ee.Y)(ci.A,{className:"chat-item-clickable scroll-item small-icon",onClick:()=>h({id:e.userId}),children:(0,ee.Y)(Rs.A,{userId:e.userId,status:(0,ze.fS)(m,1e3*e.date,!0),forceShowSelf:!0})})))})]})}})()]})]})})}))),Gg="â€¢";function jg(e,t){const{isPermanent:i,usage:s=0,date:n}=e,{isPermanent:a,usage:o=0,date:r}=t;return i||a?Number(i)-Number(a):s||o?o-s:r-n}const zg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{invites:i,revokedInvites:s}=(0,c.nTw)(e).management.byChatId[t]||{},n=(0,c.hds)(e,t);return{exportedInvites:i,revokedExportedInvites:s,chat:n,isChannel:n&&(0,l.WX)(n)}}))((({chatId:e,chat:t,exportedInvites:i,revokedExportedInvites:r,isActive:c,isChannel:d,onClose:h,onScreenSelect:m})=>{const{setEditingExportedInvite:u,showNotification:p,editExportedChatInvite:v,deleteExportedChatInvite:g,deleteRevokedExportedChatInvites:A,setOpenedInviteInfo:b}=(0,n.ko)(),f=(0,_i.A)(),C=(0,M.A)(),[y,S,w]=(0,Y.A)(),[k,N,I]=(0,Y.A)(),[P,D]=(0,s.J0)(),[T,B,R]=(0,Y.A)(),[L,x]=(0,s.J0)();(0,fe.A)({isActive:c,onBack:h});const E=(0,s.Kr)((()=>{if(i)return i.some((({expireDate:e})=>e&&e-(0,li.Fm)()<ze.il/1e3))}),[i]),V=(0,F.A)();(0,Yn.A)(V,E?1e3:void 0);const _=(0,s.Kr)((()=>t&&(0,l.Kl)(t)),[t]),U=i?.find((({isPermanent:e})=>e)),O=_?`${o.jsp}${_}`:U?.link,K=(0,s.Kr)((()=>{const e=t?.hasUsername?i:i?.filter((({isPermanent:e})=>!e));return e?.sort(jg)}),[t?.hasUsername,i]),J=(0,s.hb)((t=>{const{link:i,title:s,isRequestNeeded:n,expireDate:a,usageLimit:o}=t;v({chatId:e,link:i,title:s,isRequestNeeded:n,expireDate:a,usageLimit:o,isRevoked:!0})}),[e,v]),G=(0,s.hb)((e=>{D(e),N()}),[N]),j=(0,s.hb)((()=>{P&&(J(P),D(void 0),I())}),[I,J,P]),z=(0,s.hb)((()=>{m(a.je.EditInvite)}),[m]),H=(0,s.hb)((()=>{U&&G(U)}),[G,U]),$=(0,s.hb)((()=>{A({chatId:e}),w()}),[e,w,A]),W=(0,s.hb)((t=>{b({chatId:e,invite:t}),m(a.je.InviteInfo)}),[e,m,b]),Q=(0,s.hb)((t=>{g({chatId:e,link:t.link})}),[e,g]),Z=(0,s.hb)((e=>{x(e),B()}),[B]),X=(0,s.hb)((()=>{L&&(Q(L),x(void 0),R())}),[R,Q,L]),te=(0,s.hb)((e=>{(0,uc.eM)(e),p({message:C("LinkCopied")})}),[C,p]),ie=e=>{const{usage:t=0,usageLimit:i,expireDate:s,isPermanent:n,requested:a,isRevoked:o}=e;let r="";if(r=!o&&i&&t<i?C("CanJoin",i-t):t?C("PeopleJoined",t):C("NoOneJoined"),o)return r+=` ${Gg} ${C("Revoked")}`,r;if(a&&(r+=` ${Gg} ${C("JoinRequests",a)}`),void 0!==i&&t===i)r+=` ${Gg} ${C("LinkLimitReached")}`;else if(s){const e=s-(0,li.Fm)();r+=` ${Gg} `,r+=e>0?C("InviteLink.ExpiresIn",(0,ze.zt)(f,e)):C("InviteLink.Expired")}else n&&(r+=` ${Gg} ${C("Permanent")}`);return r},se=e=>{const{usage:t=0,usageLimit:i,isRevoked:s,expireDate:n}=e;return s?"link-status-icon-gray":i&&t<i?"link-status-icon-green":n&&1e3*(n-(0,li.Fm)())<=0?"link-status-icon-red":"link-status-icon-blue"},ne=t=>{const i=[];return i.push({title:C("Copy"),icon:"copy",handler:()=>te(t.link)}),t.isPermanent||t.isRevoked||i.push({title:C("Edit"),icon:"edit",handler:()=>(t=>{u({chatId:e,invite:t}),m(a.je.EditInvite)})(t)}),t.isRevoked?i.push({title:C("DeleteLink"),icon:"delete",handler:()=>Z(t),destructive:!0}):i.push({title:C("RevokeButton"),icon:"delete",handler:()=>G(t),destructive:!0}),i};return(0,ee.FD)("div",{className:"Management ManageInvites",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.Invite,size:o.xMZ,className:"section-icon"}),(0,ee.Y)("p",{className:"section-help",children:C(d?"PrimaryLinkHelpChannel":"PrimaryLinkHelp")})]}),O&&(0,ee.Y)("div",{className:"section",children:(0,ee.Y)(sl.A,{className:"settings-input",link:O,withShare:!0,onRevoke:t?.usernames?void 0:H,title:C(t?.usernames?"PublicLink":"lng_create_permanent_link_title")})}),(0,ee.FD)("div",{className:"section",teactFastList:!0,children:[(0,ee.Y)(ci.A,{icon:"add",withPrimaryColor:!0,className:"create-item",onClick:z,children:C("CreateNewLink")},"create"),(!K||!K.length)&&(0,ee.Y)(Sc.A,{text:"No links found"},"nothing"),K?.map((e=>(0,ee.FD)(ci.A,{leftElement:(0,ee.Y)(q.A,{name:"link",className:`link-status-icon ${se(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>W(e),contextActions:ne(e),children:[(0,ee.Y)("span",{className:"title invite-title",children:e.title||e.link}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:ie(e)})]},e.link))),(0,ee.Y)("p",{className:"section-help hint",children:C("ManageLinksInfoHelp")},"links-hint")]}),r&&Boolean(r.length)&&(0,ee.FD)("div",{className:"section",teactFastList:!0,children:[(0,ee.Y)("p",{className:"section-help",children:C("RevokedLinks")},"title"),(0,ee.Y)(ci.A,{icon:"delete",destructive:!0,onClick:S,children:(0,ee.Y)("span",{className:"title",children:C("DeleteAllRevokedLinks")})},"delete"),r?.map((e=>(0,ee.FD)(ci.A,{leftElement:(0,ee.Y)(q.A,{name:"link",className:`link-status-icon ${se(e)}`}),secondaryIcon:"more",multiline:!0,onClick:()=>W(e),contextActions:ne(e),children:[(0,ee.Y)("span",{className:"title",children:e.title||e.link}),(0,ee.Y)("span",{className:"subtitle",dir:"auto",children:ie(e)})]},e.link)))]})]}),(0,ee.Y)(vi.A,{isOpen:y,onClose:w,title:C("DeleteAllRevokedLinks"),text:C("DeleteAllRevokedLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("DeleteAll"),confirmHandler:$}),(0,ee.Y)(vi.A,{isOpen:k,onClose:I,title:C("RevokeLink"),text:C("RevokeAlert"),confirmIsDestructive:!0,confirmLabel:C("RevokeButton"),confirmHandler:j}),(0,ee.Y)(vi.A,{isOpen:T,onClose:R,title:C("DeleteLink"),text:C("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:C("Delete"),confirmHandler:X})]})}))),Hg=(0,s.ph)((0,n.EK)(((e,{userId:t})=>({user:(0,c.mBe)(e,t)})))((({userId:e,chatId:t,about:i,date:a,isChannel:o,user:r})=>{const{openChat:c,hideChatJoinRequest:d}=(0,n.ko)(),h=(0,me.x)("JoinRequest"),m=(0,M.A)(),u=(0,l.Yg)(r),p=1e3*(a-(0,li.Fm)())+Date.now(),v=(0,ze.cK)(new Date(p))?(0,ze.fU)(m,p):(0,ze.F5)(m,p,!0,!1,!0),g=(0,s.hb)((()=>{d({chatId:t,userId:e,isApproved:!0})}),[t,d,e]),A=(0,s.hb)((()=>{d({chatId:t,userId:e,isApproved:!1})}),[t,d,e]);return(0,ee.FD)("div",{className:h("&"),children:[(0,ee.FD)("div",{className:h("top"),children:[(0,ee.FD)("div",{className:h("user"),onClick:()=>{c({id:e})},children:[(0,ee.Y)(Dt.A,{size:"medium",peer:r},e),(0,ee.FD)("div",{className:h("user-info"),children:[(0,ee.Y)("div",{className:h("user-name"),children:u}),(0,ee.Y)("div",{className:h("user-subtitle"),children:i})]})]}),(0,ee.Y)("div",{className:h("date"),children:v})]}),(0,ee.FD)("div",{className:h("buttons"),children:[(0,ee.Y)(W.A,{className:h("button"),onClick:g,children:m(o?"ChannelAddToChannel":"ChannelAddToGroup")}),(0,ee.Y)(W.A,{className:h("button"),isText:!0,onClick:A,children:m("DismissRequest")})]})]})}))),$g=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t);return{chat:i,isChannel:i&&(0,l.WX)(i)}}))((({chat:e,chatId:t,isActive:i,isChannel:a,onClose:r})=>{const{hideAllChatJoinRequests:l,loadChatJoinRequests:c}=(0,n.ko)(),[d,h,m]=(0,Y.A)(),[p,v,g]=(0,Y.A)(),A=(0,M.A)();(0,fe.A)({isActive:i,onBack:r}),(0,s.vJ)((()=>{e?.joinRequests||(0,u.L8)(t)||c({chatId:t})}),[e,t,c]);const b=(0,s.hb)((()=>{l({chatId:t,isApproved:!0}),m()}),[l,t,m]),f=(0,s.hb)((()=>{l({chatId:t,isApproved:!1}),g()}),[l,t,g]);return(0,ee.FD)("div",{className:"Management ManageJoinRequests",children:[(0,ee.FD)("div",{className:"custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(Tr.A,{tgsUrl:Mr.w.JoinRequest,size:o.OMf,className:"section-icon"}),Boolean(e?.joinRequests?.length)&&(0,ee.FD)("div",{className:"bulk-actions",children:[(0,ee.Y)(W.A,{className:"bulk-action-button",onClick:h,children:"Accept all"}),(0,ee.Y)(W.A,{className:"bulk-action-button",onClick:v,isText:!0,children:"Dismiss all"})]})]}),(0,ee.FD)("div",{className:"section",teactFastList:!0,children:[(0,ee.Y)("p",{children:e?.joinRequests?e.joinRequests.length?A("JoinRequests",e.joinRequests.length):A("NoMemberRequests"):A("Loading")},"title"),!e?.joinRequests&&(0,ee.Y)(xe.A,{},"loading"),0===e?.joinRequests?.length&&(0,ee.Y)("p",{className:"section-help",children:A(a?"NoSubscribeRequestsDescription":"NoMemberRequestsDescription")},"empty"),e?.joinRequests?.map((({userId:e,about:i,date:s})=>(0,ee.Y)(Hg,{userId:e,about:i,date:s,isChannel:a,chatId:t},e)))]})]}),(0,ee.Y)(vi.A,{isOpen:d,onClose:m,title:"Accept all requests?",text:"Are you sure you want to accept all requests?",confirmHandler:b}),(0,ee.Y)(vi.A,{isOpen:p,onClose:g,title:"Reject all requests?",text:"Are you sure you want to reject all requests?",confirmHandler:f})]})}))),qg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const i=(0,c.hds)(e,t),{maxUniqueReactions:s=o.UAx}=e.appConfig||{},n=(0,c.AWZ)(e,t),a=n?.reactionsLimit||s,r=(0,l.WX)(i);return{enabledReactions:n?.enabledReactions,availableReactions:e.reactions.availableReactions,chat:i,maxUniqueReactions:s,reactionsLimit:a,isChannel:r}}),((e,{chatId:t})=>Boolean((0,c.hds)(e,t))))((({availableReactions:e,enabledReactions:t,chat:i,isActive:a,onClose:o,maxUniqueReactions:r,reactionsLimit:c,isChannel:d})=>{const{setChatEnabledReactions:h}=(0,n.ko)(),m=(0,M.A)(),[u,p]=(0,s.J0)(!1),[v,g]=(0,s.J0)(!1),[A,b]=(0,s.J0)(t),[f,C]=(0,s.J0)(c);(0,fe.A)({isActive:a,onBack:o});const y=(0,s.Kr)((()=>[{value:"all",label:m("AllReactions")},{value:"some",label:m("SomeReactions")},{value:"none",label:m("NoReactions")}]),[m]),S=(0,s.hb)((()=>{i&&(g(!0),h({chatId:i.id,enabledReactions:A,reactionsLimit:f}))}),[i,A,h,f]);(0,s.vJ)((()=>{g(!1),p(!1),b(t),C(c)}),[t,c]);const w=(0,s.Kr)((()=>e?.filter((({isInactive:e})=>!e))),[e]);(0,s.vJ)((()=>{if(void 0===f||f===c){if("some"===A?.type&&"all"!==t?.type&&"some"!==t?.type&&0===A.allowed.length)return void p(!1);if(A?.type===t?.type){if("some"===A?.type&&"some"===t?.type){const e=A.allowed,i=t?.allowed;if(e.length!==i.length||e.reverse().some((e=>!i.find((t=>(0,l.a0)(e,t))))))return void p(!0)}p(!1)}else p(!0)}else p(!0)}),[f,c,A,t]);const k=(0,s.hb)((e=>{"all"===e?(b({type:"all"}),C(c)):"some"===e?(b({type:"some",allowed:"some"===t?.type?t.allowed:[]}),C(c)):(b(void 0),C(void 0))}),[t,c]),N=(0,s.hb)((e=>{if(!i||!w)return;const{name:t,checked:s}=e.currentTarget;if("some"===A?.type){const e={emoticon:t};b(s?{type:"some",allowed:[...A.allowed,e]}:{type:"some",allowed:A.allowed.filter((t=>!(0,l.a0)(t,e)))})}}),[w,i,A]),I=(0,s.hb)((e=>{C(e)}),[]),P=(0,s.hb)((e=>m("PeerInfo.AllowedReactions.MaxCountValue",e)),[m]),Y=d&&("all"===A?.type||"some"===A?.type);return(0,ee.FD)("div",{className:"Management",children:[(0,ee.FD)("div",{className:"panel-content custom-scroll",children:[Boolean(f&&Y)&&(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("h3",{className:"section-heading",children:m("MaximumReactionsHeader")}),(0,ee.Y)(qe.A,{min:1,max:r,value:f,onChange:I,renderValue:P,isCenteredLayout:!0}),(0,ee.Y)("p",{className:"section-info section-info_push",children:m("ChannelReactions.MaxCount.Info")})]}),(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)("h3",{className:"section-heading",children:m("AvailableReactions")}),(0,ee.Y)(X.A,{selected:A?.type||"none",name:"reactions",options:y,onChange:k}),(0,ee.FD)("p",{className:"section-info section-info_push",children:["all"===A?.type&&m("EnableAllReactionsInfo"),"some"===A?.type&&m("EnableSomeReactionsInfo"),!A&&m("DisableReactionsInfo")]})]}),"some"===A?.type&&(0,ee.FD)("div",{className:"section section-with-fab",children:[(0,ee.Y)("h3",{className:"section-heading",children:m("OnlyAllowThisReactions")}),w?.map((({reaction:t,title:i})=>(0,ee.Y)("div",{className:"ListItem",children:(0,ee.Y)(un.A,{name:t.emoticon,checked:A?.allowed.some((e=>(0,l.a0)(t,e))),label:(0,ee.FD)("div",{className:"Reaction",children:[(0,ee.Y)(Ls.A,{reaction:t,availableReactions:e}),i]}),withIcon:!0,onChange:N})})))]})]}),(0,ee.Y)(ki.A,{isShown:u,onClick:S,ariaLabel:m("Save"),disabled:v,children:v?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})})]})}))),Wg="Please provide first name",Qg=(0,s.ph)((0,n.EK)(((e,{userId:t})=>{const i=(0,c.mBe)(e,t),s=(0,c.hds)(e,t),n=(0,c.vGo)(e,t),{progress:a}=(0,c.nTw)(e).management,o=s&&(0,Nc.If)(s,(0,c.K52)(e),(0,c.P5N)(e,s.id)),r=n?.personalPhoto;return{user:i,progress:a,isMuted:o,personalPhoto:r,notPersonalPhoto:n?.profilePhoto||n?.fallbackPhoto}}))((({userId:e,user:t,progress:i,isMuted:r,onClose:c,isActive:d,personalPhoto:h,notPersonalPhoto:m})=>{const{updateContact:u,deleteContact:p,closeManagement:v,uploadContactProfilePhoto:g}=(0,n.ko)(),[A,b,f]=(0,Y.A)(),[C,y,S]=(0,Y.A)(),[w,k]=(0,s.J0)(!1),[N,I]=(0,s.J0)(),P=(0,M.A)();(0,fe.A)({isActive:d,onBack:c});const F=t&&t.firstName||"",D=t&&t.lastName||"",[T,B]=(0,s.J0)(F),[R,L]=(0,s.J0)(D),[x,E]=(0,s.J0)(!r);(0,s.vJ)((()=>{E(!r)}),[r]),(0,s.vJ)((()=>{k(!1),f()}),[f,e]),(0,s.vJ)((()=>{B(F),L(D)}),[F,D,t]),(0,s.vJ)((()=>{i===a.TD.Complete&&(k(!1),I(void 0),f())}),[f,i]);const V=(0,s.hb)((e=>{B(e.target.value),k(!0),N===Wg&&I(void 0)}),[N]),_=(0,s.hb)((e=>{L(e.target.value),k(!0)}),[]),U=(0,s.hb)((e=>{E(e.target.checked),k(!0)}),[]),O=(0,s.hb)((()=>{const t=T.trim(),i=R.trim();t.length?u({userId:e,isMuted:!x,firstName:t,lastName:i}):I(Wg)}),[T,R,u,e,x]),K=(0,s.hb)((()=>{p({userId:e}),f(),v()}),[f,v,p,e]),J=(0,s.li)(),G=(0,s.li)(!1),j=(0,s.hb)((()=>{J.current?.click(),G.current=!0}),[]),z=(0,s.hb)((()=>{J.current?.click(),G.current=!1}),[]),H=(0,s.hb)((()=>{S(),k(!0),g({userId:e})}),[S,g,e]),$=(0,s.hb)((t=>{k(!0),g({userId:e,file:t,isSuggest:G.current})}),[g,e]);if(!t)return;const W=!(0,l.tv)(t)&&t.id!==o.zv8,Z=i===a.TD.InProgress;return(0,ee.FD)("div",{className:"Management",children:[(0,ee.FD)("div",{className:"custom-scroll",children:[(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(Rs.A,{userId:t.id,avatarSize:"jumbo",noStatusOrTyping:!0,noEmojiStatus:!0,withFullInfo:!0}),(0,ee.FD)("div",{className:"settings-edit",children:[(0,ee.Y)(Q.A,{id:"user-first-name",label:P("UserInfo.FirstNamePlaceholder"),onChange:V,value:T,error:N===Wg?N:void 0}),(0,ee.Y)(Q.A,{id:"user-last-name",label:P("UserInfo.LastNamePlaceholder"),onChange:_,value:R})]}),(0,ee.Y)("div",{className:"ListItem narrow",children:(0,ee.Y)(un.A,{checked:x,label:P("Notifications"),subLabel:P(x?"UserInfo.NotificationsEnabled":"UserInfo.NotificationsDisabled"),onChange:U})})]}),W&&(0,ee.FD)("div",{className:"section",children:[(0,ee.Y)(ci.A,{icon:"camera-add",ripple:!0,onClick:j,children:(0,ee.Y)("span",{className:"list-item-ellipsis",children:P("UserInfo.SuggestPhoto",t.firstName)})}),(0,ee.Y)(ci.A,{icon:"camera-add",ripple:!0,onClick:z,children:(0,ee.Y)("span",{className:"list-item-ellipsis",children:P("UserInfo.SetCustomPhoto",t.firstName)})}),h&&(0,ee.Y)(ci.A,{leftElement:(0,ee.Y)(Dt.A,{photo:m,noPersonalPhoto:!0,peer:t,size:"mini",className:"personal-photo"}),ripple:!0,onClick:y,children:P("UserInfo.ResetCustomPhoto")}),(0,ee.Y)("p",{className:"section-help",dir:"auto",children:P("UserInfo.CustomPhotoInfo",t.firstName)})]}),(0,ee.Y)("div",{className:"section",children:(0,ee.Y)(ci.A,{icon:"delete",ripple:!0,destructive:!0,onClick:b,children:P("DeleteContact")})})]}),(0,ee.Y)(ki.A,{isShown:w,onClick:O,disabled:Z,ariaLabel:P("Save"),children:Z?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"check"})}),(0,ee.Y)(vi.A,{isOpen:A,onClose:f,text:P("AreYouSureDeleteContact"),confirmLabel:P("DeleteContact"),confirmHandler:K,confirmIsDestructive:!0}),(0,ee.Y)(vi.A,{isOpen:C,onClose:S,text:P("UserInfo.ResetToOriginalAlertText",t.firstName),confirmLabel:P("Reset"),confirmHandler:H,confirmIsDestructive:!0}),(0,ee.Y)(Qh.A,{onChange:$,inputRef:J})]})}))),Zg=(0,s.ph)((0,n.EK)(((e,{chatId:t})=>{const{progress:i,error:s}=(0,c.nTw)(e).chatCreation||{};return{chat:(0,c.hds)(e,t),creationProgress:i,creationError:s}}))((({chat:e,onClose:t,isActive:i,creationProgress:o,creationError:r})=>{const{createChannel:l}=(0,n.ko)(),c=(0,_i.A)();(0,fe.A)({isActive:i,onBack:t});const[d,h]=(0,s.J0)(c("NewDiscussionChatTitle",{name:e?.title})),[m,u]=(0,s.J0)(),[p,v]=(0,s.J0)(),g=o===a.n7.InProgress,A=(0,D.A)((e=>{const{value:t}=e.currentTarget,i=t.trimStart();h(i),i!==t&&(e.currentTarget.value=i)})),b=r&&c("NewChatTitleEmptyError")||(p!==c("NewChatTitleEmptyError")&&p!==c("NewChannelTitleEmptyError")?p:void 0),f=(0,D.A)((()=>{d.length?e&&l({discussionChannelId:e.id,title:d,photo:m,isSuperGroup:!0}):v(c("NewChatTitleEmptyError"))}));return(0,ee.Y)("div",{className:"Management",children:(0,ee.Y)("div",{className:"panel-content custom-scroll",children:(0,ee.FD)("div",{className:"NewChat",children:[(0,ee.FD)("div",{className:"NewChat-inner step-2",children:[(0,ee.Y)(dh.A,{onChange:u,title:c("AddPhoto")}),(0,ee.Y)(Q.A,{value:d,onChange:A,label:c("GroupName"),error:p===c("NewChatTitleEmptyError")||p===c("NewChannelTitleEmptyError")?p:void 0}),b&&(0,ee.Y)("p",{className:"error",children:b})]}),(0,ee.Y)(ki.A,{isShown:0!==d.length,onClick:f,disabled:g,ariaLabel:c("DiscussionCreateGroup"),children:g?(0,ee.Y)(xe.A,{color:"white"}):(0,ee.Y)(q.A,{name:"arrow-right"})})]})})})}))),Xg=(0,s.ph)((0,n.EK)((e=>({managementType:(0,c.vn8)(e)})))((({chatId:e,currentScreen:t,selectedChatMemberId:i,isPromotedByCurrentUser:s,onScreenSelect:n,onChatMemberSelect:o,onClose:r,isActive:l,managementType:c})=>{switch(t){case a.je.Initial:switch(c){case"bot":return(0,ee.Y)(fg,{userId:e,onClose:r,isActive:l},e);case"user":return(0,ee.Y)(Qg,{userId:e,onClose:r,isActive:l},e);case"group":return(0,ee.Y)(Mg,{chatId:e,onScreenSelect:n,onClose:r,isActive:l||[a.je.ChatPrivacyType,a.je.Discussion,a.je.GroupPermissions,a.je.ChatAdministrators,a.je.GroupRemovedUsers,a.je.GroupUserPermissionsCreate,a.je.GroupUserPermissions,a.je.ChatAdminRights,a.je.ChatNewAdminRights,a.je.GroupRecentActions].includes(t)},e);case"channel":return(0,ee.Y)(yg,{chatId:e,onScreenSelect:n,onClose:r,isActive:l||[a.je.ChannelSubscribers,a.je.ChatAdministrators,a.je.ChannelRemovedUsers,a.je.Discussion,a.je.ChatPrivacyType,a.je.ChatAdminRights,a.je.ChatNewAdminRights,a.je.GroupRecentActions].includes(t)},e)}break;case a.je.ChatPrivacyType:return(0,ee.Y)(wg,{chatId:e,isActive:l,onClose:r});case a.je.Discussion:return(0,ee.Y)(Ig,{chatId:e,onScreenSelect:n,isActive:l,onClose:r});case a.je.GroupPermissions:return(0,ee.Y)(xg,{chatId:e,onScreenSelect:n,onChatMemberSelect:o,isActive:l||[a.je.GroupRemovedUsers,a.je.GroupUserPermissionsCreate,a.je.GroupUserPermissions].includes(t),onClose:r});case a.je.ChannelRemovedUsers:case a.je.GroupRemovedUsers:return(0,ee.Y)(Ng,{chatId:e,isActive:l,onClose:r});case a.je.GroupUserPermissionsCreate:return(0,ee.Y)(Vg,{chatId:e,onChatMemberSelect:o,onScreenSelect:n,isActive:l||[a.je.GroupUserPermissions].includes(t),onClose:r});case a.je.GroupUserPermissions:return(0,ee.Y)(Eg,{chatId:e,selectedChatMemberId:i,isPromotedByCurrentUser:s,onScreenSelect:n,isActive:l,onClose:r});case a.je.ChatAdministrators:return(0,ee.Y)(Sg,{chatId:e,onScreenSelect:n,onChatMemberSelect:o,isActive:l||[a.je.ChatAdminRights,a.je.ChatNewAdminRights,a.je.GroupRecentActions].includes(t),onClose:r});case a.je.NewDiscussionGroup:return(0,ee.Y)(Zg,{chatId:e,onScreenSelect:n,isActive:l,onClose:r});case a.je.ChatNewAdminRights:case a.je.ChatAdminRights:return(0,ee.Y)(Tg,{chatId:e,isNewAdmin:t===a.je.ChatNewAdminRights,selectedUserId:i,isPromotedByCurrentUser:s,onScreenSelect:n,isActive:l,onClose:r});case a.je.ChannelSubscribers:case a.je.GroupMembers:return(0,ee.Y)(Lg,{chatId:e,isActive:l,onClose:r});case a.je.Invites:return(0,ee.Y)(zg,{chatId:e,isActive:l,onClose:r,onScreenSelect:n});case a.je.EditInvite:return(0,ee.Y)(Kg,{chatId:e,isActive:l,onClose:r,onScreenSelect:n});case a.je.GroupAddAdmins:return(0,ee.Y)(Lg,{chatId:e,noAdmins:!0,isActive:l,onClose:r,onScreenSelect:n,onChatMemberSelect:o});case a.je.Reactions:return(0,ee.Y)(qg,{chatId:e,isActive:l,onClose:r});case a.je.InviteInfo:return(0,ee.Y)(Jg,{chatId:e,isActive:l,onClose:r});case a.je.JoinRequests:return(0,ee.Y)($g,{chatId:e,isActive:l,onClose:r})}}))),eA=/^4\d/,tA=/^5[1-5]/,iA=/^2[2-7]\d{2}/,sA=/^220[0-4]/;let nA=function(e){return e[e.Default=0]="Default",e[e.Visa=1]="Visa",e[e.Mastercard=2]="Mastercard",e[e.Mir=3]="Mir",e}({});const aA={[nA.Default]:"",[nA.Visa]:"visa",[nA.Mastercard]:"mastercard",[nA.Mir]:"mir"};function oA(e){return e=e.replace(/\s/g,""),eA.test(e)?nA.Visa:sA.test(e)?nA.Mir:tA.test(e)||iA.test(e)?nA.Mastercard:nA.Default}const rA={streetLine1:"",streetLine2:"",city:"",state:"",countryIso2:"",postCode:"",fullName:"",email:"",phone:"",shipping:"",cardNumber:"",cardholder:"",expiry:"",cvv:"",billingCountry:"",billingZip:"",saveInfo:!0,saveCredentials:!1,formErrors:{},tipAmount:0,savedCredentialId:""},lA=(e,t)=>{switch(t.type){case"changeAddress1":return{...e,streetLine1:t.payload,formErrors:{...e.formErrors,streetLine1:void 0}};case"changeAddress2":return{...e,streetLine2:t.payload,formErrors:{...e.formErrors,streetLine2:void 0}};case"changeCity":return{...e,city:t.payload,formErrors:{...e.formErrors,city:void 0}};case"changeState":return{...e,state:t.payload,formErrors:{...e.formErrors,state:void 0}};case"changeCountry":return{...e,countryIso2:t.payload.iso2,billingCountry:t.payload.defaultName,formErrors:{...e.formErrors,countryIso2:void 0}};case"changePostCode":return{...e,postCode:t.payload,formErrors:{...e.formErrors,postCode:void 0}};case"changeFullName":return{...e,fullName:t.payload,formErrors:{...e.formErrors,fullName:void 0}};case"changeEmail":return{...e,email:t.payload,formErrors:{...e.formErrors,email:void 0}};case"changePhone":return{...e,phone:t.payload,formErrors:{...e.formErrors,phone:void 0}};case"changeShipping":return{...e,shipping:t.payload};case"changeCardNumber":return{...e,cardNumber:t.payload,formErrors:{...e.formErrors,cardNumber:void 0}};case"changeCardholder":return{...e,cardholder:t.payload,formErrors:{...e.formErrors,cardholder:void 0}};case"changeExpiryDate":return{...e,expiry:t.payload,formErrors:{...e.formErrors,expiry:void 0}};case"changeCvvCode":return{...e,cvv:t.payload,formErrors:{...e.formErrors,cvv:void 0}};case"changeBillingCountry":return{...e,billingCountry:t.payload,formErrors:{...e.formErrors,billingCountry:void 0}};case"changeBillingZip":return{...e,billingZip:t.payload,formErrors:{...e.formErrors,billingZip:void 0}};case"changeSaveInfo":return{...e,saveInfo:t.payload};case"changeSaveCredentials":return{...e,saveCredentials:t.payload};case"updateUserInfo":return t.payload.country?{...e,...t.payload,billingCountry:t.payload.country}:{...e,...t.payload};case"setFormErrors":return{...e,formErrors:{...e.formErrors,...t.payload}};case"setTipAmount":return{...e,tipAmount:t.payload};case"changeSavedCredentialId":return{...e,savedCredentialId:t.payload};case"resetState":return{...rA};default:return e}};var cA=i(37960);const dA={root:"maC_9u6e",description:"zQ6lEVJ2","checkout-picture":"JgWvLdK2",checkoutPicture:"JgWvLdK2",text:"T2pYH395","checkout-title":"HadolzeF",checkoutTitle:"HadolzeF","checkout-description":"oZW7mUNP",checkoutDescription:"oZW7mUNP","price-info":"P618Q3yr",priceInfo:"P618Q3yr","price-info-item":"XNNG_ajy",priceInfoItem:"XNNG_ajy","price-info-item-main":"D9gYNLVk",priceInfoItemMain:"D9gYNLVk","price-info-item-title":"NtY5Aah7",priceInfoItemTitle:"NtY5Aah7",tipsList:"WHO341eB",tipsItem:"ksLlzBxw",tipsItem_active:"J4yem62L",tipsItemActive:"J4yem62L","invoice-info":"U2IBOLP1",invoiceInfo:"U2IBOLP1",provider:"kqWcdro1",stripe:"xKztZrna",smartglocal:"X_Ge1o4u","checkout-info-item-info-title":"ysWuPklS",checkoutInfoItemInfoTitle:"ysWuPklS","checkout-info-item-info-data":"MpC_P8_c",checkoutInfoItemInfoData:"MpC_P8_c","tos-checkbox":"OrRb0xG7",tosCheckbox:"OrRb0xG7",list:"l_wfiFG0"},hA=(0,s.ph)((({title:e,description:t,photo:i,invoice:o,shippingPrices:r,checkoutInfo:c,totalPrice:d,isTosAccepted:h,dispatch:m,onAcceptTos:u,tipAmount:p,needAddress:v,hasShippingOptions:g,savedCredentials:A,isPaymentFormUrl:b,botName:f})=>{const{setPaymentStep:C}=(0,n.ko)(),y=(0,M.A)(),S=(0,_i.A)(),w=Boolean(m),{termsUrl:k,suggestedTipAmounts:N,maxTipAmount:I}=o||{},{paymentMethod:P,paymentProvider:Y,shippingAddress:F,name:D,phone:T,shippingMethod:B}=c||{},R=(0,j.A)((0,l.cy)(i)),L=(0,cA.A)(R),x=(0,s.hb)((e=>{m({type:"setTipAmount",payload:I?Math.min(e,I):e})}),[m,I]),E=(0,s.hb)((()=>{C({step:A?.length?a.tn.SavedPayments:a.tn.PaymentInfo})}),[A?.length,C]),V=(0,s.hb)((()=>{C({step:a.tn.ShippingInfo})}),[C]),_=(0,s.hb)((()=>{C({step:a.tn.Shipping})}),[C]);return(0,ee.FD)("div",{className:dA.root,children:[(0,ee.FD)("div",{className:dA.description,children:[R&&(0,ee.Y)("img",{ref:L,className:dA.checkoutPicture,src:R,draggable:!1,width:i.dimensions?.width,height:i.dimensions?.height,alt:""}),!R&&i&&(0,ee.Y)(ns.A,{width:i.dimensions?.width,height:i.dimensions?.height,className:dA.checkoutPicture,forceAspectRatio:!0}),(0,ee.FD)("div",{className:dA.text,children:[(0,ee.Y)("h5",{className:dA.checkoutTitle,children:e}),t&&(0,ee.Y)("div",{className:dA.checkoutDescription,children:(0,Ft.A)(t,["br","links","emoji"])})]})]}),(0,ee.FD)("div",{className:dA.priceInfo,children:[o.prices.map((e=>mA(S,e.label,e.amount,o.currency))),r&&r.map((e=>mA(S,e.label,e.amount,o.currency))),N&&N.length>0&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:dA.priceInfoItem,children:[(0,ee.Y)("div",{className:dA.priceInfoItemTitle,children:e}),(0,ee.Y)("div",{children:(0,Sa.v)(S,p,o.currency)})]}),(0,ee.Y)("div",{className:dA.tipsList,children:N.map((e=>(0,ee.Y)("div",{className:(0,me.A)(dA.tipsItem,e===p&&dA.tipsItem_active),onClick:m?()=>x(e===p?0:e):void 0,children:(0,Sa.v)(S,e,o.currency,{shouldOmitFractions:!0})},e)))})]}),void 0!==d&&mA(S,y("Checkout.TotalAmount"),d,o.currency,!0)]}),(0,ee.FD)("div",{className:dA.invoiceInfo,children:[!b&&uA({title:P||A?.[0].title,label:y("PaymentCheckoutMethod"),icon:"card",onClick:w?E:void 0}),Y&&uA({title:Y,label:y("PaymentCheckoutProvider"),customIcon:(0,me.A)(dA.provider,dA[Y.toLowerCase()])}),(v||!w&&F)&&uA({title:F,label:y("PaymentShippingAddress"),icon:"location",onClick:w?V:void 0}),D&&uA({title:D,label:y("PaymentCheckoutName"),icon:"user"}),T&&uA({title:T,label:y("PaymentCheckoutPhoneNumber"),icon:"phone"}),(g||!w&&B)&&uA({title:B,label:y("PaymentCheckoutShippingMethod"),icon:"truck",onClick:w?_:void 0}),k&&(U=k,(0,ee.Y)(un.A,{label:function(e,t){const i=y("PaymentCheckoutAcceptRecurrent",f).split("*");return(0,ee.FD)(ee.FK,{children:[i[0],(0,ee.Y)(fl.A,{url:e,text:i[1],isRtl:t}),i.slice(2)]})}(U,y.isRtl),name:"checkout_tos",checked:Boolean(h),className:dA.tosCheckbox,tabIndex:0,onCheck:u}))]})]});var U}));function mA(e,t,i,s,n=!1){return(0,ee.FD)("div",{className:(0,me.A)(dA.priceInfoItem,n&&dA.priceInfoItemMain),children:[(0,ee.Y)("div",{className:dA.priceInfoItemTitle,children:t}),(0,ee.Y)("div",{children:(0,Sa.v)(e,i,s)})]})}function uA({title:e,label:t,icon:i,customIcon:s,onClick:n}){const a=Boolean(e&&t!==e);return(0,ee.FD)(ci.A,{className:dA.list,narrow:!0,multiline:a,icon:i,inactive:!n,onClick:n,leftElement:s&&(0,ee.Y)("i",{className:(0,me.A)("icon",s)}),children:[(0,ee.Y)("div",{className:dA.checkoutInfoItemInfoTitle,children:e||t}),e&&t!==e&&(0,ee.Y)("p",{className:dA.checkoutInfoItemInfoData,children:t})]})}const pA=(0,s.ph)((({url:e,noRedirect:t,onClose:i,onPaymentFormSubmit:a})=>{const{openTelegramLink:r}=(0,n.ko)(),l=(0,M.A)(),c=(0,s.hb)((e=>{try{const s=JSON.parse(e.data),{eventType:n,eventData:l}=s;switch(n){case"web_app_open_tg_link":if(!t){const e=o.jsp+l.path_full;r({url:e})}i();break;case"payment_form_submit":a&&a(l);break;default:i()}}catch(e){}}),[i,t,r,a]);return(0,s.vJ)((()=>(window.addEventListener("message",c),()=>window.removeEventListener("message",c))),[c]),(0,ee.Y)("div",{className:"ConfirmPayment",children:(0,ee.Y)("iframe",{src:e,title:l("Checkout.WebConfirmation.Title"),allow:"payment",sandbox:"allow-modals allow-forms allow-scripts allow-same-origin allow-top-navigation",className:"ConfirmPayment__content"})})})),vA=(0,s.ph)((0,n.EK)((e=>{const{payment:t}=(0,c.nTw)(e);return{errorKey:t.error?.messageKey,passwordHint:e.twoFaSettings.hint,savedCredentials:"regular"===t.form?.type?t.form.savedCredentials:void 0}}))((({isActive:e,errorKey:t,state:i,savedCredentials:a,passwordHint:o,onPasswordChange:r})=>{const{clearPaymentError:l}=(0,n.ko)(),c=(0,M.A)(),d=(0,_i.A)(),[h,m]=(0,s.J0)(!1),u=(0,s.Kr)((()=>a?.length&&i.savedCredentialId?a.find((({id:e})=>e===i.savedCredentialId))?.title:void 0),[a,i.savedCredentialId]);return(0,ee.FD)("div",{className:"PaymentInfo",children:[(0,ee.Y)(Id.A,{isBig:!0,isPasswordVisible:h}),(0,ee.Y)(Pl.A,{error:t&&d.withRegular(t),hint:o,description:c("PaymentConfirmationMessage",u),placeholder:c("Password"),clearError:l,shouldShowSubmit:!1,shouldResetValue:e,isPasswordVisible:h,onChangePasswordVisibility:m,onInputChange:r})]})})));var gA=i(63173);function AA(e,t=300){(0,s.vJ)((()=>{b.TF||setTimeout((()=>{(0,r.YS)((()=>{e.current?.focus()}))}),t)}),[e,t])}const bA=i.p+"mastercard.790db81f7978635f77d8.svg",fA=i.p+"mir.e3a390b90e2e3e292621.svg",CA=i.p+"visa.fb39984c9532c0336be9.svg",yA=(0,s.ph)((({value:e,error:t,onChange:i})=>{const n=(0,M.A)(),a=(0,s.li)();AA(a);const[o,r]=(0,s.J0)(nA.Default);(0,s.vJ)((()=>{const t=oA(e);r(t)}),[]);const l=(0,s.hb)((e=>{const t=function(e){const t=(e=e.replace(/[^\d]/g,"")).match(/.{1,4}/g);return t?t.join(" "):""}(e.target.value),s=oA(e.target.value);r(s),i(t)}),[i]),c=function(e){switch(e){case nA.Mastercard:return(0,ee.Y)("img",{src:bA,draggable:!1,alt:""});case nA.Visa:return(0,ee.Y)("img",{src:CA,draggable:!1,alt:""});case nA.Mir:return(0,ee.Y)("img",{src:fA,draggable:!1,alt:""});default:return}}(o);return(0,ee.FD)("div",{className:"CardInput",children:[(0,ee.Y)(Q.A,{ref:a,label:n("PaymentCardNumber"),onChange:l,value:e,inputMode:"numeric",className:o?"has-right-addon":"",error:t,tabIndex:0,maxLength:19,teactExperimentControlled:!0}),(0,ee.Y)("span",{className:"right-addon",children:c})]})})),SA=(0,s.ph)((({value:e,error:t,onChange:i})=>{const n=(0,M.A)(),a=(0,s.hb)((t=>{const s=t.target.value;e.endsWith("/")&&e.length>s.length?i(s):i(function(e){const t=(e=e.replace(/[^\d]/g,"").slice(0,4)).match(/.{1,2}/g);return t?.[0]&&Number(t[0])>12&&(t[0]="12"),t?.[0]&&2===t[0].length&&!t[1]&&(t[1]=""),t?t.join("/"):""}(t.target.value))}),[i,e]);return(0,ee.Y)(Q.A,{label:n("PaymentCardExpireDate"),onChange:a,value:e,error:t,inputMode:"numeric",tabIndex:0,maxLength:5,teactExperimentControlled:!0})})),wA=(0,s.ph)((({state:e,canSaveCredentials:t,needCardholderName:i,needCountry:n,needZip:a,countryList:o,dispatch:r})=>{const l=(0,s.li)();(0,s.vJ)((()=>{l.current&&l.current.value!==e.billingCountry&&(l.current.value=e.billingCountry)}),[e.billingCountry]);const c=(0,s.hb)((e=>{r({type:"changeCardNumber",payload:e})}),[r]),d=(0,s.hb)((e=>{r({type:"changeCardholder",payload:e.target.value.toUpperCase()})}),[r]),h=(0,s.hb)((e=>{r({type:"changeExpiryDate",payload:e})}),[r]),m=(0,s.hb)((e=>{const t=e.target.value.replace(/[^0-9]/g,"");r({type:"changeCvvCode",payload:t})}),[r]),u=(0,s.hb)((e=>{r({type:"changeBillingCountry",payload:e.target.value})}),[r]),p=(0,s.hb)((e=>{r({type:"changeBillingZip",payload:e.target.value})}),[r]),v=(0,s.hb)((e=>{r({type:"changeSaveCredentials",payload:e.target.value})}),[r]),g=(0,M.A)(),A=(0,_i.A)(),{formErrors:b={}}=e;return(0,ee.Y)("div",{className:"PaymentInfo",children:(0,ee.FD)("form",{children:[(0,ee.Y)("h5",{children:g("PaymentCardTitle")}),(0,ee.Y)(yA,{onChange:c,value:e.cardNumber,error:b.cardNumber&&A.withRegular(b.cardNumber)}),i&&(0,ee.Y)(Q.A,{label:g("Checkout.NewCard.CardholderNamePlaceholder"),onChange:d,value:e.cardholder,inputMode:"text",tabIndex:0,error:b.cardholder&&A.withRegular(b.cardholder)}),(0,ee.FD)("section",{className:"inline-inputs",children:[(0,ee.Y)(SA,{value:e.expiry,onChange:h,error:b.expiry&&A.withRegular(b.expiry)}),(0,ee.Y)(Q.A,{label:g("lng_payments_card_cvc"),onChange:m,value:e.cvv,inputMode:"numeric",maxLength:3,tabIndex:0,error:b.cvv&&A.withRegular(b.cvv),teactExperimentControlled:!0})]}),n||a?(0,ee.Y)("h5",{children:g("PaymentBillingAddress")}):void 0,(0,ee.FD)("section",{className:"inline-inputs",children:[n&&(0,ee.Y)(gA.A,{label:g("PaymentShippingCountry"),onChange:u,value:e.billingCountry,hasArrow:Boolean(!0),id:"billing-country",error:b.billingCountry&&A.withRegular(b.billingCountry),tabIndex:0,ref:l,children:o.map((({defaultName:t,name:i})=>(0,ee.Y)("option",{value:t,className:"county-item",selected:t===e.billingCountry,children:t||i})))}),a&&(0,ee.Y)(Q.A,{label:g("PaymentShippingZipPlaceholder"),onChange:p,value:e.billingZip,inputMode:"text",tabIndex:0,maxLength:12,error:b.billingZip&&A.withRegular(b.billingZip)})]}),(0,ee.Y)("div",{className:"checkbox",children:(0,ee.Y)(un.A,{label:g("PaymentCardSavePaymentInformation"),checked:!!t&&e.saveCredentials,tabIndex:0,subLabel:g(t?"Checkout.NewCard.SaveInfoHelp":"Checkout.2FA.Text"),onChange:v,disabled:!t})})]})})})),kA=(0,s.ph)((({state:e,savedCredentials:t,dispatch:i,onNewCardClick:n})=>{const a=(0,M.A)(),o=(0,s.Kr)((()=>t?.length?t.map((({id:e,title:t})=>({label:t,value:e}))):Ci.p),[t]),r=(0,s.hb)((e=>{i({type:"changeSavedCredentialId",payload:e})}),[i]);return(0,ee.Y)("div",{className:"PaymentInfo",children:(0,ee.FD)("form",{children:[(0,ee.Y)("h5",{children:a("PaymentCardTitle")}),(0,ee.Y)(X.A,{name:"saved-credentials",options:o,selected:e.savedCredentialId,onChange:r}),(0,ee.Y)(W.A,{isText:!0,onClick:n,children:a("PaymentCheckoutMethodNewCard")})]})})})),NA=(0,s.ph)((({state:e,shippingOptions:t,currency:i,dispatch:n})=>{const a=(0,M.A)(),o=(0,_i.A)();(0,s.vJ)((()=>{t&&t.length&&!e.shipping&&n({type:"changeShipping",payload:t[0].id})}),[t,e.shipping,n]);const r=(0,s.hb)((e=>{n({type:"changeShipping",payload:e})}),[n]),l=(0,s.Kr)((()=>t.map((({id:e,title:t,amount:s})=>({label:t,subLabel:(0,Sa.v)(o,s,i),value:e})))),[t,i,o]);return(0,ee.Y)("div",{className:"Shipping",children:(0,ee.FD)("form",{children:[(0,ee.Y)("p",{children:a("PaymentShippingMethod")}),(0,ee.Y)(X.A,{name:"shipping-options",options:l,onChange:r,selected:e.shipping})]})})})),IA=(0,s.ph)((({state:e,needEmail:t,needPhone:i,needName:n,needAddress:a,countryList:o,dispatch:r})=>{const l=(0,s.li)(),c=(0,s.li)(),d=(0,s.li)();(0,s.vJ)((()=>{d.current&&d.current.value!==e.countryIso2&&(d.current.value=e.countryIso2)}),[e.countryIso2]);const h=(0,M.A)(),m=(0,_i.A)();AA(l);const u=(0,s.hb)((e=>{r({type:"changeAddress1",payload:e.target.value})}),[r]),p=(0,s.hb)((e=>{r({type:"changeAddress2",payload:e.target.value})}),[r]),v=(0,s.hb)((e=>{r({type:"changeCity",payload:e.target.value})}),[r]),g=(0,s.hb)((e=>{r({type:"changeState",payload:e.target.value})}),[r]),A=(0,s.hb)((e=>{r({type:"changeCountry",payload:o.find((t=>t.iso2===e.target.value))})}),[o,r]),b=(0,s.hb)((e=>{r({type:"changePostCode",payload:e.target.value})}),[r]),f=(0,s.hb)((e=>{r({type:"changeFullName",payload:e.target.value})}),[r]),C=(0,s.hb)((e=>{r({type:"changeEmail",payload:e.target.value})}),[r]),y=(0,s.hb)((e=>{let{value:t}=e.target;t=`+${t.replace(/\D/g,"")}`,c.current&&(c.current.value=t),r({type:"changePhone",payload:t})}),[r]),S=(0,s.hb)((e=>{r({type:"changeSaveInfo",payload:e.target.value})}),[r]),{formErrors:w}=e;return(0,ee.Y)("div",{className:"ShippingInfo",children:(0,ee.FD)("form",{children:[a?(0,ee.FD)("div",{children:[(0,ee.Y)("h5",{children:h("PaymentShippingAddress")}),(0,ee.Y)(Q.A,{ref:l,label:h("PaymentShippingAddress1Placeholder"),onChange:u,value:e.streetLine1,inputMode:"text",tabIndex:0,error:w.streetLine1&&m.withRegular(w.streetLine1)}),(0,ee.Y)(Q.A,{label:h("PaymentShippingAddress2Placeholder"),onChange:p,value:e.streetLine2,inputMode:"text",tabIndex:0,error:w.streetLine2&&m.withRegular(w.streetLine2)}),(0,ee.Y)(Q.A,{label:h("PaymentShippingCityPlaceholder"),onChange:v,value:e.city,inputMode:"text",tabIndex:0,error:w.city&&m.withRegular(w.city)}),(0,ee.Y)(Q.A,{label:h("PaymentShippingStatePlaceholder"),onChange:g,value:e.state,inputMode:"text",error:w.state&&m.withRegular(w.state)}),(0,ee.Y)(gA.A,{label:h("PaymentShippingCountry"),onChange:A,value:e.countryIso2,hasArrow:Boolean(!0),id:"shipping-country",error:w.countryIso2&&m.withRegular(w.countryIso2),ref:d,tabIndex:0,children:o.map((({defaultName:t,name:i,iso2:s})=>(0,ee.Y)("option",{value:s,className:"county-item",selected:s===e.countryIso2,children:t||i})))}),(0,ee.Y)(Q.A,{label:h("PaymentShippingZipPlaceholder"),onChange:b,value:e.postCode,inputMode:"text",tabIndex:0,error:w.postCode&&m.withRegular(w.postCode)})]}):void 0,n||t||i?(0,ee.Y)("h5",{children:h("PaymentShippingReceiver")}):void 0,n&&(0,ee.Y)(Q.A,{label:h("PaymentShippingName"),onChange:f,value:e.fullName,inputMode:"text",tabIndex:0,error:w.fullName&&m.withRegular(w.fullName)}),t&&(0,ee.Y)(Q.A,{label:h("PaymentShippingEmailPlaceholder"),onChange:C,value:e.email,inputMode:"email",tabIndex:0,error:w.email&&m.withRegular(w.email)}),i&&(0,ee.Y)(Q.A,{label:h("PaymentShippingPhoneNumber"),onChange:y,value:e.phone,inputMode:"tel",tabIndex:0,error:w.phone&&m.withRegular(w.phone),ref:c}),(0,ee.Y)(un.A,{label:h("PaymentShippingSave"),subLabel:h("PaymentShippingSaveInfo"),checked:Boolean(e.saveInfo),tabIndex:0,onChange:S})]})})})),PA="stripe",YA="smartglocal",FA=new Set([PA,YA]),DA=(0,s.ph)((0,n.EK)((e=>{const{form:t,step:i,shippingOptions:s,error:n,confirmPaymentUrl:a,inputInvoice:o,requestId:r,stripeCredentials:d,smartGlocalCredentials:h,temporaryPassword:m,isExtendedMedia:u,url:p}=(0,c.nTw)(e).payment,{invoice:v,nativeParams:g,nativeProvider:A}=t||{},b=e.countryList.general;let f=t?.nativeProvider;!f&&p&&(f=p.startsWith("https://payment.smart-glocal.com")?YA:void 0);const C=o&&"chatId"in o?(0,c.hds)(e,o.chatId):void 0,y=Boolean(v&&(!f||!FA.has(f))),{needCardholderName:S,needCountry:w,needZip:k}=g||{},N=t?.botId?(0,c.mBe)(e,t.botId):void 0,I=(0,l.Yg)(N);return{step:i,chat:C,shippingOptions:s,nativeProvider:f,isProviderError:y,form:t,invoice:v,needCardholderName:S,needCountry:w,needZip:k,error:n,confirmPaymentUrl:a??p,isPaymentFormUrl:Boolean(!A&&p),countryList:b,requestId:r,hasShippingOptions:Boolean(s?.length),smartGlocalToken:h?.token,stripeId:d?.id,passwordValidUntil:m?.validUntil,isExtendedMedia:u,botName:I}}))((({isOpen:e,onClose:t,step:i,shippingOptions:o,form:r,isProviderError:l,invoice:c,nativeProvider:d,needCardholderName:h,needCountry:m,needZip:u,confirmPaymentUrl:p,error:v,countryList:g,hasShippingOptions:A,requestId:b,smartGlocalToken:f,stripeId:C,savedCredentials:y,passwordValidUntil:S,isExtendedMedia:w,isPaymentFormUrl:k,botName:N})=>{const{loadPasswordInfo:I,validateRequestedInfo:P,sendPaymentForm:F,setPaymentStep:T,sendCredentialsInfo:B,clearPaymentError:R,validatePaymentPassword:L,setSmartGlocalCardInfo:x}=(0,n.ko)(),E=(0,M.A)(),_=(0,_i.A)(),[U,O,K]=(0,Y.A)(),[J,G]=(0,ld.A)(lA,rA),[j,z]=(0,s.J0)(!1),[H,$]=(0,s.J0)(!1),[Q,X]=(0,s.J0)(""),te=(0,V.A)(i,!0),ie=(0,V.A)(b),ne=i!==a.tn.ConfirmPayment,ae=(0,s.hb)((e=>{T({step:e})}),[T]);(0,s.vJ)((()=>{e&&(X(""),I(),O())}),[e,I,O]),(0,s.vJ)((()=>{!e&&U&&K()}),[K,U,e]),(0,s.vJ)((()=>{(void 0!==i||v)&&z(!1)}),[i,v,b]),(0,s.vJ)((()=>{i!==a.tn.Checkout||i!==te||b===ie||J.savedCredentialId||J.cardNumber||ae(a.tn.PaymentInfo)}),[J.cardNumber,J.savedCredentialId,ie,te,b,ae,i]),(0,s.vJ)((()=>{v?.field&&G({type:"setFormErrors",payload:{[v.field]:v.messageKey}})}),[v,G]),(0,s.vJ)((()=>{if(r?.savedInfo){const{name:e,phone:t,email:i,shippingAddress:s}=r.savedInfo,{countryIso2:n,...a}=s||{},o=n&&g.find((({iso2:e})=>e===n)).defaultName;G({type:"updateUserInfo",payload:{fullName:e,phone:t&&"+"!==t.charAt(0)?`+${t}`:t,email:i,...o&&{country:o,countryIso2:n,...a}}})}}),[r,G,g]),(0,s.vJ)((()=>{y?.length&&G({type:"changeSavedCredentialId",payload:y[0].id})}),[G,y]);const oe=(0,s.hb)((()=>{R()}),[R]),re=(0,s.Kr)((()=>i!==a.tn.Checkout?0:function(e=[],t,i,s){const n=t?TA(t,i):[];let a=s;return a=e.concat(n||[]).reduce(((e,t)=>e+t.amount),a),a}(c?.prices,o,J.shipping,J.tipAmount)),[i,c?.prices,o,J.shipping,J.tipAmount]),le=(0,s.Kr)((()=>{if(i===a.tn.Checkout)return function(e,t,i){const s=function(e){const t=oA(e);return aA[t]||""}(e.cardNumber),n=s&&e.cardNumber?`${s} *${e.cardNumber.slice(-4)}`:void 0,a=e.streetLine1?`${e.streetLine1}, ${e.city}, ${e.countryIso2}`:void 0,{phone:o,fullName:r}=e,l=t?MA(t,e.shipping):void 0,c=l?.title;return{paymentMethod:n,paymentProvider:i,shippingAddress:a,name:r,phone:o,shippingMethod:c}}(J,o,d||"")}),[i,J,o,d]),ce=(0,s.hb)((()=>{ae(a.tn.PaymentInfo)}),[ae]),de=(0,s.hb)((()=>{R()}),[R]),he=(0,s.hb)((()=>{F({shippingOptionId:J.shipping,saveCredentials:J.saveCredentials,savedCredentialId:J.savedCredentialId,tipAmount:J.tipAmount})}),[F,J]),ue=(0,s.hb)((e=>{const{credentials:t}=e;x(t),he()}),[he]),pe=(0,s.hb)((()=>{const{saveInfo:e}=J,t=function(e){const{streetLine1:t,streetLine2:i,city:s,state:n,countryIso2:a,postCode:o,fullName:r,phone:l,email:c}=e;return{name:r,phone:l,email:c,shippingAddress:{streetLine1:t,streetLine2:i,city:s,state:n,countryIso2:a,postCode:o}}}(J);P({requestInfo:t,saveInfo:e})}),[P,J]),ve=(0,s.hb)((()=>{const e=function(e){const{cardNumber:t,cardholder:i,expiry:s,cvv:n,billingCountry:a,billingZip:o}=e,[r,l]=s.split("/");return{data:{cardNumber:t,cardholder:i,expiryMonth:r,expiryYear:l,cvv:n,country:a,zip:o}}}(J);B({credentials:e})}),[B,J]),ge=(0,D.A)((()=>{switch(i){case a.tn.ShippingInfo:z(!0),pe();break;case a.tn.Shipping:ae(a.tn.Checkout);break;case a.tn.SavedPayments:ae(a.tn.ConfirmPassword);break;case a.tn.ConfirmPassword:if(""===Q)return;z(!0),L({password:Q});break;case a.tn.PaymentInfo:z(!0),ve(),G({type:"changeSavedCredentialId",payload:""});break;case a.tn.Checkout:{if(k)return z(!0),void ae(a.tn.ConfirmPayment);if(r?.savedInfo&&!b&&!J.shipping)return z(!0),void pe();if(J.savedCredentialId&&(!S||S<=Date.now()/1e3-3))return void ae(a.tn.ConfirmPassword);if(!J.savedCredentialId&&(d===PA&&!C||d===YA&&!f))return void ae(a.tn.PaymentInfo);const{phone:e,email:t,fullName:i}=J,s=c?.isEmailRequested&&!t||c?.isPhoneRequested&&!e||c?.isNameRequested&&!i;if(c?.isShippingAddressRequested&&!b||s)return void ae(a.tn.ShippingInfo);if(c?.isShippingAddressRequested&&!J.shipping&&o?.length)return void ae(a.tn.Shipping);z(!0),he();break}}}));(0,s.vJ)((()=>i===a.tn.ConfirmPassword?(0,Ri.A)({onEnter:ge}):void 0),[ge,i]);const Ae=(0,s.hb)((()=>{G({type:"resetState"}),$(!1),t()}),[t,G]),be=(0,s.hb)((()=>{ae(i===a.tn.ConfirmPassword?a.tn.SavedPayments:a.tn.Checkout)}),[ae,i]),fe=(0,s.Kr)((()=>{switch(i){case a.tn.Checkout:return E("PaymentCheckout");case a.tn.ShippingInfo:return E("PaymentShippingInfo");case a.tn.Shipping:return E("PaymentShippingMethod");case a.tn.SavedPayments:return E("PaymentCheckoutMethod");case a.tn.ConfirmPassword:return E("Checkout.PasswordEntry.Title");case a.tn.PaymentInfo:return E("PaymentCardInfo");case a.tn.ConfirmPayment:return E("Checkout.WebConfirmation.Title");default:return""}}),[i,E]),Ce=i===a.tn.Checkout?E("Checkout.PayPrice",(0,Sa.A)(re,c.currency,E.code)):_("PaymentInfoDone");if(l)return(0,ee.FD)(Z.A,{className:"error",isOpen:U,onClose:K,onCloseAnimationEnd:Ae,children:[(0,ee.FD)("p",{children:["Sorry, Telegram Web A doesn't support payments with this provider yet."," ",(0,ee.Y)("br",{}),"Please use one of our mobile apps to do this."]}),(0,ee.Y)("div",{className:"dialog-buttons mt-2",children:(0,ee.Y)(W.A,{isText:!0,onClick:K,children:E("OK")})})]});const ye=function(){if(j)return!0;switch(i){case a.tn.Checkout:return Boolean(c?.termsUrl)&&!H;case a.tn.PaymentInfo:return Boolean(""===J.cardNumber||h&&""===J.cardholder||""===J.cvv||""===J.expiry);default:return!1}}();return(0,ee.FD)(Z.A,{className:(0,me.A)("PaymentModal",c?.isRecurring&&"recurring"),isOpen:U,onClose:K,onCloseAnimationEnd:Ae,children:[(0,ee.FD)("div",{className:"header",dir:E.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:i===a.tn.Checkout?K:be,ariaLabel:"Close",children:(0,ee.Y)(q.A,{name:i===a.tn.Checkout?"close":"arrow-left"})}),(0,ee.Y)("h3",{children:fe})]}),void 0!==i?(0,ee.Y)(se.Ay,{name:"slide",activeKey:i,shouldCleanup:!0,cleanupOnlyKey:a.tn.ConfirmPayment,children:(0,ee.Y)("div",{className:"content custom-scroll",children:function(e){switch(e){case a.tn.Checkout:return(0,ee.Y)(hA,{title:r.title,description:r.description,photo:r.photo,dispatch:G,shippingPrices:J.shipping&&o?TA(o,J.shipping):void 0,totalPrice:re,invoice:c,checkoutInfo:le,isPaymentFormUrl:k,hasShippingOptions:A,tipAmount:J.tipAmount,needAddress:Boolean(c?.isShippingAddressRequested),savedCredentials:y,isTosAccepted:H,onAcceptTos:$,botName:N});case a.tn.SavedPayments:return(0,ee.Y)(kA,{state:J,savedCredentials:y,dispatch:G,onNewCardClick:ce});case a.tn.ConfirmPassword:return(0,ee.Y)(vA,{state:J,savedCredentials:y,onPasswordChange:X,isActive:e===i});case a.tn.PaymentInfo:return(0,ee.Y)(wA,{state:J,dispatch:G,canSaveCredentials:Boolean(!r.isPasswordMissing&&r.canSaveCredentials),needCardholderName:h,needCountry:m,needZip:u,countryList:g});case a.tn.ShippingInfo:return(0,ee.Y)(IA,{state:J,dispatch:G,needAddress:Boolean(c?.isShippingAddressRequested),needEmail:Boolean(c?.isEmailRequested||c?.isEmailSentToProvider),needPhone:Boolean(c?.isPhoneRequested||c?.isPhoneSentToProvider),needName:Boolean(c?.isNameRequested),countryList:g});case a.tn.Shipping:return(0,ee.Y)(NA,{state:J,dispatch:G,shippingOptions:o||[],currency:c.currency});case a.tn.ConfirmPayment:return(0,ee.Y)(pA,{url:p,noRedirect:w,onPaymentFormSubmit:ue,onClose:K});default:return}}(i)})}):(0,ee.Y)("div",{className:"empty-content",children:(0,ee.Y)(xe.A,{color:"gray"})}),ne&&(0,ee.Y)("div",{className:"footer",children:(0,ee.Y)(W.A,{className:"button-text",type:"submit",onClick:ge,disabled:ye,isLoading:j,children:Ce})}),v&&!v.field&&function(){if(v)return(0,ee.FD)(Z.A,{className:"error",isOpen:Boolean(v),onClose:oe,children:[(0,ee.Y)("h4",{children:v.descriptionKey?_.withRegular(v.descriptionKey):_("ErrorUnspecified")}),(0,ee.Y)("div",{className:"dialog-buttons mt-2",children:(0,ee.Y)(W.A,{isText:!0,onClick:de,children:E("OK")})})]})}()]})})));function MA(e,t){return e.find((({id:e})=>e===t))}function TA(e,t){const i=MA(e,t);return i?.prices}const BA=(0,s.ph)((0,n.EK)((e=>{const{receipt:t}=(0,c.nTw)(e).payment;return{receipt:t}}))((({isOpen:e,onClose:t,receipt:i})=>{const n=(0,_i.A)(),[a,o,r]=(0,Y.A)();(0,s.vJ)((()=>{e&&o()}),[e,o]);const l=(0,gl.A)(i),c=i||l,d=(0,s.Kr)((()=>{if(c)return function(e,t,i){if(!t)return{paymentMethod:e};const{shippingAddress:s}=t,n=s?.streetLine1?`${s.streetLine1}, ${s.city}, ${s.countryIso2}`:void 0,{phone:a,name:o}=t;return{paymentMethod:e,shippingAddress:n,name:o,phone:a,shippingMethod:i}}(c.credentialsTitle,c.info,c.shippingMethod)}),[c]);return(0,ee.Y)(Z.A,{className:"PaymentModal PaymentModal-receipt",isOpen:a,onClose:r,onCloseAnimationEnd:t,children:c&&(0,ee.FD)(ee.FK,{children:[(0,ee.FD)("div",{className:"header",dir:n.isRtl?"rtl":void 0,children:[(0,ee.Y)(W.A,{className:"close-button",color:"translucent",round:!0,size:"smaller",onClick:r,ariaLabel:"Close",children:(0,ee.Y)(q.A,{name:"close"})}),(0,ee.FD)("h3",{children:[" ",n("PaymentReceipt")," "]})]}),(0,ee.Y)("div",{className:"receipt-content custom-scroll",children:(0,ee.Y)(hA,{shippingPrices:c.shippingPrices,totalPrice:c.totalAmount,tipAmount:c.tipAmount,invoice:c.invoice,checkoutInfo:d,title:c.title,description:c.description,photo:c.photo})})]})})}))),RA="Qo4PtFZI",LA="wtfpombl",xA=(0,s.ph)((0,n.EK)(((e,{modal:t})=>({chat:t?.chatId?(0,c.hds)(e,t.chatId):void 0})))((({modal:e,chat:t})=>{const{sendInviteMessages:i,closeInviteViaLinkModal:a,openPremiumModal:o}=(0,n.ko)(),{missingUsers:r}=e||{},c=(0,M.A)(),[d,h]=(0,s.J0)([]),m=(0,s.Kr)((()=>r?.map((e=>e.id))||Ci.p),[r]),[u,p]=(0,s.Kr)((()=>{if(!r?.length)return[[],[]];const[e,t]=(0,fi.jB)(r,(e=>e.isRequiringPremiumToMessage));return[e.map((e=>e.id)),t.map((e=>e.id))]}),[r]),v=(0,s.Kr)((()=>r?.filter((e=>e.isRequiringPremiumToInvite||e.isRequiringPremiumToMessage)).map((e=>e.id))),[r]),g=(0,s.Kr)((()=>{if(r)return!r.some((e=>e.isRequiringPremiumToInvite&&!e.isRequiringPremiumToMessage))}),[r]),A=(0,s.Kr)((()=>{const e=(0,n.mS)().users.byId;return v?.map((t=>e[t]))}),[v]);(0,s.vJ)((()=>{h(p)}),[p]);const b=(0,D.A)((()=>a())),f=(0,s.hb)((()=>{i({chatId:t.id,userIds:d}),a()}),[d,t]),C=(0,s.hb)((()=>{o()}),[]),y=(0,s.Kr)((()=>{if(t)return Boolean(t?.isCreator||t?.adminRights?.inviteUsers)}),[t]),S=(0,s.Kr)((()=>y?c(1===r?.length?"InviteBlockedOneMessage":"InviteBlockedManyMessage"):c("InviteRestrictedUsers2",r?.length)),[y,c,r?.length]),w=(0,s.Kr)((()=>{if(!v?.length||!A?.length)return;const e=g?"InviteMessagePremiumBlocked":"InvitePremiumBlocked";let t=`${e}One`,i=[(0,l.Yg)(A[0])];return 2===v.length?(t=`${e}Two`,i=[(0,l.Yg)(A[0]),(0,l.Yg)(A[1])]):3===v.length?(t=`${e}Three`,i=[(0,l.Yg)(A[0]),(0,l.Yg)(A[1]),(0,l.Yg)(A[2])]):v.length>3&&(t=`${e}Many`,i=[(0,l.Yg)(A[0]),(0,l.Yg)(A[1]),(v.length-2).toString()]),c(t,i,void 0,A.length)}),[v,g,c,A]),k=Boolean(A?.length),N=Boolean(p?.length);return(0,ee.FD)(Z.A,{isOpen:Boolean(m&&t),contentClassName:"n8eENbaR",onClose:b,isSlim:!0,children:[(0,ee.Y)(W.A,{round:!0,color:"translucent",size:"smaller",className:"smosGkw9",ariaLabel:c("Close"),onClick:b,children:(0,ee.Y)(q.A,{name:"close"})}),w&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)(As.A,{className:"Nc3SOtKd",peers:A,size:"large"}),(0,ee.Y)("h3",{className:LA,children:c(y?"InvitePremiumBlockedTitle":"ChannelInviteViaLinkRestricted")}),(0,ee.Y)("p",{className:RA,children:(0,Ft.A)(w,["simple_markdown"])}),(0,ee.Y)(W.A,{withPremiumGradient:!0,isShiny:!0,size:"smaller",onClick:C,children:c("InvitePremiumBlockedSubscribe")})]}),k&&N&&(0,ee.Y)(nc.A,{className:"UoMeVIyC",children:c("InvitePremiumBlockedOr")}),N&&(0,ee.FD)(ee.FK,{children:[(0,ee.Y)("h3",{className:LA,children:c("InviteBlockedTitle")}),(0,ee.Y)("p",{className:RA,children:S}),(0,ee.Y)(yi.A,{className:"nEYyTS_m",itemIds:m,selectedIds:d,lockedUnselectedIds:u,lockedUnselectedSubtitle:c("InvitePremiumBlockedUser"),onSelectedIdsChange:h,isViewOnly:!y,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),y&&(0,ee.Y)(W.A,{className:"Ttkq3nqt",size:"smaller",onClick:f,disabled:!d.length,children:c("SendInviteLink.ActionInvite")})]})]})})));var EA=i(84555);const VA=(0,s.ph)((({modal:e})=>{const{closeOneTimeMediaModal:t}=(0,n.ko)(),i=(0,M.A)(),s=(0,Bi.A)(e?.message,!0),{shouldRender:o,transitionClassNames:r}=(0,Oe.A)(Boolean(e)),d=(0,D.A)((()=>{})),h=(0,D.A)((()=>{t()}));if(!o||!s)return;const m=(0,l.Ie)(s),u=(0,c.SJA)((0,n.mS)()),p=i(m?"Chat.Voice.Single.Close":"Chat.Voice.Single.DeleteAndClose");return(0,ee.FD)("div",{className:(0,me.A)("c3xMWwzW",r),children:[function(){if(!s?.content)return;const{voice:e,video:t}=s.content;return e?(0,ee.Y)(yc.Ay,{className:"VLiJWMs0",theme:u,message:s,origin:a.d9.OneTimeModal,autoPlay:!0,onPlay:d,onPause:h}):t?.isRound?(0,ee.Y)(EA.A,{className:"ML2YEpGq",message:s,origin:"oneTimeModal",onStop:h}):void 0}(),(0,ee.Y)("div",{className:"VWy1qXJL",children:(0,ee.Y)(W.A,{faded:!0,onClick:h,pill:!0,size:"smaller",color:"dark"===u?"dark":"secondary",className:"FfMrCmD9",children:p})})]})})),_A=(0,s.ph)((({isOpen:e})=>{const t=(0,M.A)(),i=(0,_i.A)(),{closeWebAppsCloseConfirmationModal:a,closeWebAppModal:o}=(0,n.ko)(),[r,l]=(0,s.J0)(!1),c=(0,s.li)(),d=(0,s.hb)((()=>{a({shouldSkipInFuture:r})}),[r]),h=(0,s.hb)((()=>{o({shouldSkipConfirmation:!0}),a({shouldSkipInFuture:r})}),[r]),m=(0,s.hb)((e=>{-1===e&&h()}),[h]),u=(0,js.A)(c,e,m,".Button");return(0,ee.FD)(Z.A,{className:(0,me.A)("confirm"),title:i("CloseMiniApps"),isOpen:e,onClose:d,children:[(0,ee.Y)("p",{children:i("AreYouSureCloseMiniApps")}),(0,ee.Y)(un.A,{className:"dialog-checkbox",label:i("DoNotAskAgain"),checked:r,onCheck:l}),(0,ee.FD)("div",{className:"dialog-buttons mt-2",ref:c,onKeyDown:u,children:[(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:h,color:"danger",children:t("Confirm")}),(0,ee.Y)(W.A,{className:"confirm-dialog-button",isText:!0,onClick:d,children:t("Cancel")})]})]})})),UA=(0,s.ph)((0,n.EK)((e=>{const t=e.appConfig?.freezeUntilDate,i=e.appConfig?.freezeAppealUrl,s=e.botFreezeAppealId?(0,c.mBe)(e,e.botFreezeAppealId):void 0;return{freezeUntilDate:t,freezeAppealUrl:i,botFreezeAppealUsername:s&&(0,l.Kl)(s)}}))((({modal:e,freezeUntilDate:t,freezeAppealUrl:i,botFreezeAppealUsername:a})=>{const{closeFrozenAccountModal:o,openUrl:r}=(0,n.ko)(),l=(0,_i.A)(),c=Boolean(e),d=(0,D.A)((()=>{o()})),h=(0,D.A)((()=>{o(),i&&r({url:i})})),m=(0,s.Kr)((()=>(0,ee.FD)("div",{className:"cW2rtp6M",children:[(0,ee.Y)(Tr.A,{size:160,tgsUrl:Mr.w.BannedDuck,noLoop:!0}),(0,ee.Y)("div",{className:"qLSm0uyC",children:l("FrozenAccountModalTitle")})]})),[l]),u=(0,s.Kr)((()=>{if(c)return(0,ee.FD)("div",{className:"Vj3QQ_JQ",children:[(0,ee.Y)(W.A,{className:"anvg3JaY",size:"smaller",onClick:h,noForcedUpperCase:!0,children:l("ButtonAppeal")}),(0,ee.Y)(W.A,{isText:!0,size:"smaller",onClick:d,noForcedUpperCase:!0,children:l("ButtonUnderstood")})]})}),[l,c]);if(!t||!a)return;const p=new Date(1e3*t),v=(0,ee.Y)(Eo.A,{onClick:h,isPrimary:!0,children:(0,pc.A)(a)}),g=[["hand-stop",l("FrozenAccountViolationTitle"),l("FrozenAccountViolationSubtitle")],["lock",l("FrozenAccountReadOnlyTitle"),l("FrozenAccountReadOnlySubtitle")],["frozen-time",l("FrozenAccountAppealTitle"),l("FrozenAccountAppealSubtitle",{botLink:v,date:(0,ze.A)(p,l.code)},{withNodes:!0})]];return(0,ee.Y)(yl.A,{isOpen:c,header:m,listItemData:g,footer:u,hasBackdrop:!0,onClose:d})})))},70046:(e,t,i)=>{i.d(t,{A:()=>u});var s=i(84051),n=i(13439),a=i(87357),o=i(17712),r=i(21849),l=i(10187),c=i(64493),d=i(22337);const h="Cnh5ENvm";var m=i(20021);const u=(0,s.ph)((({isOpen:e,title:t,tableData:i,headerAvatarPeer:s,header:u,modalHeader:p,footer:v,buttonText:g,className:A,hasBackdrop:b,onClose:f,onButtonClick:C,withBalanceBar:y,isLowStackPriority:S})=>{const{openChat:w}=(0,n.ko)(),k=(0,o.A)((e=>{w({id:e}),f()}));return(0,m.FD)(d.A,{isOpen:e,hasCloseButton:Boolean(t),hasAbsoluteCloseButton:!t,absoluteCloseButtonColor:b?"translucent-white":void 0,isSlim:!0,header:p,title:t,className:A,contentClassName:"KYHkJ9Qf",onClose:f,withBalanceBar:y,isLowStackPriority:S,children:[s&&(0,m.Y)(r.A,{peer:s,size:"jumbo",className:"SHQbPR5Y"}),u,(0,m.Y)("div",{className:"DFRB0Ad4",children:i?.map((([e,t])=>(0,m.FD)(m.FK,{children:[Boolean(e)&&(0,m.Y)("div",{className:(0,a.A)(h,"AwnUe4Qk"),children:e}),(0,m.Y)("div",{className:(0,a.A)(h,"JGH6P9Az",!e&&"UssCZwgy"),children:"object"==typeof t&&"chatId"in t?(0,m.Y)(l.A,{peerId:t.chatId,className:"aS9U4hiQ",forceShowSelf:!0,withEmojiStatus:t.withEmojiStatus,clickArg:t.chatId,onClick:k}):t})]})))}),v,g&&(0,m.Y)(c.A,{className:v?void 0:"cSamlkt9",size:"smaller",onClick:C||f,children:g})]})}))},84991:(e,t,i)=>{i.d(t,{A:()=>d});var s=i(84051),n=i(87357),a=i(39351),o=i(21849),r=i(18276);const l={root:"hyRfEyRz",top:"p_Ny8jqJ",badge:"QRrryqp4",text:"I5jdPgFL"};var c=i(20021);const d=(0,s.ph)((({peer:e,avatarWebPhoto:t,avatarSize:i,text:s,badgeText:d,badgeIcon:h,className:m,badgeClassName:u,badgeIconClassName:p,textClassName:v,onClick:g})=>{const A=(0,a.A)();return(0,c.FD)("div",{className:(0,n.A)(l.root,g&&l.clickable,m),onClick:g,children:[(0,c.FD)("div",{className:l.top,children:[(0,c.Y)(o.A,{size:i,peer:e,webPhoto:t}),d&&(0,c.FD)("div",{className:(0,n.A)(l.badge,u),dir:A.isRtl?"rtl":"ltr",children:[h&&(0,c.Y)(r.A,{name:h,className:p}),d]})]}),s&&(0,c.Y)("p",{className:(0,n.A)(l.text,v),children:s})]})}))}}]);
//# sourceMappingURL=9451.b040d15fd5aa1d4a2f58.js.map